/*
 KnowledgeBase Builder

 v2.4

 2013-10-31

 Copyright (c) Ingo Straub Softwareentwicklung, Gerokstr. 6, 71332 Waiblingen

 All Rights Reserved.

 NOTICE:  All information contained herein is, and remains
 the property of Ingo Straub Softwareentwicklung. Dissemination of
 this information or reproduction of this material is strictly
 forbidden unless prior written permission is obtained.
*/
var ea=void 0,i=null;function fa(){return function(){}}function ha(a){return function(){return a}}var ja=new Image;ja.src="images/symbols.png";var la=new Image;la.src="images/icons.png";
var ma=[{i:0,p:/[.]doc/i,b:[0,77,153]},{i:2,p:/[.]xls/i,b:[2,99,26]},{i:4,p:/[.]ppt/i,b:[205,63,44]},{i:6,p:/[.]one/i,b:[129,55,134]},{i:10,p:/[.]pdf/i,b:[225,8,8]},{i:18,p:/[.]kdb/i,b:[53,91,233]},{i:16,p:/[.]gif|[.]bmp|[.]jpg|[.]jpeg|[.]png/i,b:[254,128,1]},{i:12,p:/mailto:\/\//i,b:[24,116,196]},{i:14,p:/file:\/\//i,b:[0,159,45]},{i:8,p:/http:\/\/|https:\/\//i,b:[29,85,164]},{i:20,p:/itemid:\/\//i,b:[53,91,233]},{i:14,p:/.*/i,b:[0,159,45]}],pa=200,qa=200,ua=0.5,va=0.8,wa=0.1,xa=0.5,ya=0.25,Aa=1.75,
Ba=1.3846,Ca=12,Ea=130,Fa=0,Ia=1,La=2,Ra=window.screen.width<700,Sa=["Andale Mono","Arial","Arial Black","Book Antiqua","Bookman","Comic Sans MS","Courier New","Garamond","Georgia","Helvetica","Impact","Lucida Sans Unicode","Palatino","Symbol","Tahoma","Times New Roman","Trebuchet MS","Verdana","Webdings","Wingdings"],Ua=["shift1","shift2","shift3","shift4","shift5","shift6","shift7","shift2","shift1","shift8","shift9","shift10","shift11","shift12","shift13","shift14","shift15"];
window.performance=window.performance||{};performance.now=performance.now||performance.mozNow||performance.msNow||performance.oNow||performance.webkitNow||Date.now||function(){return(new Date).getTime()};window.savevideo=i;window.selectfile=i;window.onNewKnowledgeBaseShortcutPressed=i;window.onOpenKnowledgeBaseShortcutPressed=i;window.onSaveKnowledgeBaseShortcutPressed=i;window.onPrintDiagramShortcutPressed=i;
function Ya(a){return typeof window.MSApp!=="undefined"&&typeof window.MSApp.execUnsafeLocalFunction!=="undefined"?window.MSApp.execUnsafeLocalFunction(a):a()}window.unsafeFunc=Ya;
function Za(a,e){cb(a);a.length>0&&Ya(function(){if(jqMath.parseMathQ)try{if(e){var b=a.html(),g=b.replace(/[\\][\\]/g,"\u00a7\u00a7//\u00a7\u00a7").replace(/[\\][$]/g,"##!!##");g!=b&&a.html(g)}jqMath.parseMath(a[0]);e&&(b=a.html(),g=b.replace(/[\u00a7][\u00a7][/][/][\u00a7][\u00a7]/g,"\\\\").replace(/[#][#][!][!][#][#]/g,"\\$"),g!=b&&a.html(g))}catch(f){}})}
function lb(a){a.find(".mathformula").remove();a.find("math,fmath").each(function(){var a=$(this).attr("alttext"),b=$(this).is(".ma-block")?"$$":"$";$('<span class="mathformula">'+b+a+b+"</span>").insertBefore($(this));$(this).attr("contenteditable","false")})}
function cb(a){a.find("math,fmath").each(function(){var a=$(this).prev();if(a.is(".mathformula"))a.replaceWith(a.text());else{var a=$(this).attr("alttext"),b=$(this).is(".ma-block")?"$$":"$";$(document.createTextNode(b+a+b)).insertBefore($(this))}$(this).remove()});a.find(".mathformula").each(function(){$(this).replaceWith($(this).text())});a.find(".mathformula,math,fmath").remove()}
function mb(){return qb()&&window.PointerEvent||typeof window.navigator!=="undefined"&&typeof window.navigator.pointerEnabled!=="undefined"&&window.navigator.pointerEnabled}function rb(){return qb()&&window.MSPointerEvent||typeof window.navigator!=="undefined"&&typeof window.navigator.msPointerEnabled!=="undefined"&&window.navigator.msPointerEnabled}
function vb(a){return a?typeof a.originalEvent!=="undefined"&&typeof a.originalEvent.kmap_istouchevent!=="undefined"?a.originalEvent.kmap_istouchevent:mb()||rb()?typeof a.originalEvent!=="undefined"&&typeof a.originalEvent.pointerType!=="undefined"&&(a.originalEvent.pointerType==="touch"||a.originalEvent.pointerType==="pen"||a.originalEvent.pointerType===2||a.originalEvent.pointerType===3):typeof a.kmap_istouchevent!=="undefined"&&a.kmap_istouchevent:!1}
var Mb=qb()||Bb()||Cb(),Nb=0,Ob={ids:[]},Pb=!1,Ub=!1;
$.fn.extend({bindMouseOrTouchEvent:function(a,e){return this.each(function(){function b(b){if(typeof b.originalEvent!=="undefined"&&typeof b.originalEvent.changedTouches!=="undefined")for(var f=b.originalEvent.changedTouches,g=0;g<f.length;g++)switch(m){case "mousedown":b.originalEvent.changedTouches.length==1&&(Ob={ids:[]});case "mousemove":typeof Ob[f[g].identifier]==="undefined"&&Ob.ids.push(f[g].identifier);Ob[f[g].identifier]={pageX:f[g].pageX,pageY:f[g].pageY};break;case "mouseup":typeof Ob[f[g].identifier]!==
"undefined"&&(delete Ob[f[g].identifier],Ob.ids.splice($.inArray(f[g].identifier,Ob.ids),1))}h.data(a+".touchevent",!0);b.kmap_istouchevent=!0;vb(b)?(Mb=!0,Nb=(new Date).getTime()):(new Date).getTime()>Nb+500&&(Mb=!1);return e.call(this,b)}function g(b){if(typeof h.data(a+".touchevent")!=="undefined"&&h.data(a+".touchevent"))h.data(a+".touchevent",!1);else return b.kmap_istouchevent=!1,vb(b)?(Mb=!0,Nb=(new Date).getTime()):(new Date).getTime()>Nb+500&&(Mb=!1),e.call(this,b)}function f(a){if(typeof a.originalEvent!==
"undefined"){var b=a.originalEvent;switch(m){case "mousedown":b.isPrimary&&(Ob={ids:[]});case "mousemove":typeof Ob[b.pointerId]==="undefined"&&Ob.ids.push(b.pointerId);Ob[b.pointerId]={pageX:b.pageX,pageY:b.pageY};break;case "mouseup":typeof Ob[b.pointerId]!=="undefined"&&(delete Ob[b.pointerId],Ob.ids.splice($.inArray(b.pointerId,Ob.ids),1))}}vb(a)?(Mb=!0,Nb=(new Date).getTime()):(new Date).getTime()>Nb+500&&(Mb=!1);return e.call(this,a)}var h=$(this),j=a.split("."),m=j[0],j=j.length>1?"."+j[1]:
"";switch(m){case "click":h.bind("click"+j,g);h.bind("touchend"+j,b);break;case "mousedown":mb()?h.bind("pointerdown"+j,f):rb()?h.bind("MSPointerDown"+j,f):(h.bind("mousedown"+j,g),h.bind("touchstart"+j,b));break;case "mousemove":mb()?h.bind("pointermove"+j,f):rb()?h.bind("MSPointerMove"+j,f):(h.bind("mousemove"+j,g),h.bind("touchmove"+j,b));break;case "mouseup":mb()?h.bind("pointerup"+j,f):rb()?h.bind("MSPointerUp"+j,f):(h.bind("mouseup"+j,g),h.bind("touchend"+j,b));break;case "mouseenter":mb()?
(h.bind("pointerover"+j,g),h.bind("pointerup"+j,b)):rb()?(h.bind("MSPointerOver"+j,g),h.bind("MSPointerUp"+j,b)):(h.bind("mouseenter"+j,g),h.bind("touchend"+j,b));break;case "mouseleave":mb()?(h.bind("pointerout"+j,g),h.bind("pointerup"+j,b)):rb()?(h.bind("MSPointerOut"+j,g),h.bind("MSPointerUp"+j,b)):(h.bind("mouseleave"+j,g),h.bind("touchend"+j,b))}})},unbindMouseOrTouchEvent:function(a){return this.each(function(){var e=$(this),b=a.split("."),g=b.length>1?"."+b[1]:"";switch(b[0]){case "click":e.unbind("click"+
g);e.unbind("touchend"+g);break;case "mousedown":mb()?e.unbind("pointerdown"+g):rb()?e.unbind("MSPointerDown"+g):(e.unbind("mousedown"+g),e.unbind("touchstart"+g));break;case "mousemove":mb()?e.unbind("pointermove"+g):rb()?e.unbind("MSPointerMove"+g):(e.unbind("mousemove"+g),e.unbind("touchmove"+g));break;case "mouseup":mb()?e.unbind("pointerup"+g):rb()?e.unbind("MSPointerUp"+g):(e.unbind("mouseup"+g),e.unbind("touchend"+g));break;case "mouseenter":mb()?(e.unbind("pointerover"+g),e.unbind("pointerup"+
g)):rb()?(e.unbind("MSPointerOver"+g),e.unbind("MSPointerUp"+g)):(e.unbind("mouseenter"+g),e.unbind("touchend"+g));break;case "mouseleave":mb()?(e.unbind("pointerout"+g),e.unbind("pointerup"+g)):rb()?(e.unbind("MSPointerOut"+g),e.unbind("MSPointerUp"+g)):(e.unbind("mouseleave"+g),e.unbind("touchend"+g))}})}});var Xb=666,ac=400,dc=0.2,fc=0.325,nc="processaction",pc=1,rc=2,sc=16,Dc=32,Ec=64,Fc={"default":1,circle:2,rect:2,rhomb:2.5,hexagon:2.25,triangle:2.25,para:2,trapez:2},Gc="css/jqmath-0.4.0.css";
U()?Gc="JQMATH.CSS":qb()?Gc="/css/jqmath-0.4.0.css":Bb()?Gc="css/jqmath-0.4.0.css":Cb()&&(Gc="css/jqmath-0.4.0.css");function U(){return window.external&&window.external.AjaxForCPP}function qb(){return typeof window.KnowledgeBaseBuilderControler!=="undefined"}function Bb(){return typeof window.JSInterface!=="undefined"}function Cb(){return typeof window.webkit!=="undefined"}
function Oc(a){return window.external&&window.external.AjaxForCPP?$.parseJSON(window.external.AjaxForCPP(JSON.stringify(a))):""}function Pc(a,e){window.KnowledgeBaseBuilderControler.Controler.ActionControler.processAction(JSON.stringify(a)).then(e)}function dd(a,e){setTimeout(function(){e(window.JSInterface.processAction(JSON.stringify(a)))},1)}var ed={};function fd(a,e){var b=gd();ed[b]=e;a.callbackID=b;window.webkit.messageHandlers.processAction.postMessage(JSON.stringify(a))}
window.ajaxForApple=fd;window.ajaxCallbackForApple=function(a,e){if(typeof ed[a]==="function"){var b=i;if(e){for(var b=atob(e),g=b.length,f=new Uint8Array(g),h=0;h<g;h++)f[h]=b.charCodeAt(h);b=(new TextDecoder).decode(f)}ed[a].call(this,b);delete ed[a]}};function hd(a){return a.toLowerCase().indexOf("<html>")==0?a.replace(/(^<html>)/i,"").replace(/(<\/html>$)/i,""):i}
function jd(a){return a.toLowerCase().indexOf("<html>")==0?a.replace(/(<br[ \/]*>)/gi," ").replace(/(<\/li>)/gi," ").replace(/(<([^>]+)>)/g,"").replace(/(&nbsp;)/gi," ").replace(/(&lt;)/gi,"<").replace(/(&gt;)/gi,">").replace(/(&quot;)/gi,'"').replace(/(&amp;)/gi,"&"):a}
function kd(a){return a.toLowerCase().indexOf("<html>")==0?a.replace(/(<br[ \/]*>)/gi,"\n").replace(/(<\/li>)/gi,"\n").replace(/(<([^>]+)>)/g,"").replace(/(&nbsp;)/gi," ").replace(/(&lt;)/gi,"<").replace(/(&gt;)/gi,">").replace(/(&quot;)/gi,'"').replace(/(&amp;)/gi,"&"):a.replace(/[\r]/gi,"")}function Ad(a){var e=kd(a);$.each(e.split(/[\n]/),function(){var a=$.trim(this);if(a!="")return e=a,!1});return e}
function Ed(a){return a.replace(/(<br[ \/]*>)/gi," ").replace(/(<([^>]+)>)/g,"").replace(/(&nbsp;)/gi," ").replace(/(&lt;)/gi,"<").replace(/(&gt;)/gi,">").replace(/(&quot;)/gi,'"').replace(/(&amp;)/gi,"&").replace(/([ ]+)/gi," ")}function Md(a){a=$.trim(a);a.replace(/(<br[ \/]*>)/gi,"")==""&&(a="");return a}function Nd(a){return String(a).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}
function Od(a,e,b,g,f){var h=b.outerWidth(),j=b.outerHeight(),b=e.scrollLeft(),m=e.scrollTop(),o=b+e.innerWidth(),x=m+e.innerHeight();g+h>o&&(g=o-h);f+j>x&&(f=x-j);g<b&&(g=b);f<m&&(f=m);a&&(a=a.offset(),e=e.offset(),g+=e.left-a.left-b,f+=e.top-a.top-m);return[g,f]}
function Pd(a,e,b,g){this.db=i;this.ya=a;this.ea=e;this.indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB;this.IDBTransaction=window.IDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction;this.IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange||window.msIDBKeyRange;this.ka=-1;this.dc=b;this.qd=g;this.Yd=i;if(typeof window.localStorage!=="undefined"&&(a=window.localStorage.getItem("template_"+a))&&!isNaN(a))this.ka=parseInt(a)}
Pd.prototype.open=function(a,e){if(this.db)a.call(this);else if(this.indexedDB&&this.IDBTransaction&&this.IDBKeyRange){var b=this,g=this.indexedDB.open(this.ya,1);g.onerror=function(){b.db=i;e.call(b)};g.onsuccess=function(){b.db=g.result;a.call(b)};g.onupgradeneeded=function(){var a=this.result;a.objectStoreNames.contains(b.ea)||a.createObjectStore(b.ea,{keyPath:"id",autoIncrement:!0}).createIndex("lcTemplateName","lcTemplateName",{unique:!1})}}else if(typeof window.localStorage!=="undefined"){var f=
window.localStorage.getItem("template_"+this.ya+"_"+this.ea+"_maxindex");(f==i||isNaN(f))&&window.localStorage.setItem("template_"+this.ya+"_"+this.ea+"_maxindex",0);a.call(this)}else e.call(this)};function Qd(a,e,b,g,f,h,j,m){return{TemplateName:a,lcTemplateName:a.toLowerCase(),UUID:Rd(),Modified:performance.now(),Name:e,Description:b,DirectLinkURL:g,CategoryID:f,CategoryName:h,Properties:j,TextNoteHtml:m}}
function Sd(a,e,b){a.open(function(){if(this.db){var a=this;this.db.transaction([this.ea],"readwrite").objectStore(this.ea).add(b).onsuccess=function(){a.ka=this.result;typeof window.localStorage!=="undefined"&&window.localStorage.setItem("template_"+a.ya,this.result);Td(a,e);a.qd(a.dc.j)}}else if(typeof window.localStorage!=="undefined"){var f=0,h=0;(f=window.localStorage.getItem("template_"+this.ya+"_"+this.ea+"_maxindex"))&&!isNaN(f)&&(h=parseInt(f));for(f=0;f<h;f++)if(window.localStorage.getItem("template_"+
this.ya+"_"+this.ea+"_list_"+f)==i)break;try{b.id=f;var j=JSON.stringify(b);window.localStorage.setItem("template_"+this.ya+"_"+this.ea+"_list_"+f,j);f==h&&(h++,window.localStorage.setItem("template_"+this.ya+"_"+this.ea+"_maxindex",h));this.ka=f;window.localStorage.setItem("template_"+this.ya,f);Td(this,e);this.qd(this.dc.j)}catch(m){}}},fa())}
function Xd(a,e,b){a.open(function(){if(this.db){var a=this;a.db.transaction([a.ea],"readwrite").objectStore(a.ea).put(b).onsuccess=function(){Td(a,e)}}else if(typeof window.localStorage!=="undefined"&&this.ka>=0)try{var f=JSON.stringify(b);window.localStorage.setItem("template_"+this.ya+"_"+this.ea+"_list_"+this.ka,f);Td(this,e)}catch(h){}},fa())}
function ne(a,e){a.open(function(){if(this.db){if(this.ka>=1){var a=this;this.db.transaction([this.ea],"readwrite").objectStore(this.ea)["delete"](this.ka).onsuccess=function(){a.ka=-1;typeof window.localStorage!=="undefined"&&window.localStorage.setItem("template_"+a.ya,-1);Td(a,e);a.qd(a.dc.j)}}}else if(typeof window.localStorage!=="undefined"&&this.ka>=0)window.localStorage.removeItem("template_"+this.ya+"_"+this.ea+"_list_"+this.ka),this.ka=-1,window.localStorage.setItem("template_"+this.ya,-1),
Td(this,e),this.qd(this.dc.j)},fa())}function te(a,e){a.Yd?(e(a.Yd),a.Yd=i):a.open(function(){if(this.db)if(this.ka>=1){var a=this.db.transaction([this.ea]).objectStore(this.ea).get(this.ka);a.onsuccess=function(){e(this.result)};a.onerror=function(){e(i)}}else e(i);else if(typeof window.localStorage!=="undefined")if(this.ka>=0){a=i;try{var g=window.localStorage.getItem("template_"+this.ya+"_"+this.ea+"_list_"+this.ka);g&&(a=JSON.parse(g))}catch(f){}e(a)}else e(i)},function(){e(i)})}
function ue(a){return a.indexedDB&&a.IDBTransaction&&a.IDBKeyRange?a.ka>=1:a.ka>=0}
function Td(a,e){e.gallerysection("clearexcept",["id-new-template","id-update-template","id-rename-template","id-delete-template","id-apply-template"]);a.open(function(){function a(b){e.gallerysection("addgalleryitem","id-template-"+b.id,b.TemplateName,"tooltip",2,3,!1,b.id==g.ka?1:0,!0,!1,function(a,b){b?(g.ka=a.data("pos"),e.gallerysection("setselected","id-template-"+g.ka)):g.ka=-1;typeof window.localStorage!=="undefined"&&window.localStorage.setItem("template_"+g.ya,g.ka);g.qd(g.dc.j)}).data("pos",
b.id)}var g=this;if(this.db)this.db.transaction([this.ea]).objectStore(this.ea).index("lcTemplateName").openCursor().onsuccess=function(){var e=this.result;e&&(a(e.value),e["continue"]())};else if(typeof window.localStorage!=="undefined"){var f=0,h=window.localStorage.getItem("template_"+this.ya+"_"+this.ea+"_maxindex");h&&!isNaN(h)&&(f=parseInt(h));for(h=0;h<f;h++)try{var j=window.localStorage.getItem("template_"+this.ya+"_"+this.ea+"_list_"+h);if(j){var m=JSON.parse(j);m&&a(m)}}catch(o){}}},fa())}
(function(a){a.fn.kmap=function(e){if(typeof this.data(e)==="function")return this.data(e).apply(this,Array.prototype.slice.call(arguments,1));else if(typeof e==="object"||!e){var b=a.extend({fullscreen:!1,maxitems:-1,detaillevel:-1,maxchildspernodelevel1:-1,maxchildspernodelevel2:-1,maxchildspernodelevel3:-1,maxchildspernodelevel4:-1,showcategories:!1,shownotetag:!1,showdescriptiontag:!1,showmorerelationcount:!1,showhiddenrelationcount:!1,showitemshift:!1,reltips:!0,editmode:!1,textnote:1,knowledgebasegallery:!1,
importexport:!1,wikipediaimport:!1,wikidataimport:!1,twitterimport:!1,webpageimport:!1,updatesidegallerycallback:i,downloadbutton:!1,width:"1020px",height:"750px",zoomfact:1,stretchfact:1,rotation:0,perspective:0,language:"en",database:"sqlite://knowledgebase.kdb",rootitemid:-1,rootitemname:"",baseurl:"",scriptextension:".php",imagesdir:"images/",htmldir:"html/",legalnotice:""},e);return this.each(function(){function e(){this.j=this.fa=this.L=i;this.Ld=this.Kg=this.Lg=!1;this.Oe=this.vd=this.Pe=-1;
this.Te="";this.Qe=0;this.Re=this.Se=!1;this.ca=this.Fa=this.B=this.za=this.G=-1;this.ge=!1;this.T=this.Ja=this.Wa=this.Ka=this.ga=this.Za=this.na=-1;this.la=b.maxitems;this.ha=b.detaillevel;this.Aa=b.maxchildspernodelevel1;this.Ba=b.maxchildspernodelevel2;this.Ca=b.maxchildspernodelevel3;this.Da=b.maxchildspernodelevel4;this.D=b.zoomfact;this.M=b.stretchfact;this.rotation=b.rotation;this.$=b.perspective;this.Xa=1-(1-dc)*this.$/100;this.K=1-(1-fc)*this.$/100;this.ma=b.showcategories;this.xa=b.shownotetag;
this.ta=b.showdescriptiontag;this.va=b.showmorerelationcount;this.ua=b.showhiddenrelationcount;this.Oa=b.showitemshift;this.Ng=b.reltips;this.H=b.editmode;this.Df=b.textnote;this.de=this.mb=this.nb=this.lb=this.sb=this.Lc=this.Db=!1;this.gc=this.me=!0;this.Ia=!1;this.Hb={};this.pc=-1}function f(){this.q=[];this.R=[];this.Qa=[];this.da={};this.Ab={};this.F={};this.ja={};this.Sb={};this.Oc=i;this.vc=-1;this.Sd=i;this.aa=this.W=-1;this.Ac=this.Bc=this.height=this.width=0;this.hd=this.gd=!1;this.Cb=this.Lb=
this.Bb=this.Kb=0;this.Zb=[]}function h(a,d,l,M,b){this.x=a;this.y=d;this.eb=l;this.Ua=M;this.Sc=b}function j(c,d,l,M){this.bg=c.id;this.F=a.map(c.lm,function(a,c){return parseInt(c)});d?(c.x0>l*2/3&&c.x0<l*4/3&&c.x2>l*2/3&&c.x2<l*4/3&&c.y0>M*2/3&&c.y0<M*4/3&&c.y2>M*2/3&&c.y2<M*4/3?(this.xd=1.5*l,this.Bd=3*M,this.yd=1.5*l,this.Cd=3*M,this.zd=1.5*l,this.Dd=3*M,this.Ad=1.5*l,this.Ed=3*M):(this.xd=l+(c.x0-l)*3,this.Bd=M+(c.y0-M)*3,this.yd=l+(c.x1-l)*3,this.Cd=M+(c.y1-M)*3,this.zd=l+(c.x2-l)*3,this.Dd=
M+(c.y2-M)*3,this.Ad=l+(c.x3-l)*3,this.Ed=M+(c.y3-M)*3),this.ye=c.x0,this.Ce=c.y0,this.ze=c.x1,this.De=c.y1,this.Ae=c.x2,this.Ee=c.y2,this.Be=c.x3,this.Fe=c.y3,this.Mg=c,this.wc=1,this.ob=0):(this.ye=l,this.xd=c.x0,this.Ce=M,this.Bd=c.y0,this.ze=l,this.yd=c.x1,this.De=M,this.Cd=c.y1,this.Ae=l,this.zd=c.x2,this.Ee=M,this.Dd=c.y2,this.Be=l,this.Ad=c.x3,this.Fe=M,this.Ed=c.y3,this.wc=0,this.ob=1)}function m(a,d,l,M,b,e){this.jd(a,d,l,M,b);this.Uc=!1;this.dd=this.ed=this.bb=this.Ra=this.fb=this.Sa=this.gb=
0;d=i;typeof a.pt!=="undefined"&&(d=a.pt);l=i;typeof a.ptd!=="undefined"&&(l=a.ptd);e?(this.Ic=d,this.La=i,this.zf=l,this.Cc=i,this.wc=1,this.ob=0):(this.Ic=i,this.La=d,this.zf=i,this.Cc=l,this.wc=0,this.ob=1)}function o(a,d,l,M,b){var e=a.i[d];l?(e.x>M*2/3&&e.x<M*4/3&&e.y>b*2/3&&e.y<b*4/3?(this.O=1.5*M,this.N=3*b):(this.O=M+(e.x-M)*3,this.N=b+(e.y-b)*3),this.Fb=0,this.Wb=e.x,this.Xb=e.y,this.Cg=e.z,this.ib=e.r,this.V=0,this.zg=e.t,this.Ob=0,this.Ag=e.l,this.U=-1):(this.Wb=M,this.O=e.x,this.Xb=b,
this.N=e.y,this.Cg=0,this.Fb=e.z,this.ib=0,this.V=e.r,this.zg=0,this.Ob=e.t,this.Ag=-1,this.U=e.l);this.ie=this.Dg=e.w;this.jd(a,d,l);this.A=e}function x(a){this.bookmarks=[];this.initialviewindex=-1;try{if(a&&a!=""){var d=JSON.parse(a);if(d)this.bookmarks=d.bookmarks,typeof d.initialviewindex!=="undefined"&&(this.initialviewindex=d.initialviewindex)}}catch(l){this.bookmarks=[],this.initialviewindex=-1}this.He(-1)}function s(a,d,l,M,b,e,D,n,G,v,f,g,S,u,W,q,w,za,h,K,j,yb,m,o,p,r,tx,s,B,x,y,A,C,E,I,
N,sa,Ud,ia,hg){this.n=a;this.i=d;this.z=l;this.s=M;this.rot=b;this.persp=e;this.mi=D;this.ml=n;this.c1=G;this.c2=v;this.c3=f;this.c4=g;this.ssb=S;this.skg=u;this.seg=W;this.sfg=q;this.ssg=w;this.sig=za;this.t=h;this.svg=K;this.sdg=j;this.shg=yb;this.e=m;this.dl=o;this.dl3d=p;this.tv=r;this.iex=tx;this.dce=s;this.mri=B;this.wcl=A;this.wtr=C;this.to3d=x;this.atran=y;this.a=E;this.nt=I;this.dt=N;this.mr=sa;this.hr=Ud;this.sft=ia;this.f=hg}function r(a){this.excludeitems={};this.excludeitemtemplates=
{};this.excluderelations={};this.excluderelationtemplates={};this.databaseid=a;try{if(this.databaseid&&this.databaseid.length>0&&typeof window.localStorage!=="undefined"){var d=window.localStorage.getItem("db_"+this.databaseid+"_filter");if(d){var l=JSON.parse(d);if(l)this.excludeitemtemplates=l.excludeitemtemplates,this.excluderelationtemplates=l.excluderelationtemplates}}}catch(M){this.excludeitems={},this.excludeitemtemplates={},this.excluderelations={},this.excluderelationtemplates={}}}function A(a){this.searchhistory=
[];this.curpos=-1;this.databaseid=a;try{if(this.databaseid&&this.databaseid.length>0&&typeof window.localStorage!=="undefined"){var d=window.localStorage.getItem("db_"+this.databaseid+"_searchhistory");if(d){var l=JSON.parse(d);if(l)this.searchhistory=l.searchhistory,this.curpos=l.curpos,this.curpos>=0&&this.curpos<this.searchhistory.length&&id&&id.val(this.searchhistory[this.curpos])}}}catch(M){this.searchhistory=[],this.curpos=-1}this.ae()}function p(a){this.history=[];this.curpos=-1;this.databaseid=
a;try{if(this.databaseid&&this.databaseid.length>0&&typeof window.localStorage!=="undefined"){var d=window.localStorage.getItem("db_"+this.databaseid+"_history");if(d){var l=JSON.parse(d);if(l)this.history=l.history,this.curpos=l.curpos,this.Gf()}}}catch(M){this.history=[],this.curpos=-1}}function E(a,d){this.i=a;this.n=d}function B(c,d,l){U()?(c=Oc(c),d(c)):qb()?Pc(c,function(c){c=a.parseJSON(c);d(c)}):Bb()?dd(c,function(c){c=a.parseJSON(c);d(c)}):Cb()?fd(c,function(c){c=a.parseJSON(c);d(c)}):a.ajax({url:b.baseurl+
nc+b.scriptextension,dataType:"json",data:c,success:function(a){d(a)},error:function(){typeof l==="function"&&l()}})}function I(c,d){if(U()){var l=Oc(c);d(l,c.search)}else qb()?Pc(c,function(l){l=a.parseJSON(l);d(l,c.search)}):Bb()?dd(c,function(l){l=a.parseJSON(l);d(l,c.search)}):Cb()?fd(c,function(l){l=a.parseJSON(l);d(l,c.search)}):a.ajax({url:b.baseurl+nc+b.scriptextension,dataType:"json",data:c,searchString:c.search,success:function(a){d(a,this.searchString)}})}function F(c,d,l,b){qb()?WinJS.xhr({responseType:"json",
url:c+"?"+a.param(d)}).done(function(c){c&&typeof c.response==="string"?l(a.parseJSON(c.response)):l(c.response)},function(){b()},fa()):a.ajax({url:c,data:d,dataType:"jsonp",success:function(a){l(a)},error:function(){b()}})}function ca(a,d,l){if(qb())try{ig==i&&(ig=new window.Windows.Web.Http.HttpClient,ig.defaultRequestHeaders.userAgent.parseAdd("Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.79 Safari/537.36 Edge/14.14393"));var b=new window.Windows.Foundation.Uri(a),
t=i;ig.getAsync(b).then(function(a){a.isSuccessStatusCode&&(d?a.content.readAsBufferAsync().then(function(c){for(var c=new Uint8Array(c,0,c.length),d="",k=0;k<c.length;k++)d+=String.fromCharCode(c[k]);t=btoa(d);t="data:"+a.content.headers["content-type"]+";base64,"+t;return a}):a.content.readAsStringAsync().then(function(c){t=c;return a}))}).done(function(){l(t)},function(){l(i)})}catch(e){l(i)}else if(Bb()||U()){b=new XMLHttpRequest;b.onreadystatechange=function(){if(this.readyState==4){var a=!0;
if(this.status==200)if(d){if(typeof this.response!=="undefined"){for(var a=new Uint8Array(this.response,0,this.response.byteLength),c="",b=0;b<a.length;b++)c+=String.fromCharCode(a[b]);c=btoa(c);c="data:"+this.getResponseHeader("content-type")+";base64,"+c;a=!1;l(c)}}else typeof this.responseText==="string"&&(a=!1,l(this.responseText));a&&l(i)}};b.onerror=function(){l(i)};try{b.open("GET",a,!0),b.responseType=d?"arraybuffer":"text ",b.send(i)}catch(D){l(i)}}else B({action:"getremotefile",url:a,isbinary:d?
1:0},function(a){l(a)},function(){l(i)})}function T(c,d){function l(c,d,k){a(".waitinl").addClass("waitinllarge");a("div.waitanim span.waittext").text(c.replace("%1",d+1).replace("%2",k))}function b(c,d){var c=a.trim(c),d=a.trim(d),k=c.lastIndexOf("/"),l=c.indexOf("//");k>l+2&&c.substr(k+1).match(/[.?&]/)&&(c=c.substr(0,k+1));c[c.length-1]!="/"&&(c+="/");var k=c.substr(0,c.indexOf("/",l+2)),M=c.substr(0,l),l=c.substr(c.indexOf("/",l+2));if(d.indexOf("//")===0)k=M+d;else if(d.indexOf("/")===0)k+=d;
else if(d.indexOf("://")>0)k=d;else{for(;d.indexOf("./")===0;)d=d.substring(2);for(;d.indexOf("../")===0;)d=d.substring(3),l!=="/"&&(l=l.substring(0,l.lastIndexOf("/",l.length-2)+1));k+=l+d}return k}function t(a,c){function d(){if(!Pb){if(b<a.length){var c=a[b];b++;ca(c.url,!0,function(a){a&&(c.data=a.replace(/\r/g,"").replace(/\n/g,""));M++;d()})}M<a.length&&l(Xh,M,a.length)}}function k(){setTimeout(function(){Pb||M>=a.length?c():k()},250)}var b=0,M=0,t=0;l(Xh,0,a.length);for(t=0;t<10;t++)d();k()}
function e(a,c){for(var d=0;d<a.length;d++){var k=a[d].data;if(typeof k!=="undefined"&&k){var l=k.indexOf(","),t="";if(l>=0&&(t=k.substr(0,l+1),k=k.substr(l+1),k!=""&&t.substr(0,14).toLowerCase()=="data:text/css;")){var Va=!1,k=ve(k),k=k.replace(/(url[ ]*\([\"\']*)([^\)\"\']*)/gi,function(c,k,l){return l.substr(0,5).toLowerCase()=="data:"?k+l:(Va=!0,k+b(a[d].url,l))});Va&&(a[d].data=t+we(k))}}}c()}var c=a.trim(c),D=[];D.push({url:c});t(D,function(){var l=D[0].data;if(Pb||typeof l==="undefined"||l==
i||l=="")d(i);else{var G=l.indexOf(","),v="";G>=0&&(v=l.substr(0,G+1),l=l.substr(G+1));if(l=="")d(i);else if(v.toLowerCase().indexOf("utf-8")>=0?l=ve(l):v.toLowerCase().indexOf("iso-8859-1")>=0?l=atob(l):(G=l,l=atob(l),l.match(/charset\s*=[\s\"\']*utf-8/i)&&(l=ve(G))),l.match(/<html/i)){var f=[],g={},l=l.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,""),l=l.replace(/<iframe\b[^<]*(?:(?!<\/iframe>)<[^<]*)*<\/iframe>/gi,""),l=l.replace(/<[/]*noscript[^>]*>/gi,""),l=l.replace(/<[/]*meta[^>]*>/gi,
""),l=l.replace(/(<[^>]*(src|href)\s*=\s*[\"\'])([^>\"\']*)([\"\'][^>]*>)/gi,function(a,d,l,k,t){return k.substr(0,5).toLowerCase()=="data:"?d+k+t:d.toLowerCase().lastIndexOf("<img",0)===0||d.toLowerCase().lastIndexOf("<link",0)===0?(a=gd(),k=b(c,k),typeof g[k]!=="undefined"?a=g[k]:(f.push({id:a,url:k}),g[k]=a),d+a+t):d+b(c,k)+t}),l=l.replace(/(url[ ]*\([\"\']*)([^\)\"\']*)/gi,function(a,d,k){return k.substr(0,5).toLowerCase()=="data:"?d+k:d+b(c,k)}),l=l.replace(/(<[^> ]*)(\s*target\s*=\s*[\"\'][^>\"\']*[\"\'])([^>]*>)/gi,
function(a,c,d,k){return c+k}),l=l.replace(/(<a\s*[^>]*href\s*=\s*[\"\'][^>\"\']*[\"\'])([^>]*>)/gi,function(a,c,d){return c+' target="_blank"'+d}),l=l.replace(/(<[^> ]*)(\s*action\s*=\s*[\"\'][^>\"\']*[\"\'])([^>]*>)/gi,function(a,c,d,k){return c+k}),S=l.replace(/(<[^>]*(src|href)\s*=\s*[\"\'])([^>\"\']*)([\"\'][^>]*>)/gi,function(a,c,d,k,l){return c+l}),S=S.replace(/<style\b[^<]*(?:(?!<\/style>)<[^<]*)*<\/style>/gi,""),u="",W="",q;if((G=S.match(/<title>([^<]*)<\/title>/im))&&G.length>1)G=a.trim(G[1].replace(/\r\n/g,
" ").replace(/[\r\n]/g," ")),G=a("<div></div>").html(G),q=Qc(G[0],i,0,i,0,i),q.sp=0,q.ep=0,G=Vb(q,!1),q.ep=Math.min(40,G.d.length),G=Vb(q,!1),u=G.n,W=G.d;G=Ya(function(){return a("<div></div>").html(S)});q=Qc(G[0],i,0,i,0,i);if(u=="")q.sp=0,q.ep=0,G=Vb(q,!1),q.ep=Math.min(40,G.d.length),G=Vb(q,!1),u=G.n,W=G.d;t(f,function(){e(f,function(){if(Pb)d(i);else{for(var a=0;a<f.length;a++){var c=f[a].data;if(typeof c==="undefined"||c==i||c.substr(0,6).toLowerCase()=="data:;")c="";l=l.replace(RegExp(f[a].id,
"g"),c)}d({html:l,text:q.t,name:u,description:W})}})})}else d(i)}})}function V(c,d){if(Ib||Wb||$b||Ma&&(L.zoom||L.dragged))c.preventDefault();else{var l=this;a.fn.C.closedelayed=!1;setTimeout(function(){a.fn.C.closedelayed||da.call(l,c,d)},10);return!1}}function da(c,k){if(!(typeof c.originalEvent!=="undefined"&&typeof c.originalEvent.type!=="undefined"&&typeof c.originalEvent.pointerType!=="undefined"&&(c.originalEvent.type=="MSPointerOver"||c.originalEvent.type=="pointerover")&&c.originalEvent.pointerType!==
"mouse"&&c.originalEvent.pointerType!==4))if(!Ib&&!Wb&&!($b||Ma&&(L.zoom||L.dragged))){var l=!1,M=a(this).closest("div"),t=a(this).is("a")?a(this):a(this).find("a:first"),e=t.data("pid"),D=d.j.q[d.j.F[e]],n=a(a.fn.C.obj);if(C.find(".itemselector").is(":visible")&&C.find(".itemselector a").data("pid")==e&&(!k||n.is(":visible")||C.find(".itemtoolbar").is(":visible")))l=!0;if(!l&&D){a.fn.C.close();d.j.Hc(i,i,!1);var l=function(c){var k=a(this).data("pid"),l=d.j.q[d.j.F[k]];if(!C.find(".itemselector").is(":visible"))return ld(c),
!1;ld(i);d.j.Ga(k,-1,d.H||k==P,!1,d.Ia||d.H||k==P);d.Ia?jg(k,!0,i):d.H?V.call(l.A.J,c,!0):k!=P&&(d.load(k,-1,"",Xb,!0,!1,xe+1),U()&&Oc({action:"onitemselected",i:k,r:-1,search:"",setasroot:1,redraw:1}));return!1},n=function(){if(d.H){var c=a(this).data("pid");c==P?Rc(c):(d.load(c,-1,"",Xb,!0,!1,xe+1),U()&&Oc({action:"onitemselected",i:c,r:-1,search:"",setasroot:1,redraw:1}))}},G=function(c){var k=c.handleObj,l=a.data(c.target),b=(new Date).getTime(),M=l.qa?b-l.qa:0;M<300&&M>30?(l.qa=i,c.type=k.origType,
d.H&&(c=a(this).data("pid"),c==P?Rc(c):(d.load(c,-1,"",Xb,!0,!1,xe+1),U()&&Oc({action:"onitemselected",i:c,r:-1,search:"",setasroot:1,redraw:1})))):l.qa=b},t=C.find(".itemselector a").attr("href",t.attr("href")).data("pid",e);t.unbindMouseOrTouchEvent("click.kmEvents").bindMouseOrTouchEvent("click.kmEvents",l);t.unbind("dblclick.kmEvents").bind("dblclick.kmEvents",n);t.unbind("touchstart.kmEvents").bind("touchstart.kmEvents",G);t=C.find(".itemselector .kbb-selector-button").data("pid",e);t.unbindMouseOrTouchEvent("click.kmEvents").bindMouseOrTouchEvent("click.kmEvents",
l);t.unbind("dblclick.kmEvents").bind("dblclick.kmEvents",n);t.unbind("touchstart.kmEvents").bind("touchstart.kmEvents",G);var t=16*Math.max(1,d.D),n=M.position().left-t,G=M.position().top-t,v=M.outerWidth()+2*t,l=M.outerHeight()+2*t;C.find(".itemselector .kbb-selector-button").css("transform","scale("+d.D+")");C.find(".itemselector").appendTo(M).css({left:-t+"px",top:-t+"px",width:v+"px",height:l+"px","-moz-border-radius":t+"px","-webkit-border-radius":t+"px","border-radius":t+"px"}).show();var f=
!1;if(d.H&&(e==d.j.W||k)&&!d.Ia&&D.xb(rc|sc|Dc|Ec))v=C.find(".itemtoolbar"),f=C.find(".kmappage"),f=M.offset().top-f.offset().top-t-v.outerHeight()<0,db(".id-new-item",!0,D.xb(pc)&&D.xb(rc)),db(".id-new-relation",!0,D.xb(rc)),db(".id-edit-item",!0,D.xb(Dc|Ec)),db(".id-delete-item",!0,D.xb(sc)),db(".id-delete-relation",!0,!1),db(".id-open-attachments",!0,D.$a),db(".id-undo",!0,nf.length>0),db(".id-redo",!0,of.length>0),db(".id-paste-item",!0,Vd),db(".id-reset-item-shift",!0,kg(e,d.j)),db(".id-reset-item-shifts",
!0,kg(-1,d.j)),Yh(v,n,G+(f?l-1:1),f);if(!f&&(!d.H||d.H&&(e==d.j.W||k)&&!d.Ia))D=M.offset().left+M.width(),D=D-M.width()/2>a(window).width()/2&&D>a(window).width()-370,window.lastTooltipItemID=e,window.lastTooltipRelationID=-1,M.C({alignment:D?{body:"left",pointer:"right"}:{body:"right",pointer:"left"},url:b.baseurl+nc+b.scriptextension,action:"tooltip",diagram:d,openAttachments:Sc,openDocument:md,rootItemID:P,id:e,idfrom:-1,idto:-1,hOffset:13,vOffset:3-Math.min(l/2-t-15,0),moveTop:!d.H,searchEngines:Wd,
fadeIn:d.T!=0,onOpenCallback:function(c){if(typeof c!=="undefined"){var c=[jd(c.n)],c=ze(c),d=a(a.fn.C.obj).find(".tttext");nb(d,c,!0,!1)}},database:O}),a.fn.C.obj.mouseleave(function(c){d.lc(c)||a.fn.C.close()});vb(c)&&d.j.Vb(e)}return!1}}function N(a){var k="",l=Ua[d.G],b=d.xa||d.B==Ia,t=d.ta||d.B==Ia,e=d.ma||d.B==Ia,D=d.va||d.B==Ia,n=d.ua||d.B==Ia,G=0,v=0;if(d.Oa&&a.properties&&a.properties[l]&&(l=a.properties[l],l=d.yb()?l:l[a.Ta.toString()+(d.jc()?":"+a.U.toString():"")]))G=parseInt(l.x),v=-parseInt(l.y);
if(a.Yb>=0&&b||a.ef&&t||a.Q>=0&&e||a.Rd>0&&D||a.le>0&&n||G!=0||v!=0){k+='<table class="kbb-item-labels"><tr>';a.Rd>0&&D&&(k+='<td class="kbb-bk-orange">+'+a.Rd+"</td>");a.le>0&&n&&(k+='<td class="kbb-bk-grey">+'+a.le+"</td>");a.Yb>=0&&b&&(k+='<td class="kbb-bk-yellow">'+Yk+"</td>");a.ef&&t&&(k+='<td class="kbb-bk-darkblue">?</td>');a.Q>=0&&typeof d.j.da[a.Q]!=="undefined"&&e&&(k+='<td class="kbb-bk-blue">'+Nd(d.j.da[a.Q].templateName)+"</td>");if(G!=0||v!=0)k+='<td class="kbb-bk-green">x:'+G+" y:"+
v+"</td>";k+="</tr></table>"}return k}function ka(c){var k=!1,l=c.A,k=c.sa()*c.Ob,b=N(c),t=c.Rb("ici")[0],e=typeof l.cd==="undefined"||typeof l.Yc==="undefined"||typeof l.Wc==="undefined"||typeof l.Vc==="undefined"||typeof l.bd==="undefined"||typeof l.$c==="undefined"||typeof l.Xc==="undefined"||typeof l.Zc==="undefined"||typeof l.nc==="undefined"||l.cd!=c.text||l.Yc!=c.html||l.Wc!=c.ba||l.Vc!=c.Z||l.bd!=c.Xd||l.$c!=c.Wd||l.Xc!=c.Ha||l.Zc!=b||l.nc[0]!=t[0]||l.nc[1]!=t[1]||l.nc[2]!=t[2];l.cd=c.text;
l.Yc=c.html;l.Wc=c.ba;l.Vc=c.Z;l.bd=c.Xd;l.$c=c.Wd;l.Xc=c.Ha;l.Zc=b;l.nc=t;if(l.J==i&&k>0){var k=!0,D=C.find(".textlayer")[0];l.J=a("<div></div>").hide().addClass("itemtext").appendTo(D)}else k=!1;var n=l.J;if(n!=i&&(e||k)){delete l.zc;delete l.Fc;delete l.Ub;n.children().remove();l=a('<a href="?id='+c.I+'"></a>').data("pid",c.I).click(function(a){V.call(this,a,!0);return!1}).appendTo(n);if(c.Ha!=""){var G=c.Ha;G.length>3&&G.substring(G.length-3)=="\u00a7if"&&(G=G.substring(0,G.length-3));for(var v=
0,f=[255,255,255],e=0;e<ma.length;e++)if(G.search(ma[e].p)>=0){v=ma[e].i;f=ma[e].b;break}Ya(function(){a("<div></div>").iconbtn({iconindex:v,iconhilightindex:v+1,iconhilightbackgroundcolor:f,link:G,width:64,synchron:!0,onclick:function(a){if(Ma&&L.zoom)return!1;var a=a.data("pid"),c=d.j.q[d.j.F[a]],a=!1,k=c.Ha;c.Ha.length>3&&c.Ha.substring(c.Ha.length-3)=="\u00a7if"&&(a=!0,k=k.substring(0,k.length-3));c=k.length>=7&&k.substring(0,7).toLowerCase()=="file://";if(k.length>=9&&k.substring(0,9).toLowerCase()==
"itemid://"){var l=parseInt(k.substring(9));isNaN(l)||(d.load(l,-1,"",Xb,!0,!1,xe+1),U()&&Oc({action:"onitemselected",i:l,r:-1,search:"",setasroot:1,redraw:1}))}else if(a&&!c)md(k);else if(U())Oc({action:"shellexecute",file:k});else if(Cb())fd({action:"launchurl",file:k},fa());else if((qb()||Bb())&&c)B({action:"launchfile",file:k},fa());else if(qb())try{l=new window.Windows.Foundation.Uri(k),window.Windows.System.Launcher.launchUriAsync(l)}catch(b){}else window.open(k,"_blank","");return!1},onMouseDown:fa()}).appendTo(n).data("pid",
c.I)})}b!=""&&a(b).appendTo(n).hide();var b=a("<span></span>").appendTo(l),l=a('<span class="itemheader"></span>').appendTo(b),g=a("<span></span>").appendTo(l);c.html?Ya(function(){g.html((ye()?"<wbr>":"")+c.html)}):g.text(c.text);Za(g,!1);g.css("color",$e(t));(e=ef(l,c,!0))&&e.children("span").css("color",$e(t));if(d.na>0&&(c.ba.length>0||c.Z&&c.Z.length>64))l.addClass("expanded"),t=a('<span class="itembody"></span>').appendTo(b),g=a("<span></span>").appendTo(t),c.Z?Ya(function(){g.html((ye()?"<wbr>":
"")+c.Z)}):g.text(c.ba),Za(g,!1);n.unbindMouseOrTouchEvent("mouseenter.kmEvents").bindMouseOrTouchEvent("mouseenter.kmEvents",function(a){V.call(this,a,!1)}).unbindMouseOrTouchEvent("mousedown.kmEvents").bindMouseOrTouchEvent("mousedown.kmEvents",function(a){V.call(this,a,!0)})}return k}function Y(a,k,l){var b=a.A,t=b.J,e=a.sa(),D=e*a.ie,n=e*a.Ob,G=4*d.D,v=t.find("span:first").html(),e=t.children("a"),f=e.find(".itemheader"),g=e.find(".itembody"),S=1;typeof z.ia!=="undefined"&&z.ia!==i&&(S=z.ia);
var S=a.Pa?"0.1":S,u=a.pa("ici")[0],W=ff(u[0],u[1],u[2]),W=[255,255,255],q=a.Pb(),w=typeof b.Qc==="undefined"||b.Qc!=q;b.Vd=w||typeof b.pd==="undefined"||typeof b.Gb==="undefined"||typeof b.md==="undefined"||b.pd!=D||b.Gb!=n&&n!=0||b.md!=v;b.pd=D;b.Gb=n;b.Qc=q;b.md=v;t.css("z-index",10+k);w&&t.css("font-family",q);if(b.Vd)t.css({width:D+"px","font-size":n/100+"em"}),e.css({"-moz-border-radius":G,"-webkit-border-radius":G,"border-radius":G}),g.css({"-moz-border-bottom-left-radius":G,"-webkit-border-bottom-left-radius":G,
"border-bottom-left-radius":G}),g.css({"-moz-border-bottom-right-radius":G,"-webkit-border-bottom-right-radius":G,"border-bottom-right-radius":G}),b.Nb=D;if(k=typeof b.Fc==="undefined"||typeof b.Ub==="undefined"||b.Fc!=S||b.Ub[0]!=u[0]||b.Ub[1]!=u[1]||b.Ub[2]!=u[2])f.css("background-color",gf(u,S)),g.css("background-color",gf(W,S)),g.css("border-color",gf(u,S)),b.Fc=S,b.Ub=u;if(k=k||typeof b.zc==="undefined"||b.zc!=Ae)Ae?(W=ff(u[0],u[1],u[2]),k=hf(W[0],Math.max(0,W[1]-50),100),D=hf(W[0],W[1]>5?Math.min(100,
W[1]+25):W[1],Math.max(0,W[2]-25)),f.css({"background-image":"-webkit-gradient(linear, right top, right bottom, color-stop(0%,rgba("+k[0]+","+k[1]+","+k[2]+","+S+")), color-stop(50%,rgba("+u[0]+","+u[1]+","+u[2]+","+S+")), color-stop(100%,rgba("+D[0]+","+D[1]+","+D[2]+","+S+")))",filter:"progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#"+("00"+k[0].toString(16)).slice(-2)+("00"+k[1].toString(16)).slice(-2)+("00"+k[2].toString(16)).slice(-2)+",endColorstr=#"+("00"+D[0].toString(16)).slice(-2)+
("00"+D[1].toString(16)).slice(-2)+("00"+D[2].toString(16)).slice(-2)+")"})):f.css({"background-image":"none",filter:"progid:DXImageTransform.Microsoft.gradient(enabled = false)"}),b.zc=Ae;a.Pa?e.addClass("kbb-item-hidden"):e.removeClass("kbb-item-hidden");l&&t.show()}function aa(){var a=-1;if(d.B==Ia){var k=C.find(".textlayer").find(".kbb-tableviewcell-selected");k.length>0&&(a=k.data("sn"))}else if(d.j&&d.j.W>=0&&(k=d.j.q[d.j.F[d.j.W]]))a=k.we;return a}function H(){var c=P;if(d.B==Ia){var k=C.find(".textlayer"),
l=k.find(".kbb-tableviewcell-selected"),k=k.find(".kbb-tableviewcolumn"),b;if(l.length>0)b=l.closest(".kbb-tableviewcolumn"),c=l.data("pid"),d.ca=k.index(b),P=b.data("pid");else if(k.length>0)b=a(k[k.length-1]),c=b.data("pid"),d.ca=k.length-1,P=c}else if(d.j)if(d.j.W>=0)c=d.j.W;else if(d.j.aa>=0)c=d.j.q[d.j.R[d.j.ja[d.j.aa]].ra].I;return c}function Ga(){var a=H(),k=a;if(d.B==Ia){var l=C.find(".textlayer"),a=l.find(".kbb-tableviewcell-selected");if(a.length>0)l=l.find(".kbb-tableviewcolumn"),a=a.closest(".kbb-tableviewcolumn"),
k=a.data("pid"),d.ca=l.index(a),P=k}else if(d.j&&a>=0&&(a=d.j.q[d.j.F[a]])&&a.A.p>=0)a=d.L.i[a.A.p].i,a>=0&&(k=a);return k}function J(){var a=-1;if(d.B==Ia){var k=C.find(".textlayer"),l=k.find(".kbb-tableviewcell-selected");if(l.length>0){var k=k.find(".kbb-tableviewcolumn"),b=l.closest(".kbb-tableviewcolumn"),a=l.data("rid");d.ca=k.index(b);P=b.data("pid")}}else if(d.j)a=d.j.aa;return a}function Ja(c,k,l,b){var t=i;if(d.B==Ia){var e=C.find(".textlayer"),D=e.find(".kbb-tableviewcell-selected");if(D.length>
0){var n=D.closest(".kbb-tableviewcolumn");l||b?(c=n.find(".kbb-tableviewcell:not(.kbb-tableviewheaderdescription)"),k=c.index(D),l&&k>0?t=a(c[k-1]):b&&k<c.length-1&&(t=a(c[k+1]))):(l=e.find(".kbb-tableviewcolumn"),b=l.index(n),c&&b>0?t=a(l[b-1]).find(".kbb-tableviewcell:first"):k&&b<l.length-1&&(t=a(l[b+1]).find(".kbb-tableviewcell:first")))}}return t}function ob(c,k,l,b,t,e){var D=!U()&&!qb()&&!Bb()&&!jf();function n(a,c,d,k,l,b){function M(a,c,d){var k=Math.round(a.width/2),l=Math.round(a.height/
2);if(k<=c&&l<=d)return a;var b=document.createElement("canvas");b.width=k;b.height=l;b.getContext("2d").drawImage(a,0,0,k,l);return M(b,c,d)}function t(a,c,d,k,l){for(var b=a.getContext("2d").getImageData(0,0,c,d),M=a.getContext("2d").getImageData(0,0,k,l),b=b.data,n=M.data,e=c/k,q=d/l,G=Math.ceil(e/2),v=Math.ceil(q/2),D=0;D<l;D++)for(var w=0;w<k;w++){for(var Va=(w+D*k)*4,f=0,u=0,W=0,g=0,S=0,Pa=0,za=0,h=(D+0.5)*q,ra=Math.floor(D*q);ra<(D+1)*q;ra++){var K=Math.abs(h-(ra+0.5))/v,j=(w+0.5)*e;K*=K;for(var gg=
Math.floor(w*e);gg<(w+1)*e;gg++){var y=Math.abs(j-(gg+0.5))/G,f=Math.sqrt(K+y*y);f>=-1&&f<=1&&(f=2*f*f*f-3*f*f+1,f>0&&(y=4*(gg+ra*c),za+=f*b[y+3],W+=f,b[y+3]<255&&(f=f*b[y+3]/250),g+=f*b[y],S+=f*b[y+1],Pa+=f*b[y+2],u+=f))}}n[Va]=g/u;n[Va+1]=S/u;n[Va+2]=Pa/u;n[Va+3]=za/W}a.getContext("2d").clearRect(0,0,Math.max(c,k),Math.max(d,l));a.width=k;a.height=l;a.getContext("2d").putImageData(M,0,0)}var n=document.createElement("canvas"),q=a.naturalWidth,G=a.naturalHeight,v=q,D=G,d=Math.min(d/q,k/G);4<l&&l<
9&&(k=v,v=D,D=k);n.width=v;n.height=D;k=n.getContext("2d");switch(l){case 2:k.transform(-1,0,0,1,q,0);break;case 3:k.transform(-1,0,0,-1,q,G);break;case 4:k.transform(1,0,0,-1,0,G);break;case 5:k.transform(0,1,1,0,0,0);break;case 6:k.transform(0,1,-1,0,G,0);break;case 7:k.transform(0,-1,-1,0,G,q);break;case 8:k.transform(0,-1,1,0,0,q)}k.drawImage(a,0,0,q,G);v=Math.round(v*d);D=Math.round(D*d);n=M(n,v,D);(n.width>v||n.height>D||e)&&t(n,n.width,n.height,v,D);c.src=n.toDataURL(b,1)}function G(a){for(var a=
a.replace(/^data\:([^\;]+)\;base64,/gmi,""),c=atob(a),d=c.length,k=new Uint8Array(d),a=0;a<d;a++)k[a]=c.charCodeAt(a);c=new DataView(k.buffer);if(c.getUint16(0,!1)!=65496)return-2;d=c.byteLength;for(k=2;k<d;){if(c.getUint16(k+2,!1)<=8)break;a=c.getUint16(k,!1);k+=2;if(a==65505){if(c.getUint32(k+=2,!1)!=1165519206)break;var l=c.getUint16(k+=6,!1)==18761;k+=c.getUint32(k+4,l);var b=c.getUint16(k,l);k+=2;for(a=0;a<b;a++)if(c.getUint16(k+a*12,l)==274)return c.getUint16(k+a*12+8,l)}else if((a&65280)!=
65280)break;else k+=c.getUint16(k,!1)}return-1}function v(c,d,k){yb?(kf(ba),setTimeout(function(){v(c,d,k);lf()},500)):(yb=!0,kf(ba),setTimeout(function(){var l=G(d),b=a('<img class="kbb-preview-image"/>').appendTo(w);a("<img />").attr("src",d).bind("load.kmEvents",function(){a(this).unbind("load.kmEvents");try{n(this,b[0],150,150,l,"image/png"),S.push({i:this.src,w:this.naturalWidth,h:this.naturalHeight,o:l,p:b[0].src,n:c,u:k})}catch(d){b.remove()}Mb||u.dialog("option","position",{my:"center",at:"center"});
lf();yb=!1})},10))}function f(c){function d(c){kf(ba);var k=new FileReader;a(k).bind("load",function(){v(typeof c.name==="string"?c.name:"",this.result,"");lf()});k.readAsDataURL(c)}for(var k=0;k<c.length;k++)c[k]&&d(c[k])}function g(c,k){function l(){b++;!q&&b<S.length?(a(".waitinl").addClass("waitinllarge"),a("div.waitanim span.waittext").text(Zk.replace("%1",b+1).replace("%2",S.length)),setTimeout(function(){function d(){var a=S[b].i,k=S[b].p,n=a.search(";base64,"),G=k.search(";base64,"),v=S[b].w,
D=S[b].h,w=S[b].n,f=w.lastIndexOf("."),f=f>=0?w.substr(0,f):w,u=v+" x "+D+" px",W=S[b].u,g=q||b+1>=S.length;a.search("data:image/")==0&&k.search("data:image/")==0&&n>0&&G>0?e?(e(a,v,D,h),l()):(v={ap:w,rp:w,ift:0,sp:1},W!=""&&(v.url=W),a={i:c,n:f,d:u,dt:W==""?a.substring(11,n):"",mt:W==""?a.substring(5,n):"",id:a.substring(n+8),sid:k.substring(G+8),ip:JSON.stringify(v),f:t?1:0,l:g?1:0,u:M},a={action:"importimage",jsonimagedata:JSON.stringify(a),undotext:$k,undoproperties:kb(),database:O},B(a,function(a){M=
a;t=!1;l()})):l()}q=Pb;e||S[b].w>nd||S[b].h>nd||S[b].o>1?a("<img />").attr("src",S[b].i).bind("load.kmEvents",function(){a(this).unbind("load.kmEvents");try{var c=a("<img />").bind("load.kmEvents",function(){a(this).unbind("load.kmEvents");S[b].i=this.src;S[b].w=this.naturalWidth;S[b].h=this.naturalHeight;d()});n(this,c[0],e?Be:nd,e?Be:nd,S[b].o,S[b].i.search("data:image/jpeg")==0?"image/jpeg":S[b].i.search("data:image/jpg")==0?"image/jpg":"image/png")}catch(k){l()}}):d()},1)):(a("div.waitanim span.waittext").text(ba),
a(".waitinl").removeClass("waitinllarge"),wb={},k?k():d.load(P,-1,"",0,!1,!1,xe+1),lf())}kf(ba);var b=-1,M=-1,t=!0,q=!1,G=u.find(".kbb-max-image-size").val();isNaN(G)||(e?Be=Math.max(12,Math.min(1024,parseInt(G))):nd=Math.max(150,parseInt(G)));typeof window.localStorage!=="undefined"&&(e?window.localStorage.setItem("importimageSize",Be):window.localStorage.setItem("maximportimageSize",nd));Pb=!1;l()}var S=[],u=i,W=i,q=i,w=i,za=i,h="l";a.fn.C.close();d.j&&d.j.Ga(c,-1,!0,!1,!0);var K="<form>";e==i&&
(K+='<div style="margin-top:0px; margin-bottom:12px;"><label><input class="kbb-create-new-item" type="checkbox"'+(t?" checked":"")+">"+al+"</label></div>");K+=Bb()?'<div><button class="kbb-open-file" type="button">'+bl+'</button><button class="kbb-take-picture" type="button">'+cl+"</button></div>":'<div><input class="kbb-select-file" type="file" accept=".jpg,.jpeg,.png,.bmp,.tif,.tiff,.gif,.ico" multiple="multiple"/></div>';D&&(K+="<div>"+od+"</div>",K+='<div class="kbb-drop-file">'+dl+"</div>");
K+="<div>"+od+"</div>";K+='<div class="kbb-paste-image">'+el+'<div contentEditable="true"></div></div>';K+="<div>"+(e?fl:gl)+'<input class="kbb-max-image-size" type="text" value="'+(e?Be:nd)+'">'+hl+"</div>";K+='<div class="kbb-import-image-preview"></div>';e&&(K+="<div>"+il+'&nbsp;&nbsp;<label><input name="image-alignment" value="l" type="radio" checked>'+jl+'</label>&nbsp;&nbsp;<label><input name="image-alignment" value="r" type="radio">'+kl+'</label>&nbsp;&nbsp;<label><input name="image-alignment" value="t" type="radio">'+
ll+"</label></div>");K+='<input type="submit" class="kbb-invisible" />';K+="</form>";var j={};j[Da]=function(){if(S.length>0){var a=e?!1:u.find(".kbb-create-new-item").is(":checked");e&&(h=u.find("input[name=image-alignment]:checked").val());u.dialog("close");if(a){var a=Ga(),d=aa();Hc(a,d+1,k,l,b,"","","","",function(a,c,d,k){g(c,function(){a(c,d,k)})})}else g(c,i)}};j[eb]=function(){u.dialog("close")};j[ml]=function(){S=[];w.empty()};u=a('<div class="kbb-import-image-dialog" />');Ya(function(){u.html(K)});
u.dialog({modal:!0,closeOnEscape:!1,resizable:!1,buttons:j,title:nl,width:500,position:Mb?{my:"center top",at:"center top"}:{my:"center",at:"center"},open:function(){a(this).parent(".ui-dialog").find("*").not(".kbb-import-image-dialog,form,.kbb-paste-image").myDisableSelection(!1)},close:function(){a(this).dialog("destroy");a(window).unbind("paste.kmEvents")}});w=u.find(".kbb-import-image-preview");u.find("form").bind("submit",function(){setTimeout(function(){j[Da]()},50);return!1});var yb=!1,m="";
window.loadimagecallback=function(a,c,d,k,l){if(typeof k==="undefined"||k)m="";m+=c;(typeof l==="undefined"||l&&m!="")&&v(a,m,d)};if(Bb()){var o="",p=function(a,c,d,k){d&&(o="");o+=c;k&&o!=""&&v(a,o,"")};u.find(".kbb-open-file").button().bind("click",function(){window.loadfilecallback=p;B({action:"loadfile",extensions:".jpg,.jpeg,.png,.bmp,.tif,.tiff,.gif,.ico",tag:"openimage"},fa())});u.find(".kbb-take-picture").button().bind("click",function(){window.loadfilecallback=p;B({action:"loadfile",extensions:".jpg,.jpeg,.png,.bmp,.tif,.tiff,.gif,.ico",
tag:"takepicture"},fa())})}else q=u.find(".kbb-select-file"),q.bind("change",function(){this.files&&this.files.length>0&&f(this.files);return!1});D&&(W=u.find(".kbb-drop-file"),W.bind("dragover",ha(!1)),W.bind("dragenter",function(){W.addClass("kbb-hilite");return!1}),W.bind("dragleave",function(){W.removeClass("kbb-hilite");return!1}),W.bind("drop",function(a){W.removeClass("kbb-hilite");typeof a.originalEvent!=="undefined"&&typeof a.originalEvent.dataTransfer!=="undefined"&&typeof a.originalEvent.dataTransfer.files!==
"undefined"&&a.originalEvent.dataTransfer.files.length>0&&f(a.originalEvent.dataTransfer.files);return!1}));var za=u.find('.kbb-paste-image > div[contenteditable="true"]'),r=i;za.bind("blur keyup paste input",function(){r!=i&&clearTimeout(r);r=setTimeout(function(){var c=za.find("img");if(c.length>0){for(var d=!1,k=0,k=0;k<c.length;k++)c[k].complete&&(v("",a(c[k]).attr("src"),""),d=!0);d&&za.html("")}r=i},50)});a(window).unbind("paste.kmEvents").bind("paste.kmEvents",function(a){if(typeof a.originalEvent!==
"undefined"&&typeof a.originalEvent.clipboardData!=="undefined"&&(a=a.originalEvent.clipboardData.items)){for(var c=[],d=0,d=0;d<a.length;d++)if(a[d].type.indexOf("image")!==-1){var k=a[d].getAsFile();c.push(k)}f(c);return!1}if(typeof window.clipboardData!=="undefined"&&typeof window.clipboardData.files!=="undefined"&&window.clipboardData.files.length>0)return f(window.clipboardData.files),!1})}function xb(){b.webpageimport&&na.find("a").unbind("click.kmEvents").bind("click.kmEvents",function(c){return d.me&&
c&&c.currentTarget&&(c=a.trim(a(c.currentTarget).attr("href")),c!="")?(vc(H(),c),!1):!0})}function vc(c,d){var l=i;a.fn.C.close();var b="<form>";b+="<div>"+ol+'</div><div><input class="kbb-import-url" type="text" value="'+Nd(d)+'"></div><div class="kbb-import-error"></div>';b+='<input type="submit" class="kbb-invisible" />';b+="</form>";var t={};t[Da]=function(){function d(){if(f<t.length){var M=t[f]+k;T(M,function(k){k?(a("div.waitanim span.waittext").text(ba),a(".waitinl").removeClass("waitinllarge"),
lf(),l.dialog("close"),hb.sidegallery("show",!0,0,function(){Yd.toolbarbtn("setselected",!0);var a=pf;pf=Zh;Hc(c,-1,k.name,k.description,M,k.html,k.text,k.name,k.description,i);pf=a})):(f++,d())})}else a("div.waitanim span.waittext").text(ba),a(".waitinl").removeClass("waitinllarge"),lf(),b.text(pl)}var k=a.trim(l.find(".kbb-import-url").val()),b=l.find(".kbb-import-error"),M=k.indexOf("://"),t;if(M>=0){var e=k.substr(0,M+3);t=[];t.push(e);e.toLowerCase()!="https://"&&t.push("https://");e.toLowerCase()!=
"http://"&&t.push("http://");k=k.substr(M+3)}else t=["https://","http://"];var f=0;Pb=!1;kf(ba);b.text("");d()};t[eb]=function(){l.dialog("close")};l=a('<div class="kbb-import-webpage-dialog" />');Ya(function(){l.html(b)});l.dialog({modal:!0,closeOnEscape:!1,resizable:!1,buttons:t,title:Zh,width:500,position:Mb?{my:"center top",at:"center top"}:{my:"center",at:"center"},open:function(){a(this).parent(".ui-dialog").find("*").not(".kbb-import-webpage-dialog,form").myDisableSelection(!1)},close:function(){a(this).dialog("destroy")}});
l.find("form").bind("submit",function(){setTimeout(function(){t[Da]()},50);return!1})}function ux(){var c=i,d=i,l="<form>";l+="<div>"+ql+' (<a href="https://query.wikidata.org/" target="_blank">'+rl+')</a><button class="kbb-insert-example" type="button">'+sl+"</button></div>";l+='<div><textarea class="kbb-text-input" spellcheck="false">'+Nd(ng)+"</textarea></div>";l+='<input type="submit" class="kbb-invisible" />';l+="</form>";var b={};b[Da]=function(){var a=d.val();a.length>0?(c.dialog("close"),
ng=a,window.localStorage.setItem("importwikidataquery",ng),vx(a)):d.focus()};b[eb]=function(){c.dialog("close")};c=a('<div class="kbb-import-wikidata-dialog" />');Ya(function(){c.html(l)});var t=600,e=450;if(typeof window.localStorage!=="undefined"){var D=window.localStorage.getItem("kbb_import_wikidata_dialog_size");if(D&&(D=JSON.parse(D)))t=D.w,e=D.h}c.dialog({modal:!0,closeOnEscape:!1,resizable:!0,buttons:b,title:tl,width:t,height:e,minWidth:600,minHeight:300,position:Mb?{my:"center top",at:"center top"}:
{my:"center",at:"center"},close:function(){a(this).dialog("destroy")},open:function(){a(this).parent(".ui-dialog").find("*").myDisableSelection(!1);d=c.find(".kbb-text-input");d.height(c.height()-d.position().top-8)},resize:function(){d&&d.height(c.height()-d.position().top-8)},resizeStop:function(){if(typeof window.localStorage!=="undefined"){var d=JSON.stringify({w:Math.max(200,Math.min(a(window).width()-200,c.parent().outerWidth())),h:Math.max(200,Math.min(a(window).height()-50,c.parent().outerHeight()))});
window.localStorage.setItem("kbb_import_wikidata_dialog_size",d)}}});d=c.find(".kbb-text-input");d.on("keydown",mf);c.find(".kbb-insert-example").button().bind("click",function(){d.val('# The following prefixes must be used for SPARQL variables in the SELECT statement:\n# i_ : item\n# ic_ : item category, the column values are ignored, only the column header is relevant\n# in_ or i_XXXLabel or ic_XXXLabel: item name\n# id_ or i_XXXDescription or ic_XXXDescription: item description\n# iu_ : item url\n# ii_ : item image\n# idi_ : item description image\n# rn_ : relation name\n# rn_t_ : relation name for a table relation\n# rc_ : relation category\n# The columns in the SELECT statement must have the following order (the values in round brackets are optional)\n# ?i_item1 (?ic_item1) (?in_item1) (?id_item1) (?iu_item1) (?ii_item1) (?rn_relation1) (?rc_relation1) ?i_item2 (?ic_item2) ... (?rn_relation2) (?i_item3) ...\n# This SELECT statement connects item1 through relation1 with item2 and through relation 2 with item3\n# One result row can connect item1 with any number of other items\n# A line starting with the comment #query can be used to separte many queries\n#\nSELECT ?i_item ?i_itemLabel ?i_itemDescription ?ii_pic ?iu_enwiki ?rn_property1Label (?rn_property1Label as ?rc_property1Label) ?i_link1 ?rn_property2Label (?rn_property2Label as ?rc_property2Label) ?i_link2 ?rn_t_property3Label (?rn_t_property3Label as ?rc_property3Label) ?ic_DateOfBirth ?rn_t_property4Label (?rn_t_property4Label as ?rc_property4Label) ?ic_PlaceOfBirth ?ic_PlaceOfBirthLabel ?ic_PlaceOfBirthDescription ?rn_t_property5Label (?rn_t_property5Label as ?rc_property5Label) ?ic_DateOfDeath ?rn_t_property6Label (?rn_t_property6Label as ?rc_property6Label) ?ic_PlaceOfDeath ?ic_PlaceOfDeathLabel ?ic_PlaceOfDeathDescription ?rn_property7Label (?rn_property7Label as ?rc_property7Label) ?i_Spouse ?i_SpouseLabel ?i_SpouseDescription WHERE {\nwd:Q9682 wdt:P40* ?i_item.\nOPTIONAL { ?i_item wdt:P18 ?ii_pic. }\nOPTIONAL { ?iu_enwiki schema:about ?i_item; schema:isPartOf <https://en.wikipedia.org/> }\nOPTIONAL { ?i_item wdt:P22 ?i_link1. }\nOPTIONAL { ?rn_property1 wikibase:directClaim wdt:P22. }\nOPTIONAL { ?i_item wdt:P25 ?i_link2. }\nOPTIONAL { ?rn_property2 wikibase:directClaim wdt:P25. }\nOPTIONAL { ?i_item wdt:P569 ?ic_DateOfBirth. }\nOPTIONAL { ?rn_t_property3 wikibase:directClaim wdt:P569. }\nOPTIONAL { ?i_item wdt:P19 ?ic_PlaceOfBirth. }\nOPTIONAL { ?rn_t_property4 wikibase:directClaim wdt:P19. }\nOPTIONAL { ?i_item wdt:P570 ?ic_DateOfDeath. }\nOPTIONAL { ?rn_t_property5 wikibase:directClaim wdt:P570. }\nOPTIONAL { ?i_item wdt:P20 ?ic_PlaceOfDeath. }\nOPTIONAL { ?rn_t_property6 wikibase:directClaim wdt:P20. }\nOPTIONAL { ?i_item wdt:P26 ?i_Spouse. }\nOPTIONAL { ?rn_property7 wikibase:directClaim wdt:P26. }\nSERVICE wikibase:label { bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en". }\n}')});
c.find("form").bind("submit",function(){setTimeout(function(){b[Da]()},50);return!1})}function vx(c){function k(c,d,k){a(".waitinl").addClass("waitinllarge");a("div.waitanim span.waittext").text(c.replace("%1",d+1).replace("%2",k))}function l(a,c){ca(e+"?format=json&query="+encodeURIComponent(a),!1,function(a){c(a)})}function b(c,d){function l(){if(!Pb){if(n<t.length){var c=t[n];n++;var d=c.uri,b=d.lastIndexOf("/");b>=0&&(d=d.substr(b+1),d="https://commons.wikimedia.org/w/thumb.php?f="+d+"&w=101");
ca(d,!0,function(d){if(d)c.data=d.replace(/\r/g,"").replace(/\n/g,""),c["~img"]=a("<img />").attr("src",c.data)[0];e++;l()})}e<t.length&&k(Zd,e,t.length)}}function M(){setTimeout(function(){var c=!1;e>=t.length&&(c=!0,a.each(t,function(){if(this["~img"])if(this["~img"].complete)this.width=this["~img"].naturalWidth,this.height=this["~img"].naturalHeight;else return c=!1}));Pb||c?d():M()},500)}if(Pb)d();else{var t=[];a.each(c,function(a,c){c.image&&t.push(c.image);c.descriptionimage&&t.push(c.descriptionimage)});
var n=0,e=0,q=0;k(Zd,0,t.length);for(q=0;q<10;q++)l();M()}}function t(c,d){a.trim(c)==""?(n++,D.length>n&&t(D[n],d)):(n>0&&(c="#query"+c),l(c,function(c){if(c&&!Pb){var k=i;try{k=JSON.parse(c)}catch(l){}if(k&&(c=k.results,k=k.head,c&&k)){var e=c.bindings,k=k.vars;if(e&&k){var G=function(a,c){return a.length>=c.length&&a.substr(0,c.length).toLowerCase()==c.toLowerCase()},q=function(a,c){return a.length>=c.length&&a.substr(a.length-c.length).toLowerCase()==c.toLowerCase()},w=function(a){return G(a,
"in_")||(G(a,"i_")||G(a,"ic_"))&&q(a,"label")},f=function(a){return G(a,"id_")||(G(a,"i_")||G(a,"ic_"))&&q(a,"description")},Va=function(a){if(w(a))return"itemName";else if(f(a))return"itemDescription";else if(G(a,"ii_"))return"itemImage";else if(G(a,"idi_"))return"itemDescriptionImage";else if(G(a,"iu_"))return"itemUrl";else if(G(a,"i_"))return"item";else if(G(a,"ic_"))return"itemCategory";else if(G(a,"rn_"))return"relationName";else if(G(a,"rc_"))return"relationCategory";return i},c=function(a,
c){var d=Va(c);if(d)if(a[d]||G(c,"rn_")||G(c,"rc_")&&!a.relationName||G(c,"i_")&&!w(c)&&!f(c)&&a.itemName){var k={};k[d]=c;return k}else a[d]=c;return i},g,h,j,m,o,p,r=[],s={},B,x,A,y,C,E,I={},N,z="";for(h=0;h<k.length;h++)if(B=c(s,k[h]))r.push(s),s=B;r.push(s);for(h=0;h<r.length;h++)s=r[h],h>0&&(z+="$relationname;$relationcategory;"),s.itemCategory&&(z+=R(s.itemCategory.substr(3).replace(/^_+/g,""))),z+=";$itemdescription;$itemurl;";z+="\n";var sa=function(a,c,d,k,l){typeof I[a]==="undefined"&&(I[a]=
{});typeof I[a].name==="undefined"&&(I[a].name=c);d&&typeof I[a].image==="undefined"&&(I[a].image={uri:d});typeof I[a].description==="undefined"&&(I[a].description=k);l&&typeof I[a].descriptionimage==="undefined"&&(I[a].descriptionimage={uri:l})};for(h=0;h<e.length;h++){g=e[h];for(j=0;j<r.length;j++)s=r[j],x=g[s.item]||g[s.itemName]||g[s.itemCategory],k=g[s.itemName],c=g[s.itemImage],A=g[s.itemDescription],B=g[s.itemDescriptionImage],x&&x.type=="uri"&&x.value&&k&&k.value&&sa(x.value,k.value,c&&c.value?
c.value:i,A&&A.value?A.value:i,B&&B.value?B.value:i)}kf(ai);b(I,function(){a("div.waitanim span.waittext").text(ba);a(".waitinl").removeClass("waitinllarge");if(Pb)lf();else{a.each(I,function(a,c){m="<html>";c.image&&c.image.data&&(m+='<span style="display:inline-table"><img src="'+c.image.data+'" style="width:'+c.image.width/20+"em;height:"+c.image.height/20+'em;margin:0.2em 0.4em 0 0;float:left" /><span style="display:table-cell;vertical-align:middle">');c.name&&(m+=Nd(c.name));c.image&&c.image.data&&
(m+="</span></span>");m+="</html>";c.name=m;o="<html>";c.descriptionimage&&c.descriptionimage.data&&(o+='<img src="'+c.descriptionimage.data+'" style="width:'+c.descriptionimage.width/15+"em;height:"+c.descriptionimage.height/15+'em;margin:0.2em 0.4em 0.2em 0;float:left" />');c.description&&(o+=Nd(c.description));o+="</html>";c.description=o});for(h=0;h<e.length;h++){g=e[h];for(j=0;j<r.length;j++)if(s=r[j],C=g[s.relationName],E=g[s.relationCategory],x=g[s.item]||g[s.itemName]||g[s.itemCategory],A=
g[s.itemDescription],y=g[s.itemUrl],x&&x.value)if(C&&C.value?(p=C.value,G(s.relationName,"rn_t_")&&(p="T:"+p),z+=R(p),z+=";"):j>0&&(z+=";"),E&&E.value?(z+=R(E.value),z+=";"):j>0&&(z+=";"),x.type=="uri")(N=I[x.value])?(z+=R(N.name),z+=";",z+=R(N.description),z+=";",y&&y.value&&(z+=R(y.value)),z+=";"):z+=";;;";else{m=x.value;if(x.datatype=="http://www.w3.org/2001/XMLSchema#dateTime"){var c=!1;m.charAt(0)=="-"&&(m="-00"+m.substr(1),c=!0);m=(new Date(m)).toLocaleDateString("de-DE");c&&(m+=" BC")}z+=R(m);
z+=";";A&&A.value&&(z+=R(A.value));z+=";";y&&y.value&&(z+=R(y.value));z+=";"}else j>0&&(z+=";;"),z+=";;;";z+="\n"}pd(z,!0,!1,!1,!0,!1,!1,d,ul,function(a){lf();n++;D.length>n?t(D[n],d):a()})}})}}}lf()}))}var e="https://query.wikidata.org/sparql",D=c.split(/^#Query/im),n=0;Pb=!1;kf(ai);a(".waitinl").addClass("waitinllarge");D.length>n&&B({action:"getnextundopos",database:O},function(a){var c=!1;d.Wa=0;(function(a,d){d!==z[a]&&(z[a]=d,c=!0)})("wtr",0);if(c){var k={action:"setdiagramproperty",name:"dp",
value:JSON.stringify(z),undotext:"",undoproperties:kb(),database:O};B(k,function(){t(D[n],a)})}else t(D[n],a)})}function Tc(c,k){function l(a,c,d){F(f,{action:"query",list:"search",srnamespace:"0",srsearch:a,srwhat:"text",srlimit:c,srprop:"snippet",format:"json"},function(a){d(a)},function(){d(i)})}function b(a,c){F(f,{action:"query",prop:"extracts|images|info",titles:a,explaintext:"",imlimit:"max",inprop:"url",format:"json"},function(a){c(a)},function(){c(i)})}function t(a,c){F(f,{action:"query",
prop:"imageinfo",titles:a,iiprop:"url|size",iiurlheight:"100",format:"json"},function(a){c(a)},function(){c(i)})}function e(){m!=i&&clearTimeout(m);m=setTimeout(function(){m=i;D()},250)}function D(){var c=a.trim(W.val()),d=parseInt(q.val()),k=Math.max(1,Math.min(50,parseInt(w.val()))),b=a.trim(h.val()).toLowerCase();f=G.replace("*w*",b).replace("*p*",v[d].u);l(c,k,function(l){if(l&&typeof l.query!=="undefined"){var t=l.query;if(t&&typeof t.search!=="undefined"&&(t=t.search)){typeof window.localStorage!==
"undefined"&&(og=d,window.localStorage.setItem("importwikipediaprojectindex",og),pg=k,window.localStorage.setItem("importwikipediamaxresults",pg),qg=b,window.localStorage.setItem("importwikipedialanguagecode",qg));u.empty();var M=!0;a.each(t,function(c,d){d&&typeof d.title!=="undefined"&&(Ya(function(){a('<div class="kbb-title"><input type="radio" name="rootitem"'+(M?" checked":"")+'><label><input type="checkbox" checked>'+(c+1)+") "+d.title+"</label></div>").appendTo(u);typeof d.snippet!=="undefined"&&
a('<div class="kbb-snippet">'+d.snippet+"</div>").appendTo(u)}),M=!1)});nb(u,c.toLowerCase().split(/[\s()]+/),!1,!1);var n=u.find("input[type=checkbox]");n.bind("change",function(){var c=n.index(this),c=u.find("input[type=radio]")[c],d=a(this).is(":checked");c.disabled=!d;!d&&a(c).is(":checked")&&(a(c).prop("checked",!1),c=u.find("input[type=radio]:enabled"),c.length>0&&a(c[0]).prop("checked",!0))});g=l}}})}function n(k,l,n){function e(c,d,k){a(".waitinl").addClass("waitinllarge");a("div.waitanim span.waittext").text(c.replace("%1",
d+1).replace("%2",k))}function q(c){var d=0;if(Pb)c();else{e(rg,d,w.length);a.each(w,function(c,k){b(k.t,function(c){var l=!1;if(c&&typeof c.query!=="undefined"&&(c=c.query)&&typeof c.pages!=="undefined")if(c=c.pages)if((c=a.map(c,function(a){return a}))&&c.length>0&&c[0])c=c[0],typeof c.extract!=="undefined"&&(k.e=c.extract.replace(/([A-Za-z)\]}\u00bb"'\u2019\u201d!?;:]{3,})[.]([A-Z])/g,"$1. $2")),typeof c.fullurl!=="undefined"&&(k.u=c.fullurl),l=!0,G(c,k,function(){d++;d<w.length&&e(rg,d,w.length)});
l||(d++,d<w.length&&e(rg,d,w.length))})});var k=function(){setTimeout(function(){d>=w.length?c():k()},500)};k()}}function G(c,d,k){var l=!0;if(typeof c.images!=="undefined"){var c=c.images,b="";c&&(a.each(c,function(a,c){if(typeof c.title!=="undefined"){var d=c.title;d&&(b!=""&&(b+="|"),b+=d)}}),b!=""&&(l=!1,t(b,function(c){if(c&&typeof c.query!=="undefined"&&(c=c.query)&&typeof c.pages!=="undefined")if(c=c.pages)a.each(c,function(a,c){if(typeof c.imageinfo!=="undefined"){var k=c.imageinfo;if(k&&
k.length>0&&typeof k[0].size!=="undefined"&&typeof k[0].duration==="undefined"&&typeof k[0].url!=="undefined"&&typeof k[0].thumburl!=="undefined"&&typeof k[0].thumbheight!=="undefined"){var l=parseInt(k[0].size),b=k[0].url,t=k[0].thumburl,M=t.split(".");l>1E4&&M.length>1&&b.indexOf(".svg",b.length-4)==-1&&(b=M.pop().toLowerCase(),d.i.push({u:t,s:t,w:k[0].thumbwidth,h:k[0].thumbheight,t:b,d:k[0].descriptionurl,z:l}),D++)}}}),d.i.sort(function(a,c){return c.z-a.z});k()})))}l&&k()}function v(c){var d=
0;if(l&&!Pb){e(Zd,d,D);a.each(w,function(c,k){a.each(k.i,function(a,c){ca(c.u,!0,function(a){a&&(c.s=a.replace(/\r/g,"").replace(/\n/g,""));d++;d<D&&e(Zd,d,D)})})});var k=function(){setTimeout(function(){d>=D?c():k()},500)};k()}else c()}var D=0,w=[];Pb=!1;kf(ba);if(k&&typeof k.query!=="undefined"&&(k=k.query)&&typeof k.search!=="undefined")if(k=k.search){k.length>0&&typeof window.localStorage!=="undefined"&&(sg=l,window.localStorage.setItem("importwikipediadownloadimages",sg?1:0),tg=n,window.localStorage.setItem("importwikipediaupdateexistingitems",
tg?1:0));var f=u.find("input[type=checkbox]"),Va=u.find("input[type=radio]"),g=0;a.each(k,function(c,d){if(d&&typeof d.title!=="undefined"){var k=!0,l=!1;g<f.length&&(k=a(f[g]).is(":checked"));g<Va.length&&(l=a(Va[g]).is(":checked"));if(k)k={t:d.title,s:"",e:"",i:[],u:"",r:l},typeof d.snippet!=="undefined"&&(k.s=d.snippet),w.push(k);g++}});kf(ba);q(function(){v(function(){function k(c){t="<html>";c.i.length>0&&(t+='<span style="display:inline-table"><img src="'+c.i[0].s+'" style="width:'+c.i[0].w/
27+"em;height:"+c.i[0].h/27+'em;margin:0.2em 0.4em 0.2em 0;float:left" /><span style="display:table-cell;vertical-align:middle">');t+=c.t.replace(/\n\s*\n/g,"\n").replace(/\n/g,"<br>");c.i.length>0&&(t+="</span></span>");t+="</html>";t=R(t);M="<html>";a.each(c.i,function(a,c){a>0&&(M+='<img src="'+c.s+'" style="width:'+c.w/27+"em;height:"+c.h/27+'em;margin:0.2em 0.4em 0.2em 0;float:left" />')});for(var d=c.e.replace(/^[\r\n\s]+/g,"").replace(/\n\s*\n\s*(\n\s*)+/g,"\n\n").replace(/\n/g,"<br>").replace(/Bearbeiten(\s*=)/g,
"$1").replace(/Edit(\s*=)/g,"$1").replace(/Modifica(\s*=)/g,"$1").replace(/Modifier(\s*=)/g,"$1").replace(/Editar(\s*=)/g,"$1").replace(/=[=]+\s*(\b[^\r\n=]*\b)\s*=[=]+/g,"<b>$1</b>").replace(/=[=]+\s*([^\r\n=]*)\s*=[=]+/g,"<b>$1</b>"),l=0,b=!1;!b;){var n=d.indexOf("<br>",l+1);if(n>0&&n<2500)b=n-l>175,l=n;else break}l>0&&l<2500?M+=d.substring(0,l):(l=Vb({sp:0,ep:Math.min(300,d.length),t:d},!1),M+=l.d);M+="</html>";M=R(M);e="<html>";a.each(c.i,function(a,c){e+='<a href="'+c.d+'" target="_blank"><img src="'+
c.s+'" style="width:'+1.5*c.w+"px;height:"+1.5*c.h+'px;margin:0.2em 0.4em 0.2em 0;float:left" /></a>'});e+=d;e+="</html>";e=R(e);q=c.u+"\u00a7if";q=R(q);G=Ed(c.s).replace(/\n\s*\n/g,"\n").replace(/\n/g,"<br>").replace(/\s*=[=]*\s*/g,"");G=R(G)}function l(){a.each(w,function(a,c){k(c);b+=a==v?D+";"+M+";"+e+";"+q+";;;;;;\n":D+";;;;"+G+";"+t+";"+M+";"+e+";"+q+";\n"});b.length>0&&pd(b,!0,!1,!1,n,!1,!1,-1,vl);lf()}a("div.waitanim span.waittext").text(ba);a(".waitinl").removeClass("waitinllarge");var b=
";$itemdescription;$itemnote;$itemurl;$relationdescription;;$itemdescription;$itemnote;$itemurl;\n",t="",M="",e="",q="",G="",v=0,D="";a.each(w,function(a,c){if(c.r)return v=a,!1});var f=!1;if(v<w.length&&(k(w[v]),D=t,c>=0)){var Va=d.j.q[d.j.F[c]];Va&&(Va=R("<html>"+(Va.html?Va.html:Va.text)+"</html>"),Va!=D&&(n?f=!0:Va.length>15&&a.trim(jd(a.trim(Va))).toLowerCase()!=a.trim(jd(a.trim(D))).toLowerCase()&&(b+=Va+";;;;;"+D+";;;;\n")))}f?Uc(c,D.replace(/^\"|\"$/g,"").replace(/\"\"/g,'"'),i,i,i,-1,i,i,
-1,"","","","",ug,l):l()})})}lf()}var G="https://*w*.*p*.org/w/api.php",v=[{n:"Wikipedia",u:"wikipedia"},{n:"Wikinews",u:"wikinews"},{n:"Wikivoyage",u:"wikivoyage"},{n:"Wikibooks",u:"wikibooks"},{n:"Wikiversity",u:"wikiversity"},{n:"Wikiquote",u:"wikiquote"},{n:"Wikisource",u:"wikisource"},{n:"Wiktionary",u:"wiktionary"}],f="",g=i,S=i,u=i,W=i,q=i,w=i,h=i,j=i,K=i,m=i;a.fn.C.close();d.j&&d.j.Ga(c,-1,!0,!1,!0);if(k==""&&c>=0){var yb=d.j.q[d.j.F[c]];yb&&(k=Ad(yb.A.n))}var o="<form>";k!=""&&(o+="<div autofocus></div>");
o+='<div style="margin-top:2px; margin-bottom:5px;"><label>'+wl+'<input class="kbb-search-text" type="text" value="'+Nd(k)+'"></label><label>'+xl+'<select class="kbb-select-wikipedia-project">';for(yb=yb=0;yb<v.length;yb++)o+='<option value="'+yb+'"'+(yb==og?" selected":"")+">"+v[yb].n+"</option>";o+='</select></label><label style="margin-left:10px;">'+yl+'<input class="kbb-max-results" type="number" min="1" value="'+pg+'"></label></div>';o+="<div><label>"+zl+'<input class="kbb-language-code" type="text" value="'+
Nd(qg)+'">'+Al+"</label></div>";o+='<div style="margin-top:0px; margin-bottom:15px;"><label><input class="kbb-download-images" type="checkbox"'+(sg?" checked":"")+">"+Bl+'</label>&nbsp;&nbsp;&nbsp;<label><input class="kbb-update-existing-items" type="checkbox"'+(tg?" checked":"")+">"+Cl+"</label></div>";o+='<div class="kbb-search-results"></div>';o+='<input type="submit" class="kbb-invisible" />';o+="</form>";var r={};r[Da]=function(){if(g){var a=j.is(":checked"),c=K.is(":checked");S.dialog("close");
n(g,a,c)}};r[eb]=function(){S.dialog("close")};S=a('<div class="kbb-import-wikipedia-articles-dialog" />');Ya(function(){S.html(o)});var yb=600,p=450;if(typeof window.localStorage!=="undefined"){var s=window.localStorage.getItem("kbb_import_wikipedia_dialog_size");if(s&&(s=JSON.parse(s)))yb=s.w,p=s.h}S.dialog({modal:!0,closeOnEscape:!1,resizable:!0,buttons:r,title:Dl,width:yb,height:p,minWidth:600,minHeight:300,position:Mb?{my:"center top",at:"center top"}:{my:"center",at:"center"},close:function(){a(this).dialog("destroy")},
open:function(){a(this).parent(".ui-dialog").find("*").myDisableSelection(!1);u=S.find(".kbb-search-results");u.height(S.height()-u.position().top+4)},resize:function(){u&&u.height(S.height()-u.position().top+4)},resizeStop:function(){if(typeof window.localStorage!=="undefined"){var c=JSON.stringify({w:Math.max(200,Math.min(a(window).width()-200,S.parent().outerWidth())),h:Math.max(200,Math.min(a(window).height()-50,S.parent().outerHeight()))});window.localStorage.setItem("kbb_import_wikipedia_dialog_size",
c)}}});W=S.find(".kbb-search-text");q=S.find(".kbb-select-wikipedia-project");w=S.find(".kbb-max-results");h=S.find(".kbb-language-code");j=S.find(".kbb-download-images");K=S.find(".kbb-update-existing-items");u=S.find(".kbb-search-results");W.bind("keyup.kmEvents paste.kmEvents copy.kmEvents cut.kmEvents",e);q.bind("change.kmEvents",e);w.bind("keyup.kmEvents paste.kmEvents copy.kmEvents cut.kmEvents input.kmEvents",e);h.bind("keyup.kmEvents paste.kmEvents copy.kmEvents cut.kmEvents",e);S.find("form").bind("submit",
function(){setTimeout(function(){r[Da]()},50);return!1});D()}function sb(c){function d(c){if(c){var k=new FileReader;a(k).bind("load",function(){e.val(this.result)});k.readAsText(c)}}var l=i,b=i,t=i,e=i,t="<form>";t+=Bb()?'<div><button class="kbb-open-file" type="button">'+El+"</button></div>":'<div><input class="kbb-select-file" type="file" accept=".csv,.txt" /></div>';c&&(t+="<div>"+od+"</div>",t+='<div class="kbb-drop-file">'+Fl+"</div>");t+="<div>"+Gl+"</div>";t+='<div><textarea class="kbb-text-input" spellcheck="false"></textarea></div>';
t+='<div><label><input class="kbb-with-header" type="checkbox" checked>'+Hl+"</label></div>";t+='<div><label><input class="kbb-relation-categories" type="checkbox">'+Il+"</label></div>";t+='<input type="submit" class="kbb-invisible" />';t+="</form>";var D={};D[Da]=function(){var a=l.find(".kbb-with-header").is(":checked"),c=l.find(".kbb-relation-categories").is(":checked"),d=e.val();d.length>0?(l.dialog("close"),pd(d,a,!1,c,!0,!0,!1,-1,Jl)):e.focus()};D[eb]=function(){l.dialog("close")};l=a('<div class="kbb-import-csv-dialog" />').html(t).dialog({modal:!0,
closeOnEscape:!1,resizable:!1,buttons:D,title:Kl,width:500,position:Mb?{my:"center top",at:"center top"}:{my:"center",at:"center"},open:function(){a(this).parent(".ui-dialog").find("*").myDisableSelection(!1)},close:function(){a(this).dialog("destroy")}});e=l.find(".kbb-text-input");l.find("form").bind("submit",function(){setTimeout(function(){D[Da]()},50);return!1});Bb()?l.find(".kbb-open-file").button().bind("click",function(){var a="";window.loadfilecallback=function(c,d,k){d&&(a="");a+=c;k&&a!=
""&&(c=ve(a),e.val(c))};B({action:"loadfile",extensions:".csv,.txt",tag:"opencsv"},fa())}):(t=l.find(".kbb-select-file"),t.bind("change",function(){this.files&&this.files.length>0&&d(this.files[0]);return!1}));c&&(b=l.find(".kbb-drop-file"),b.bind("dragover",ha(!1)),b.bind("dragenter",function(){b.addClass("kbb-hilite");return!1}),b.bind("dragleave",function(){b.removeClass("kbb-hilite");return!1}),b.bind("drop",function(a){b.removeClass("kbb-hilite");typeof a.originalEvent!=="undefined"&&typeof a.originalEvent.dataTransfer!==
"undefined"&&typeof a.originalEvent.dataTransfer.files!=="undefined"&&a.originalEvent.dataTransfer.files.length>0&&d(a.originalEvent.dataTransfer.files[0]);return!1}))}function R(a){return'"'+a.replace(/"/g,'""')+'"'}function pd(c,k,l,b,t,e,D,n,G,v){function f(c){var c=a.trim(c),d=c.lastIndexOf("#");d>=0&&/^\d+$/.test(a.trim(c.substr(d+1)))&&(c=a.trim(c.substr(0,d)));return c}kf(ba);var g=Papa.parse(c);g&&g.data&&g.data.length>0&&(c={action:"getalldata",jsonfilter:JSON.stringify({id:0,"in":0,iu:0,
rn:1,rb:0,rd:0}),database:O},kf(ba),B(c,function(c){if(c.n==0){for(var u=a("<div></div>"),W=0,q=0,w=0,h=[{csv:"itemdescription",json:"d",type:"s",obj:"item"},{csv:"itemnote",json:"a",type:"s",obj:"item"},{csv:"itemurl",json:"u",type:"s",obj:"item"},{csv:"relationname",json:"n",type:"s",obj:"relation"},{csv:"relationbackname",json:"b",type:"s",obj:"relation"},{csv:"relationdescription",json:"d",type:"s",obj:"relation"},{csv:"relationvisibleuptolevel",json:"v",type:"i",obj:"relation"},{csv:"relationcategory",
json:"tr",type:"s",obj:"relation"}],j=-1,K=i,m="",o=K=-1,r="",p=-1,s=m=-1,K=-1,j="",o=-1,j="",x={},A={},q={},Zb={},E={},I={},y={},z=W=i,K=i,N=[],Y=[],F=[],J=z=-2,sa=-2,Ud=-2,ia={it:[],rt:[],i:[],r:[]},W=0;W<c.it.length;W++)if(m=a.trim(c.it[W].tn).toLowerCase(),m!="")q[m]=c.it[W].ti,Zb[c.it[W].ti]=c.it[W].tn;for(W=0;W<c.rt.length;W++)j=a.trim(c.rt[W].tn).toLowerCase(),j!=""&&(E[j]=c.rt[W].tr);for(W=0;W<c.i.length;W++)r=l?c.i[W].n:a.trim(jd(a.trim(c.i[W].n)).toLowerCase()),r!=""&&(I[c.i[W].ti+":"+r]=
c.i[W].i);for(W=0;W<c.r.length;W++)y[c.r[W].tr+":"+c.r[W].f+":"+c.r[W].t]=c.r[W].r;if(k)for(w=0;w<g.data[0].length;w++){o=K=j=-1;m=a.trim(g.data[0][w]).toLowerCase();if(m!=""){for(W=0;W<h.length;W++)if(m=="$"+h[W].csv){j=W;break}j<0&&(typeof q[m]==="undefined"?(K=z,z--,q[m]=K,Zb[K]=g.data[0][w],ia.it.push({ti:K,tn:g.data[0][w],tp:JSON.stringify({ic:hf((c.it.length+ia.it.length)*75%360,90,90)})})):K=q[m])}j<0&&typeof q["#"+m]!=="undefined"&&(o=q["#"+m]);N.push(j);Y.push(K);F.push(o)}for(q=k?1:0;q<
g.data.length;q++){m=-1;z=W=i;for(w=0;w<g.data[q].length;w++)if(p=o=K=j=-1,w<N.length&&(j=N[w]),w<Y.length&&(K=Y[w]),w<F.length&&(o=F[w]),r=l?g.data[q][w]:a.trim(jd(a.trim(g.data[q][w])).toLowerCase()),r!="")if(j>=0)if(K=h[j],K.obj=="item"){if(z=i,W)if(K.csv=="itemnote"){var aa=gc(g.data[q][w]);if(aa!="")Ya(function(){u.html(aa)}),j=Qc(u[0],i,0,i,0,i),j.sp=0,j.ep=0,o=Vb(j,!1),j.ep=Math.min(40,o.d.length),o=Vb(j,!1),c=o.n,o=o.d,j=j.t,W[K.json]=aa,W.at=j,W.an=c,W.ad=o}else j=a.trim(g.data[q][w]),j!=
""&&(K.type=="i"?isNaN(j)||(W[K.json]=parseInt(j)):W[K.json]=j)}else K.obj=="relation"&&(W=i,z==i&&(z={}),j=a.trim(g.data[q][w]),j!=""&&(K.type=="i"?isNaN(j)||(z[K.json]=parseInt(j)):z[K.json]=j));else{typeof I[K+":"+r]!=="undefined"||o!=-1&&typeof I[o+":"+r]!=="undefined"?(p=typeof I[K+":"+r]!=="undefined"?I[K+":"+r]:I[o+":"+r],typeof x[p]!=="undefined"?(W=ia.i[x[p]],f(g.data[q][w]).length>W.n.length&&(W.n=f(g.data[q][w]))):p>=0?(W={i:p,ti:K,n:f(g.data[q][w])},ia.i.push(W),x[p]=ia.i.length-1):W=
i):(p=sa,sa--,I[K+":"+r]=p,W={i:p,ti:K,n:f(g.data[q][w])},ia.i.push(W),x[p]=ia.i.length-1);if(m==-1)m=p;else if(o=-1,j="",z==i&&(z={}),typeof z.tr!=="undefined"&&(j=a.trim(z.tr).toLowerCase(),delete z.tr),b&&j==""&&typeof Zb[K]!=="undefined"&&(j=Zb[K]),j!=""&&(typeof E[j]==="undefined"?(o=J,J--,E[j]=o,ia.rt.push(a.extend(z,{tr:o,tn:j}))):o=E[j]),typeof y[o+":"+m+":"+p]==="undefined")K=Ud,Ud--,y[o+":"+m+":"+p]=K,z.r=K,z.tr=o,z.f=m,z.t=p,ia.r.push(z),A[K]=ia.r.length-1;else if(K=y[o+":"+m+":"+p],typeof A[K]!==
"undefined"){var K=ia.r[A[K]],oa;for(oa in z)z[oa]!=""&&(K[oa]=z[oa])}else if(K>=0&&!a.isEmptyObject(z))z.r=K,ia.r.push(z),A[K]=ia.r.length-1;s==-1&&(s=p);z=i}}var uc=ia.it.length,H=uc+ia.rt.length,R=H+ia.i.length,T=R+ia.r.length,ka=function(a){for(var c={it:[],rt:[],i:[],r:[]},d=a;d<a+100;d++)d<uc?c.it.push(ia.it[d]):d<H?c.rt.push(ia.rt[d-uc]):d<R?c.i.push(ia.i[d-H]):d<T&&c.r.push(ia.r[d-R]);return c},L=function(){if(d.B==Ia){var a=C.find(".textlayer"),c=a.find(".kbb-tableviewcell-selected");if(c.length>
0)a=a.find(".kbb-tableviewcolumn"),c=c.closest(".kbb-tableviewcolumn"),d.Fa=a.index(c)+1,d.ca=d.Fa}c=!D&&s>=0;if(d.j)d.j.W=s,d.j.aa=-1;d.load(c?s:P,s,"",Xb,!0,!1,xe+1);U()&&(Oc({action:"onitemmodified",i:c?s:P,f:-1,r:-1,search:"",setasroot:c?1:0}),c&&Oc({action:"onitemselected",i:c?s:P,r:-1,search:"",setasroot:0,redraw:1}));Db&&d.kb(c?s:P,!0);lf()};v||(v=L);kf(ba);var V=0,ca=-1,da=!1,Ga=function(){!da&&V<T?(a(".waitinl").addClass("waitinllarge"),a("div.waitanim span.waittext").text(Ll.replace("%1",
V).replace("%2",T)),setTimeout(function(){da=Pb;var a=ka(V);a.uei=t?1:0;a.uer=e?1:0;a.f=V==0?1:0;V+=100;a.l=da||V>=T?1:0;a.u=ca;a={action:"importdata",jsondata:JSON.stringify(a),undotext:G,undoproperties:kb(),database:O};B(a,function(a){s<0&&(s=a.i);ca=a.u;for(var c=0;c<ia.i.length;c++)ia.i[c].ti<-1&&typeof a.tit[ia.i[c].ti]!=="undefined"&&(ia.i[c].ti=a.tit[ia.i[c].ti]);for(c=0;c<ia.r.length;c++)ia.r[c].tr<-1&&typeof a.trt[ia.r[c].tr]!=="undefined"&&(ia.r[c].tr=a.trt[ia.r[c].tr]),ia.r[c].f<-1&&typeof a.ti[ia.r[c].f]!==
"undefined"&&(ia.r[c].f=a.ti[ia.r[c].f]),ia.r[c].t<-1&&typeof a.ti[ia.r[c].t]!=="undefined"&&(ia.r[c].t=a.ti[ia.r[c].t]);Ga()})},1)):(a("div.waitanim span.waittext").text(ba),a(".waitinl").removeClass("waitinllarge"),n>=0?B({action:"combineundoactionsupto",undostepid:n,description:G,database:O},function(){v(L)}):v(L))};Pb=!1;Ga()}lf()}));lf()}function bi(c){function d(){h=l.find(".kbb-separator").val();t=l.find(".kbb-export-as-text").is(":checked");e=l.find(".kbb-export-item-description").is(":checked");
D=l.find(".kbb-export-item-note").is(":checked");n=l.find(".kbb-export-item-url").is(":checked");G=l.find(".kbb-export-relation-name").is(":checked");v=l.find(".kbb-export-relation-back-name").is(":checked");f=l.find(".kbb-export-relation-description").is(":checked");g=l.find(".kbb-export-relation-category").is(":checked")}var l=i,M=i,t=!0,e=!0,D=!0,n=!0,G=!0,v=!0,f=!0,g=!0,h=b.language=="de"?";":",",u="<form>";u+="<div>"+Ml+'<select class="kbb-separator" ><option value=","'+(h==","?" selected":"")+
'>,</option><option value=";"'+(h==";"?" selected":"")+'>;</option><option value="\t">Tab</option></select></div>';u+='<div><label><input class="kbb-export-as-text" type="checkbox" checked>'+Nl+"</label></div>";u+="<div><table><tr><td>";u+="<div>"+Ol+"</div>";u+='<div><label><input class="kbb-export-item-description" type="checkbox">'+ci+"</label></div>";u+='<div><label><input class="kbb-export-item-note" type="checkbox">'+di+"</label></div>";u+='<div><label><input class="kbb-export-item-url" type="checkbox">'+
ei+"</label></div>";u+="</td><td>";u+="<div>"+Pl+"</div>";u+='<div><label><input class="kbb-export-relation-name" type="checkbox">'+Ql+"</label></div>";u+='<div><label><input class="kbb-export-relation-back-name" type="checkbox">'+Rl+"</label></div>";u+='<div><label><input class="kbb-export-relation-description" type="checkbox">'+Sl+"</label></div>";u+='<div><label><input class="kbb-export-relation-category" type="checkbox">'+Tl+"</label></div>";u+="</td></tr></table></div>";u+='<div><button class="kbb-update-preview" type="button">'+
fi+"</button></div>";u+='<div><textarea class="kbb-text-output" spellcheck="false"></textarea></div>';u+='<input type="submit" class="kbb-invisible" />';u+="</form>";var W={};W[gi]=function(){d();hi(t,e,D,n,G,v,f,g,h,function(d){if(c){var k=function(a){a!=0&&l.dialog("close")};window.savefilecallback=k;d={action:"savefile",base64data:we(d),extension:"csv",mimetype:"text/csv"};B(d,k)}else{if(typeof window.navigator!=="undefined"&&window.navigator.msSaveBlob)k=new Blob([d],{type:"text/csv"}),window.navigator.msSaveBlob(k,
"knowledgebase.csv");else{var b=a('<a href="data:text/csv;base64,'+we(d)+'" download="knowledgebase.csv">')[0];(function(){try{if(document.createEvent){var a=document.createEvent("MouseEvents");a.initEvent("click",!0,!0);b.dispatchEvent(a);return}}catch(c){}try{if(document.createEventObject){var d=document.createEventObject();b.fireEvent("onclick",d);return}}catch(k){}try{b.click&&b.click()}catch(l){}})()}l.dialog("close")}})};if(qb()||Bb())W[ii]=function(){d();hi(t,e,D,n,G,v,f,g,h,function(a){qb()?
(window.sendTextData(a,"csv"),l.dialog("close")):(a={action:"sendfile",base64data:we(a),extension:"csv",mimetype:"text/csv"},B(a,function(){l.dialog("close")}))})};W[eb]=function(){l.dialog("close")};l=a('<div class="kbb-export-csv-dialog" />').html(u).dialog({modal:!0,closeOnEscape:!1,resizable:!1,buttons:W,title:Ul,width:600,position:Mb?{my:"center top",at:"center top"}:{my:"center",at:"center"},open:function(){a(this).parent(".ui-dialog").find("*").myDisableSelection(!1)}});l.find(".kbb-update-preview").button().bind("click",
function(){var c=a(this);d();hi(t,e,D,n,G,v,f,g,h,function(a){M.val(a);qf(M);c.focus()});return!1});M=l.find(".kbb-text-output");l.find("form").bind("submit",function(){setTimeout(function(){W[Da]()},50);return!1})}function hi(c,d,l,b,t,e,D,n,G,v){function f(a,d){return c&&(d||a.toLowerCase().indexOf("<html>")==0)?Ya(function(){return g.html(a).text()}):a}var g=a("<div></div>"),h={action:"getalldata",jsonfilter:JSON.stringify({id:d?1:0,"in":l?1:0,iu:b?1:0,rn:t?1:0,rb:e?1:0,rd:D?1:0}),database:O};
kf(ba);B(h,function(a){var c="";if(a.n==0){for(var c=0,q=-1,w=-1,g=-1,h=i,j=i,S,w={},ra=S=-1,m=-1,g="",o={},p={},h={},j={},r=[],s=[],x={},B={},A={},y=[],ra=function(a,c){var q={categoryid:a,itemcount:0,itemnamecol:[c]};d&&(q.itemdescriptioncol=["$itemdescription"]);l&&(q.itemnotecol=["$itemnote"]);b&&(q.itemurlcol=["$itemurl"]);t&&(q.relationnamecol=["$relationname"]);e&&(q.relationbacknamecol=["$relationbackname"]);D&&(q.relationdescriptioncol=["$relationdescription"]);n&&(q.relationcategorycol=
["$relationcategory"]);return q},c=0;c<a.i.length;c++)S=a.i[c].ti,typeof w[S]!=="undefined"?g=w[S]:(g={},w[S]=g),S=f(a.i[c].n,!1),typeof g[S]!=="undefined"?typeof g[S]==="object"?(g[S].n+="#1",a.i[c].n+="#2",g[S]=3):(a.i[c].n+="#"+g[S],g[S]++):g[S]=a.i[c];r.push(ra(-1,""));s.push(ra(-1,""));for(c=0;c<a.it.length;c++)S=a.it[c].ti,g=a.it[c].tn,r.push(ra(S,g)),s.push(ra(S,g));for(c=0;c<a.rt.length;c++)o[a.rt[c].tr]=c;for(c=0;c<a.i.length;c++)p[a.i[c].i]=c,a.i[c].exp=!1;for(var C=function(c){return c>=
0&&typeof p[c]!=="undefined"?(q=p[c],a.i[q].ti):-1},c=0;c<a.r.length;c++)w=a.r[c].f,g=a.r[c].t,S=C(w),typeof h[S]==="undefined"?h[S]=1:h[S]++,S=C(g),typeof j[S]==="undefined"?j[S]=1:j[S]++;for(c=0;c<r.length;c++)S=r[c].categoryid,typeof h[S]!=="undefined"&&(r[c].itemcount=2*h[S]),typeof j[S]!=="undefined"&&(r[c].itemcount=Math.max(r[c].itemcount,j[S]));for(c=0;c<s.length;c++)S=s[c].categoryid,typeof j[S]!=="undefined"&&(s[c].itemcount=j[S]);c=function(a,c){return c.itemcount-a.itemcount};r.sort(c);
s.sort(c);for(c=0;c<r.length;c++)S=r[c].categoryid,x[S]=c;for(c=0;c<s.length;c++)S=s[c].categoryid,B[S]=c;var E=function(a){a.itemnamecol.push("");d&&a.itemdescriptioncol.push("");l&&a.itemnotecol.push("");b&&a.itemurlcol.push("");t&&a.relationnamecol.push("");e&&a.relationbacknamecol.push("");D&&a.relationdescriptioncol.push("");n&&a.relationcategorycol.push("")};S=function(){for(var a=0,c=-1,a=0;a<r.length;a++)E(r[a]);for(a=0;a<s.length;a++)E(s[a]);r.length>0&&(c=r[0].itemnamecol.length-1);return c};
a.r.sort(function(c,d){var k=c.f,l=d.f,b=x[C(k)],t=x[C(l)];return b==t?k>=0&&typeof p[k]!=="undefined"&&l>=0&&typeof p[l]!=="undefined"?a.i[p[k]].n.localeCompare(a.i[p[l]].n):0:b-t});for(c=0;c<a.r.length;c++)if(w=a.r[c].f,g=a.r[c].t,w>=0&&typeof p[w]!=="undefined"&&g>=0&&typeof p[g]!=="undefined"){var h=a.i[p[w]],j=a.i[p[g]],ra=C(w),m=C(g),g=r[x[ra]],z=i,z=x[m]>x[ra]?r[x[m]]:s[B[m]];typeof A[w]==="undefined"&&(A[w]=[]);for(var m=ra=0,I=!1,m=0;m<A[w].length;m++)if(ra=A[w][m],z.itemnamecol[ra]==""){z.itemnamecol[ra]=
f(j.n,!1);if(!j.exp)d&&(z.itemdescriptioncol[ra]=f(j.d,!1)),l&&(z.itemnotecol[ra]=f(j.a,!0)),b&&(z.itemurlcol[ra]=j.u),j.exp=!0;t&&(z.relationnamecol[ra]=a.r[c].n);e&&(z.relationbacknamecol[ra]=a.r[c].b);D&&(z.relationdescriptioncol[ra]=f(a.r[c].d,!1));n&&a.r[c].tr>=0&&(z.relationcategorycol[ra]=a.rt[o[a.r[c].tr]].tn);I=!0;break}if(!I&&(ra=S(),ra>=0)){g.itemnamecol[ra]=f(h.n,!1);z.itemnamecol[ra]=f(j.n,!1);if(!h.exp)d&&(g.itemdescriptioncol[ra]=f(h.d,!1)),l&&(g.itemnotecol[ra]=f(h.a,!0)),b&&(g.itemurlcol[ra]=
h.u),h.exp=!0;if(!j.exp)d&&(z.itemdescriptioncol[ra]=f(j.d,!1)),l&&(z.itemnotecol[ra]=f(j.a,!0)),b&&(z.itemurlcol[ra]=j.u),j.exp=!0;t&&(z.relationnamecol[ra]=a.r[c].n);e&&(z.relationbacknamecol[ra]=a.r[c].b);D&&(z.relationdescriptioncol[ra]=f(a.r[c].d,!1));n&&a.r[c].tr>=0&&(z.relationcategorycol[ra]=a.rt[o[a.r[c].tr]].tn);A[w].push(ra)}}a.i.sort(function(a,c){if(a.exp&&c.exp)return 0;else{var d=x[a.ti],k=x[c.ti];return d==k?a.n.localeCompare(c.n):d-k}});for(c=0;c<a.i.length;c++)if(h=a.i[c],!h.exp){ra=
h.ti;g=r[x[ra]];ra=S();if(ra>=0)g.itemnamecol[ra]=h.n,d&&(g.itemdescriptioncol[ra]=h.d),l&&(g.itemnotecol[ra]=h.a),b&&(g.itemurlcol[ra]=h.u);h.exp=!0}for(var N=function(a){for(var c=1;c<a.length;c++)if(a[c]!="")return!1;return!0},sa=function(a){N(a)||y.push(a)},o=function(a){N(a.itemnamecol)||(t&&sa(a.relationnamecol),e&&sa(a.relationbacknamecol),D&&sa(a.relationdescriptioncol),n&&sa(a.relationcategorycol),sa(a.itemnamecol),d&&sa(a.itemdescriptioncol),l&&sa(a.itemnotecol),b&&sa(a.itemurlcol))},c=
0;c<r.length;c++)o(r[c]);for(c=0;c<s.length;c++)o(s[c]);c=ra=0;o=i;B={data:[]};if(y.length>0)for(ra=0;ra<y[0].length;ra++){o=[];for(c=0;c<y.length;c++)o.push(y[c][ra].replace(/[\r]/g,"").replace(/[\n]/g," ").replace(/[\t]/g," ").trim());B.data.push(o)}c=Papa.unparse(B,{quotes:!1,delimiter:G,newline:"\r\n"})}lf();v(c)})}function ji(c){function k(c){if(c){var d=new FileReader;a(d).bind("load",function(){e.val(this.result)});d.readAsText(c)}}var l=i,b=i,t=i,e=i,t="<form>";t+=Bb()?'<div><button class="kbb-open-file" type="button">'+
Vl+"</button></div>":'<div><input class="kbb-select-file" type="file" accept=".xml,.xsd,.wsdl" /></div>';c&&(t+="<div>"+od+"</div>",t+='<div class="kbb-drop-file">'+Wl+"</div>");t+="<div>"+Xl+"</div>";t+='<div><textarea class="kbb-text-input" spellcheck="false"></textarea></div>';t+='<input type="submit" class="kbb-invisible" />';t+="</form>";var D={};D[Da]=function(){var a=e.val();a.length>0?(l.dialog("close"),B({action:"getnextundopos",database:O},function(c){function k(a,c){c!==z[a]&&(z[a]=c,l=
!0)}var l=!1;d.G=3;k("dl",3);d.za=1;k("dl3d",1);d.Wa=0;k("wtr",0);d.Ka=1;k("wcl",1);d.Za=0;k("dce",0);d.ga=0;k("mri",0);if(l){kf(ba);var b={action:"setdiagramproperty",name:"dp",value:JSON.stringify(z),undotext:"",undoproperties:kb(),database:O};B(b,function(){Yl(a,c);lf()})}else Yl(a,-1)})):e.focus()};D[eb]=function(){l.dialog("close")};l=a('<div class="kbb-import-xml-dialog" />').html(t).dialog({modal:!0,closeOnEscape:!1,resizable:!1,buttons:D,title:Zl,width:500,position:Mb?{my:"center top",at:"center top"}:
{my:"center",at:"center"},open:function(){a(this).parent(".ui-dialog").find("*").myDisableSelection(!1)},close:function(){a(this).dialog("destroy")}});e=l.find(".kbb-text-input");l.find("form").bind("submit",function(){setTimeout(function(){D[Da]()},50);return!1});Bb()?l.find(".kbb-open-file").button().bind("click",function(){var a="";window.loadfilecallback=function(c,d,k){d&&(a="");a+=c;k&&a!=""&&(c=ve(a),e.val(c))};B({action:"loadfile",extensions:".xml,.xsd,.wsdl",tag:"openxml"},fa())}):(t=l.find(".kbb-select-file"),
t.bind("change",function(){this.files&&this.files.length>0&&k(this.files[0]);return!1}));c&&(b=l.find(".kbb-drop-file"),b.bind("dragover",ha(!1)),b.bind("dragenter",function(){b.addClass("kbb-hilite");return!1}),b.bind("dragleave",function(){b.removeClass("kbb-hilite");return!1}),b.bind("drop",function(a){b.removeClass("kbb-hilite");typeof a.originalEvent!=="undefined"&&typeof a.originalEvent.dataTransfer!=="undefined"&&typeof a.originalEvent.dataTransfer.files!=="undefined"&&a.originalEvent.dataTransfer.files.length>
0&&k(a.originalEvent.dataTransfer.files[0]);return!1}))}function Yl(a,d){function l(a){if(a!=i){var c=0,d=i,k=i,c=i,k=a.localName;if(a.nodeType==1&&(c=a.attributes,d=a.childNodes,c&&c.length!=0||d&&d.length>0&&(d.length!=1||d[0].nodeType!=3)))if(typeof n[k]==="undefined"&&(D.push(k),n[k]=D.length-1),d)for(c=0;c<d.length;c++)k=d[c],l(k)}}function b(a,c){if(typeof n[a]!=="undefined")for(var d=0,k=n[a],d=0;d<=k;d++)G+=c?";;;;":";;"}function t(a,c){var d=D.length;typeof n[a]!=="undefined"&&(d-=n[a]+1);
for(var k=0;k<d;k++)G+=c?";;;;":";;"}function e(a,c,d){if(a!=i){var k=0,l=i,n=i,v=n=i,l=a.nodeType,D=a.localName,k=a.namespaceURI,f=i,f="";k==i&&(k="");if(l==1)if(n=a.attributes,l=a.childNodes,(n==i||n.length==0)&&(l==i||l.length==0||l.length==1&&l[0].nodeType==3))f="",l.length==1&&(f=l[0].nodeValue),b(d,!1),G+=R(c)+";;",t(d,!1),G+=";;;;",t("",!0),G+=R("T:"+D)+";;"+R(f.substr(0,200))+";"+R(k)+";;;;\n";else{f='<html><span data-guid="'+gd()+'">'+Nd(D)+"</span></html>";b(d,!1);G+=R(c)+";;";t(d,!1);b(D,
!0);G+=";;"+R(f)+";"+R(k)+";";t(D,!0);G+=";;;;;;;\n";if(n)for(k=0;k<n.length;k++)v=n[k],e(v,f,D);if(l)for(k=0;k<l.length;k++)n=l[k],e(n,f,D)}else if(l==2&&(f=a.nodeValue))b(d,!1),G+=R(c)+";;",t(d,!1),G+=";;;;",t("",!0),G+=";;;;"+R("T:"+D)+";;"+R(f.substr(0,200))+";"+R(k)+"\n"}}var D=[],n={},G="";try{var v=(new DOMParser).parseFromString(a,"text/xml"),f;if(v){l(v.documentElement);G=R(ki)+";$itemdescription;";for(f=0;f<D.length;f++)G+=R(D[f])+";$itemdescription;";G+="$relationname;$relationcategory;"+
R(ki)+";$itemdescription;";for(f=0;f<D.length;f++)G+="$relationname;$relationcategory;"+R(D[f])+";$itemdescription;";G+="$relationname;$relationcategory;"+R($l)+";$itemdescription;$relationname;$relationcategory;"+R(am)+";$itemdescription\n";e(v.documentElement,"","");pd(G,!0,!0,!1,!0,!0,!1,d,bm)}}catch(g){}}function wx(){var c=!U()&&!qb()&&!Bb()&&!jf();function k(c){if(c){var d=new FileReader;a(d).bind("load",function(){e.val(this.result)});d.readAsText(c)}}var l=i,b=i,t=i,e=i,t="<form>";t+=Bb()?
'<div><button class="kbb-open-file" type="button">'+cm+"</button></div>":'<div><input class="kbb-select-file" type="file" accept=".txt" /></div>';c&&(t+="<div>"+od+"</div>",t+='<div class="kbb-drop-file">'+dm+"</div>");t+="<div>"+em+'<button class="kbb-insert-example" type="button">'+fm+"</button></div>";t+='<div><textarea class="kbb-text-input" spellcheck="false"></textarea></div>';t+='<input type="submit" class="kbb-invisible" />';t+="</form>";var D={};D[Da]=function(){var a=e.val();a.length>0?
(l.dialog("close"),B({action:"getnextundopos",database:O},function(c){function k(a,c){c!==z[a]&&(z[a]=c,l=!0)}var l=!1;d.G=3;k("dl",3);d.za=1;k("dl3d",1);d.Wa=0;k("wtr",0);d.Ka=1;k("wcl",1);d.Za=0;k("dce",0);d.ga=0;k("mri",0);if(l){kf(ba);var b={action:"setdiagramproperty",name:"dp",value:JSON.stringify(z),undotext:"",undoproperties:kb(),database:O};B(b,function(){gm(a,c);lf()})}else gm(a,-1)})):e.focus()};D[eb]=function(){l.dialog("close")};l=a('<div class="kbb-insert-pseudocode-dialog" />').html(t).dialog({modal:!0,
closeOnEscape:!1,resizable:!1,buttons:D,title:hm,width:500,position:Mb?{my:"center top",at:"center top"}:{my:"center",at:"center"},open:function(){a(this).parent(".ui-dialog").find("*").myDisableSelection(!1)},close:function(){a(this).dialog("destroy")}});e=l.find(".kbb-text-input");e.on("keydown",mf);l.find(".kbb-insert-example").button().bind("click",function(){e.val(im)});l.find("form").bind("submit",function(){setTimeout(function(){D[Da]()},50);return!1});Bb()?l.find(".kbb-open-file").button().bind("click",
function(){var a="";window.loadfilecallback=function(c,d,k){d&&(a="");a+=c;k&&a!=""&&(c=ve(a),e.val(c))};B({action:"loadfile",extensions:".txt",tag:"openpseudocode"},fa())}):(t=l.find(".kbb-select-file"),t.bind("change",function(){this.files&&this.files.length>0&&k(this.files[0]);return!1}));c&&(b=l.find(".kbb-drop-file"),b.bind("dragover",ha(!1)),b.bind("dragenter",function(){b.addClass("kbb-hilite");return!1}),b.bind("dragleave",function(){b.removeClass("kbb-hilite");return!1}),b.bind("drop",function(a){b.removeClass("kbb-hilite");
typeof a.originalEvent!=="undefined"&&typeof a.originalEvent.dataTransfer!=="undefined"&&typeof a.originalEvent.dataTransfer.files!=="undefined"&&a.originalEvent.dataTransfer.files.length>0&&k(a.originalEvent.dataTransfer.files[0]);return!1}))}function gm(c,d){function l(c,d){for(var k=0;k<d.length;k++){var l=a.inArray(d[k].c,f);l<0&&(l=0);for(var b=0;b<c.length;b++){var t=a.inArray(c[b].c,f);t<0&&(t=0);for(var M=0;M<t;M++)e+=";;;";e+=R(c[b].n)+";"+R(c[b].d)+";"+R(c[b].t)+";";for(M=t;M<f.length-1;M++)e+=
";;;";for(M=0;M<l;M++)e+=";;;;;;";e+=R(c[b].rn)+";"+R(c[b].rd)+";"+R(c[b].rc)+";"+R(d[k].n)+";"+R(d[k].d)+";"+R(d[k].t)+";";for(M=l;M<f.length-1;M++)e+=";;;;;;";e+="\n"}}}function b(a,c,d,k){if(n[G].c=="{")for(G++;G<n.length;){if(n[G].c=="}"){G++;break}a=t(a,c,d,k)}else a=t(a,c,d,k);return a}function t(a,c,d,k){function e(c){if(c==""&&n[G].t=="")return G++,a;c=[{n:"<html>"+(c!=""?"<b>"+Nd(c)+"</b><br>":"")+'<span data-guid="'+gd()+'">'+Nd(n[G].t)+"</span></html>",d:n[G].d,t:v,c:n[G].c,rn:"",rd:"",
rc:""}];l(a,c);G++;v="";return c}function q(a){var c=[{n:'<html><b><span data-guid="'+gd()+'">'+Nd(jm)+"</span></b></html>",d:"",t:"",c:"return",rn:"",rd:"",rc:""}];l(a,c)}function f(a,c,d,k){for(var l=[],b=0;b<a.length;b++)l.push({n:a[b].n,d:a[b].d,t:a[b].t,c:a[b].c,rn:c,rd:d,rc:k});return l}var D=[],w;if(n[G].c=="if")a=e(km),a=f(a,vg,"",""),D=b(a,c,d,k),n[G].c=="else"?(a=f(a,rf,"",""),G++,D=D.concat(b(a,c,d,k))):(a=f(a,rf,"",""),D=a.concat(D));else if(n[G].c=="switch"){if(w=a=e(lm),n[G].c=="{")for(G++;G<
n.length;)if(n[G].c=="case"||n[G].c=="default"){w=f(w,n[G].c=="default"?mm:n[G].t,n[G].d,"");G++;for(a=w;G<n.length;){if(n[G].c=="break"){D=D.concat(a);G++;break}a=t(a,c,d,k)}}else if(n[G].c=="}"){G++;break}else G++}else n[G].c=="while"?(c=[],a=e(li),w=a=f(a,vg,"",""),a=b(a,w,c,k),l(a,w),w=f(w,rf,"",""),D=w=w.concat(c)):n[G].c=="do"?(c=[],w=a=e(nm),a=b(a,w,c,k),n[G].c=="while"&&(D=e(li),D=f(D,vg,"",""),l(D,w),D=f(D,rf,"",""),D=D.concat(c))):n[G].c=="for"?(c=[],a=e(om),w=a=f(a,pm,"",""),a=b(a,w,c,
k),l(a,w),w=f(w,qm,"",""),D=w=w.concat(c)):n[G].c=="continue"?(l(a,c),G++):n[G].c=="break"?(Array.prototype.push.apply(d,a),G++):n[G].c=="function"?(a=[],k=[],w="",n[G].t.length>0&&(D=n[G].t.split(/[\s(]+/),D.length>0&&(w=D[0].trim())),a=e(rm),w!=""&&(g[w]=a),D=b(a,c,d,k),k.length==0?Array.prototype.push.apply(k,D):D.length>0&&D[D.length-1].n!=k[k.length-1].n&&Array.prototype.push.apply(k,D),q(k),D=[]):n[G].c=="return"?(n[G].t!=""&&(a=f(a,n[G].t,"","")),Array.prototype.push.apply(k,a),G++):n[G].c==
"call"?(w="",n[G].t.length>0&&(D=n[G].t.split(/[\s(]+/),D.length>0&&(w=D[0].trim())),D=e(mi),w!=""&&h.push({n:w,c:f(D,mi,"","call")})):D=e("");return D}for(var e="",D=c.split(/\n/),n=[],G=0,v=Nd(c).replace(/[\r]/gi,"").replace(/[\n]/gi,"<br>").replace(/[\t]/gi,"    ").replace(/[ ]/gi,"&nbsp;"),f=["cmd","if","switch","while","do","for","function","call","return"],g={},h=[],u=0;u<f.length;u++)e+=R(f[u]),e+=";$itemdescription;$itemnote;";for(u=0;u<f.length;u++)e+="$relationname;$relationdescription;$relationcategory;",
e+=R(f[u]),e+=";$itemdescription;$itemnote;";e+="\n";for(u=0;u<D.length;u++)if(/\S/.test(D[u])){var j=a.trim(D[u].replace(/[\t\n]+/g," ")),q=j.lastIndexOf("//"),w="";q>=0&&(w=j.substr(q+2).trim(),j=j.substr(0,q).trim());j.length>0&&j[j.length-1]==";"&&(j=j.slice(0,-1));var za=j.indexOf(" "),m=q="";za>0?(q=j.substr(0,za).trim().toLowerCase(),m=j.substr(za).trim()):q=j.trim().toLowerCase();if(a.inArray(q,["{","}","if","else","switch","case","break","default","default:","while","do","for","continue",
"function","call","return"])>=0){if(a.inArray(q,["if","else","switch","while","for"])>=0&&m.length>0&&m[0]=="("&&m[m.length-1]==")"){for(var j=0,za=!0,K=0;K<m.length-1;K++)if(m[K]=="(")j++;else if(m[K]==")"&&(j--,j==0)){za=!1;break}za&&(m=m.substr(1,m.length-2).trim())}q=="case"&&m.length>0&&m[m.length-1]==":"&&(m=m.slice(0,-1));q=="default:"&&(q=q.slice(0,-1));n.push({c:q,t:m,d:w})}else n.push({c:"",t:j,d:w})}for(D=[];G<n.length;)D=t(D,[],[],[]);for(u=0;u<h.length;u++)typeof g[h[u].n]!=="undefined"&&
l(h[u].c,g[h[u].n]);pd(e,!0,!0,!1,!0,!0,!1,d,sm)}function xx(){var c=!U()&&!qb()&&!Bb()&&!jf();function d(c){if(c){var k=new FileReader;a(k).bind("load",function(){e.val(this.result)});k.readAsText(c)}}var l=i,b=i,t=i,e=i,t="<form>";t+=Bb()?'<div><button class="kbb-open-file" type="button">'+tm+"</button></div>":'<div><input class="kbb-select-file" type="file" accept=".txt" /></div>';c&&(t+="<div>"+od+"</div>",t+='<div class="kbb-drop-file">'+um+"</div>");t+="<div>"+vm+'<button class="kbb-insert-example" type="button">'+
wm+"</button></div>";t+='<div><textarea class="kbb-text-input" spellcheck="false"></textarea></div>';t+='<input type="submit" class="kbb-invisible" />';t+="</form>";var D={};D[Da]=function(){var a=e.val();a.length>0?(l.dialog("close"),yx(a)):e.focus()};D[eb]=function(){l.dialog("close")};l=a('<div class="kbb-insert-outlinedtext-dialog" />').html(t).dialog({modal:!0,closeOnEscape:!1,resizable:!1,buttons:D,title:xm,width:500,position:Mb?{my:"center top",at:"center top"}:{my:"center",at:"center"},open:function(){a(this).parent(".ui-dialog").find("*").myDisableSelection(!1)},
close:function(){a(this).dialog("destroy")}});e=l.find(".kbb-text-input");e.on("keydown",mf);l.find(".kbb-insert-example").button().bind("click",function(){e.val(ym)});l.find("form").bind("submit",function(){setTimeout(function(){D[Da]()},50);return!1});Bb()?l.find(".kbb-open-file").button().bind("click",function(){var a="";window.loadfilecallback=function(c,d,k){d&&(a="");a+=c;k&&a!=""&&(c=ve(a),e.val(c))};B({action:"loadfile",extensions:".txt",tag:"openoutlinedtext"},fa())}):(t=l.find(".kbb-select-file"),
t.bind("change",function(){this.files&&this.files.length>0&&d(this.files[0]);return!1}));c&&(b=l.find(".kbb-drop-file"),b.bind("dragover",ha(!1)),b.bind("dragenter",function(){b.addClass("kbb-hilite");return!1}),b.bind("dragleave",function(){b.removeClass("kbb-hilite");return!1}),b.bind("drop",function(a){b.removeClass("kbb-hilite");typeof a.originalEvent!=="undefined"&&typeof a.originalEvent.dataTransfer!=="undefined"&&typeof a.originalEvent.dataTransfer.files!=="undefined"&&a.originalEvent.dataTransfer.files.length>
0&&d(a.originalEvent.dataTransfer.files[0]);return!1}))}function yx(a){function d(a,c){for(;q<W.length;)if(q>0&&W[q].i>c)d(W[q-1],W[q].i);else if(W[q].i<c)break;else{var b=a,t=W[q],e=j[t.ic];if(b){for(var M=j[b.ic],n=0;n<M;n++)l+=";;;";l+=R(b["in"])+";"+R(b.id)+";"+R(b.it)+";";for(n=M;n<u.length-1;n++)l+=";;;"}else for(n=0;n<u.length;n++)l+=";;;";for(n=0;n<e;n++)l+=";;;;;;";l+=R(t.rn)+";"+R(t.rd)+";"+R(t.rc)+";"+R(t["in"])+";"+R(t.id)+";"+R(t.it)+";";for(n=e;n<u.length-1;n++)l+=";;;;;;";l+="\n";q++}}
for(var l="",b=a.split(/\n/),t,e,D,n,f=Nd(a).replace(/[\r]/gi,"").replace(/[\n]/gi,"<br>").replace(/[\t]/gi,"    ").replace(/[ ]/gi,"&nbsp;"),v,g,h,j={},u=[],W=[],q=0,w=0;w<b.length;w++)/\S/.test(b[w])&&(a=b[w].search(/\S/),a>=0&&(t=b[w].substr(a).trim(),e=t.indexOf(">>"),e>=0?(v=t.substr(0,e).trim(),t=t.substr(e+2).trim()):v="",t!=""&&(g=e="",D=t.indexOf("::"),D>=0&&(e=t.substr(0,D).trim(),t=t.substr(D+2).trim()),typeof j[e]==="undefined"&&(j[e]=u.push(e)-1),D=v.indexOf("::"),D>=0&&(g=v.substr(0,
D).trim(),v=v.substr(D+2).trim()),t!=""&&(h=n="",D=t.lastIndexOf("("),D>=0&&t[t.length-1]==")"&&(n=t.substring(D+1,t.length-1).trim(),t=t.substr(0,D).trim()),v!=""&&(D=v.lastIndexOf("("),D>=0&&v[v.length-1]==")"&&(h=v.substring(D+1,v.length-1).trim(),v=v.substr(0,D).trim())),t!=""&&(W.push({i:a,"in":t,id:n,ic:e,it:f,rn:v,rd:h,rc:g}),f="")))));for(w=0;w<u.length;w++)l+=R(u[w]),l+=";$itemdescription;$itemnote;";for(w=0;w<u.length;w++)l+="$relationname;$relationdescription;$relationcategory;",l+=R(u[w]),
l+=";$itemdescription;$itemnote;";l+="\n";d(i,0);pd(l,!0,!1,!1,!0,!0,!1,-1,zm)}function Am(c,k){function l(c){if(c){var d=new FileReader;a(d).bind("load",function(){D.val(this.result)});d.readAsText(c)}}var b=i,t=i,e=i,D=i,n=i,f=i,v=i,g=i,e=[{n:Bm,c:"de"},{n:Cm,c:"en"},{n:Dm,c:"fr"},{n:Em,c:"es"},{n:Fm,c:"it"},{n:Gm,c:"ud"}],h="<form>";k==i&&(h+=Bb()?'<div><button class="kbb-open-file" type="button">'+Hm+"</button></div>":'<div><input class="kbb-select-file" type="file" accept=".txt" /></div>',c&&
(h+="<div>"+od+"</div>",h+='<div class="kbb-drop-file">'+Im+"</div>"),h+="<div>"+Jm+'<button class="kbb-insert-notes" type="button">'+Km+"</button></div>");h+='<div><textarea class="kbb-text-input" spellcheck="false"></textarea></div>';h+="<div><label>"+Lm+'<select class="kbb-select-text-language">';for(var j=0;j<e.length;j++)h+='<option value="'+Nd(e[j].c)+'"'+(e[j].c==wg?" selected":"")+">"+e[j].n+"</option>";h+="</select></label></div>";h+="<div><label>"+Mm+'<br><input class="kbb-additional-stopwords" type="text" value="'+
Nd(sf)+'"></label></div>';h+="<div><label>"+Nm+'<br><input class="kbb-additional-wordendings" type="text" value="'+Nd(xg)+'"></label></div>';h+="<div><label>"+Om+'<br><input class="kbb-additional-abbreviations" type="text" value="'+Nd(yg)+'"></label></div>';h+='<input type="submit" class="kbb-invisible" />';h+="</form>";var u={};u[Da]=function(){var a=D.val(),c=n.val(),l=f.val(),t=v.val(),e=g.val();a.length>0?(b.dialog("close"),k&&Pm(),typeof window.localStorage!=="undefined"&&(wg=c,window.localStorage.setItem("analyzetextlanguagecode",
wg),sf=l,window.localStorage.setItem("analyzetextadditionalstopwords",sf),xg=t,window.localStorage.setItem("analyzetextadditionalwordendings",xg),yg=e,window.localStorage.setItem("analyzetextadditionalabbreviations",yg)),B({action:"getnextundopos",database:O},function(k){var b=!1;d.Ka=0;(function(a,c){c!==z[a]&&(z[a]=c,b=!0)})("wcl",0);if(b){kf(ba);var M={action:"setdiagramproperty",name:"dp",value:JSON.stringify(z),undotext:"",undoproperties:kb(),database:O};B(M,function(){Qm(a,c,l,t,e,k);lf()})}else Qm(a,
c,l,t,e,-1)})):D.focus()};u[eb]=function(){b.dialog("close")};b=a('<div class="kbb-analyze-text-dialog" />').html(h).dialog({modal:!0,closeOnEscape:!1,resizable:!1,buttons:u,title:Rm,width:500,position:Mb?{my:"center top",at:"center top"}:{my:"center",at:"center"},open:function(){a(this).parent(".ui-dialog").find("*").myDisableSelection(!1)},close:function(){a(this).dialog("destroy")}});b.find(".kbb-insert-notes").button().bind("click",function(){var c=a(this),k={action:"getalldata",jsonfilter:JSON.stringify({id:0,
"in":0,iu:0,rn:0,rb:0,rd:0}),database:O};Pb=!1;kf(ba);B(k,function(k){if(k.n==0){var l=a("<div></div>"),b="",t="",e=0,M=function(){!Pb&&e<k.i.length?(a(".waitinl").addClass("waitinllarge"),a("div.waitanim span.waittext").text(Sm.replace("%1",e+1).replace("%2",k.i.length+1)),d.fc(k.i[e].i,function(a){a&&a!=""&&(a=a.replace(/<style\b[^<]*(?:(?!<\/style>)<[^<]*)*<\/style>/gi,""),a=a.replace(/<head\b[^<]*(?:(?!<\/head>)<[^<]*)*<\/head>/gi,""),b=Ya(function(){l.html(a);return Qc(l[0],i,0,i,0,i).t}),b!=
""&&(t+=b+"\n"),a="");e++;M()})):(D.val(t),qf(D),c.focus(),a("div.waitanim span.waittext").text(ba),a(".waitinl").removeClass("waitinllarge"),lf())};M()}});return!1});D=b.find(".kbb-text-input");n=b.find(".kbb-select-text-language");f=b.find(".kbb-additional-stopwords");v=b.find(".kbb-additional-wordendings");g=b.find(".kbb-additional-abbreviations");k&&D.val(k);I({action:"searchtemplate",search:"#",maxsearchresults:1E3,templatetype:0,database:O},function(c){if(c.n==0){for(var d=-1,k=0;k<c.h.length;k++)if(c.h[k].v==
"#"){d=c.h[k].i;break}d>=0&&B({action:"getitemsincategory",id:d,maxresults:1E4,database:O},function(c){if(c.n==0){for(var d=[],k={},l,b,t="",e=sf.split(/[\s]+/),M=0;M<e.length;M++)l=e[M],b=l.toLowerCase(),b!=""&&typeof k[b]==="undefined"&&(d.push(l),k[b]=1);c.i.forEach(function(c){l=a.trim(jd(a.trim(c.n)));b=l.toLowerCase();b!=""&&typeof k[b]==="undefined"&&(d.push(l),k[b]=1)});for(M=0;M<d.length;M++)M>0&&(t+=" "),t+=d[M];f.val(t)}})}});b.find("form").bind("submit",function(){setTimeout(function(){u[Da]()},
50);return!1});Bb()?b.find(".kbb-open-file").button().bind("click",function(){var a="";window.loadfilecallback=function(c,d,k){d&&(a="");a+=c;k&&a!=""&&(c=ve(a),D.val(c))};B({action:"loadfile",extensions:".txt",tag:"openanalyzetext"},fa())}):(e=b.find(".kbb-select-file"),e.bind("change",function(){this.files&&this.files.length>0&&l(this.files[0]);return!1}));c&&(t=b.find(".kbb-drop-file"),t.bind("dragover",ha(!1)),t.bind("dragenter",function(){t.addClass("kbb-hilite");return!1}),t.bind("dragleave",
function(){t.removeClass("kbb-hilite");return!1}),t.bind("drop",function(a){t.removeClass("kbb-hilite");typeof a.originalEvent!=="undefined"&&typeof a.originalEvent.dataTransfer!=="undefined"&&typeof a.originalEvent.dataTransfer.files!=="undefined"&&a.originalEvent.dataTransfer.files.length>0&&l(a.originalEvent.dataTransfer.files[0]);return!1}))}function Qm(c,d,l,b,t,e){function D(){function d(a){for(var a=a.split(/[\s]+/),c=0,k=0,l=0;l<a.length;l++)o=y(a[l]),c=typeof Y[o]!=="undefined"?Y[o]:Wh,k=
l==0?c:k*c/(k+c);return k}function k(a,c){for(var d=!0;d;)if(d=!1,a.length>0&&"([{\u00ab\u00bb\"'\u201e\u201c\u2018\u2019\u201c\u201d".indexOf(a[0])>=0&&(a=a.substring(1),d=!0),a.length>0&&",.!?;:)]}\u00ab\u00bb\"'\u201c\u2018\u2019\u201c\u201d".indexOf(a[a.length-1])>=0&&(a.match(/^[0-9]*[.]$/)==i||a.match(/^[0-9]*[.]$/)[0].length>3)&&(c||typeof uc[a.toLowerCase()]==="undefined"))a=a.substring(0,a.length-1),d=!0;return a}function b(a){var c=a.replace(/[0-9(\[{\u00ab\u201e)\]}\u00bb\"\'\u201c\u2018\u2019\u201c\u201d]*$/,
""),a=a.replace(/^[(\[{\u00ab\u00bb\"\'\u201e\u201c\u2018\u2019\u201c\u201d]*/,"").replace(/[0-9(\[{\u00ab\u201e)\]}\u00bb\"\'\u201c\u2018\u2019\u201c\u201d!?;]*$/,"");return c.length>2&&".!?;".indexOf(c[c.length-1])>=0&&(c.match(/^[0-9]*[.]$/)==i||c.match(/^[0-9]*[.]$/)[0].length>3)&&typeof uc[a.toLowerCase()]==="undefined"}function t(a){var c=a.replace(/[0-9(\[{\u00ab\u201e)\]}\u00bb\"\'\u201c\u2018\u2019\u201c\u201d!?;:]*$/,"");return a.length>0&&",.!?;:)]}\u00ab\u00bb\"'\u201c\u2018\u2019\u201c\u201d".indexOf(a[a.length-
1])>=0&&(a.match(/^[0-9]*[.]$/)==i||a.match(/^[0-9]*[.]$/)[0].length>3)&&typeof uc[c.toLowerCase()]==="undefined"}function M(a,c){for(var d=[],k=0;k<a.length;k++)for(var l=0;l<c.length;l++)if(a[k].si==c[l].si){d.push({si:a[k].si,wi:a[k].wi,w:a[k].w+" "+c[l].w});break}return d}function D(){var a,c,d,k={},l,b;c=!1;for(var t=-1,e=0;e<v.length;e++)v[e]==T?t=-1:v[e]!=P&&(t>=0&&(l=v[t]+"-"+v[e],typeof k[l]!=="undefined"?k[l].n++:k[l]={n:1}),t=f[v[e]].x?-1:e);t=-1;for(e=0;e<v.length;e++)if(v[e]==T)t=-1;
else if(v[e]!=P){if(t>=0&&(l=v[t]+"-"+v[e],k[l].n>=2)){a=0;b="";if(!f[v[e]].x)for(d=e+1;d<v.length;d++)if(v[d]==T)break;else if(v[d]!=P){if(!f[v[d]].x)b=v[e]+"-"+v[d],a=k[b].n;break}if(k[l].n>=a)a=m[t]+" "+m[e],typeof k[l].i!=="undefined"?(d=k[l].i,c=f[d],c.n++):(c={x:!1,s:M(f[v[t]].s,f[v[e]].s),n:1},d=f.push(c)-1,c.i=d,k[l].i=d),A[e]=f[v[e]].x?{i:t,w:v[t],n:v[e],r:m[t]}:{i:t,w:-1,n:-1,r:""},v[t]=d,v[e]=P,m[t]=a,c=!0,b!=""&&k[b].n--}t=f[v[e]].x||v[e]==P?-1:e}return c}function y(a){var c=a;do for(var d,
a=c,k=aa.length-1;k>=0;k--)if(a.length>k+1&&(d=a.substr(a.length-k-1),aa[k].indexOf(d)>=0)){c=a.substr(0,a.length-k-1);break}while(c.length<a.length);return c}function oa(a){var c="";if(a.length>0){c+="<html><ul>";for(var d=0;d<Math.min(7,a.length);d++)d>0&&K[a[d].si].toLowerCase()==K[a[d-1].si].toLowerCase()||(c+="<li>"+Nd(K[a[d].si])+"</li>");c+="</ul></html>"}return c}function z(a){var c="";f[a].s.length>0&&(c=f[a].s[0].w);return c}function I(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}
function sa(a){var c="";if(typeof Ud[a]==="undefined"&&f[a].s.length>0){var c=Nd(K[f[a].s[0].si]),d=Nd(z(a)),k=RegExp(I(d),"g"),c="<html>"+c.replace(k,'<font size="4"><b>'+d+"</b></font>")+"</html>";Ud[a]=1}return c}function N(a){var c="<html>",d="";if(typeof hg[a]==="undefined")for(var k=0;k<f[a].s.length;k++){var l=Nd(K[f[a].s[k].si]);if(l!=d)for(var d=l,b=0;b<f[a].s.length;b++){var t=Nd(f[a].s[b].w),e=RegExp(I(t),"g"),t=l.replace(e,"<b>"+t+"</b>");if(t!=l){c+=t+"<br><br>";break}}}c+="</html>";
hg[a]=1;return c}for(var F=window[L],Y={},J,ia,H="",tc,Q=0;Q<F.length;Q++){J=Ef.indexOf(F.charAt(Q++));ia=Ef.indexOf(F.charAt(Q++));J=H.substr(0,J);for(H=0;H<ia;H++)J+=F[Q++];H=Ef.indexOf(F.charAt(Q++));ia=Ef.indexOf(F.charAt(Q++));tc=Ef.indexOf(F.charAt(Q));H=(64*H+ia)/Math.pow(64,tc);o=y(J);o!=""&&(typeof Y[o]!=="undefined"&&!isNaN(Y[o])?Y[o]+=H:Y[o]=H);H=J}var Wh=1;a.each(Y,function(a,c){c>5.0E-4&&C.push(a);Wh=Math.min(Wh,c)});F=l.split(/[\s]+/);for(Q=0;Q<F.length;Q++)o=y(F[Q].toLowerCase()),o!=
""&&C.push(o);for(Q=0;Q<C.length;Q++)E[C[Q]]=1;var F={x:!0,s:[],n:1},P=f.push(F)-1;F.i=P;var F={x:!0,s:[],n:1},T=f.push(F)-1;F.i=T;c+=" ";for(Q=0;Q<c.length;Q++)if(/\S/.test(c[Q]))n.push(c[Q]);else if(n.length>0){za="\r\n".indexOf(c[Q])>=0;n=n.join("");r==""?s=-1:r+=" ";r+=n;s++;if(b(n)||za)K.push(r),r="";n.length>0&&"([{\u00ab\u00bb\"'\u201e\u201c\u2018\u2019\u201c\u201d".indexOf(n[0])>=0&&(v.push(T),m.push(""));q=t(n)||za;x=k(n,!1);o=y(x.toLowerCase());if(o.length>0)g=B[o],typeof g!=="undefined"&&
typeof f[g]!=="undefined"?(F=f[g],F.n++,p!=F.s[F.s.length-1].si&&F.s.push({si:p,wi:s,w:x})):(w=o.length<2||typeof E[o]!=="undefined"||o.match(/^[-+.,0-9]*$/)!=i,F={x:w,s:[{si:p,wi:s,w:x}],n:1},g=f.push(F)-1,F.i=g,B[o]=g),v.push(g),m.push(n),q&&(v.push(T),m.push(""));n=[];p=K.length}r!=""&&K.push(r);for(var Ud={},hg={},Q=2;D();Q++);(function(){for(var a=v.length-1;a>=0;a--)if(typeof A[a]!=="undefined")A[a].w==-1?a=A[a].i:(v[A[a].i]=A[a].w,v[a]=A[a].n,m[A[a].i]=A[a].r)})();for(Q=0;Q<v.length;Q++)g=
v[Q],g!=P&&(f[g].x||j.push(g),g==T&&(j.length>0&&h.push(j),j=[]));j.length>0&&h.push(j);for(F=0;F<h.length-1;F++){J=function(a,c){var d;a!=c&&(d=a<c?a+"-"+c:c+"-"+a,typeof u[d]==="undefined"?u[d]={f:a,t:c,n:1}:u[d].n+=1)};j=h[F].concat(h[F+1]);for(Q=0;Q<j.length-1;Q++)for(H=Q+1;H<j.length;H++)J(j[Q],j[H])}for(Q=F=0;Q<f.length;Q++)F+=f[Q].n;for(Q=0;Q<f.length;Q++){for(H=J=0;H<f[Q].s.length;H++)J+=d(k(f[Q].s[H].w.toLowerCase(),!0));f[Q].s.length>0?J/=f[Q].s.length:J=1;f[Q].n/=F*J}var ka=[];a.each(u,
function(a,c){c.n*=f[c.f].n*f[c.t].n/(f[c.f].n+f[c.t].n);ka.push(c)});ka.sort(function(a,c){return c.n-a.n});for(Q=0;Q<f.length;Q++)f[Q].s.sort(function(a,c){var d=(K[a.si].length<120?600*Math.pow((120-K[a.si].length)/120,2):K[a.si].length-120)-(K[c.si].length<120?600*Math.pow((120-K[c.si].length)/120,2):K[c.si].length-120)+8*(a.wi-c.wi);return d==0?K[a.si].length-K[c.si].length:d});F=";$itemdescription;$itemnote;$relationdescription;;$itemdescription;$itemnote;\n";tc={};for(Q=0;Q<0.03*ka.length;Q++)J=
ka[Q].f,H=ka[Q].t,typeof tc[J]==="undefined"&&(tc[J]=0),typeof tc[H]==="undefined"&&(tc[H]=0),tc[J]>12||tc[H]>12||(tc[J]++,tc[H]++,f[H].n>f[J].n&&(ia=J,J=H,H=ia),F+=R(z(J))+";"+R(sa(J))+";"+R(N(J))+";"+R(oa(M(f[J].s,f[H].s)))+";"+R(z(H))+";"+R(sa(H))+";"+R(N(H))+";\n");pd(F,!0,!1,!1,!0,!0,!1,e,Tm)}var n=[],f=[],v=[],g,h=[],j=[],u={},m=[],q,w,za,o,K=[],r="",p=0,s=-1,x,B={},A={},C=[],E={},z=["e","n","t","em","en","er","es","et","st","te","eln","ern","est","nen"],I=["e","f","s","y","'s","fe","fs","es",
"ed","is","ve","ies","ves","ing","ten","ping","ning","ging"],y=["s","au","eau","aux","eaux","al","ail","eu","eux","ou","oux","e","er","es","ons","ez","ent","\u00e9","ais","ait","ions","iez","aient"],N=["s","es","z","ces","i\u00f3n","iones","\u00fas","uses","ar","o","as","a","amos","\u00e1is","an","er","e","emos","\u00e9is","en","ir","imos","is"],Y=["o","i","a","e","co","chi","go","ghi","ca","che","ga","ghe","io","iamo","ate","ano","ete","ono","ite","isco","isci","isce","iscono"],F=[],aa=[],J=["bzw",
"bspw","d.h","etc","evtl","geb","ggf","n.chr","usw","v.chr","vgl","z.b","dr","abb","abs","anm","bsp","bzgl","ca","gem","hrsg","i.a","i.d.r","i.v","inkl","insb","lit","max","min","mwst","mio","mrd","nr","p.a","pos","pp","rd","s.a","s.o","s.u","tab","tel","tsd","u.a","u.e","u.u","vs","z.t","zzgl","ziff"],sa=["mr","ms","mrs","etc","apt","ave","blvd","dr","ln","mt","st","jr","prof","sr","a.m","p.m","acct","addr","amt","attn","bros","ca","co","corr","dept","dir","e.g","ed","encl","esp","etc","excl","fig",
"foll","gen","hr","i.a","i.e","inc","incl","ltd","mill","mr","mrs","ms","no","off","nec","oz","poss","ret","s.o","sth","yd","vs"],H=["app","arr","att","ave","ch","cie","co","coup","dpt","mrs","p.f.v","s.p","sim","sol"],ia=["a.m","a.c","aprox","d","da","dr","dra","esq","etc","ing","h","p.ej","prof","profa","sr","sra","srta","tel","av","cta","d.c","dn","dep","dpto","ej","i.e","hno","izq","p.a","p.d","p.p","p.pa","s.a","s.l","sta","sto","ud","uds","v.b","vol"],P=["es","ecc","etc","dott","g","gg","ing",
"mons","ogg","prof","sig","sigg","soc","v","acc","br","graz","a.c","all","arch","avv","c.a","c.m","c.p","c.so","c.s","c.v","ecc","egr","fatt","int","n.b","egr","ogg","p.c","p.s","p.v","p.za","prof","prof.ssa","s.a.s","s.n.c","v.s"],oa=[],uc={},T=(U()?"":"js/")+"wf_"+d+".js",L="wf_"+d;d=="de"?(F=z,oa=J):d=="en"?(F=I,oa=sa):d=="fr"?(F=y,oa=H):d=="es"?(F=N,oa=ia):d=="it"&&(F=Y,oa=P);z=b.split(/[\s]+/);for(d=0;d<z.length;d++)b=z[d].toLowerCase(),b!=""&&F.push(b);for(d=0;d<F.length;d++){for(;aa.length<
F[d].length;)aa.push([]);aa[F[d].length-1].push(F[d])}F=t.split(/[\s]+/);for(d=0;d<F.length;d++)t=F[d].toLowerCase().replace(/[.]$/,""),t!=""&&oa.push(t);for(d=0;d<oa.length;d++)uc[oa[d]+"."]=1;typeof window[L]!=="undefined"?D():(oa=document.createElement("script"),oa.onload=function(){D()},oa.src=T,document.head.appendChild(oa))}function zx(){var c="",k="",l=H();if(l>=0&&(l=d.j.q[d.j.F[l]]))c=l.text,l.Q>=0&&typeof d.j.da[l.Q]!=="undefined"&&(k=d.j.da[l.Q].templateName);var b=i,t=i,e=i,l="<form>";
l+="<div>"+Um+'</div><div><input class="kbb-appointment-name" type="text" value="'+Nd(c)+'"></div>';l+="<div>"+Vm+'</div><div><input class="kbb-appointment-description" type="text"></div>';l+="<div>"+Wm+'</div><div class="kbb-appointment-category-container"></div>';l+="<div>"+Xm+'</div><div><input class="kbb-appointment-relation" type="text"></div>';l+="<div>"+Ym+'</div><div><input class="kbb-appointment-relation-description" type="text"></div>';l+="<div>"+Zm+'</div><div class="kbb-appointment-relation-category-container"></div>';
l+="<div>"+$m+'</div><div><input class="kbb-start-date" type="text"><select class="kbb-start-time"></select></div>';l+="<div>"+an+'</div><div><input class="kbb-end-date" type="text"><select class="kbb-end-time"></select></div>';l+='<input type="submit" class="kbb-invisible" />';l+="</form>";var f={};f[Da]=function(){var a=b.find(".kbb-appointment-name").val(),c=b.find(".kbb-appointment-description").val(),d=t.val(),k=b.find(".kbb-appointment-relation").val(),l=b.find(".kbb-appointment-relation-description").val(),
f=e.val(),D=b.find(".kbb-start-date").datepicker("getDate"),g=b.find(".kbb-start-time").val(),q=b.find(".kbb-end-date").datepicker("getDate"),w=b.find(".kbb-end-time").val();if(D==i&&q==i)b.find(".kbb-start-date").focus();else{var h=D?D:q,j=h.getFullYear(),m=h.getMonth(),o=h.getDate(),h=q?q:D,D=h.getFullYear(),q=h.getMonth(),h=h.getDate();b.dialog("close");Ax(j,m,o,g,D,q,h,w,a,c,d,k,l,f)}};f[eb]=function(){b.dialog("close")};b=a('<div class="kbb-insert-appointment-dialog" />').html(l).dialog({modal:!0,
closeOnEscape:!1,resizable:!1,buttons:f,title:bn,width:400,position:Mb?{my:"center top",at:"center top"}:{my:"center",at:"center"},open:function(){var c={changeMonth:!0,changeYear:!0},d=a(this).parent(".ui-dialog"),l=d.find(".kbb-start-date"),b=d.find(".kbb-end-date"),M=d.find(".kbb-start-time,.kbb-end-time"),f=d.find(".kbb-appointment-category-container"),d=d.find(".kbb-appointment-relation-category-container");l.datepicker(c);b.datepicker(c);M.append(a("<option>",{value:"",text:""}));for(c=0;c<
24;c++){var D=c.toString();D.length<2&&(D="0"+D);for(var g=0;g<60;g+=15){var q=g.toString();q.length<2&&(q="0"+q);q=D+":"+q;M.append(a("<option>",{value:q,text:q}))}}l.on("change",function(){b.datepicker("option","minDate",a(this).datepicker("getDate"))});b.on("change",function(){l.datepicker("option","maxDate",a(this).datepicker("getDate"))});t=tf(f,"kbb-appointment-category",0,"","",i);k!=""&&t.val(k);e=tf(d,"kbb-appointment-relation-category",1,"","",i);a(this).parent(".ui-dialog").find("*").myDisableSelection(!1)},
close:function(){a(this).dialog("destroy")}});b.find("form").bind("submit",function(){setTimeout(function(){f[Da]()},50);return!1})}function Ax(c,d,l,b,t,e,f,n,G,v,g,h,j,u){function m(c,d,k,l){var b=h;h!=""&&l!=""&&(b+=" ");b+=l;w=new Date(c,d,k,0,0,0,0);K=a.datepicker.formatDate("dd.mm.yy",w);o=a.datepicker.formatDate("DD",w);r=w.getDay()==0||w.getDay()==6;p+=R(G)+";"+R(v)+";;;;;;;;;;";r&&(p+=";;;;;");p+=R("T:"+b)+";"+R(j)+";1;"+R(u)+";"+R("<html>"+Nd(K)+"<br><small>"+Nd(o)+"</small><br></html>");
r||(p+=";;;;;");p+="\n"}var q=c==t&&d==e&&l==f,w,o,r,K,p="";a.datepicker.setDefaults(a.datepicker.regional[cn]);p+=R(g)+";$itemdescription;"+R(qd)+";$relationcategory;$relationvisibleuptolevel;"+R(qd)+";$relationcategory;$relationvisibleuptolevel;"+R(zg)+";$relationcategory;"+R(Ag)+";$relationname;$relationdescription;$relationvisibleuptolevel;$relationcategory;"+R(Bg)+";$relationname;$relationdescription;$relationvisibleuptolevel;$relationcategory;"+R(dn)+"\n";q?(g=b,b!=""&&n!=""&&(g+=" - "),g+=
n):(g=en,b!=""&&(g+=" "+b));m(c,d,l,g);q||(g=fn,n!=""&&(g+=" "+n),m(t,e,f,g));for(b=c;b<=t;b++){f=(b-1).toString();l=b.toString();p+=";;"+R(f)+";"+R(qd+"-"+qd)+";1;"+R(l)+";;;;;;;;;;;;;;;\n";for(f=0;f<12;f++)w=new Date(b,f,15,0,0,0,0),n=a.datepicker.formatDate("MM",w),p+=";;"+R(l)+";;;;"+R(qd+"-"+zg)+";1;"+R("<html>"+Nd(n)+"<br><small>"+Nd(l)+"</small><br></html>")+";;;;;;;;;;;;\n"}f=t.toString();l=(t+1).toString();p+=";;"+R(f)+";"+R(qd+"-"+qd)+";1;"+R(l)+";;;;;;;;;;;;;;;\n";for(w=new Date(c,d,1,
0,0,0,0);;){b=w.getFullYear();f=w.getMonth();if(b>t||b==t&&f>e)break;l=b.toString();n=a.datepicker.formatDate("MM",w);K=w.getDate().toString();K=a.datepicker.formatDate("dd.mm.yy",w);o=a.datepicker.formatDate("DD",w);r=w.getDay()==0||w.getDay()==6;p+=";;;;;;;;"+R("<html>"+Nd(n)+"<br><small>"+Nd(l)+"</small><br></html>")+";;;";r&&(p+=";;;;;");p+=";;1;"+R(zg+"-"+Bg)+";"+R("<html>"+Nd(K)+"<br><small>"+Nd(o)+"</small><br></html>");r||(p+=";;;;;");p+="\n";c=a.datepicker.iso8601Week(w);c=Ag+" "+c;p+=";;;;;;;;;;"+
R("<html>"+Nd(c)+"<br><small>"+Nd(l)+"</small><br></html>")+";";r&&(p+=";;;;;");p+=";;1;"+R(Ag+"-"+Bg)+";"+R("<html>"+Nd(K)+"<br><small>"+Nd(o)+"</small><br></html>");r||(p+=";;;;;");p+="\n";w.setDate(w.getDate()+1)}pd(p,!0,!1,!1,!0,!0,!0,-1,gn)}function ni(c){function d(){t=l.find(".kbb-create-table-of-contents").is(":checked");e=l.find(".kbb-hilight-items").is(":checked");f=l.find(".kbb-export-item-name").is(":checked");n=l.find(".kbb-export-item-description").is(":checked");G=l.find(".kbb-export-item-note").is(":checked");
v=l.find(".kbb-export-item-url").is(":checked");g=l.find(".kbb-export-item-name-formatted").is(":checked");h=l.find(".kbb-export-item-description-formatted").is(":checked");j=l.find(".kbb-export-item-note-formatted").is(":checked");u=l.find(".kbb-export-item-name-numbering").is(":checked")}var l=i,b=i,t=!0,e=!0,f=!0,n=!0,G=!0,v=!0,g=!0,h=!0,j=!0,u=!0,m="<form>";m+='<div><label><input class="kbb-create-table-of-contents" type="checkbox">'+hn+'</label>&nbsp;&nbsp;&nbsp;<label><input class="kbb-hilight-items" type="checkbox">'+
jn+"</label></div>";m+="<div><table><tr><td>";m+='<div><label><input class="kbb-export-item-name" type="checkbox" checked>'+kn+"</label></div>";m+='<div><label><input class="kbb-export-item-description" type="checkbox" checked>'+ci+"</label></div>";m+='<div><label><input class="kbb-export-item-note" type="checkbox">'+di+"</label></div>";m+='<div><label><input class="kbb-export-item-url" type="checkbox">'+ei+"</label></div>";m+="</td><td>";m+='<div><label><input class="kbb-export-item-name-formatted" type="checkbox" checked>'+
Cg+"</label></div>";m+='<div><label><input class="kbb-export-item-description-formatted" type="checkbox" checked>'+Cg+"</label></div>";m+='<div><label><input class="kbb-export-item-note-formatted" type="checkbox" checked>'+Cg+"</label></div>";m+='</td><td width="100%">';m+='<div><label><input class="kbb-export-item-name-numbering" type="checkbox" checked>'+ln+"</label></div>";m+="</td></tr></table></div>";m+='<div><button class="kbb-update-preview" type="button">'+fi+"</button></div>";m+='<div style="margin:0px"><iframe class="kbb-html-preview"></iframe></div>';
m+='<input type="submit" class="kbb-invisible" />';m+="</form>";var q={};q[gi]=function(){d();oi(t,e,f,n,G,v,g,h,j,u,function(d){if(c){var k=function(a){a!=0&&l.dialog("close")};window.savefilecallback=k;d={action:"savefile",base64data:we(d),extension:"html",mimetype:"text/html"};B(d,k)}else{if(typeof window.navigator!=="undefined"&&window.navigator.msSaveBlob)k=new Blob([d],{type:"text/html"}),window.navigator.msSaveBlob(k,"knowledgebase.html");else{var b=a('<a href="data:text/html;base64,'+we(d)+
'" download="knowledgebase.html">')[0];(function(){try{if(document.createEvent){var a=document.createEvent("MouseEvents");a.initEvent("click",!0,!0);b.dispatchEvent(a);return}}catch(c){}try{if(document.createEventObject){var d=document.createEventObject();b.fireEvent("onclick",d);return}}catch(k){}try{b.click&&b.click()}catch(l){}})()}l.dialog("close")}})};if(qb()||Bb())q[ii]=function(){d();oi(t,e,f,n,G,v,g,h,j,u,function(a){qb()?(window.sendTextData(a,"html"),l.dialog("close")):(a={action:"sendfile",
base64data:we(a),extension:"html",mimetype:"text/html"},B(a,function(){l.dialog("close")}))})};q[eb]=function(){l.dialog("close")};Ya(function(){l=a('<div class="kbb-export-text-document" />').html(m).dialog({modal:!0,closeOnEscape:!1,resizable:!1,buttons:q,title:mn,width:600,position:Mb?{my:"center top",at:"center top"}:{my:"center",at:"center"},open:function(){a(this).parent(".ui-dialog").find("*").not(".kbb-html-preview").myDisableSelection(!1)}})});l.find(".kbb-update-preview").button().bind("click",
function(){d();oi(t,e,f,n,G,v,g,h,j,u,function(c){Ya(function(){var d=b[0],d=d.contentDocument?d.contentDocument:d.contentWindow.document;d.open();d.write(c);d.close();d.body.contentEditable="true";a(d.body).css({margin:"0px",padding:"8px",width:"calc(100% - 16px)",height:"calc(100% - 16px)",overflow:"auto","-ms-overflow-style":"scrollbar","user-select":"text","-o-user-select":"text","-moz-user-select":"text","-khtml-user-select":"text","-webkit-user-select":"text","-ms-user-select":"text"})})});
return!1});b=l.find(".kbb-html-preview");l.find("form").bind("submit",function(){setTimeout(function(){q[Da]()},50);return!1})}function oi(c,k,l,b,t,e,f,n,g,v,h){function j(c,d,k,l,b){function t(c){var d=document.styleSheets,k={},l;for(l in d)if(typeof d[l].href!=="undefined"&&d[l].href&&d[l].href.toLowerCase().indexOf("jqmath")>=0){var b=d[l].rules||d[l].cssRules,M;for(M in b)c.is(b[M].selectorText)&&(k=a.extend(k,e(b[M].style),e(c.attr("style"))))}return k}function e(a){var c={};if(!a)return c;
if(a instanceof CSSStyleDeclaration)for(var d=0;d<a.length;d++){var k=a[d];c[k]=a[k]}else if(typeof a=="string")for(d in a=a.split("; "),a)k=a[d].split(": "),c[k[0].toLowerCase()]=k[1];return c}return Ya(function(){d||c.toLowerCase().indexOf("<html>")==0?k?S.text(c.replace(/[\r\n\t]/g,"").replace(/(<br[ \/]*>)/gi,"\n").replace(/<\/li>/gi,"\n").replace(/<\/li>/gi,"\n").replace(/<\/table>/gi,"\n").replace(/<\/td>/gi,"\t").replace(/<\/tr>/gi,"\n").replace(/<\/p>/gi,"\n").replace(/<\/div>/gi,"\n").replace(/<\/h[0-9]+>/gi,
"\n").replace(/(<([^>]+)>)/g,"").replace(/(&nbsp;)/gi," ").replace(/(&lt;)/gi,"<").replace(/(&gt;)/gi,">").replace(/(&quot;)/gi,'"').replace(/(&amp;)/gi,"&")):S.html(c):S.text(c);b&&nb(S,b,!1,!1);if(k)return l+S.html();else{var e=function(c){if(c.nodeType===3)return c.nodeValue=l+c.nodeValue,!0;else{var d=!1;a(c).contents().each(function(){if(d=e(this))return!1});return d}};S.find("*").each(function(){this.style.removeProperty("font-family");this.style.removeProperty("font-size")});S.find("font").contents().unwrap();
S.find("h1,h2,h3,h4,h5,h6").each(function(){a(this).replaceWith('<div class="innerheader">'+a(this).html()+"</div")});l!=""&&(e(S[0])||S.prepend(l));Za(S,!1);S.find("fmath,math").each(function(){var c=t(a(this));a(this).css(c);S.find("*").each(function(){var c=t(a(this));a(this).css(c)});a(this).removeAttr("class");a(this).find("*").removeAttr("class")});return S.html()}})}var S=a("<div></div>");kf(ba);var u=JSON.stringify(a.map(wb,function(a,c){return parseInt(c)})),u={action:"map",id:P,search:"",
maxitems:d.la,maxlevel:d.ha,maxchildslevel1:d.Aa,maxchildslevel2:d.Ba,maxchildslevel3:d.Ca,maxchildslevel4:d.Da,crosslinks:0,tablerelations:0,hierarchical:d.Kd()?1:0,bookmarks:0,expanded:1,displaymode:Fa,imagecache:u,excludeitemids:Wa.cb("excludeitems"),excludeitemtemplateids:Wa.cb("excludeitemtemplates"),excluderelationids:Wa.cb("excluderelations"),excluderelationtemplateids:Wa.cb("excluderelationtemplates"),textnoterecordid:-1,updatetextnote:0,database:O};kf(ba);B(u,function(a){function q(){function d(k,
t,h,Pa){if(typeof u[k]==="undefined"){u[k]=1;q=Math.max(q,t);if(c||l)t>0&&(h=h+(h!=""?".":"")+(Pa+1)),c&&(Pa=j(a.i[k].n,!1,!0,v&&t>0?h+": ":"",i),Pa!=""&&(S+='<div class="toc_level_'+t+'">',l&&(S+='<a href="#'+k+'">'),S+=Pa,l&&(S+="</a>"),S+="</div>\r\n")),l&&(Pa=j(a.i[k].n,!1,!f,v&&t>0?h+": ":"",o),Pa!=""&&(m+='<div class="title_level_'+t+'" id="'+k+'">',m+=Pa,m+="</div>\r\n"));b&&(Pa=j(a.i[k].dt,!1,!n,"",o),Pa!=""&&(m+='<div class="description_level_'+t+'">',m+=Pa,m+="</div>\r\n"));typeof a.i[k].textNoteHtml!==
"undefined"&&a.i[k].textNoteHtml!=""&&(Pa=j(a.i[k].textNoteHtml,!0,!g,"",o),Pa!=""&&(m+='<div class="textnote_level_'+t+'">',m+=Pa,m+="</div>\r\n"));if(e)Pa=a.i[k].u,Pa.length>3&&Pa.substring(Pa.length-3)=="\u00a7if"&&(Pa=Pa.substring(0,Pa.length-3)),Pa!=""&&(m+='<div class="url_level_'+t+'">',m+='<a href="'+Pa+'" target="_blank">'+Pa+"</a>",m+="</div>\r\n");if(typeof w[k]!=="undefined")for(Pa=Pa=0;Pa<w[k].length;Pa++)d(w[k][Pa],t+1,h,Pa)}}for(var t=0,q=0,w={},u={},S="",m="",o=k?rd():i,t=0;t<a.i.length;t++)a.i[t].p>=
0&&(typeof w[a.i[t].p]==="undefined"&&(w[a.i[t].p]=[]),w[a.i[t].p].push(t));if(a.i.length>0){d(0,0,"",0);t="<!DOCTYPE html>\r\n<html>\r\n<head>\r\n";t+='<meta charset="utf-8" />\r\n';t+="<title>"+j(a.i[0].n,!1,!0,"",i)+"</title>\r\n";t+="<style>\r\n";t+="body {font-family:Arial,Helvetica,Sans-Serif; font-size:14px; line-height:1.5em;}\r\n";t+="body table {border-collapse:collapse;}\r\n";t+="body td {vertical-align:top; padding:0px;}\r\n";t+=".innerheader {font-weight:bold;}\r\n";for(var za=0,p=["1.3em",
"1.1em","1.0em"],r=["1.4em","1.3em","1.2em"],s=["1.2em","1.1em","1em"],y=["1.1em","1.0em"],x=["1.0em","0.9em"],B=["0 0 0.5em 0","1.5em 0 0.5em 0"],A=["0.5em 0 0.5em 0"],C=["0.5em 0 0.5em 0"],z=["0.5em 0 0.5em 0"],E,I,F,N,oa,uc,J,H,Y,za=0;za<=q;za++)E=p[Math.min(za,p.length-1)],I=r[Math.min(za,r.length-1)],F=s[Math.min(za,s.length-1)],N=y[Math.min(za,y.length-1)],oa=x[Math.min(za,x.length-1)],uc=B[Math.min(za,B.length-1)],J=A[Math.min(za,A.length-1)],H=C[Math.min(za,C.length-1)],Y=z[Math.min(za,z.length-
1)],t+=".toc_level_"+za+"{font-size:"+E+"; margin:"+(za>0?"0.35em":"0")+" 0 0 "+Math.max(0,za-1)*0.5+"em; "+(za<2?"font-weight:bold; ":"")+"overflow:hidden;}\r\n",t+=".title_level_"+za+"{font-size:"+I+"; font-weight:bold; margin:"+uc+"; overflow:hidden;}\r\n",t+=".description_level_"+za+"{font-size:"+F+"; margin:"+J+"; overflow:hidden;}\r\n",t+=".textnote_level_"+za+"{font-size:"+N+"; margin:"+H+"; overflow:hidden;}\r\n",t+=".url_level_"+za+"{font-size:"+oa+"; margin:"+Y+"; font-style:italic; overflow:hidden;}\r\n";
t+=".toc {margin:0 0 2.5em 0;}\r\n";t+=".toc a:link {color:black; text-decoration:none;}\r\n";t+=".toc a:visited {color:black; text-decoration:none;}\r\n";t+=".toc a:active {color:black; text-decoration:none;}\r\n";t+=".toc a:hover {color:black; text-decoration:underline;}\r\n";t+="</style>\r\n";t+="</head>\r\n<body>\r\n";m=t+(S!=""?'<div class="toc">'+S+"</div>":"")+m;m+="</body>\r\n</html>"}lf();h(m)}function w(){u<a.i.length?a.i[u].a>=0?d.fc(a.i[u].i,function(c){a.i[u].textNoteHtml=c;u++;w()}):
(u++,w()):q()}var u=0;a&&a.n==0?t?w():q():(lf(),h(""))});lf()}function kb(){return JSON.stringify({ri:P})}function Dg(){if(d.B==Ia){var c=[];C.find(".textlayer .kbb-tableviewcolumn").each(function(){c.push(a(this).data("pid"))});return c}else return P}function $d(c){var d=-1;typeof c!=="undefined"&&(a.isArray(c)?bb=c.slice():d=c<0?P:c);bb&&bb.length>0&&(d=bb.shift());return d}function Bx(){var a=-1;Ic&&Ic.length>0&&(a=Ic.shift());return a}function Qb(){C.find(".kbb-sidegallery:not(.id-sidebar-closed-horizontal,.id-sidebar-closed-vertical):visible").each(function(c,
d){a(d).sidegallery("closeifnotpinned")})}function Ce(c){B({action:"getitemsincategory",id:c,maxresults:1E3,database:O},function(c){if(c.n==0){var l="";if(c.i.length==0)l='<div class="kbb-gallery-status">'+nn+"</div>";else{c.i.forEach(function(c){c.n=a.trim(jd(a.trim(c.n)))});var b=function(a){var c=a.split(".");c.length==3?(c[0].length!=4&&(c=c.reverse()),a=c.join("/")):(c=a.split("-"),c.length==3&&(c[2].length==4&&(c=c.reverse()),a=c.join("/")));return Date.parse(a)};c.i.sort(function(a,c){if(a.n!=
""&&c.n!=""){var d=!isNaN(a.n),k=!isNaN(c.n);if(d&&k)return parseFloat(a.n)-parseFloat(c.n);var l=d?NaN:b(a.n),e=k?NaN:b(c.n),f=!isNaN(l),g=!isNaN(e);if(f&&g)return l-e;if(d&&g)return-1;else if(f&&k)return 1;else if(d||f)return-1;else if(k||g)return 1}return a.n.localeCompare(c.n)});c.i.forEach(function(a){l+='<div class="kbb-gallery-item kbb-gallery-item-enabled" data-itemid="'+a.i+'">'+(a.n.trim()==""?"&nbsp;":Nd(a.n))+"</div>"})}Ya(function(){hc.html(l)});c=hc.find(".kbb-gallery-item");c.bindMouseOrTouchEvent("mouseenter",
function(){a(this).addClass("kbb-gallery-item-hover")});c.bindMouseOrTouchEvent("mouseleave",function(){a(this).removeClass("kbb-gallery-item-hover")});c.bind("click",function(){if(!$b){var c=a(this).data("itemid");d.Ia?jg(c,!0,function(){Ce(Eb.data("pid"))}):(sd=!0,d.load(c,-1,"",Xb,!0,!1,xe+1),U()&&Oc({action:"onitemselected",i:c,r:-1,search:"",setasroot:1,redraw:1}));return!1}});d.H&&De(c);hc.height()>=hc.parent().height()?hc.addClass("scrollable"):hc.removeClass("scrollable")}})}function pi(){Eb&&
hc&&(Eb.val("").data("pid",-1).data("fid",-2).data("fn",""),Eb.parent().find(".kbb-selectcategoryhint").show(),hc.empty())}function Pm(){Db=!1;hb&&hb.sidegallery("settextbtnselected",!1)}function uf(c,k){if(!(c&&nf.length==0||!c&&of.length==0)){kf(ba);var l={action:"undoredo",undo:c?1:0,steps:k,undoproperties:kb(),database:O};B(l,function(c){var g;g=(c=c&&c.length>0?a.parseJSON(c):i)&&typeof c.ri!=="undefined"?c.ri:P,c=g;P=-1;d.G=-1;d.za=-1;d.B=-1;d.Za=-1;d.ga=-1;d.Ka=-1;d.Wa=-1;d.Ja=-1;d.T=-1;d.la=
-1;d.ha=-1;d.Aa=-1;d.Ba=-1;d.Ca=-1;d.Da=-1;d.Fa=0;d.ca=-1;Eg=!0;Rb=i;wb={};Ic=bb=i;d.load(c,-1,"",Xb,!0,!0,xe+1);Db&&d.kb(c,!0);lf()})}}function td(a){function k(a,c,d){var k=0;if(c.length>0){a.gallerysection("clear");for(k=0;k<c.length;k++)a.gallerysection("addgalleryitem",(d?"id-undo-item-":"id-redo-item-")+k,c[k],"tooltip",d?90:92,d?91:93,!0,-1,!0,!1,function(a){uf(d,a.data("steps"))}).data("steps",k+1);a.gallerysection("setenabled",!0)}else a.gallerysection("setenabled",!1)}k(on,nf,!0);k(pn,of,
!1);if(a){var l=-1,e=i,t=i,f=i,D=!1,n=ue(ic),g=!1,v=ue(jc);a.aa>=0&&typeof a.ja[a.aa]!=="undefined"&&(e=a.R[a.ja[a.aa]],t=a.q[e.ra],f=a.q[e.Va],g=d.B<=Fa);if(a.W>=0)l=a.W,D=!0;else if(t)l=t.I;qn.galleryitem("setenabled",D);rn.galleryitem("setenabled",D);sn.galleryitem("setenabled",D);tn.galleryitem("setenabled",D);un.galleryitem("setenabled",D&&Vd);vn.galleryitem("setenabled",D);wn.galleryitem("setenabled",D&&n);xn.galleryitem("setenabled",n);yn.galleryitem("setenabled",n);zn.galleryitem("setenabled",
D&&n);An.galleryitem("setenabled",g);Bn.galleryitem("setenabled",g);Cn.galleryitem("setenabled",g);Dn.galleryitem("setenabled",g&&v);En.galleryitem("setenabled",v);Fn.galleryitem("setenabled",v);Gn.galleryitem("setenabled",g&&v);D?qi.show():qi.hide();g?Fg.show():Fg.hide();Hn(a);if(l>=0&&typeof a.F[l]!=="undefined"){l=a.q[a.F[l]];D=l.pa("ici");ri.colorpickergalleryitem("setcurrentcolor",D[0],!D[1]);si.galleryitem("setselected",D[1]);si.galleryitem("setenabled",!D[1]);D=l.Rb("ici");ti.colorpickergalleryitem("setcurrentcolor",
D[0],!D[1]);ui.galleryitem("setselected",D[1]);ui.galleryitem("setenabled",!D[1]);D=l.Pb();for(n=0;n<Sa.length;n++)if(Sa[n]==D){vi.comboboxgalleryitem("setselected","id-font-name-"+n);break}D=l.sa();Vc.comboboxgalleryitem("setselected",D<0.75?"id-ultra-small-font-size":D<0.85?"id-very-small-font-size":D<0.95?"id-small-font-size":D<1.1?"id-medium-font-size":D<1.4?"id-large-font-size":D<2?"id-very-large-font-size":"id-ultra-large-font-size");D="id-shape-default";switch(l.Dc()){case "circle":D="id-shape-circle";
break;case "rect":D="id-shape-rect";break;case "rhomb":D="id-shape-rhomb";break;case "hexagon":D="id-shape-hexagon";break;case "triangle":D="id-shape-triangle";break;case "para":D="id-shape-para";break;case "trapez":D="id-shape-trapez"}Jc.comboboxgalleryitem("setselected",D);D=l.ec();D>=0?wi.show().galleryitem("setselected",D>0):wi.hide();In.iconpickergalleryitem("setselectedicons",l.df());l.$a?Gg.show():Gg.hide()}else Gg.hide();if(e){l=e.ub>=0?a.Qa[e.ub]:i;a=e.vb>=0?a.Qa[e.vb]:i;D=e.pa(kc!=0?f:t,
kc!=0?a:l,"icd");xi.colorpickergalleryitem("setcurrentcolor",D[0],!D[1]);yi.galleryitem("setselected",D[1]);yi.galleryitem("setenabled",!D[1]);t=e.Rb(kc!=0?f:t,kc!=0?a:l,"icd");zi.colorpickergalleryitem("setcurrentcolor",t[0],!t[1]);Ai.galleryitem("setselected",t[1]);Ai.galleryitem("setenabled",!t[1]);t="id-solid-line";t=e.ke()==0?"id-solid-line":"id-dotted-line";Hg.comboboxgalleryitem("setselected",t);t=e.cf();f="id-medium-line";ae.comboboxgalleryitem("setselected",t<0.333?"id-very-thin-line":t<
0.75?"id-thin-line":t<1.5?"id-medium-line":t<3?"id-thick-line":"id-very-thick-line");t="id-arrows-end";switch(e.Gd()){case 0:t="id-arrows-none";break;case 1:t="id-arrows-start";break;case 2:t="id-arrows-end";break;case 3:t="id-arrows-start-end"}Ee.comboboxgalleryitem("setselected",t);t="id-level-all";switch(e.Hg){case 1:t="id-level-1";break;case 2:t="id-level-2"}vf.comboboxgalleryitem("setselected",t);D=e.Hd();for(n=0;n<Sa.length;n++)if(Sa[n]==D){Bi.comboboxgalleryitem("setselected","id-font-name-"+
n);break}D=e.Id();Wc.comboboxgalleryitem("setselected",D<0.75?"id-ultra-small-font-size":D<0.85?"id-very-small-font-size":D<0.95?"id-small-font-size":D<1.1?"id-medium-font-size":D<1.4?"id-large-font-size":D<2?"id-very-large-font-size":"id-ultra-large-font-size")}if(d.B==La){e="id-mindmap3d-radial";switch(d.za){case 1:e="id-tree3d-vertical-levelwise";break;case 2:e="id-tree3d-vertical-levelwise-both-sides";break;case 3:e="id-tree3d-vertical-relation-direction";break;case 4:e="id-spherical3d"}lc.comboboxgalleryitem("setselected",
e)}else{e="id-mindmap-compact-curved";switch(d.G){case 1:e="id-mindmap-circular-straight";break;case 2:e="id-flowchart-topbottom";break;case 3:e="id-flowchart-leftright";break;case 4:e="id-hierarchical";break;case 5:e="id-network-grouped";break;case 6:e="id-relations-grouped";break;case 7:e="id-mindmap-circular-curved";break;case 8:e="id-mindmap-compact-straight";break;case 9:e="id-hierarchical-grouped";break;case 10:e="id-hierarchical-relations-grouped";break;case 11:e="id-one-column-grouped";break;
case 12:e="id-one-column-relations-grouped";break;case 13:e="id-two-columns-grouped";break;case 14:e="id-two-columns-relations-grouped";break;case 15:e="id-concept-map-radial";break;case 16:e="id-concept-map-hierarchical"}fb.comboboxgalleryitem("setselected",e)}e="id-to-viewer";switch(d.Ja){case 1:e="id-static";break;case 2:e="id-radial"}ud.comboboxgalleryitem("setselected",e);e="id-same-height";switch(d.Za){case 1:e="id-childcount-wise";break;case 2:e="id-levelwise"}be.comboboxgalleryitem("setselected",
e);e="id-parent-wise";if(typeof z.col!=="undefined"&&z.col!==i)switch(z.col){case 0:e="id-item-wise";break;case 1:e="id-level-wise";break;case 3:e="id-category-wise"}Fe.comboboxgalleryitem("setselected",e);e="RdYlBu";typeof z.ics!=="undefined"&&z.ics!==i&&(e=z.ics);Ci.comboboxgalleryitem("setselected",e);e=0;typeof z.ico!=="undefined"&&z.ico!==i&&(e=z.ico);Jn.slidergalleryitem("setvalue",e+1);Kn.galleryitem("setselected",kc!=0);e=1;typeof z.ia!=="undefined"&&z.ia!==i&&(e=z.ia);Ln.slidergalleryitem("setvalue",
e*100);e=typeof z.bc==="undefined"||z.bc===i;Di.colorpickergalleryitem("setcurrentcolor",Sb,!e);Ei.galleryitem("setselected",e);Ei.galleryitem("setenabled",!e);e="id-perspective";e=typeof z.bp==="undefined"||z.bp===i?"id-automatic":"id-"+Ge;vd.comboboxgalleryitem("setselected",e);f="id-medium-line";f=wc<0.333?"id-very-thin-line":wc<0.75?"id-thin-line":wc<1.5?"id-medium-line":wc<2.5?"id-thick-line":"id-very-thick-line";ce.comboboxgalleryitem("setselected",f);Fi.galleryitem("setselected",d.na>0);wf.galleryitem("setselected",
d.ga!=0);Ig.galleryitem("setselected",d.Ka>0);Mn.galleryitem("setselected",d.Wa>0);xf.galleryitem("setselected",d.T>0);Nn.galleryitem("setselected",Jg!=0);On.galleryitem("setselected",Ae!=0);Pn.galleryitem("setselected",yf!=0);de.toolbarbtn("setselected",d.B<=Fa);ee.toolbarbtn("setselected",d.B==La);fe.toolbarbtn("setselected",d.B==Ia)}Gi.galleryitem("setselected",d.ma||d.xa||d.ta||d.va||d.ua||d.Oa);Hi.galleryitem("setselected",d.ma);Ii.galleryitem("setselected",d.xa);Ji.galleryitem("setselected",
d.ta);Ki.galleryitem("setselected",d.va);Li.galleryitem("setselected",d.ua);He.galleryitem("setselected",d.Oa);Qn.val(d.la<1?100:d.la);Rn.val(d.ha<1?100:d.ha);Sn.val(d.Aa<1?100:d.Aa);Tn.val(d.Ba<1?100:d.Ba);Un.val(d.Ca<1?100:d.Ca);Vn.val(d.Da<1?100:d.Da);b.updatesidegallerycallback&&b.updatesidegallerycallback()}function Kg(a,k,l,b,e){var f="",D="",n="",g="",v=-1,h="";a>=0&&a!=l&&(l>=0||b.length>0)&&te(jc,function(j){function m(){kf(ba);var j={action:"newrelation",idfrom:a,sequencefrom:k,idto:l,nameto:b,
relationname:f,relationbackrelname:D,relationdescription:n,relationproperties:g,relationtemplateid:v,relationtemplatename:h,undotext:Wn,undoproperties:kb(),database:O};B(j,function(k){var l=k.r,k=k.i;if(l>=0){var b=typeof d.j.F[a]==="undefined"?i:d.j.q[d.j.F[a]],b=d.Ka==0||b==i||b.U>=d.ha||d.fa==i||d.fa.i.length>=d.la-5;if(d.j)d.j.W=e?k:-1,d.j.aa=e?-1:l;d.load(b?a:P,k,"",Xb,!0,!1,xe+1);U()&&(b&&Oc({action:"onitemselected",i:a,r:l,search:"",setasroot:1,redraw:0}),Oc({action:"onrelationmodified",r:l}),
Oc({action:"onrelationselected",i:a,r:l,redraw:0}))}lf()})}Wf&&(j=i);j?(f=j.Name,D=j.BackName,n=j.Description,g=j.Properties,v=j.CategoryID,v>=0?B({action:"getrelationtemplate",id:v,database:O},function(a){a.r!=0?h=a.tn:v=-1;m()}):m()):m()});Mg()}function Cx(c){var k=Ya(function(){return a('<div class="selectrelateditemctrl"></div>').appendTo(c).html('<form action="" method="get" autocomplete="off"><table><tr><td><input class="ui-autocomplete-input selectrelateditemhint" type="text" value="'+Nd(Xn)+
'"><input class="ui-autocomplete-input selectrelateditem" type="text" maxlength="50"></td><td><div class="selectrelateditembtn"></div></td></tr></table></form>')}),l=k.find("form"),e=k.find(".selectrelateditemhint"),t=k.find(".selectrelateditem"),k=k.find(".selectrelateditembtn"),f=[];t.bind("keydown.autocomplete",function(c){c=c.which?c.which:c.keyCode;if(c==13)return l.submit(),!1;else if(c==27&&!a(this).autocomplete("widget").is(":visible"))return Mg(),!1;else c!=16&&c!=17&&c!=18&&e.hide()}).autocomplete({source:function(c,
d){function k(c,l){c.n==0&&(l==t.val()&&(f=a.map(c.h,function(a){return{label:'<span data-itemid="'+a.i+'">'+a.n+"</span>",value:a.v,itemID:a.i}})),d(f))}I({action:"search",search:c.term,maxsearchresults:50,database:O},function(a,c){k(a,c)})},minLength:0,delay:150,position:{my:"left top",at:"left bottom",collision:"none"},messages:{noResults:"",results:ha("")},select:function(c,d){if(d.item){var k=C.find(".newrelationbar");Kg(k.data("pid"),k.data("sn"),d.item.itemID,"",!1)}a(this).blur();return!1},
focus:function(c,k){if(k.item){var l=a('.ui-menu-item span[data-itemid="'+k.item.itemID+'"]').parent().parent();window.lastTooltipItemID=k.item.itemID;window.lastTooltipRelationID=-1;l.C({alignment:{body:"left",pointer:"right"},url:b.baseurl+nc+b.scriptextension,action:"tooltip",diagram:d,openAttachments:Sc,openDocument:md,rootItemID:P,id:k.item.itemID,idfrom:-1,idto:-1,vOffset:14-l.height()/2,searchEngines:Wd,fadeIn:d.T!=0,onOpenCallback:function(c){if(typeof c!=="undefined"){var c=[jd(c.n)],c=ze(c),
d=a(a.fn.C.obj).find(".tttext");nb(d,c,!0,!1)}},database:O})}},open:function(){var c=a(this).autocomplete("widget");c.css({height:"auto","z-index":"10501"});var d=a(this).offset().top-a(window).scrollTop(),k=a(this).height(),l=c.height(),b=a(window).height();k+d+l>b&&c.css("height",Math.max(Math.min(100,l),b-k-d-20)+"px")}}).blur(function(){a(this).val()==""&&e.show()}).mousemove(function(){a.fn.C.close()});e.focus(function(){t.focus()});var D=!1;k.bindMouseOrTouchEvent("mousedown",function(){D=t.autocomplete("widget").is(":visible")}).bindMouseOrTouchEvent("click",
function(){t.focus();if(D)return t.autocomplete("close"),!1;t.autocomplete("search","");return!1});l.submit(function(){var a=t.val();if(a!=""){var c=C.find(".newrelationbar");Kg(c.data("pid"),c.data("sn"),-1,a,!1)}t.blur();return!1})}function Dx(c,d){var l='<div class="kbb-selectitemctrl id-edit-item-select-item"><table><tr><td>';l+='<input class="ui-autocomplete-input kbb-selectitem" type="text" maxlength="500">';l+='</td><td><div class="kbb-selectitembtn"></div></td></tr></table></div>';var b=Ya(function(){return a(l).appendTo(c)}),
e=b.find(".kbb-selectitemhint"),f=b.find(".kbb-selectitem"),b=b.find(".kbb-selectitembtn"),D=[],n=!1;f.bind("keydown.autocomplete",function(a){a=a.which?a.which:a.keyCode;if(a==13){if(d)if(f.autocomplete("widget").is(":visible")){if(f.data("fid")>-2)return f.data("pid",f.data("fid")),f.val(f.data("fn")),d&&d(f.data("fid")),f.blur(),!1}else if(f.val()=="")return f.autocomplete("search",""),!1}else a!=16&&a!=17&&a!=18&&e.hide()}).autocomplete({source:function(c,d){function k(c,l){if(c.n==0){if(l==""||
l==f.val())f.data("pid",-1).data("fid",-2).data("fn",""),D=a.map(c.h,function(a){var c=a.v;c.toLowerCase()===l.toLowerCase()&&f.data("pid",a.i);return{label:a.n,value:c,itemID:a.i}}),D.length>0&&f.data("fid",D[0].itemID).data("fn",D[0].value);d(D)}}I({action:"search",search:c.term,maxsearchresults:50,database:O},function(a,c){k(a,c)})},minLength:0,delay:150,position:{my:"left top",at:"left-9px bottom+5px",collision:"none"},messages:{noResults:"",results:ha("")},select:function(c,l){l.item&&(a(this).data("pid",
l.item.itemID),d&&(d(l.item.itemID),n=!0,a(this).blur(),setTimeout(function(){n=!1},1500)));e.hide()},focus:function(c,d){d.item&&a(this).data("fid",d.item.itemID).data("fn",d.item.value)},open:function(){var c=a(this).autocomplete("widget");c.css({height:"auto","z-index":"11003"});var d=a(this).offset().top-a(window).scrollTop(),k=a(this).height(),l=c.height(),b=a(window).height();k+d+l>b&&c.css("height",Math.max(Math.min(100,l),b-k-d-20)+"px")}}).focus(function(){n&&a(this).blur()});var g=!1;b.bindMouseOrTouchEvent("mousedown",
function(){g=f.autocomplete("widget").is(":visible")}).bindMouseOrTouchEvent("click",function(){f.focus();if(g)return f.autocomplete("close"),!1;f.autocomplete("search","");return!1});return f}function Ex(c,k){function l(){Kc(i);var c=a(this).closest(".kbb-search-result-item").data("pid");c!=P&&d.load(c,-1,"",Xb,!0,!1,xe+1);return!1}function b(c){function d(c,k,l){function b(a){var c=a.replace(/[0-9(\[{\u00ab\u201e)\]}\u00bb\"\'\u201c\u2018\u2019\u201c\u201d]*$/,""),a=a.replace(/^[(\[{\u00ab\u00bb\"\'\u201e\u201c\u2018\u2019\u201c\u201d]*/,
"").replace(/[0-9(\[{\u00ab\u201e)\]}\u00bb\"\'\u201c\u2018\u2019\u201c\u201d!?;]*$/,"");return c.length>0&&".!?;".indexOf(c[c.length-1])>=0&&(c.match(/^[0-9]*[.]$/)==i||c.match(/^[0-9]*[.]$/)[0].length>3)&&typeof s[a.toLowerCase()]==="undefined"}for(var e=[],t,n=[],f="",c=kd(c)+" ",M=0;M<c.length;M++)if(/\S/.test(c[M]))e.push(c[M]);else if(e.length>0){t="\r\n".indexOf(c[M])>=0;e=e.join("");f!=""&&(f+=" ");f+=e;if(b(e)||t)n.push(f),f="";e=[]}f!=""&&n.push(f);k=="f"?n.length>0&&l.push(n[0]):a.each(n,
function(c,d){var b=d.toLowerCase(),e=!0;a.each(x,function(a,c){if(Yn(c,b)<0)return e=!1});e&&l.push({s:d,t:k})})}var k=[];d(c.n,"n",k);d(c.t,"t",k);a.each(c.a,function(a,c){d(c.c,"a",k)});if(k.length>0){var l=[];d(c.n,"f",l);z.push({n:l.length>0?l[0]:"",s:k,i:c.i})}}function e(){var c=a(this).closest(".kbb-search-result-item"),d=c.find(".kbb-less");c.find(".kbb-additional-sentences").slideDown(250,"smoothEasing");a(this).hide();d.show()}function f(){var c=a(this).closest(".kbb-search-result-item"),
d=c.find(".kbb-more");c.find(".kbb-additional-sentences").slideUp(250,"smoothEasing");a(this).hide();d.show()}function D(){var c,d;a.each(z,function(b,n){if(Pb)return!1;c='<div class="kbb-search-result-item" data-pid="'+n.i+'"><div class="kbb-search-result-title">';c+="\u2022&nbsp;&nbsp;<b>";c+=Nd(n.n);c+='</b></div><div class="kbb-sentences">';a.each(n.s,function(a,d){a==1&&(c+='<div class="kbb-additional-sentences">');c+='<div class="kbb-sentence">';c+=Nd(d.s);n.s.length>1&&(a==0&&(c+='<span class="kbb-more">'+
Zn+"</span>"),a==n.s.length-1&&(c+='<span class="kbb-less">'+$n+"</span>"));c+="</div>"});n.s.length>1&&(c+="</div>",q.toolbarbtn("setenabled",!0));c+="</div></div>";d=Ya(function(){return a(c)});nb(d.find(".kbb-sentences"),x,!1,!1);d.find(".kbb-search-result-title").click(l);d.find(".kbb-more").click(e);d.find(".kbb-less").click(f);Ya(function(){d.appendTo(k)})});z=[]}function n(){if(Ub)Pb=!0;else if(!h(200)){o.toolbarbtn("seticonindex",80,80);o.toolbarbtn("settooltip",ao);Ub=!0;q.toolbarbtn("setenabled",
!1);q.toolbarbtn("seticonindex",154,154);q.toolbarbtn("settooltip",Ng);za=!1;var a=u.val().trim();Ie.add(a);x=a.toLowerCase().split(/[\s]+/);Pb=!1;z=[];k.empty();E=0;v(-1);u.blur()}}function g(){o.toolbarbtn("seticonindex",59,59);o.toolbarbtn("settooltip",Mi);tb.sidegallery("setheadertext",Ni);Ub=!1;if(d.gc&&!d.Db&&!Qa.is(":visible")&&(xc>=0||na.text().length>0)){var a=rd();nb(na,a,!1,!1);xb()}d.B==Ia&&(a=rd(),nb(C.find(".textlayer .kbb-tableviewcellbody"),a,!0,!0))}function v(c){Pb?g():(tb.sidegallery("setheadertext",
bo.replace("%1",E+1).replace("%2",E+p)),B({action:"searchdata",startitemid:c,itemcount:p,searchterms:x,database:O},function(c){Pb?g():(a.each(c.i,function(a,c){if(Pb)return!1;b(c)}),D(),Pb?g():c.n==1&&c.li>0?(v(c.li-1),E+=p):g())}))}function h(a){var c=!1;try{var d=window.getSelection();if(d){var k=d.toString();k&&(k=k.trim(),k.length>0&&k.length<a&&(d.removeAllRanges(),Je(k),c=!0))}}catch(l){}return c}Ie==i&&(Ie=new A(""));for(var j=Ya(function(){return a('<div class="kbb-searchitemsctrl"><form action="" method="get" autocomplete="off"><table><tr><td><input type="text" maxlength="500"></td><td><div class="kbb-startstopsearchitemsbtn"></div></td><td><div class="kbb-expandcollapsesearchitemsbtn"></div></td><td><div class="kbb-previoussearchbtn"></div></td><td><div class="kbb-nextsearchbtn"></div></td></tr></table></form></div>').appendTo(c)}),
m=j.find("form"),u=j.find("input"),o=j.find(".kbb-startstopsearchitemsbtn"),q=j.find(".kbb-expandcollapsesearchitemsbtn"),w=j.find(".kbb-previoussearchbtn"),j=j.find(".kbb-nextsearchbtn"),za=!1,p=100,r=["mr","ms","mrs","etc"],s={},x=[],z=[],E=0,I=0;I<r.length;I++)s[r[I]+"."]=1;Je=function(a){function c(){Ub?(Pb=!0,setTimeout(function(){c()},50)):setTimeout(function(){n()},50)}a&&u.val(a);c()};o.toolbarbtn({iconindex:59,iconhilightindex:59,tooltip:Mi,scrollable:!0,onClick:function(){n();return!1}});
q.toolbarbtn({iconindex:154,iconhilightindex:154,tooltip:Ng,enabled:!1,scrollable:!0,onClick:function(){var a=k.find(".kbb-more"),c=k.find(".kbb-less"),d=k.find(".kbb-additional-sentences");za?(q.toolbarbtn("seticonindex",154,154),q.toolbarbtn("settooltip",Ng),za=!1,d.slideUp(250,"smoothEasing"),c.hide(),a.show()):(q.toolbarbtn("seticonindex",156,156),q.toolbarbtn("settooltip",co),za=!0,d.slideDown(250,"smoothEasing"),a.hide(),c.show());return!1}});w.toolbarbtn({iconindex:4,iconhilightindex:4,tooltip:eo,
scrollable:!0,onClick:function(){var a=Ie.kg();a!=""&&Je(a)}});j.toolbarbtn({iconindex:6,iconhilightindex:6,tooltip:fo,scrollable:!0,onClick:function(){var a=Ie.jg();a!=""&&Je(a)}});m.bind("submit",function(){Je(i);return!1});k.bind("mouseup.kmEvents",function(a){if(a.which&&a.which==1||a.button&&a.button==0)return!h(75)});return u}function tf(c,d,l,b,e,f){var D='<div class="kbb-selectcategoryctrl '+d+'"><table><tr><td>';b!=""&&(D+='<div><input class="ui-autocomplete-input kbb-selectcategoryhint" type="text" value="'+
Nd(b)+'">');D+='<input class="ui-autocomplete-input kbb-selectcategory" type="text" maxlength="500">';b!=""&&(D+="</div>");D+='</td><td><div class="kbb-selectcategorybtn"></div></td></tr></table></div>';var d=Ya(function(){return a(D).appendTo(c)}),n=d.find(".kbb-selectcategoryhint"),g=d.find(".kbb-selectcategory"),d=d.find(".kbb-selectcategorybtn"),v=[],h=!1;(f||b!="")&&g.bind("keydown.autocomplete",function(a){a=a.which?a.which:a.keyCode;if(a==13){if(f)if(g.autocomplete("widget").is(":visible")){if(g.data("fid")>
-2)return g.data("pid",g.data("fid")),g.val(g.data("fn")),f&&f(g.data("fid")),g.blur(),!1}else if(g.val()=="")return g.autocomplete("search",""),!1}else a!=16&&a!=17&&a!=18&&n.hide()});g.autocomplete({source:function(c,d){function k(c,l){if(c.n==0){if(l==""||l==g.val())g.data("pid",-1).data("fid",-2).data("fn",""),v=a.map(c.h,function(a){var c=a.v;c.toLowerCase()===l.toLowerCase()&&g.data("pid",a.i);return{label:a.n,value:c,templateID:a.i}}),e!=""&&l==""&&v.unshift({label:e,value:e,templateID:-1}),
v.length>0&&g.data("fid",v[0].templateID).data("fn",v[0].value);d(v)}}I({action:"searchtemplate",search:c.term,maxsearchresults:50,templatetype:l,database:O},function(a,c){k(a,c)})},minLength:0,delay:150,position:{my:"left top",at:"left-9px bottom+5px",collision:"none"},messages:{noResults:"",results:ha("")},select:function(c,d){d.item&&(a(this).data("pid",d.item.templateID),f&&(f(d.item.templateID),h=!0,a(this).blur(),setTimeout(function(){h=!1},1500)));n.hide()},focus:function(c,d){d.item&&a(this).data("fid",
d.item.templateID).data("fn",d.item.value)},open:function(){var c=a(this).autocomplete("widget");c.css({height:"auto","z-index":"11003"});var d=a(this).offset().top-a(window).scrollTop(),k=a(this).height(),l=c.height(),b=a(window).height();k+d+l>b&&c.css("height",Math.max(Math.min(100,l),b-k-d-20)+"px")}}).focus(function(){h&&a(this).blur()});b!=""&&(g.blur(function(){a(this).val()==""&&n.show()}),n.focus(function(){g.focus()}));var j=!1;d.bindMouseOrTouchEvent("mousedown",function(){j=g.autocomplete("widget").is(":visible")}).bindMouseOrTouchEvent("click",
function(){g.focus();if(j)return g.autocomplete("close"),!1;g.autocomplete("search","");return!1});return g}function go(c){var k=U()||qb()||Bb()||Cb();c?(wd=a(Yf("html","body")),wd.length>0&&(ho=wd.scrollLeft(),io=wd.scrollTop(),wd.animate({scrollLeft:0,scrollTop:0},0)),a("html, body").addClass("noscroll-fullscreen"),k||(a('<div id="body_placeholder"></div>').prepend(a("body > *").not(".ui-autocomplete, .ttip")).appendTo(a("body")).hide(),a('<div id="kmap_placeholder"></div>').insertAfter(C),a("body").prepend(C)),
C.find(".kmappage").removeClass("restoredscreenkmappage").addClass("fullscreenpage"),C.removeClass("restoredscreenpages").addClass("fullscreenpage")):(k||(C.insertAfter(a("#kmap_placeholder")),a("#kmap_placeholder").remove(),a("body").prepend(a("#body_placeholder > *")),a("#body_placeholder").remove()),C.find(".kmappage").addClass("restoredscreenkmappage").removeClass("fullscreenpage"),C.addClass("restoredscreenpages").removeClass("fullscreenpage"),a("html, body").removeClass("noscroll-fullscreen"),
wd&&wd.length>0&&wd.animate({scrollLeft:ho,scrollTop:io},0));if(P>=0&&d&&d.j&&d.j.q&&typeof d.j.F[P]!=="undefined"){var l=C.find(".kmappage").width(),c=C.find(".kmappage").height(),k=d.j.q[d.j.F[P]],l=Math.min(Math.max(0,d.j.width-l),Math.max(0,k.O-l/2)),c=Math.min(Math.max(0,d.j.height-c),Math.max(0,k.N-c/2));Zf(C.find(".kmappage"),l,c)}gb(0,P,!0,!1,!1);jo()}function ko(){function a(c){if(c.map)c.map.dispose(),c.map=ea;c.dispose()}function d(l){if(l!==i){for(var b=0;b<l.children.length;b++)d(l.children[b]);
if(l.geometry)l.geometry.dispose(),l.geometry=ea;if(l.material)if(l.material instanceof Array)for(b=0;b<l.material.length;b++)a(l.material[b]),l.material[b]=ea;else a(l.material),l.material=ea}}zf&&zf(!1);Af&&(cancelAnimationFrame(Af),Af=i);Jb&&(d(Jb),Jb=i);if($a)$a.dispose(),$a.context=ea,$a.domElement=ea,$a=i;pb&&(pb=i);Na&&(Na.dispose(),Na=i)}function Bf(a){var k=C.find(".diagramcontainer"),l=Fa;k.hasClass("kbb-tableview")?l=Ia:k.hasClass("kbb-rendering-3d")&&(l=La);d.B=a;if(a!=l){d.B==La?(Fb&&
Fb.hide(),Gb&&Gb.hide(),ge.show(),typeof navigator.xr!=="undefined"&&he.show()):(Fb&&Fb.show(),Gb&&Gb.show(),ge.hide(),he.hide());ie.hide();je.hide();ke.hide();var b=C.find(".textlayer"),e=b.find(".kbb-tableviewcolumn"),f=b.find(".itemtext");d.B==Ia?(k.addClass("kbb-tableview"),C.find(".newfirstitembtn").hide(),C.find(".itemselector").appendTo(b),C.find(".kbb-selector").hide(),f.remove(),Fg.hide(),be.hide(),wf.hide(),Ig.hide(),ud.hide(),xf.hide(),Hb&&Hb.show(),Pi.hide(),Qi.hide(),Ri.hide(),fb.hide(),
lc.hide(),He.hide(),b.unbind("click.kmTableView").bind("click.kmTableView",function(){Qb();Lc()})):d.B==La?(b=C.find(".textlayer"),f=b.find(".itemtext"),k.addClass("kbb-rendering-3d"),C.find(".newfirstitembtn").hide(),C.find(".itemselector").appendTo(b),C.find(".kbb-selector").hide(),f.remove(),wf.hide(),ud.show(),xf.hide(),Hb&&Hb.hide(),fb.hide(),lc.show(),l<=Fa&&lc.comboboxgalleryitem("setexpanded",fb.comboboxgalleryitem("isexpanded"),0),He.hide(),C.find(".canvas6").unbindMouseOrTouchEvent("click.kmRendering3D").bindMouseOrTouchEvent("click.kmRendering3D",
function(){Qb();Lc()})):(wf.show(),ud.hide(),xf.show(),Hb&&Hb.show(),lc.hide(),fb.show(),l==La&&fb.comboboxgalleryitem("setexpanded",lc.comboboxgalleryitem("isexpanded"),0),He.show());l==Ia?(k.removeClass("kbb-tableview"),e.remove(),be.show(),Ig.show(),Pi.show(),Qi.show(),Ri.show(),b.unbind("click.kmTableView")):l==La&&(ko(),C.find(".canvas6").unbindMouseOrTouchEvent("click.kmRendering3D"),k.removeClass("kbb-rendering-3d"));d.L=i;d.fa=i;d.j=i;a<0&&(a=Fa);Ke[l]=d.D;Le[l]=d.M;lo[l]=d.ma;mo[l]=d.xa;
no[l]=d.ta;oo[l]=d.va;po[l]=d.ua;d.D=Ke[a];d.M=Le[a];d.ma=lo[a];d.xa=mo[a];d.ta=no[a];d.va=oo[a];d.ua=po[a];xd(d.D,d.M,d.rotation,d.$)}}function Lc(){var c=C.find(".itemtoolbar");c.is(":visible")&&(C.find(".textlayer .kbb-tableviewcell-hover").removeClass("kbb-tableviewcell-hover"),c.hide());a.fn.C.close()}function qo(c,k){na.attr("spellcheck","false");if(c){if(Qa.is(":visible")){var l=gc(i);Ya(function(){na.html(l)});Me.show();Qa.hide()}else(!k||!d.gc)&&nb(na,[],!1,!1);if(k&&(Za(na,!1),d.gc)){var e=
rd();nb(na,e,!d.lb&&!d.nb&&!d.mb,!d.lb&&!d.nb&&!d.mb)}Qa.is(":visible")||xb();na.removeAttr("contenteditable")}else lb(na),nb(na,[],!1,!1),na.attr("contenteditable","true"),b.webpageimport&&na.find("a").unbind("click.kmEvents"),a(Kb).unbind("selectionchange.kmEvents").bind("selectionchange.kmEvents",function(){le&&le()}),le&&le()}function me(a,k){qo(!a,!k);d.Db=a;d.sb=k;Ne.toolbarbtn("setselected",a);a?(Ne.show(),Pg.hide(),Cf.show(),Si.show(),Qg.hide(),Rg.hide()):(k?(Ne.hide(),Pg.hide(),Qg.show(),
Rg.show()):(Ne.show(),Pg.show(),Qg.hide(),Rg.hide()),Cf.hide(),Si.hide());hb.sidegallery("adjustlayout")}function xd(a,k,l,b){ro.slidergalleryitem("setvalue",a>=1?(1+a)*100/2:(3*a-1)*100/(2*a));d.B==Ia?Sg.slidergalleryitem("settext",so):Sg.slidergalleryitem("settext",Ti);Sg.slidergalleryitem("setvalue",k>=1?(1+k)*100/2:(3*k-1)*100/(2*k));d.B<=Fa?(Tg.show(),Tg.slidergalleryitem("setvalue",l),Ug.show(),Ug.slidergalleryitem("setvalue",b)):(Tg.hide(),Ug.hide())}function Fx(c){var k=Ya(function(){return a('<div class="searchbar"></div>').appendTo(c).html('<div><form action="" method="get" autocomplete="off"><table><tr><td><input class="ui-autocomplete-input searchhint" type="text" value="'+
Nd(to)+'"><input class="ui-autocomplete-input search" type="text" maxlength="50"></td><td><div class="searchbtn"></div></td></tr></table></form></div>')}),l=k.find("form"),e=k.find(".searchhint"),t=k.find(".search"),k=k.find(".searchbtn").toolbaricon({index:59,hilightindex:59,width:27,height:27,border:!1}),f=[],D=!1;t.bind("keydown.autocomplete",function(c){c=c.which?c.which:c.keyCode;if(c==13)return l.submit(),a(this).autocomplete("close").autocomplete("search",""),!1;else c!=16&&c!=17&&c!=18&&e.hide()}).autocomplete({source:function(c,
d){function k(c,l){c.n==0&&(l==t.val()&&(f=a.map(c.h,function(a){return{label:'<span data-itemid="'+a.i+'">'+a.n+"</span>",value:a.v,itemID:a.i}})),d(f))}I({action:"search",search:c.term,maxsearchresults:50,database:O},function(a,c){k(a,c)})},minLength:1,delay:150,position:{my:"left top",at:"left bottom",collision:"none"},messages:{noResults:"",results:ha("")},select:function(c,k){k.item&&(sd=!0,d.load(k.item.itemID,-1,"",Xb,!0,!1,xe+1),U()&&Oc({action:"onitemselected",i:k.item.itemID,r:-1,search:"",
setasroot:1,redraw:1}));D=!0;a(this).blur();setTimeout(function(){D=!1},1500);return!1},focus:function(c,k){if(k.item){var l=a('.ui-menu-item span[data-itemid="'+k.item.itemID+'"]').parent().parent();window.lastTooltipItemID=k.item.itemID;window.lastTooltipRelationID=-1;l.C({alignment:{body:"left",pointer:"right"},url:b.baseurl+nc+b.scriptextension,action:"tooltip",diagram:d,openAttachments:Sc,openDocument:md,rootItemID:P,id:k.item.itemID,idfrom:-1,idto:-1,vOffset:14-l.height()/2,searchEngines:Wd,
fadeIn:d.T!=0,onOpenCallback:function(c){if(typeof c!=="undefined"){var c=[jd(c.n)],c=ze(c),d=a(a.fn.C.obj).find(".tttext");nb(d,c,!0,!1)}},database:O})}},open:function(){var c=a(this).autocomplete("widget");c.css({height:"auto","z-index":"10501"});var d=a(this).offset().top-a(window).scrollTop(),k=a(this).height(),l=c.height(),b=a(window).height();k+d+l>b&&c.css("height",Math.max(Math.min(100,l),b-k-d-20)+"px")}}).focus(function(){Qb();D&&a(this).blur()}).blur(function(){a(this).val()==""&&e.show()}).mousemove(function(){a.fn.C.close()});
e.focus(function(){t.focus()});k.bindMouseOrTouchEvent("click",function(){var a=t.val().trim();a!=""&&tb.sidegallery("show",!0,d.T==0?0:500,function(){Je(a)});t.autocomplete("close").autocomplete("search","")});l.submit(function(){var a=t.val();a!=""&&(sd=!0,d.load(P,-1,a,Xb,!0,!1,xe+1),U()&&Oc({action:"onitemselected",i:-1,r:-1,search:a,setasroot:1,redraw:1}));t.blur();return!1})}function Ta(a,k,l,b,e,f){k==i?typeof z[a]!=="undefined"&&delete z[a]:z[a]=k;kf(ba);a={action:"setdiagramproperty",name:"dp",
value:JSON.stringify(z),undotext:f,undoproperties:kb(),database:O};B(a,function(){d.load(P,-1,"",l,b,e,xe+1);lf()})}function Ui(c){function k(){Oe(c);c||(C.find(".kbb-sidegalleryremainder>.kbb-sidegallery").not(".id-search-items-gallery, .id-items-in-category-gallery, .id-textnote-gallery, .id-viewmode-gallery, id-diagramnavigation-gallery").each(function(){a(this).sidegallery("close",d.T==0?0:500)}),d.j.Ga(-1,-1,!0,!1,!0));Hb&&Hb.galleryitem("setselected",c)}a.fn.C.close();Qb();Fb.toolbarbtn("setselected",
c);Gb.toolbarbtn("setselected",!c);c?k():Xc(k)}function Vi(c){a.fn.C.close();var k=C.find(".kmappage"),l="scale("+c/d.D+")",k=k.scrollLeft()+(d.B==Ia?0:k.width()/2)+"px "+(k.scrollTop()+(d.B==Ia?0:k.height()/2))+"px";C.find(".ikmap>.canvas5,.ikmap>.textlayer").css({"-ms-transform":l,"-moz-transform":l,"-webkit-transform":l,transform:l,"-ms-transform-origin":k,"-moz-transform-origin":k,"-webkit-transform-origin":k,"transform-origin":k});l=C.find(".ikmap>.canvas1").position();C.find(".ikmap>.canvas5").css({left:l.left*
c/d.D+"px",top:l.top*c/d.D+"px"})}function Wi(a){d.B==Ia&&(bb=Dg(),bb.length>0&&(P=bb[bb.length-1]));Bf(a);if(a==Ia){P>=0&&bb&&bb.length>0&&bb[bb.length-1]!=P&&bb.push(P);var k=$d();k>=0&&(P=k)}b.editmode?Ta("tv",a,0,!0,!0,Xi):d.load(P,-1,"",0,!0,!0,xe+1);a==Ia&&Db&&d.kb(P,!1)}function Gx(){function c(c,d,k){if(c&&(Df(1E3),d)){var c=$f(Mc),l=i,b={};b[Da]=function(){l.dialog("close")};l=a("<div />").html(uo.replace("%1",Mc.ee+Mc.If).replace("%2",Mc.ee).replace("%3",c.ac)).dialog({modal:!0,closeOnEscape:!1,
resizable:!1,buttons:b,title:vo,width:400,position:Mb?{my:"center top",at:"center top"}:{my:"center",at:"center"},open:function(){a(this).parent(".ui-dialog").find("*").myDisableSelection(!1)},close:function(){a(this).dialog("destroy")}})}k&&(l=i,b={},b[Da]=function(){l.dialog("close")},l=a("<div />").html(wo).dialog({modal:!0,closeOnEscape:!1,resizable:!1,buttons:b,title:xo,width:400,position:Mb?{my:"center top",at:"center top"}:{my:"center",at:"center"},open:function(){a(this).parent(".ui-dialog").find("*").myDisableSelection(!1)},
close:function(){a(this).dialog("destroy")}}));d&&(Mc=i)}function k(){var k=ag(Mc,!0,!0);if(k==i)c(!1,!1,!0);else{bg(ba);a("#docframe").remove();Ya(function(){a('<div id="docframe"></div>').appendTo(a("body")).html('<div id="doccontainer"><div id="docheader"><table><tr><td style="width:100%;vertical-align:middle;"><table class="kbb-learn-header"><tr><td></td><td></td></tr></table></td><td><div id="closebtn"></div></td></tr></table></div><div id="doccontent" style="overflow:auto;background-color:#0D2648;"></div></div>')});
var l=a("#closebtn");l.toolbaricon({index:80,hilightindex:81,width:19,height:19,color:"#FFF",border:!0,hover:i});l.bindMouseOrTouchEvent("click",function(){c(!0,!1,!1)});zb=a(Yf("html","body"));zb.length>0&&(Wg=zb.scrollLeft(),Xg=zb.scrollTop(),zb.animate({scrollLeft:0,scrollTop:0},0));a("html, body").addClass("noscroll-attachments");var l=a(window).width(),b=a(window).height();a("body").width(l).height(b);a("#docframe").show();a("#doccontainer").width(l).height(b);a("#doccontent").width(a("#doccontainer").width()).height(Math.max(0,
a("#doccontainer").height()-a("#docheader").height()));a("#doccontainer").css({top:"0px",left:l+"px"}).animate({left:0},d.T==0?0:1E3,"smoothEasing",function(){a(".ikmap,.kbb-sidegallery,.quickaccesstoolbar").addClass("invisible");a("#doccontainer").css({left:"0px",right:"0px",top:"0px",bottom:"0px",width:"",height:""});cg()});dg(Mc,k,!1)}}function l(){var l=JSON.stringify(a.map(wb,function(a,c){return parseInt(c)})),l={action:"map",id:P,search:"",maxitems:d.la,maxlevel:d.ha,maxchildslevel1:d.Aa,maxchildslevel2:d.Ba,
maxchildslevel3:d.Ca,maxchildslevel4:d.Da,crosslinks:d.Ka,tablerelations:d.Wa,hierarchical:d.Kd()?1:0,bookmarks:0,expanded:1,displaymode:Fa,imagecache:l,excludeitemids:Wa.cb("excludeitems"),excludeitemtemplateids:Wa.cb("excludeitemtemplates"),excluderelationids:Wa.cb("excluderelations"),excluderelationtemplateids:Wa.cb("excluderelationtemplates"),textnoterecordid:xc,updatetextnote:0,database:O};U()||kf(ba);B(l,function(l){var e=b.editmode?Uc:i;U()||lf();if(!b.editmode&&!U()&&!qb()&&!Bb()&&!Cb()){var t=
{ip:{}};try{if(Pe.length>0&&typeof window.localStorage!=="undefined"){var f=window.localStorage.getItem("db_"+Pe+"_learnsession");if(f){var M=JSON.parse(f);if(M&&typeof M.ip!=="undefined"){t=M;for(f=0;f<l.i.length;f++)l.i[f].o=typeof t.ip[l.i[f].i]!=="undefined"?t.ip[l.i[f].i]:""}}}}catch(g){}e=function(a,c,d,k,l,b,e){t.ip[a]=e;try{if(Pe.length>0&&typeof window.localStorage!=="undefined"){var f=JSON.stringify(t);window.localStorage.setItem("db_"+Pe+"_learnsession",f)}}catch(n){}}}var h=!1,j=!1,Va=
"a",q=new eg(Qe,Re,h,j,Va,wb,$i,aj,bj,cj,dj,ej,fj,nb,e,d.fc,c);q.init(l,wb);if(ag(q,!0,!0)==i)c(!1,!1,!0);else{var w=i,f=$f(q),h=f.ac>1,m="<form>";m+="<div autofocus></div>";m+="<div><label>"+yo+'<input class="kbb-unit-size" type="text" value="'+Qe+'">'+zo+"</label></div>";m+="<div><label>"+Ao+'<input class="kbb-possible-answer-count" type="text" value="'+Re+'">'+Bo+"</label></div>";f.ac>1&&(m+="<div>"+Co.replace("%1",f.ac-1)+"</div>");m+='<div><label><input class="kbb-force-learning" type="checkbox"'+
(h?" checked":"")+">"+Do+"</label></div>";m+='<div><label><input class="kbb-browse-mode" type="checkbox"'+(j?" checked":"")+">"+Eo+"</label></div>";m+='<div><select class="kbb-filter-mode">';m+='<option value="a"'+(Va=="a"?" selected":"")+">"+Fo+"</option>";m+='<option value="n"'+(Va=="n"?" selected":"")+">"+Go+"</option>";m+='<option value="w"'+(Va=="w"?" selected":"")+">"+Ho+"</option>";m+="</select></div>";m+="<div>"+Io.replace("%1",f.lf)+"</div>";m+="<div>"+Jo.replace("%1",f.uf)+"</div>";m+="<div>"+
Ko.replace("%1",f.tf)+"</div>";m+="<div>"+Lo.replace("%1",f.$d)+"</div>";m+='<input type="submit" class="kbb-invisible" />';m+="</form>";var o={};o[Da]=function(){var a=w.find(".kbb-unit-size").val(),b=w.find(".kbb-possible-answer-count").val();h=w.find(".kbb-force-learning").is(":checked");j=w.find(".kbb-browse-mode").is(":checked");Va=w.find(".kbb-filter-mode").val();isNaN(a)||(Qe=Math.max(1,Math.min(999,parseInt(a))));isNaN(b)||(Re=Math.max(2,Math.min(100,parseInt(b))));typeof window.localStorage!==
"undefined"&&(window.localStorage.setItem("memorizeitemsunitsize",Qe),window.localStorage.setItem("memorizeitemspossibleanswercount",Re));w.dialog("close");q=new eg(Qe,Re,h,j,Va,wb,$i,aj,bj,cj,dj,ej,fj,nb,e,d.fc,c);q.init(l,wb);Mc=q;k()};o[eb]=function(){w.dialog("close")};w=Ya(function(){return a('<div class="kbb-memorize-items-dialog" />').html(m).dialog({modal:!0,closeOnEscape:!1,resizable:!1,buttons:o,title:Mo,width:550,position:Mb?{my:"center top",at:"center top"}:{my:"center",at:"center"},open:function(){a(this).parent(".ui-dialog").find("*").myDisableSelection(!1)},
close:function(){a(this).dialog("destroy")}})});w.find("form").bind("submit",function(){setTimeout(function(){o[Da]()},50);return!1})}},function(){U()||lf()})}d.j.Hc(i,i,!1);a.fn.C.close();if(Mc){var e=i,t={};t[yd]=function(){e.dialog("close");k()};t[zd]=function(){e.dialog("close");l()};e=a("<div />").html(No).dialog({modal:!0,closeOnEscape:!1,resizable:!1,buttons:t,title:Oo,width:400,position:Mb?{my:"center top",at:"center top"}:{my:"center",at:"center"},close:function(){a(this).dialog("destroy")},
open:function(){a(this).parent(".ui-dialog").find("*").myDisableSelection(!1)}})}else l()}function Oe(a){var k=C.find(".itemselector");d.H=a;d.H?(De(k),k.addClass("kbb-show-icon"),Po(Yb),Yb.selector("showicon",Yb.data("pid")!=P||d.G==2||d.G==3),Po(bc),bc.selector("showicon",bc.data("pid")!=P||d.G==2||d.G==3),De(yc),yc.selector("showicon",!0),De(zc),zc.selector("showicon",!0),De(C.find(".id-items-in-category-gallery .kbb-gallery-item")),Se&&Se.show()):(Ff(k),k.removeClass("kbb-show-icon"),gj(Yb),Yb.selector("showicon",
!1),gj(bc),bc.selector("showicon",!1),Ff(yc),yc.selector("showicon",!1),Ff(zc),zc.selector("showicon",!1),Ff(C.find(".id-items-in-category-gallery .kbb-gallery-item")),Se&&Se.hide());Hn(d.j);qo(!d.H||!d.Db,!0);hb.sidegallery("showtoolbar",d.H)}function Hn(a){a&&d.H&&d.B<=Fa?(a.W>=0?kg(a.W,a)?Gf.show():Gf.hide():Gf.hide(),kg(-1,a)?Zg.show():Zg.hide()):(Gf.hide(),Zg.hide())}function Po(a){gj(a);a.bindMouseOrTouchEvent("mousedown.dragItem",Hx)}function gj(a){a.unbindMouseOrTouchEvent("mousedown.dragItem")}
function Hx(c){if(Xa)return Hf(i),!1;var k=a(this).data("pid");return k>=0&&(k!=P||d.G==2||d.G==3)?(Xa={x:fg(c),y:lg(c),i:k},Wb=!1,a(document).unbindMouseOrTouchEvent("mousemove.dragItem").bindMouseOrTouchEvent("mousemove.dragItem",Ix),a(document).unbindMouseOrTouchEvent("mouseup.dragItem").bindMouseOrTouchEvent("mouseup.dragItem",Hf),!1):!0}function Ix(c){if(Xa){var k=vb(c)?15:15,l=fg(c),c=lg(c);if(!Wb&&Math.pow(Math.pow(l-Xa.x,2)+Math.pow(c-Xa.y,2),0.5)<k)return!1;C.find(".itemselector").is(":visible")&&
a.fn.C.close();if(!Wb)k=d.j.q[d.j.F[Xa.i]],k.Ud(Te,1E3),If.selector("show",k.A.Ib,k.A.Jb,k.A.qb,k.A.ab,d.D),Yb.selector("showicon",!1),bc.selector("showicon",!1),Xa.dp1=Te.position(),Xa.dp2=If.position(),Xa.off=C.find(".ikmap").offset();var k=C.find(".ikmap").offset(),l=l-Xa.x-k.left+Xa.off.left,c=c-Xa.y-k.top+Xa.off.top,k=Xa.dp1.left+l,b=Xa.dp1.top+c;Te.css({left:k+"px",top:b+"px"});k=Xa.dp2.left+l;b=Xa.dp2.top+c;If.css({left:k+"px",top:b+"px"});hj(k,b,150,2E3,4);Wb=!0}return!1}function Hf(c){if(d.H&&
Xa&&Wb&&c){var k=fg(c),c=lg(c),l=C.find(".ikmap").offset(),b=k-Xa.x-l.left+Xa.off.left,e=c-Xa.y-l.top+Xa.off.top;b/=d.D;e/=d.Xa*d.D;k=d.rotation;c=d.ne();if(k>45&&k<135||k>225&&k<315)d.Md()?(c=!0,k-=270):d.ne()&&(c=!1,k+=270);c&&(c=b,b=e,e=c,k=-k);var c=-k*2*Math.PI/360,k=Math.sin(c),c=Math.cos(c),l=c*b-k*e,e=k*b+c*e,b=l,f=Ua[d.G],g=Xa.i;if(b!=0||e!=0)kf(ba),B({action:"getnextundopos",database:O},function(a){if(a>=0){var c=0,k,l=!1,h=function(){var j=0,u=0,m=b,q=e,w,o;if(c<d.j.q.length){k=d.j.q[c];
c++;if(k.Ta>=0){if(w=d.j.q[d.j.F[k.Ta]])j=k.A.sx-w.A.sx,u=k.A.sy-w.A.sy}else if(d.hf()){h();return}if(k.I==g){if(k.properties&&k.properties[f]&&(o=k.properties[f],w=d.yb()?o:o[k.Ta.toString()+(d.jc()?":"+k.U.toString():"")]))m+=w.x,q+=w.y,j=w.ox,u=w.oy}else if(q=m=0,d.yb()||k.properties&&k.properties[f]){h();return}w={x:m,y:q,ox:j,oy:u};d.yb()?o=w:(o=k.properties&&k.properties[f]?k.properties[f]:{},o[k.Ta.toString()+(d.jc()?":"+k.U.toString():"")]=w);ij(k.I,f,o,jj,function(){l=!0;h()})}else l?B({action:"combineundoactionsupto",
undostepid:a,description:jj,database:O},function(){d.load(P,g,"",Xb,!1,!0,xe+1);lf()}):lf()};h()}else lf()})}Te.hide();If.hide();Yb.selector("showicon",d.H&&(Yb.data("pid")!=P||d.G==2||d.G==3));bc.selector("showicon",d.H&&(bc.data("pid")!=P||d.G==2||d.G==3));a(document).unbindMouseOrTouchEvent("mousemove.dragItem");a(document).unbindMouseOrTouchEvent("mouseup.dragItem");Xa=i;setTimeout(function(){Wb=!1},250);return!1}function De(a){Ff(a);a.bindMouseOrTouchEvent("mousedown.dragRelation",Jx)}function Ff(a){a.unbindMouseOrTouchEvent("mousedown.dragRelation")}
function Jx(c){if(ga)return ld(i),!1;var d=!1;ga={x:fg(c),y:lg(c),galleryitem:i};$b=!1;if(a(this).is(".id-drag-to-endpoint"))ga.i=a(this).parents(".newrelationbar").data("pid"),ga.a="newrelation";else if(a(this).is(".itemselector"))ga.i=a(this).find("a").data("pid"),ga.a="newrelation";else if(a(this).is(".kbb-gallery-item"))ga.i=a(this).data("itemid"),ga.a="newrelation",ga.galleryitem=a(this),d=!0;else if(a(this).is(".id-item-selector, .id-item-hover"))ga.i=a(this).data("pid"),ga.a="newrelation";
else if(a(this).is(".id-relation-from-selector, .id-relation-to-selector"))ga.i=a(this).data("pid"),ga.from=a(this).data("pfrom"),ga.to=a(this).data("pto"),ga.a=a(this).is(".id-relation-from-selector")?"movefrom":"moveto",ga.pos=a(this).position();a(document).unbindMouseOrTouchEvent("mousemove.dragRelation").bindMouseOrTouchEvent("mousemove.dragRelation",Kx);a(document).unbindMouseOrTouchEvent("mouseup.dragRelation").bindMouseOrTouchEvent("mouseup.dragRelation",ld);return d}function hj(a,d,l,b,e){var f=
C.find(".kmappage"),g=f.scrollLeft(),n=f.scrollTop(),G=f.width(),v=f.height(),h=0,j=0;f.stop();f.css("overflow-x")=="scroll"&&(a-g<l&&(h=-(l-(a-g))*e),a-g>G-l&&(h=(a-g-(G-l))*e));f.css("overflow-y")=="scroll"&&(d-n<l&&(j=-(l-(d-n))*e),d-n>v-l&&(j=(d-n-(v-l))*e));(h!=0||j!=0)&&f.animate({scrollLeft:g+h,scrollTop:n+j},b,"smoothEasing")}function Kx(c){if(ga&&ga.i>=0){var k=ga.galleryitem!=i,l=fg(c),b=lg(c);if(Math.pow(Math.pow(l-ga.x,2)+Math.pow(b-ga.y,2),0.5)<(vb(c)?15:15))return k;C.find(".itemselector").is(":visible")&&
a.fn.C.close();var e=C.find(".canvas9")[0],f=0,g=0,g=oe([a(e)]),f=g.l,g=g.t;if(e.getContext){var n=a(e).width(),G=a(e).height(),e=e.getContext("2d"),v=C.find(".ikmap").offset(),h=l-v.left,j=b-v.top,m=-1,u=!1,o=i;ga.a=="movefrom"?(m=ga.to,o=yc,u=!0):ga.a=="moveto"?(m=ga.from,o=zc):m=ga.i;var q=0,w=0,p=i,r=0;if(k){ga.galleryitem.addClass("kbb-gallery-item-dragging");p=ga.galleryitem.closest(".id-items-in-category-gallery");r=p.offset().left+p.outerWidth();if(l<=r)return e.clearRect(0,0,n,G),!0;q=r-
v.left-10;w=ga.galleryitem.offset().top+ga.galleryitem.outerHeight()/2-v.top}else w=d.j.q[d.j.F[m]],q=w.O,w=w.N;var m=h,s=j,x=i;k||(p=C.find(".id-items-in-category-gallery"),p.is(":visible")&&(p.find(".kbb-gallery-item-dragging").removeClass("kbb-gallery-item-dragging"),x=p.find(".kbb-gallery").gallery("hitgalleryitem",c),r=p.offset().left+p.outerWidth()));if(x)x.addClass("kbb-gallery-item-dragging"),m=r-v.left,s=x.offset().top+x.outerHeight()/2-v.top;else if((c=d.j.Qb(c))&&c.eb>=0)s=d.j.q[c.eb],
m=s.O,s=s.N;o&&(c=m-o.outerWidth()/2,k=s-o.outerHeight()/2,o.css({left:c+"px",top:k+"px"}));u&&(u=q,q=m,m=u,u=w,w=s,s=u);e.save();e.clearRect(0,0,n,G);e.setTransform(1,0,0,1,-f,-g);f=mg(Sb,[255,255,255],[0,0,0]);e.fillStyle=gf(f,0.75);e.strokeStyle=gf(f,0.75);d.j.ud(e,{x:q,y:w},{x:m,y:s},5*d.D,5*d.D,0,!1,!0);e.restore();a(document.elementFromPoint(l,b)).closest(".id-items-in-category-gallery").length>0?C.find(".kmappage").stop():hj(h,j,150,2E3,4);$b=!0}}return!1}function ld(c){var k=ga&&ga.galleryitem!=
i;k&&ga.galleryitem.removeClass("kbb-gallery-item-dragging");var l=k;if(ga&&ga.i>=0&&$b){var l=!1,b=C.find(".canvas9")[0];if(b.getContext){var e=a(b).width(),f=a(b).height();b.getContext("2d").clearRect(0,0,e,f)}if(d.H&&c){var b=Math.pow(Math.pow(fg(c)-ga.x,2)+Math.pow(lg(c)-ga.y,2),0.5)>(vb(c)?15:15),e=i,g=-1;k||(e=C.find(".id-items-in-category-gallery"),e.is(":visible")&&(e.find(".kbb-gallery-item-dragging").removeClass("kbb-gallery-item-dragging"),(e=e.find(".kbb-gallery").gallery("hitgalleryitem",
c))&&(g=e.data("itemid"))));if(g<0&&(e=d.j.Qb(c))&&e.eb>=0)g=d.j.q[e.eb].I;if(g>=0)if(ga.a=="newrelation")b&&ga.i!=g&&Kg(ga.i,-1,g,"",!1);else if(ga.from!=g&&ga.to!=g){if(b){var n=a.extend({},ga);B({action:"getrelation",id:n.i,database:O},function(a){if(a.r!=0){if(n.from!=a.fr||n.to!=a.to)n.a=n.a=="movefrom"?"moveto":"movefrom";n.a=="movefrom"?mc(n.i,g,-1,-1,-1,-1,i,i,i,i,-1,i,i,kj):n.a=="moveto"&&mc(n.i,-1,-1,g,-1,-1,i,i,i,i,-1,i,i,pe)}})}}else b||d.j.Vb(ga[ga.a=="movefrom"?"from":"to"]);else if(!k)if(typeof ga.pos!==
"undefined"&&(ga.a=="movefrom"?yc:zc).css({left:ga.pos.left+"px",top:ga.pos.top+"px"}),ga.a=="newrelation"){if(b){for(var e=C.find(".ikmap").offset(),b=d.j.q[d.j.F[ga.i]],k=b.O,b=b.N,f=Math.atan2(lg(c)-e.top-b,fg(c)-e.left-k),G,v=2*Math.PI,c=0,h,e=-1,c=0;c<d.j.q.length;c++)if(h=d.j.q[c],h.Ta==ga.i&&(G=Math.atan2(h.N-b,h.O-k),G=f-G,d.Md()&&(G*=-1),G<0&&(G+=2*Math.PI),G<v))e=h.we,v=G;if(e>=0&&d.fa)for(c=0;c<d.fa.i.length;c++)k=d.fa.i[c],typeof k.lx!=="undefined"&&delete k.lx,typeof k.ly!=="undefined"&&
delete k.ly,typeof k.lo!=="undefined"&&delete k.lo;Hc(ga.i,e,"","","","","","","",i)}}else b||d.j.Vb(ga[ga.a=="movefrom"?"from":"to"])}}a(document).unbindMouseOrTouchEvent("mousemove.dragRelation");a(document).unbindMouseOrTouchEvent("mouseup.dragRelation");ga=i;setTimeout(function(){$b=!1},250);return l}function lj(a){C.find(".textlayer").find(".kbb-tableviewcell-selected").removeClass("kbb-tableviewcell-selected");a.addClass("kbb-tableviewcell-selected")}function Lx(a){a.unbindMouseOrTouchEvent("mousedown.dragTableCell");
a.bindMouseOrTouchEvent("mousedown.dragTableCell",Mx)}function Jf(c,d){var l=i;c.each(function(){var c=a(this),b=c.offset(),e=c.outerWidth(),c=c.outerHeight(),f=fg(d),n=lg(d),g=[];g.push(X(b.left,b.top));g.push(X(b.left,b.top+c));g.push(X(b.left+e,b.top+c));g.push(X(b.left+e,b.top));if(Lg(f,n,g))return l={e:a(this),x:f-b.left,y:n-b.top},!1});return l}function $g(){var a=C.find(".textlayer");a.find(".kbb-tableviewcell-dragover-top").removeClass("kbb-tableviewcell-dragover-top");a.find(".kbb-tableviewcell-dragover-bottom").removeClass("kbb-tableviewcell-dragover-bottom")}
function Qo(c){var d=C.find(".textlayer"),l=Jf(d.find(".kbb-tableviewcell"),c);if(l){var c=l.e.closest(".kbb-tableviewheader").length>0,d=l.e.hasClass("kbb-tableviewheaderdescription"),b=a.trim(l.e.closest(".kbb-tableviewcolumn").find(".kbb-tableviewheaderdescription .kbb-tableviewcellbody .kbb-tableviewcelltext").html()).length>0;if((!c||!b)&&l.e.closest(".kbb-tableviewcolumn").data("pid")!=ib.i.data("pid"))oc=l,l.y<=0.5*l.e.outerHeight()&&!d&&!c?l.e.hasClass("kbb-tableviewcell-dragover-top")||($g(),
l.e.addClass("kbb-tableviewcell-dragover-top")):l.e.hasClass("kbb-tableviewcell-dragover-bottom")||($g(),l.e.addClass("kbb-tableviewcell-dragover-bottom"))}else if((l=Jf(d.find(".kbb-tableviewcolumn"),c))&&l.e.data("pid")!=ib.i.data("pid"))c=lg(c),l=l.e.find(".kbb-tableviewcell").last(),l.length>0&&c>l.offset().top+l.outerHeight()&&(l.hasClass("kbb-tableviewcell-dragover-bottom")||($g(),l.addClass("kbb-tableviewcell-dragover-bottom")),oc={e:l,x:1,y:l.height()})}function Ro(a){var d=fg(a)-ib.dx,l=
lg(a)-ib.dy;ib.c.css({left:d+"px",top:l+"px"});var l=C.find(".kmappage"),b=l.scrollLeft(),e=l.width(),f=0;l.stop();d=fg(a)-l.offset().left;l.css("overflow-x")=="scroll"&&(d<150&&(f=-(150-d)*4),d>e-150&&(f=(d-(e-150))*4));f!=0&&l.animate({scrollLeft:b+f},2E3,"smoothEasing");if(d=Jf(C.find(".kbb-tableviewbody"),a))d.e.stop(),l=lg(a)-d.e.offset().top,a=d.e.scrollTop(),b=d.e.height(),e=0,l<150&&(e=-(150-l)*4),l>b-150&&(e=(l-(b-150))*4),e!=0&&d.e.animate({scrollTop:a+e},2E3,"smoothEasing")}function Mx(c){if(d.H)if(ib)Kc(i);
else{oc=i;var k=fg(c),b=lg(c),e=a(this),t=e.position(),f=e.clone();f.removeClass("kbb-tableviewcell-selected kbb-tableviewcell-rootitem kbb-tableviewcell-hover");f=a('<div class="kbb-tableviewcell-drag"></div>').append(f);f.css("font-size",13*d.D+"px");f.find("*").myDisableSelection(!1);ib={x:k,y:b,dx:k-t.left,dy:b-t.top,i:e,c:f};ah=!1;a(document).unbindMouseOrTouchEvent("mousemove.dragTableCell").bindMouseOrTouchEvent("mousemove.dragTableCell",Nx);a(document).unbindMouseOrTouchEvent("mouseup.dragTableCell").bindMouseOrTouchEvent("mouseup.dragTableCell",
Kc);cc!=i&&clearTimeout(cc);cc=setTimeout(function(){cc=i;ib&&(ah?Kc(i):(Ma=i,a("html,body").removeClass("cursormove"),Lc(),f.appendTo(C.find(".ikmap")),Ro(c),Qo(c)))},250)}}function Nx(a){if(ib&&!ah)if(cc)Math.pow(Math.pow(fg(a)-ib.x,2)+Math.pow(lg(a)-ib.y,2),0.5)>(vb(a)?15:15)&&(ah=!0);else return Ro(a),Qo(a),!1}function Kc(c){var k=!0,b=!0;cc!=i&&(clearTimeout(cc),cc=i,b=!1);if(ib&&(ib.c.remove(),$g(),d.H&&c&&b&&oc&&ib.i[0]!=oc.e[0])){var e=C.find(".textlayer").find(".kbb-tableviewcolumn"),t=oc.e.closest(".kbb-tableviewcolumn"),
f=ib.i.closest(".kbb-tableviewcolumn"),c=oc.e.closest(".kbb-tableviewheader").length>0,b=oc.e.hasClass("kbb-tableviewheaderdescription"),g=ib.i.data("rid"),n=oc.e.data("sn"),h=t.data("pid"),v=ib.i.data("pid");oc.y<=0.5*oc.e.outerHeight()&&!b&&!c?n--:n++;h!=v&&(B({action:"getrelation",id:g,database:O},function(a){if(a.r!=0)d.ca=e.index(t),P=h,f[0]!=t[0]&&(bb=[f.data("pid")],Ic=[e.index(f)]),a.fr==h&&a.to==v?(Nc=g,mc(g,h,n,v,-1,-1,i,i,i,i,-1,i,i,pe)):a.fr==v&&a.to==h?(Nc=g,mc(g,v,-1,h,n,-1,i,i,i,i,
-1,i,i,kj)):a.fr==h?(Nc=g,mc(g,h,-1,v,n,-1,i,i,i,i,-1,i,i,pe)):a.to==v?(Nc=g,mc(g,h,n,v,-1,-1,i,i,i,i,-1,i,i,pe)):a.fr==v?(Nc=g,mc(g,v,-1,h,n,-1,i,i,i,i,-1,i,i,pe)):a.to==h&&(Nc=g,mc(g,v,n,h,-1,-1,i,i,i,i,-1,i,i,pe))}),k=!1)}a(document).unbindMouseOrTouchEvent("mousemove.dragTableCell");a(document).unbindMouseOrTouchEvent("mouseup.dragTableCell");oc=ib=i;return k}function mj(){C.find(".ikmap,.kbb-sidegallery,.quickaccesstoolbar").each(function(){var c=a(this).width(),d=a(this).height();a(this).find(".editoverlay").css({width:c+
"px",height:d+"px"}).fadeTo(0,0).show()})}function So(c,k,b,e,t,f,g,n,h,v,j,m,o){var u=!1,p=C.find(".kmappage"),q=qb()?C.children(".kbb-sidegalleryremainder").first():C,j=a("<div></div>").tabbeddialog({id:"id-edit-item-dialog",title:m?To:Uo,editoktext:nj,editcanceltext:oj,astabletext:pj,addcontenteditabletoolbarmenus:qj,onenddialog:j}).appendTo(q);b.length>3&&b.substring(b.length-3)=="\u00a7if"&&(b=b.substring(0,b.length-3),u=!0);m="Verdana,Helvetica,Sans-Serif";o>=0&&(m=d.j.q[d.j.F[o]].Pb());j.tabbeddialog("addtexteditpage",
"id-edit-item-name",Vo,c,!0,!0,!1,!1,m);j.tabbeddialog("addtexteditpage","id-edit-item-description",Wo,k,!0,!0,!1,!1,m);var w=j.tabbeddialog("addpropertypage","id-edit-item-hyperlink",Xo),c=j.tabbeddialog("addpropertypage","id-edit-item-category",rj);a('<div class="kbb-property-page-text-label">'+Yo+"</div>").appendTo(w);a('<div class="id-edit-item-hyperlink kbb-property-page-text-input"><input type="text" maxlength="500"></div>').appendTo(w).find("input").val(b);if(U()||qb()||Bb()||Cb())a('<div class="id-edit-item-select-file kbb-property-page-button"><button class="kbb-open-file" type="button">...</button></div>').appendTo(w).find("button").button().bind("click",
function(){window.selectfilecallback=function(a){w.find(".id-edit-item-hyperlink>input").val(a)};window.selectfile?window.selectfile():B({action:"selectfile"},fa())}),w.find(".id-edit-item-hyperlink").css({display:"inline-block",width:"calc(100% - 50px)"}),w.find(".id-edit-item-select-file").css({display:"inline-block",width:"49px","vertical-align":"top","text-align":"right"});a('<div class="id-edit-item-hyperlink-new-window kbb-property-page-checkbox"><label><input type="checkbox">'+Zo+"</label></div>").appendTo(w).find("input").prop("checked",
!u);a('<div class="kbb-property-page-text-label" style="margin-top:10px">'+$o+"</div>").appendTo(w);var r=Dx(w,function(a){w.find(".id-edit-item-hyperlink>input").val("itemid://"+a)});b.length>=9&&b.substring(0,9).toLowerCase()=="itemid://"&&(b=parseInt(b.substring(9)),isNaN(b)||B({action:"getitem",id:b,database:O},function(c){if(c.r!=0)(c=c.n)&&r.val(jd(a.trim(c)))}));a('<div class="kbb-property-page-text-label">'+sj+"</div>").appendTo(c);var s=tf(c,"id-edit-item-select-category",0,"","",i).val(t).data("pid",
e);j.tabbeddialog("addpagetoolbarbutton","id-edit-item-category","id-edit-category",tj,"tooltip",33,33,-1,function(){var c=s.data("pid");if(c>=0){var k=i,b="<form>";b+="<div>"+uj+'</div><div><input type="text"></div>';b+="</form>";var l={};l[Da]=function(){var a=k.find("input").val();k.dialog("close");if(a!=""&&a!=s.val()){var b={action:"updateitemtemplate",id:c,itemtemplatename:a,undotext:ap,undoproperties:kb(),database:O};B(b,function(){Ab&&Ab.gallerysection("isexpanded")&&Wa.jb(Ab,i,0);s.val(a);
d.load(P,-1,"",0,!1,!1,xe+1)})}};l[eb]=function(){k.dialog("close")};k=a('<div class="kbb-edit-item-category-dialog" />').html(b).dialog({modal:!0,closeOnEscape:!1,buttons:l,title:bp,width:400,position:Mb?{my:"center top",at:"center top"}:{my:"center",at:"center"},open:function(){a(this).parent(".ui-dialog").find("*").myDisableSelection(!1);a(this).find("input").val(s.val())},close:function(){a(this).dialog("destroy")}});k.find("form").bind("submit",function(){setTimeout(function(){l[Da]()},50);return!1})}},
i);j.tabbeddialog("addpagetoolbarbutton","id-edit-item-category","id-delete-category",vj,"tooltip",55,55,-1,function(){var c=s.data("pid");if(c>=0){var k=i,b={};b[yd]=function(){k.dialog("close");var a={action:"deleteitemtemplate",id:c,undotext:cp,undoproperties:kb(),database:O};B(a,function(){Ab&&Ab.gallerysection("isexpanded")&&Wa.jb(Ab,i,0);Eb&&Eb.data("pid")==s.data("pid")&&pi();s.val("").data("pid",-1);d.load(P,-1,"",0,!1,!1,xe+1)})};b[zd]=function(){k.dialog("close")};k=a("<div />").html(dp.replace("%1",
s.val())).dialog({modal:!0,closeOnEscape:!1,resizable:!1,buttons:b,title:ep,width:400,position:Mb?{my:"center top",at:"center top"}:{my:"center",at:"center"},open:function(){a(this).parent(".ui-dialog").find("*").myDisableSelection(!1)},close:function(){a(this).dialog("destroy")}})}},i);j.tabbeddialog("handlevirtualkeyboard",C,p);j.tabbeddialog("activatetab","id-edit-item-name");j.tabbeddialog("show",p,f,g,v,n,h);j.data("pid",o);mj();C.find(".id-textnote-gallery > .editoverlay").hide();Xc(function(){d.Lc=
d.Db;Ac||me(!1,!0)})}function Rc(c){var k=d.j.q[d.j.F[c]],b=C.find(".textlayer").find(".kbb-tableviewcell-selected");if(k!=i&&(d.B<=Fa&&k.A.J!=i||d.B==Ia&&b.length>0))a.fn.C.close(),d.j.Ga(c,-1,!0,!1,!0),B({action:"getitem",id:c,database:O},function(a){var e=d.B==Ia?b:k.A.J,f="",g="",n="",h=-1,v="",j=C.find(".kmappage"),m=j.scrollTop()+0.5*j.innerHeight(),j=e.outerWidth(),e=e.outerHeight(),o=Math.max(475,j),u=Math.max(300,e);if(a.r!=0)f=a.n,g=a.t,n=a.u,h=a.ti,v=a.tn;var a=d.B==Ia?b.position().left:
k.A.Ib,p=d.B==Ia?b.position().top:k.A.Jb,m=p+0.5*e>m;So(f,g,n,h,v,a+0.5*j,m?p-10*d.D:p+e+(d.B==Ia?10:40)*d.D,o,u,m,Ox,!1,c);U()&&(Oc({action:"seteditmode",editmode:1}),c!=d.j.W&&Oc({action:"onitemselected",i:c,r:-1,search:"",setasroot:0,redraw:1}))})}function Uc(a,k,b,e,t,f,g,n,h,v,j,m,o,u,p){kf(ba);h={action:"updateitem",id:a,itemtemplateid:f,textnoterecordid:h,textnotehtml:v,textnotetext:j,textnotename:m,textnotedescription:o,undotext:u,undoproperties:kb(),database:O};k!==i&&(h.itemname=k);b!==
i&&(h.itemdescription=b);e!==i&&(h.itemdirectlinkurl=e);t!==i&&(h.itemtemplatename=t);g!==i&&(h.itemproperties=g);n!==i&&(h.itemtemplateproperties=n);B(h,function(k){k=k.a;k>=0&&(xc=k);p?p():d.load(P,a,"",0,!1,!1,xe+1);lf();t!==i&&t!=""&&f<0&&Ab&&Ab.gallerysection("isexpanded")&&Wa.jb(Ab,i,0)})}function ij(a,k,b,e,t){var f=d.j.q[d.j.F[a]];if(f.properties===i)f.properties={};b==i?typeof f.properties[k]!=="undefined"&&delete f.properties[k]:f.properties[k]=b;k=JSON.stringify(f.properties);Uc(a,i,i,
i,i,-1,k,i,-1,"","","","",e,t)}function Yc(a,k,b){function e(a,c){c==i?typeof n[a]!=="undefined"&&delete n[a]:n[a]=c}var t=H(),f=d.j.q[d.j.F[t]],g=!1,n=i,h=i,v=i;if(f.Q>=0&&typeof d.j.da[f.Q]!=="undefined")g=d.j.da[f.Q],g.properties===i&&(g.properties={}),n=g.properties,g=!0;else{if(f.properties===i)f.properties={};n=f.properties}if(a==i||typeof a==="object"){k=["ic","tc","fn","iw","is","iis","sym"];for(f=0;f<k.length;f++)e(k[f],a&&typeof a[k[f]]!=="undefined"?a[k[f]]:i)}else e(a,k);g?v=JSON.stringify(n):
h=JSON.stringify(n);Uc(t,i,i,i,i,-1,h,v,-1,"","","","",b,i)}function Zc(a,k,b){if(d.j.aa>=0){var e=d.j.R[d.j.ja[d.j.aa]],t=!1,f=i,g=i,n=i;if(e.Na>=0&&typeof d.j.Ab[e.Na]!=="undefined")t=d.j.Ab[e.Na],t.properties===i&&(t.properties={}),f=t.properties,t=!0;else{if(e.properties===i)e.properties={};f=e.properties}e=function(a,c){c==i?typeof f[a]!=="undefined"&&delete f[a]:f[a]=c};if(a==i||typeof a==="object")for(var k=["rc","tc","ls","lw","la","lfn","lfs"],h=0;h<k.length;h++)e(k[h],a&&typeof a[k[h]]!==
"undefined"?a[k[h]]:i);else e(a,k);t?n=JSON.stringify(f):g=JSON.stringify(f);mc(d.j.aa,-1,-1,-1,-1,-1,i,i,i,i,-1,g,n,b)}}function Qc(a,d,b,e,t,f){function g(a){if(a.nodeType==3)a==d&&(n=v.length+b),a==e&&(h=v.length+t),v+=a.nodeValue.replace(/\s/g," ");else if(a.nodeType==1&&a.childNodes){j[a.nodeName.toUpperCase()]&&v.length>0&&v.charAt(v.length-1)!="\n"&&(v+="\n");for(var c=0;c<a.childNodes.length;c++)g(a.childNodes[c])}}var n=-1,h=-1,v="",j={ADDRESS:!0,BLOCKQUOTE:!0,BR:!0,CENTER:!0,DIR:!0,DIV:!0,
DL:!0,FIELDSET:!0,FORM:!0,H1:!0,H2:!0,H3:!0,H4:!0,H5:!0,H6:!0,HR:!0,ISINDEX:!0,LABEL:!0,MENU:!0,NOFRAMES:!0,NOSCRIPT:!0,OL:!0,P:!0,PRE:!0,TABLE:!0,UL:!0,DD:!0,DT:!0,FRAMESET:!0,LI:!0,TBODY:!0,TD:!0,TFOOT:!0,TH:!0,THEAD:!0,TR:!0};g(a);n<0&&h>=0&&(n=f?h-f.length:h);h<0&&n>=0&&(h=f?n+f.length:n);return{sp:n,ep:h,t:v}}function Vb(a,d){function b(a,c,d,k){for(var l=a.length,e=0,d=Math.max(0,d-1),t=0;t<c.length;t++)e=a.indexOf(c[t],d),e>=0&&e<l&&(l=e,k&&l<a.length&&(a[l]=="."||a[l]=="!"||a[l]=="?"||a[l]==
";"||a[l]==":")&&l++);return l}function e(a,c,d){for(var k=0,b=0,l=0;l<c.length;l++)b=a.lastIndexOf(c[l],d),b>=0&&(b+=c[l].length),b>=k&&(k=b);return k}function t(a,c){var d=0,a=a.replace(/\s/g," ");do d=a.length,a=a.replace(/[ ][ ]/g," "),a=a.replace(c?/^[ \'\".,:;!?()\[\]{}<>\u00ab\u00bb]/g:/^[ ]/g,""),a=a.replace(c?/[ \'\".,:;!?()\[\]{}<>\u00ab\u00bb]$/g:/[ ]$/g,"");while(a.length!=d);return a}var f="",g="",n="";if(a.sp>=0&&a.ep+(d?0:1)>a.sp&&a.ep<=a.t.length){f=a.t.substring(a.sp,a.ep);if(/[\u3400-\u9FBF]/.test(f))g=
a.t.substring(Math.max(0,a.sp-25),Math.min(a.ep+25,a.t.length)),n=f;else var n=e(a.t,[" ","\n"],a.sp),g=e(a.t,["\n",". ","! ","? ","; ",": "],a.sp),h=b(a.t,["\n",". ","! ","? ","; "],a.ep,!0),v=b(a.t,[" ","!","?",";",":","\n",". ",", ",".\n"],a.ep,!0),f=a.t.substring(n,b(a.t,[" ","!","?",";",":","\n",". ",", ",".\n"],a.ep,!1)),g=a.t.substring(g,h),n=a.t.substring(n,v);f=t(f,!0);g=t(g,!1);n=t(n,!1)}return{n:f,d:g,s:n}}function Xc(c){var d=na[0];Qa.is(":visible")&&(d=a("<div></div>").html(Og(Qa,Qa.val()))[0]);
var b=Qc(d,i,0,i,0,i);b.sp=0;b.ep=0;var e=Vb(b,!1);b.ep=Math.min(40,e.d.length);var e=Vb(b,!1),d=e.n,e=e.d,b=b.t,t=fp;xc==-2?t=gp:Ac&&(t=hp);Uc($c,i,i,i,i,-1,i,i,xc,ub?gc(i):"",ub?b:"",ub?d:"",ub?e:"",t,c);ub=!1;Tb=i}function gc(c){var d="";c||!Qa.is(":visible")?(d=Ya(function(){return a("<div></div>").html(c?c:na.html())}),nb(d,[],!1,!1),cb(d)):d=Ya(function(){return a("<div></div>").html(Og(Qa,Qa.val()))});d.find("a").removeAttr("target");return d=Md(Vg(d.html(),!1))}function Ox(a,k){k&&(!Ac||d.sb)&&
me(d.Lc,!1);C.find(".editoverlay").hide();var b=k.data("pid");if(!a){var e=k.tabbeddialog("getcontent","id-edit-item-name"),t=k.tabbeddialog("getcontent","id-edit-item-description"),f=k.tabbeddialog("getpropertypagecontrol","id-edit-item-hyperlink","id-edit-item-hyperlink").find("input").val(),g=!k.tabbeddialog("getpropertypagecontrol","id-edit-item-hyperlink","id-edit-item-hyperlink-new-window").find("input").is(":checked"),n=k.tabbeddialog("getpropertypagecontrol","id-edit-item-category","id-edit-item-select-category").find("input"),
h=n.val(),n=n.data("pid");g&&f.length>0&&(f+="\u00a7if");b==$c&&(g=Ed(e),hb.sidegallery("setheadertext",Ue+(g!=""?ch+g+'"':"")));Uc(b,e,t,f,h,n,i,i,-1,"","","","",ug,i)}U()&&Oc({action:"seteditmode",editmode:0})}function Hc(c,k,b,e,t,f,g,n,h,v){var j=-1;function m(a,y){y&&(!Ac||d.sb)&&me(d.Lc,!1);y&&C.find(".editoverlay").hide();if(!a){if(y){b=y.tabbeddialog("getcontent","id-edit-item-name");e=y.tabbeddialog("getcontent","id-edit-item-description");t=y.tabbeddialog("getpropertypagecontrol","id-edit-item-hyperlink",
"id-edit-item-hyperlink").find("input").val();!y.tabbeddialog("getpropertypagecontrol","id-edit-item-hyperlink","id-edit-item-hyperlink-new-window").find("input").is(":checked")&&t.length>0&&(t+="\u00a7if");var ra=y.tabbeddialog("getpropertypagecontrol","id-edit-item-category","id-edit-item-select-category").find("input");p=ra.val();u=ra.data("pid")}kf(ba);var z=function(a,k){if(a>=0){var b=d.B==Ia||A&&A.U>=d.ha||d.fa&&d.fa.i.length>=d.la-5;Nc=k;if(d.j)d.j.W=a,d.j.aa=-1;d.ge=!0;d.load(b?c:A?P:a,a,
"",Xb,!0,!1,xe+1);Db&&d.kb(a,!1);U()&&(Oc({action:"onitemmodified",i:b?c:a,f:c,r:k,search:"",setasroot:b||A==i?1:0}),b&&Oc({action:"onitemselected",i:a,r:k,search:"",setasroot:0,redraw:1}))}lf()};xj={action:"newitem",id:c,sequencefrom:k,itemname:b,itemdescription:e,itemdirectlinkurl:t,itemproperties:o,itemtemplateid:u,itemtemplatename:p,textnoterecordid:j,textnotehtml:f,textnotetext:g,textnotename:n,textnotedescription:h,relationname:q,relationbackrelname:w,relationdescription:r,relationproperties:s,
relationtemplateid:K,relationtemplatename:x,undotext:pf,undoproperties:kb(),database:O};B(xj,function(a){v?v(z,a.i,a.r,a.a):z(a.i,a.r)})}U()&&Oc({action:"seteditmode",editmode:0})}var o="",u=-1,p="",q="",w="",r="",s="",K=-1,x="",A=i,z=0,E=0,I=475,F=300,N=!0;typeof c==="undefined"&&(c=-1);c>=0&&(A=d.j.q[d.j.F[c]]);var Zb=C.find(".textlayer").find(".kbb-tableviewcell-selected");if(A!=i&&(d.B<=Fa&&A.A.J!=i||d.B==Ia&&Zb.length>0))var J=d.B==Ia?Zb:A.A.J,H=C.find(".kmappage"),H=H.scrollTop()+0.5*H.innerHeight(),
y=J.outerWidth(),J=J.outerHeight(),I=Math.max(475,y),F=Math.max(300,J),Q=d.B==Ia?Zb.position().left:A.A.Ib,Zb=d.B==Ia?Zb.position().top:A.A.Jb,N=Zb+0.5*J>H,z=Q+0.5*y,E=N?Zb-10*d.D:Zb+J+(d.B==Ia?10:40)*d.D;Mg();a.fn.C.close();b==""&&e==""&&t==""?(te(jc,function(a){Wf&&(a=i);if(a)q=a.Name,w=a.BackName,r=a.Description,s=a.Properties,K=a.CategoryID,K>=0&&B({action:"getrelationtemplate",id:K,database:O},function(a){a.r!=0?x=a.tn:K=-1})}),te(ic,function(c){function d(){c&&c==Vd?m(!1,i):So(b,e,t,u,p,z,E,
I,F,N,m,!0,-1)}Wf&&(c=i);if(c){j=-1;f=c.TextNoteHtml;h=n=g="";if(f!=""){var k=a("<div></div>");Ya(function(){k.html(f)});var q=Qc(k[0],i,0,i,0,i);q.sp=0;q.ep=0;var w=Vb(q,!1);q.ep=Math.min(40,w.d.length);w=Vb(q,!1);n=w.n;h=w.d;g=q.t}b=c.Name;e=c.Description;t=c.DirectLinkURL;o=c.Properties;u=c.CategoryID;u>=0?B({action:"getitemtemplate",id:u,database:O},function(a){a.r!=0?p=a.tn:u=-1;d()}):d()}else d()})):m(!1,i)}function dh(c,k){var b=d.j.q[d.j.F[c]],e={action:"deleteitem",id:c,undotext:k,undoproperties:kb(),
database:O};B(e,function(){var k=-1,e=b.U==0;if(d.B==Ia){var f=C.find(".kbb-tableviewcolumn"),e=!0,k=Ga();if(k==c)d.Fa=d.ca,d.ca--,k=d.ca>=0?a(f[d.ca]).data("pid"):-1;else if(d.ca>=0&&d.ca<f.length-1&&a(f[d.ca+1]).data("pid")==c)d.Fa=d.ca+1}else if(e)if(d.L.i.length>1){if(k=d.L.i[1].i,d.j&&U())d.j.W=k,d.j.aa=-1}else k=-1;else if(d.j&&d.j.W>=0)k=d.j.W;if(d.j.W==c)d.j.W=-1;d.load(e?k:P,-1,"",Xb,!0,!1,xe+1);U()&&Oc({action:"onitemmodified",i:k,r:-1,search:"",setasroot:e?1:0});$c==c&&d.kb(e?k:P,!0)})}
function ip(a){eh==i?Bd=d.D:clearTimeout(eh);a==0?Bd=1:Bd*=a;Bd=Math.max(1/3,Math.min(3,Bd));eh=setTimeout(function(){eh=i;d.B<=Fa&&d.hb(d.L,d.L);var a=Bd/d.D;d.D=Bd;xd(d.D,d.M,d.rotation,d.$);Ve(a,0);U()&&Oc({action:"onsettingschanged",zoomfact:d.D})},a==0?0:1E3);Vi(Bd)}function Ve(a,k){if(d.B==Ia)Kf(!1);else if(d.B<=Fa){var b=C.find(".kmappage");gb(k,-3,!0,!0,!0,"swing",{x:a*(b.scrollLeft()+0.5*b.width()),y:a*(b.scrollTop()+0.5*b.height())})}else gb(k,-2,!0,!0,!0)}function fh(c,k){d.B!=La&&(Lf=
-1,c>=0&&(a.fn.C.close(),B({action:"getitem",id:c,database:O},function(b){if(b.r!=0){var e=b.n,f=b.t,g=b.u,h=b.ti,n=b.tn,j=b.o;d.fc(c,function(c){Vd=Qd(jd(a.trim(e)),e,f,g,h,n,j,c);k&&k()})}})))}function yj(a,k){d.B!=La&&fh(a,function(){var b=d.j.$f(a,k);if(b.length>0){var e=0,f=function(){e<b.length-1?We(b[e++].Ea,f,gh):(We(b[e++].Ea,i,gh),Lf=a)};f()}else dh(a,gh)})}function zj(){var a=d.B==Ia?Ga():H(),k=d.B==Ia?aa()+1:-1;if(Vd&&a>=0&&d.B!=La){var b=function(){ic.Yd=Vd;Hc(a,k,"","","","","","","",
i)};Lf>=0?B({action:"getitem",id:Lf,database:O},function(d){d.r!=0?Kg(a,k,Lf,"",!0):b()}):b()}}function kg(a,k){function b(a,c){var k=!1;if(a.properties){var l=a.properties[e];l&&(l=d.yb()?l:l[a.Ta.toString()+(d.jc()?":"+a.U.toString():"")])&&(k=c||l.x!=0||l.y!=0)}return k}var e=Ua[d.G];if(a<0)for(var f=0;f<k.q.length;f++){if(b(d.j.q[f],!0))return!0}else if(f=k.q[k.F[a]])return b(f,!1);return!1}function jp(a){if(a>=0){var k=d.j.q[d.j.F[a]],b=Ua[d.G];if(k&&k.properties&&k.properties[b]){var e=k.properties[b],
f;if(f=d.yb()?e:e[k.Ta.toString()+(d.jc()?":"+k.U.toString():"")])f.ox!=0||f.oy!=0?(f.x=0,f.y=0):f=i;d.yb()?e=f:e[k.Ta.toString()+(d.jc()?":"+k.U.toString():"")]=f;ij(a,b,e,kp,function(){d.load(P,a,"",Xb,!1,!0,xe+1)})}}}function lp(){kf(ba);B({action:"getnextundopos",database:O},function(a){if(a>=0){var k=Ua[d.G],b,e=0,f=!1,g=function(){e<d.j.q.length?(b=d.j.q[e],e++,b&&b.properties&&b.properties[k]?ij(b.I,k,i,Aj,function(){f=!0;g()}):g()):f?B({action:"combineundoactionsupto",undostepid:a,description:Aj,
database:O},function(){d.load(-1,-1,"",Xb,!1,!0,xe+1);lf()}):lf()};g()}else lf()})}function mp(c,k){var b=d.j.q[d.j.F[c]],e=C.find(".textlayer").find(".kbb-tableviewcell-selected");if(b!=i&&b.A.J!=i||d.B==Ia&&e.length>0&&H()>=0){d.B==Ia?Lc():a.fn.C.close();U()&&Oc({action:"seteditmode",editmode:1});mj();var f=C.find(".newrelationbar"),g=f.find(".id-drag-to-endpoint");d.B==Ia?g.hide():g.show();f.css({left:"-2000px",top:"-2000px"}).show().data("pid",c).data("sn",k);g=f.outerHeight();if(d.B==Ia)b=e.position(),
g=e.parents(".kbb-tableviewheader").length>0,b=Od(f.parent(),C.find(".kmappage"),f,b.left,b.top+e.outerHeight(!0)-(g?1:e.outerHeight()+f.outerHeight()-1));else var e=(b.A.J.outerHeight()-b.A.J.height())/2,h=(b.A.J.outerWidth()-b.A.J.width())/2,b=Od(f.parent(),C.find(".kmappage"),f,b.A.Ib+h/2,b.A.Jb+e/2-g);f.hide().css({left:b[0]+"px",top:b[1]+"px"}).fadeIn(300);f.find(".selectrelateditem").val("").autocomplete("option","minLength",1).autocomplete("close").autocomplete("search","").autocomplete("option",
"minLength",0)}}function Mg(){var a=C.find(".newrelationbar");a.is(":visible")&&(a.hide(),C.find(".editoverlay").hide(),U()&&Oc({action:"seteditmode",editmode:0}))}function Yh(a,d,b,e){d=Od(a.parent(),C.find(".kmappage"),a,d,b-(e?0:a.outerHeight()));a.css({left:d[0]+"px",top:d[1]+"px","max-width":C.find(".diagramcontainer").width()+"px"}).show()}function db(a,d,b){a=C.find((d?".itemtoolbar ":".relationtoolbar ")+a).parent();b?a.show():a.hide()}function Xe(c){var b=d.j.R[d.j.ja[c]];if(b!=i){a.fn.C.close();
d.j.Ga(-1,c,!0,!1,!0);var l=function(l){var e="",f="",g="",n=-1,h="",v=0,j=0,m=0,o=0,u=C.find(".kmappage"),p=u.scrollTop()+0.5*u.innerHeight(),v=C.find(".relationselector");v.is(":visible")?(j=v.position(),m=v.outerWidth(),o=v.outerHeight(),v=j.left,j=j.top):(j=b.je(),o=m=24,v=j.x-m/2,j=j.y-o/2);if(l.r!=0)e=l.n,f=l.b,g=l.t,n=l.ti,h=l.tn;var q=qb()?C.children(".kbb-sidegalleryremainder").first():C,q=a("<div></div>").tabbeddialog({id:"id-edit-relation-dialog",title:np,editoktext:nj,editcanceltext:oj,
astabletext:pj,addcontenteditabletoolbarmenus:qj,onenddialog:Px}).appendTo(q);q.tabbeddialog("addtexteditpage","id-edit-relation-name",op,e,!1,!1,!0,l.nt!=0,"Verdana,Helvetica,Sans-Serif");q.tabbeddialog("addtexteditpage","id-edit-relation-backrelname",pp,f,!1,!1,!0,l.bt!=0,"Verdana,Helvetica,Sans-Serif");q.tabbeddialog("addtexteditpage","id-edit-relation-description",qp,g,!0,!1,!1,!1,"Verdana,Helvetica,Sans-Serif");l=q.tabbeddialog("addpropertypage","id-edit-relation-category",rj);a('<div class="kbb-property-page-text-label">'+
sj+"</div>").appendTo(l);var w=tf(l,"id-edit-relation-select-category",1,"","",i).val(h).data("pid",n);q.tabbeddialog("addpagetoolbarbutton","id-edit-relation-category","id-edit-category",tj,"tooltip",33,33,-1,function(){var c=w.data("pid");if(c>=0){var b=i,k="<div>"+uj+'</div><div><input type="text"></div>',l={};l[Da]=function(){var k=a(this).find("input").val();b.dialog("close");if(k!=""&&k!=w.val()){var l={action:"updaterelationtemplate",id:c,relationtemplatename:k,undotext:rp,undoproperties:kb(),
database:O};B(l,function(){Lb&&Lb.gallerysection("isexpanded")&&Wa.jb(Lb,i,1);w.val(k);d.load(P,-1,"",0,!1,!1,xe+1)})}};l[eb]=function(){b.dialog("close")};b=a('<div class="kbb-edit-relation-category-dialog" />').html(k).dialog({modal:!0,closeOnEscape:!1,buttons:l,title:sp,width:400,position:Mb?{my:"center top",at:"center top"}:{my:"center",at:"center"},open:function(){a(this).parent(".ui-dialog").find("*").myDisableSelection(!1);a(this).find("input").val(w.val())},close:function(){a(this).dialog("destroy")}})}},
i);q.tabbeddialog("addpagetoolbarbutton","id-edit-relation-category","id-delete-category",vj,"tooltip",55,55,-1,function(){var c=w.data("pid");if(c>=0){var b=i,k={};k[yd]=function(){b.dialog("close");var a={action:"deleterelationtemplate",id:c,undotext:tp,undoproperties:kb(),database:O};B(a,function(){Lb&&Lb.gallerysection("isexpanded")&&Wa.jb(Lb,i,1);w.val("").data("pid",-1);d.load(P,-1,"",0,!1,!1,xe+1)})};k[zd]=function(){b.dialog("close")};b=a("<div />").html(up.replace("%1",w.val())).dialog({modal:!0,
closeOnEscape:!1,resizable:!1,buttons:k,title:vp,width:400,position:Mb?{my:"center top",at:"center top"}:{my:"center",at:"center"},open:function(){a(this).parent(".ui-dialog").find("*").myDisableSelection(!1)},close:function(){a(this).dialog("destroy")}})}},i);q.tabbeddialog("handlevirtualkeyboard",C,u);q.tabbeddialog("activatetab","id-edit-relation-name");o=Math.max(300,o);m=Math.max(475,m);n=j>p;q.tabbeddialog("show",u,v,n?Math.min(b.Sa,b.Ra)-20*d.D:Math.max(b.Sa,b.Ra)+20*d.D,n,m,o);q.data("pid",
c);mj();C.find(".id-textnote-gallery > .editoverlay").hide();Xc(function(){d.Lc=d.Db;Ac||me(!1,!0)})};B({action:"getrelation",id:c,database:O},function(a){l(a);U()&&(Oc({action:"seteditmode",editmode:1}),Oc({action:"onrelationselected",i:d.j.q[b.ra].I,r:c,redraw:1}))})}}function mc(a,b,l,e,f,g,h,n,j,v,m,o,p,u){kf(ba);l={action:"updaterelation",id:a,idfrom:b,sequencefrom:l,idto:e,sequenceto:f,visibleuptolevel:g,relationtemplateid:m,undotext:u,undoproperties:kb(),database:O};h!==i&&(l.relationname=
h);n!==i&&(l.relationbackrelname=n);j!==i&&(l.relationdescription=j);v!==i&&(l.relationtemplatename=v);o!==i&&(l.relationproperties=o);p!==i&&(l.relationtemplateproperties=p);B(l,function(l){if(!(U()&&l==0)){l=P;if((b>=0||e>=0)&&d.B<=Fa){var f=d.j.R[d.j.ja[a]],t=typeof d.j.F[e]==="undefined"?i:d.j.q[d.j.F[e]],t=b>=0?typeof d.j.F[b]==="undefined"?i:d.j.q[d.j.F[b]]:d.j.q[f.ra],f=e>=0?typeof d.j.F[e]==="undefined"?i:d.j.q[d.j.F[e]]:d.j.q[f.Va];if(d.Ka==0||t==i||t.U>=d.ha||f==i||f.U>=d.ha||d.fa==i||d.fa.i.length>=
d.la-5)if(f&&(t==i||f.U<t.U))l=f.I;else if(t)l=t.I}d.load(l,-1,"",b>=0||e>=0||g>=0||d.hc()?Xb:0,b>=0||e>=0||d.hc(),!1,xe+1)}lf();v!==i&&v!=""&&m<0&&Lb&&Lb.gallerysection("isexpanded")&&Wa.jb(Lb,i,1)})}function Px(a,b){b&&(!Ac||d.sb)&&me(d.Lc,!1);C.find(".editoverlay").hide();var l=b.data("pid");if(!a){var e=b.tabbeddialog("getcontent","id-edit-relation-name"),f=b.tabbeddialog("getpagedata","id-edit-relation-name","astableselected"),g=b.tabbeddialog("getcontent","id-edit-relation-backrelname"),h=b.tabbeddialog("getpagedata",
"id-edit-relation-backrelname","astableselected"),n=b.tabbeddialog("getcontent","id-edit-relation-description"),j=b.tabbeddialog("getpropertypagecontrol","id-edit-relation-category","id-edit-relation-select-category").find("input"),v=j.val(),j=j.data("pid");f&&(e="T:"+e);h&&(g="T:"+g);mc(l,-1,-1,-1,-1,-1,e,g,n,v,j,i,i,wp)}U()&&Oc({action:"seteditmode",editmode:0})}function We(a,b,l){l={action:"deleterelation",id:a,undotext:l,undoproperties:kb(),database:O};B(l,function(){if(b)b();else{if(d.j.aa==
a)d.j.aa=-1;d.load(P,-1,"",Xb,!0,!1,xe+1);U()&&Oc({action:"onrelationmodified",r:-1})}})}function Mf(c,b,l,e,f){var g="",h="",n="",j=i,v=i;try{var m=ad.getSelection(),o=m.anchorNode,p=m.anchorOffset,u=m.focusNode,r=m.focusOffset;if(o&&u)n=m.toString(),v=Qc(na[0],o,p,u,r,n),j=Vb(v,c),g=j.n,h=j.d,n=j.s}catch(q){}if(g!=""){Pm();var w=H();if(b){if(g!=hh||h!=ih)Hc(w,-1,g,h,"","","","","",function(a,c,b,k){a(c,b,k);d.j.Vb(w)}),hh=g,ih=h,jh!=i&&clearTimeout(jh),jh=setTimeout(function(){jh=i;ih=hh=""},5E3)}else if(l)Tc(w,
g);else if(!e&&f&&(l=C.find(".kbb-tabbed-dialog:visible").tabbeddialog("getactivetexteditdocument")))c=l[2],b=l[3],l=l[4],l.is(":visible")?(n=a("<div />").text(n).html(),l.val().length>0&&(n=" "+n),document.execCommand("insertText",!1,n)):(b.text().length>0&&(n=" "+n),c.execCommand("insertText",!1,n));n=Yg(na[0],ad,Kb);if(n.start>=0&&n.end>n.start)n.end=n.start,bh(na[0],n,ad,Kb)}}function jo(){var c="",b="";Me=C.find(".id-textnote-gallery .textnote > iframe");var l=Ih(Me,"Arial,Helvetica,Sans-Serif",
"15px");ad=l[0];Kb=l[1];na=a(Kb.body);Qa=C.find(".id-textnote-gallery .textnote > textarea");na.bind("mouseup.kmEvents",function(a){var c=!d.sb&&d.lb,b=!d.sb&&d.nb,k=!d.sb&&d.mb,l=d.sb&&d.de;if(d.H&&!d.Db&&(c||b||k||l)&&!Qa.is(":visible")&&(a.which&&a.which==1||a.button&&a.button==0))return Mf(!0,c,b,k,l),!1}).bind("click.kmEvents",function(){Qb();C.find(".kbb-popup-frame:visible").hide()}).bind("focus.kmEvents",function(){ub||(Tb=gc(i))}).bind("blur.kmEvents",function(){d.Db&&!ub&&Tb!==i&&(ub=gc(i)!=
Tb);Tb=i}).bind("keyup.kmEvents paste.kmEvents cut.kmEvents input.kmEvents",function(){d.Db&&!ub&&(ub=Tb!==i?gc(i)!=Tb:!0);na.find("iframe").attr("sandbox","");kh!=i&&clearTimeout(kh);Bb()||(kh=setTimeout(function(){kh=i;b=na.text();if(b!==c){var a=Yg(na[0],ad,Kb);Za(na,!0);lb(na);bh(na[0],a,ad,Kb);c=b}},1E3))}).bind("mousemove.kmEvents",function(c){if(a(a.fn.C.obj).is(":visible")||C.find(".textselector").is(":visible")){var b=Me.offset();b.left-=a(Kb).scrollLeft();b.top-=a(Kb).scrollTop();c.pageX+=
b.left;c.pageY+=b.top;var k=d.lc(c);c.pageX-=b.left;c.pageY-=b.top;k||a.fn.C.close()}});a([Kb.body,Kb.defaultView]).bind("scroll.kmEvents",function(){a.fn.C.close()});Qa.bind("focus.kmEvents",function(){ub||(Tb=gc(i))}).bind("blur.kmEvents",function(){!ub&&Tb!==i&&(ub=gc(i)!=Tb);Tb=i}).bind("click.kmEvents",function(){Qb()}).bind("keyup.kmEvents paste.kmEvents cut.kmEvents input.kmEvents",function(){ub||(ub=Tb!==i?gc(i)!=Tb:!0)})}function qj(c,d,b,e,f,g){function h(a){var c=b();if(c){var d=c[1],k=
c[2],c=c[3];c.is(":visible")?(c.focus(),document.execCommand(a,!1,i)):(k.focus(),d.execCommand(a,!1,i));e()}}function n(a){h(a);j()}function j(){try{var a=b();if(a){var c=a[1],d=a[2],k=a[3];r.galleryitem("setselected",d.attr("spellcheck")=="true");q.galleryitem("setselected",k.is(":visible"));a=function(a,d){var b=!1;try{b=c.queryCommandState(d)}catch(k){}a.galleryitem("setselected",b)};a(w,"bold");a(s,"italic");a(x,"underline");a(K,"strikeThrough");for(var e=c.queryCommandValue("fontName").split(",")[0].replace(/[\"\']/g,
"").toLowerCase().trim(),k=0;k<Sa.length;k++)if(Sa[k].toLowerCase()==e){A.comboboxgalleryitem("setselected","id-font-name-"+k);break}d.addClass("kbb-default-font-size");var f=parseInt(c.queryCommandValue("fontSize"));d.removeClass("kbb-default-font-size");d="id-medium-font-size";switch(f){case 1:d="id-ultra-small-font-size";break;case 2:d="id-very-small-font-size";break;case 3:d="id-small-font-size";break;case 4:d="id-medium-font-size";break;case 5:d="id-large-font-size";break;case 6:d="id-very-large-font-size";
break;case 7:d="id-ultra-large-font-size"}C.comboboxgalleryitem("setselected",d);a(z,"superscript");a(E,"subscript");var t=Jh(c.queryCommandValue("foreColor"));t&&I.colorpickergalleryitem("setcurrentcolor",t,!0);var g=Jh(c.queryCommandValue("backColor"));g&&F.colorpickergalleryitem("setcurrentcolor",g,!0);a(Q,"insertOrderedList");a(Y,"insertUnorderedList");a(N,"justifyLeft");a(J,"justifyCenter");a(H,"justifyRight");a(y,"justifyFull");var n=v().c.length>0;aa.galleryitem("setenabled",n);P.galleryitem("setenabled",
n);T.galleryitem("setenabled",n);sa.galleryitem("setenabled",n);R.galleryitem("setenabled",n);ia.galleryitem("setenabled",n);ka.galleryitem("setenabled",n);B=-1}}catch(h){}}function v(){var c=a([]),d=a([]),k=a([]),e=-1,f=-1,t=0,g=0,n=b();if(n){var q;a:{n=n[0];try{var h=(typeof n==="undefined"?window:n).getSelection();if(h.getRangeAt&&h.rangeCount){q=h.getRangeAt(0).startContainer;break a}}catch(w){}q=i}if(q)c=a(q).closest("td"),c.length==0&&q.nodeType==3&&(q.nextSibling&&(c=a(q.nextSibling).closest("td")),
c.length==0&&q.previousSibling&&(c=a(q.previousSibling).closest("td"))),d=c.closest("tr"),k=d.closest("table"),e=k.find("tr").index(d),f=d.find("td").index(c),t=k.children("tbody").children("tr").length,g=d.children("td").length}return{t:k,r:d,c:c,ri:e,ci:f,rc:t,cc:g}}var m=[],o=[],p=c.toolbar("addpopupbutton","id-edit",d?zp:lh,"tooltip",d?298:-1,d?298:-1,-1,!0,fa(),i);o.push(p[0][0]);p=p[1];d||(p.gallery("addgalleryitem","id-update-textnote",Ap,"tooltip",67,68,-1,!0,!0,function(){Xc(i)}),p.gallery("addgalleryitem",
"id-clear-textnote",Bp,"tooltip",69,70,-1,!0,!0,function(){var c=i,d={};d[yd]=function(){Qa.is(":visible")?Qa.val("").focus():na.html("").focus();Ac=!0;xc=-2;Xc(i);c.dialog("close")};d[zd]=function(){c.dialog("close")};c=a("<div />").html(Cp.replace("%1",Ye)).dialog({modal:!0,closeOnEscape:!1,resizable:!1,buttons:d,title:Dp,width:400,position:Mb?{my:"center top",at:"center top"}:{my:"center",at:"center"},close:function(){a(this).dialog("destroy")},open:function(){a(this).parent(".ui-dialog").find("*").myDisableSelection(!1)}})},
i));p.gallery("addgalleryitem","id-undo",Ep,"tooltip",90,91,-1,!0,!0,function(){h("undo")});p.gallery("addgalleryitem","id-redo",Fp,"tooltip",92,93,-1,!0,!0,function(){h("redo")});var u=p.gallery("addgalleryitem","id-insert-images",Bj,"tooltip",194,195,-1,!0,!0,function(){var a=b();if(a){var c=a[0],d=a[1],k=a[2],g=Yg(k[0],c,d);ob(-1,"","","",!1,function(a,b,l,n){k.focus();bh(k[0],g,c,d);Ya(function(){Kh('<img src="'+a+'" style="'+f(n,l)+'">',c,d);e()})})}});m.push(u[0]);u=p.gallery("addgalleryitem",
"id-insert-mathexpression",Hp,"tooltip",264,265,-1,!0,!0,function(){var a=b();if(a){var c=a[0],d=a[1],a=a[2];a.focus();var k=Yg(a[0],c,d);Ya(function(){try{var a=typeof d==="undefined"?document:d,b=(typeof c==="undefined"?window:c).getSelection();if(b.getRangeAt&&b.rangeCount){var k=b.getRangeAt(0);k.deleteContents();k.insertNode(a.createTextNode(" $\u2211\u2199{i=0}\u2196j {1+\u221a^n{2\u22c53}}/{3\u2196{\u2192}+4_1^2}(\\table \\a,\\b;c,d)$ $$1/{2+3}$$ "))}}catch(l){}});Za(a,!0);lb(a);k.end=k.start;
bh(a[0],k,c,d);e()}});m.push(u[0]);u=p.gallery("addgalleryitem","id-insert-hyperlink",Cj,"tooltip",10,11,-1,!0,!0,function(){var c=b();if(c){var d=c[0],k=c[1],f=c[2],t=Yg(f[0],d,k),g=i,n=i,c="<form>";c+="<div><label>"+Ip+'<br><input class="kbb-url" type="text" value=""></label></div>';c+='<input type="submit" class="kbb-invisible" />';c+="</form>";var q={};q[Da]=function(){g.dialog("close");f.focus();bh(f[0],t,d,k);var a=n.val();a.length>0&&(k.execCommand("createLink",!1,a),e())};q[eb]=function(){g.dialog("close")};
g=a('<div class="kbb-insert-hyperlink-dialog" />').html(c).dialog({modal:!0,closeOnEscape:!1,resizable:!1,buttons:q,title:Cj,width:500,position:Mb?{my:"center top",at:"center top"}:{my:"center",at:"center"},open:function(){a(this).parent(".ui-dialog").find("*").myDisableSelection(!1)},close:function(){a(this).dialog("destroy")}});n=g.find(".kbb-url");g.find("form").bind("submit",function(){setTimeout(function(){q[Da]()},50);return!1})}});m.push(u[0]);u=p.gallery("addgalleryitem","id-remove-hyperlink",
Jp,"tooltip",16,17,-1,!0,!0,function(){h("unlink")});m.push(u[0]);u=p.gallery("addgalleryitem","id-insert-horizontal-rule",Kp,"tooltip",126,127,-1,!0,!0,function(){h("insertHorizontalRule")});m.push(u[0]);var r=p.gallery("addgalleryitem","id-edit-spellcheck",Lp,"tooltip",296,297,0,!0,!0,function(a,c){var d=b();if(d){var k=d[2];k.removeAttr("contenteditable");setTimeout(function(){k.attr("spellcheck",c?"true":"false");k.attr("contenteditable","true")},1)}});m.push(r[0]);var q=p.gallery("addgalleryitem",
"id-edit-showhtmlsource",Mp,"tooltip",134,135,0,!0,!0,function(){g&&g()}),p=c.toolbar("addpopupbutton","id-font",d?Np:Op,"tooltip",d?300:-1,d?300:-1,-1,!0,fa(),i);m.push(p[0][0]);for(var p=p[1],w=p.gallery("addgalleryitem","id-format-bold",Pp,"tooltip",39,40,-1,!0,!0,function(){n("bold")}),s=p.gallery("addgalleryitem","id-format-italic",Qp,"tooltip",41,42,-1,!0,!0,function(){n("italic")}),x=p.gallery("addgalleryitem","id-format-underline",Rp,"tooltip",43,44,-1,!0,!0,function(){n("underline")}),K=
p.gallery("addgalleryitem","id-format-strike-through",Sp,"tooltip",45,46,-1,!0,!0,function(){n("strikeThrough")}),A=p.gallery("addcomboboxgalleryitem","id-format-fontname",mh,"tooltip",!1,!0,function(a){var c=b();if(c){var d=c[1];c[2].focus();a=parseInt(a.match(/\d+(?=\D*$)/));d.execCommand("fontName",!1,Sa[a]);e()}}),u=0;u<Sa.length;u++)A.comboboxgalleryitem("addcomboboxitem","id-font-name-"+u,Sa[u],"tooltip",296,297);A.comboboxgalleryitem("setselected","id-font-name-1");var B=-1,C=p.gallery("addcomboboxgalleryitem",
"id-format-fontsize",nh,"tooltip",!1,!0,function(a){var c=b();if(c){var d=c[1];c[2].focus();a=="id-ultra-small-font-size"?B=1:a=="id-very-small-font-size"?B=2:a=="id-small-font-size"?B=3:a=="id-medium-font-size"?B=4:a=="id-large-font-size"?B=5:a=="id-very-large-font-size"?B=6:a=="id-ultra-large-font-size"&&(B=7);d.execCommand("fontSize",!1,B);e()}});C.comboboxgalleryitem("addcomboboxitem","id-ultra-small-font-size",oh,"tooltip",246,247);C.comboboxgalleryitem("addcomboboxitem","id-very-small-font-size",
ph,"tooltip",248,249);C.comboboxgalleryitem("addcomboboxitem","id-small-font-size",qh,"tooltip",250,251);C.comboboxgalleryitem("addcomboboxitem","id-medium-font-size",rh,"tooltip",252,253);C.comboboxgalleryitem("addcomboboxitem","id-large-font-size",sh,"tooltip",254,255);C.comboboxgalleryitem("addcomboboxitem","id-very-large-font-size",th,"tooltip",256,257);C.comboboxgalleryitem("addcomboboxitem","id-ultra-large-font-size",uh,"tooltip",258,259);C.comboboxgalleryitem("setselected","id-medium-font-size");
p.gallery("addgalleryitem","id-format-increase-font-size",Tp,"tooltip",286,287,-1,!0,!0,function(){var a=b();if(a){var c=a[1],a=a[2];a.focus();B<1&&(a.addClass("kbb-default-font-size"),B=c.queryCommandValue("fontSize"),a.removeClass("kbb-default-font-size"));B<7&&(B++,c.execCommand("fontSize",!1,B));e()}});p.gallery("addgalleryitem","id-format-decrease-font-size",Up,"tooltip",196,197,-1,!0,!0,function(){var a=b();if(a){var c=a[1],a=a[2];a.focus();B<1&&(a.addClass("kbb-default-font-size"),B=c.queryCommandValue("fontSize"),
a.removeClass("kbb-default-font-size"));B>1&&(B--,c.execCommand("fontSize",!1,B));e()}});var z=p.gallery("addgalleryitem","id-format-superscript",Vp,"tooltip",49,50,-1,!0,!0,function(){n("superscript")}),E=p.gallery("addgalleryitem","id-format-subscript",Wp,"tooltip",47,48,-1,!0,!0,function(){n("subscript")}),u=[[0,0,0],[255,255,255],[0,255,255],[127,219,255],[57,204,204],[0,116,217],[0,0,255],[0,0,128],[0,255,0],[46,204,64],[128,128,0],[61,153,112],[0,128,128],[0,128,0],[0,31,63],[255,255,0],[255,
220,0],[255,165,0],[255,133,27],[255,65,54],[255,0,0],[133,20,75],[240,18,190],[177,13,201],[128,0,128],[221,221,221],[192,192,192],[170,170,170],[128,128,128],[17,17,17]],I=p.gallery("addcolorpickergalleryitem","id-format-textcolor",vh,"tooltip",Cd,Dd,u,!1,function(a){var c=b();c&&(c[1].execCommand("foreColor",!1,"#"+(16777216+(a[2]|a[1]<<8|a[0]<<16)).toString(16).slice(1)),e())}),F=p.gallery("addcolorpickergalleryitem","id-format-background-color",Dj,"tooltip",Cd,Dd,u,!1,function(a){var c=b();c&&
(c[1].execCommand("backColor",!1,"#"+(16777216+(a[2]|a[1]<<8|a[0]<<16)).toString(16).slice(1)),e())});p.gallery("addgalleryitem","id-format-remove-format",Xp,"tooltip",55,56,-1,!0,!0,function(){n("removeFormat")});p=c.toolbar("addpopupbutton","id-paragraph",d?Yp:Zp,"tooltip",d?302:-1,d?302:-1,-1,!0,fa(),i);m.push(p[0][0]);var p=p[1],N=p.gallery("addgalleryitem","id-format-justify-left",$p,"tooltip",278,279,-1,!0,!0,function(){n("justifyLeft")}),J=p.gallery("addgalleryitem","id-format-justify-center",
aq,"tooltip",280,281,-1,!0,!0,function(){n("justifyCenter")}),H=p.gallery("addgalleryitem","id-format-justify-right",bq,"tooltip",282,283,-1,!0,!0,function(){n("justifyRight")}),y=p.gallery("addgalleryitem","id-format-justify-full",cq,"tooltip",284,285,-1,!0,!0,function(){n("justifyFull")});p.gallery("addgalleryitem","id-format-indent",dq,"tooltip",274,275,-1,!0,!0,function(){h("indent")});p.gallery("addgalleryitem","id-format-outdent",eq,"tooltip",276,277,-1,!0,!0,function(){h("outdent")});var Q=
p.gallery("addgalleryitem","id-format-ordered-list",fq,"tooltip",270,271,-1,!0,!0,function(){n("insertOrderedList")}),Y=p.gallery("addgalleryitem","id-format-unordered-list",gq,"tooltip",272,273,-1,!0,!0,function(){n("insertUnorderedList")}),p=c.toolbar("addpopupbutton","id-table",d?hq:iq,"tooltip",d?304:-1,d?304:-1,-1,!0,fa(),i);m.push(p[0][0]);p=p[1];p.gallery("addgalleryitem","id-insert-table",Ej,"tooltip",218,219,-1,!0,!0,function(){var c=b();if(c){var d=c[0],k=c[1],f=c[2],t=Yg(f[0],d,k),g=i,
n=i,q=i,c="<form>";c+='<div><label><span style="display:inline-block;width:125px">'+jq+'</span><input class="kbb-rowcount" type="number" min="1" value="3"></label></div>';c+='<div><label><span style="display:inline-block;width:125px">'+kq+'</span><input class="kbb-columncount" type="number" min="1" value="2"></label></div>';c+='<input type="submit" class="kbb-invisible" />';c+="</form>";var h={};h[Da]=function(){for(var a=Math.min(32E3,Math.max(1,n.val())),c=Math.min(256,Math.max(1,q.val())),b='\n<table style="border-collapse:collapse;border-width:0.07em;border-style:solid;border-color:inherit;padding:0.2em 0.4em;min-width:4em;min-height:1.5em;text-align:left;vertical-align:top">\n<tbody style="border-width:inherit;border-style:inherit;border-color:inherit;padding:inherit;min-width:inherit;min-height:inherit;text-align:inherit;vertical-align:inherit">\n',
l=0;l<a;l++){b+='<tr style="border:inherit;padding:inherit;min-width:inherit;min-height:inherit;text-align:inherit;vertical-align:inherit">\n';for(var h=0;h<c;h++)b+='<td style="border:inherit;padding:inherit;min-width:inherit;min-height:inherit;text-align:inherit;vertical-align:inherit"></td>\n';b+="</tr>\n"}b+="</tbody>\n</table>\n";g.dialog("close");f.focus();bh(f[0],t,d,k);Ya(function(){Kh(b,d,k);e()})};h[eb]=function(){g.dialog("close")};g=a('<div class="kbb-insert-table-dialog" />').html(c).dialog({modal:!0,
closeOnEscape:!1,resizable:!1,buttons:h,title:Ej,width:230,position:Mb?{my:"center top",at:"center top"}:{my:"center",at:"center"},open:function(){a(this).parent(".ui-dialog").find("*").myDisableSelection(!1)},close:function(){a(this).dialog("destroy")}});n=g.find(".kbb-rowcount");q=g.find(".kbb-columncount");g.find("form").bind("submit",function(){setTimeout(function(){h[Da]()},50);return!1})}});var aa=p.gallery("addgalleryitem","id-delete-table",lq,"tooltip",314,315,-1,!0,!0,function(){v().t.remove();
e()}),P=p.gallery("addgalleryitem","id-insert-table-row-before",mq,"tooltip",306,307,-1,!0,!0,function(){var c=v();if(c.ri>=0){for(var d='<tr style="border:inherit;padding:inherit;min-width:inherit;min-height:inherit;text-align:inherit;vertical-align:inherit">\n',b=0;b<c.cc;b++)d+='<td style="border:inherit;padding:inherit;min-width:inherit;min-height:inherit;text-align:inherit;vertical-align:inherit"></td>\n';d+="</tr>\n";a(d).insertBefore(c.r);e()}}),T=p.gallery("addgalleryitem","id-insert-table-row-after",
nq,"tooltip",306,307,-1,!0,!0,function(){var c=v();if(c.ri>=0){for(var d='<tr style="border:inherit;padding:inherit;min-width:inherit;min-height:inherit;text-align:inherit;vertical-align:inherit">\n',b=0;b<c.cc;b++)d+='<td style="border:inherit;padding:inherit;min-width:inherit;min-height:inherit;text-align:inherit;vertical-align:inherit"></td>\n';d+="</tr>\n";a(d).insertAfter(c.r);e()}}),sa=p.gallery("addgalleryitem","id-delete-table-row",oq,"tooltip",310,311,-1,!0,!0,function(){var a=b();if(a){var c=
a[0],d=a[1],a=a[2];a.focus();var k=Yg(a[0],c,d);v().r.remove();e();k.end=k.start;bh(a[0],k,c,d)}}),R=p.gallery("addgalleryitem","id-insert-table-col-before",pq,"tooltip",308,309,-1,!0,!0,function(){var c=v();c.ci>=0&&(a('<td style="border:inherit;padding:inherit;min-width:inherit;min-height:inherit;text-align:inherit;vertical-align:inherit"></td>\n').insertBefore(c.t.find("td:nth-of-type("+(c.ci+1)+")")),e())}),ia=p.gallery("addgalleryitem","id-insert-table-col-after",qq,"tooltip",308,309,-1,!0,!0,
function(){var c=v();c.ci>=0&&(a('<td style="border:inherit;padding:inherit;min-width:inherit;min-height:inherit;text-align:inherit;vertical-align:inherit"></td>\n').insertAfter(c.t.find("td:nth-of-type("+(c.ci+1)+")")),e())}),ka=p.gallery("addgalleryitem","id-delete-table-col",rq,"tooltip",312,313,-1,!0,!0,function(){var a=v();if(a.ci>=0){var c=b();if(c){var d=c[0],k=c[1],c=c[2];c.focus();var f=Yg(c[0],d,k);a.t.find("td:nth-of-type("+(a.ci+1)+")").remove();e();f.end=f.start;bh(c[0],f,d,k)}}});c.parent().find(".kbb-popup-frame *").myDisableSelection(!1);
return[a(m),a(o),j]}function Qx(a,d){var b=a==i==(d==i);a!=i&&d!=i&&(b=a.eb==d.eb&&a.Ua==d.Ua&&a.Sc==d.Sc);return b}function Ze(a,b){var l=1,e=1,f=ua*Math.max(1,b),f=-1+2*Math.min(f,a.c)/f,g=1-2*Math.min(4,a.l)/4,h=d.B==La?3:1,n=a.l==0&&d.ga!=0;d.Za==1?(l=1+(f>0?va:wa)*f,e=1+(f>0?xa:ya)*f):d.Za==2&&(l=1+(g>0?h*va:wa)*g,e=1+(g>0?h*xa:ya)*g);n&&(l*=Aa,e*=Ba);return{r:l,f:e}}function wh(c,b,l){if(typeof c.i[b].ew==="number"&&typeof c.i[b].eh==="number")return{w:c.i[b].ew,h:c.i[b].eh};var e=c.i[b].k;
c.i[b].k="";var f=new o(c,b,!1,0,0);c.i[b].k=e;var g=f.sa(),e=Ze(c.i[b],l),h=e.f,n=d.na>0&&(f.ba.length>0||f.Z&&f.Z.length>64),l=g*Math.round(Ea*h),j=f.Pb(),e=16+g*Math.round(Ca*e.r),g=a('<div class="screenshotlayer itemtext" style="width:'+g*Math.round(h*(n?qa:pa))+'px;text-align:center"></div>'),j=a('<div style="font-family:'+j+";font-size:"+l/100+'em;line-height:111%;border-radius:4"></div>').appendTo(g),v=a('<div style="padding:0.5em 0.75em 0.65em 0.75em;display:inline-block"></div>').appendTo(j);
f.html?Ya(function(){v.html(f.html)}):v.text(f.text);Za(v,!1);ef(v,f,!1);var m=i;n&&(m=a('<div style="font-size:85%;padding:0.5em 0.75em;display:inline-block"></div>').appendTo(j),f.Z?Ya(function(){m.html(f.Z)}):m.text(f.ba),Za(m,!1));g.prependTo(a("body"));n=v.outerWidth();m&&(n=Math.max(n,m.outerWidth()));j=j.outerHeight();h=v.width();m&&(h=Math.max(h,m.width()));h==0&&(n=0.75*l,j=0.25*l);l={w:n,h:j+e};g.remove();c.i[b].ew=l.w;c.i[b].eh=l.h;return l}function oe(a,d,b){var e=C.find(".kmappage"),
d=typeof d==="undefined"?e.scrollLeft():d,b=typeof b==="undefined"?e.scrollTop():b,f=e.width(),e=e.height(),g=C.find(".ikmap"),h=g.width(),g=g.height(),n=0,j=0,j=n=0;d!=Fj&&(sq=d>Fj?0.1:0.9);b!=Gj&&(tq=b>Gj?0.1:0.9);Fj=d;Gj=b;for(var v=0;v<a.length;v++)n=parseInt(a[v].attr("width")),j=parseInt(a[v].attr("height")),n=Math.max(0,Math.min(h-n,d-parseInt(sq*(n-f)))),j=Math.max(0,Math.min(g-j,b-parseInt(tq*(j-e)))),a[v].css({left:n+"px",top:j+"px"});return{l:n,t:j}}function Kf(c){function b(){var c=0;
h.length>0&&(f.width(r+100),r=Math.max(1+h.last().position().left+h.last().outerWidth(!0),v));f.width(r);e.css("overflow-x",r>v?"scroll":"hidden");for(var d=[],c=0;c<h.length;c++)d.push(a(h[c]).height()-a(h[c]).find(".kbb-tableviewheader").outerHeight(!0));for(c=0;c<h.length;c++)a(h[c]).find(".kbb-tableviewbody").height(d[c]);Lh()}function l(a){e.css("overflow-x")=="scroll"&&r>=v&&parseInt(e.scrollLeft())!=parseInt(u-v)?e.animate({scrollLeft:u-v},d.T==0?0:ac,"smoothEasing",a):typeof a!=="undefined"&&
a()}Mh(0);var e=C.find(".kmappage"),f=C.find(".ikmap"),g=C.find(".textlayer"),h=g.find(".kbb-tableviewcolumn"),n=g.find(".kbb-tableviewcelltext"),j=n.find(".kbb-iconbtn"),v=e.width(),m=0;g.css({"-ms-transform":"","-moz-transform":"","-webkit-transform":"",transform:"","-ms-transform-origin":"","-moz-transform-origin":"","-webkit-transform-origin":"","transform-origin":""});if(j.length>0){var o=18*d.D,g=2*d.D,m=0.5*(Math.pow(2,0.5)-1)*o+1,p=4*d.D;j.each(function(){a(this).iconbtn("setwidth",o)});j.css({"border-width":g+
"px",padding:m+"px","margin-bottom":p+"px","margin-right":p+"px","float":"left"})}h.css("font-size",13*d.D+"px");n.width(Math.min(0.5*v-30*d.D,325*d.M*d.D));for(var u=1,m=0;m<h.length;m++)u+=a(h[m]).outerWidth(!0);var r=Math.max(u,v),n=f.width();Mh(0);r<n&&c?l(b):(b(),c&&l());if(d.j)d.j.Bc=u,d.j.Ac=f.height();Lh()}function gb(c,b,l,e,f,g,h){if(!(d.j==i||d.L==i||!C.find(".kmappage").is(":visible")&&!l))if(a(".quickaccesstoolbar").removeClass("kbb-small"),a(window).width()<a(".quickaccesstoolbar").width()&&
a(".quickaccesstoolbar").addClass("kbb-small"),d.B==Ia)Mh(0),Kf(!1),d.j.Ff(),td(d.j),Lh(),a(".quickaccesstoolbar, .closetoolbar").css("right","0px");else if(d.B==La)if(f||Af==i)Fd!=i&&clearTimeout(Fd),kf(ba),Fd=setTimeout(function(){Fd=i;d.j.rf(d.L);d.j.sd(d.L);d.j.Rf();d.fa=d.L;lf()},1);else{var n=C.find(".ikmap"),f=n.width(),n=n.height();pb.aspect=f/n;pb.updateProjectionMatrix();$a.setSize(f,n);$a.render(Jb,pb)}else Mh(0),Fd!=i&&(clearTimeout(Fd),Lh()),Fd=setTimeout(function(){var f=C.find(".kmappage"),
t=C.find(".ikmap");Fd=i;d.j.og(d.L,d.fa,c!=0||e);var n=t.width(),j=t.height();d.j.width>n&&t.width(d.j.width);d.j.height>j&&t.height(d.j.height);d.j.gd&&f.css("overflow-x","scroll");d.j.hd&&f.css("overflow-y","scroll");d.j.sd(d.L);var t=f.width(),n=f.height(),j=Math.max(0,d.j.width-t),m=Math.max(0,d.j.height-n);if(b>=0&&typeof d.j.F[b]!=="undefined"){var u=d.j.q[d.j.F[b]];d.j.Kb=f.scrollLeft();d.j.Bb=Math.min(j,Math.max(0,u.O-t/2));d.j.Lb=f.scrollTop();d.j.Cb=Math.min(m,Math.max(0,u.N-n/2))}else if(b==
-2)d.j.Kb=f.scrollLeft(),d.j.Bb=Math.min(j,Math.max(0,(d.j.width-t)/2)),d.j.Lb=f.scrollTop(),d.j.Cb=Math.min(m,Math.max(0,(d.j.height-n)/2));else if(b==-3&&typeof h!=="undefined")d.j.Kb=f.scrollLeft(),d.j.Bb=Math.min(j,Math.max(0,h.x-t/2)),d.j.Lb=f.scrollTop(),d.j.Cb=Math.min(m,Math.max(0,h.y-n/2));t=C.find(".canvas9").width();n=C.find(".canvas9").height();j=Math.floor(Math.max(t,1.75*f.width()));m=Math.floor(Math.max(n,1.75*f.height()));if(t!=j||n!=m)C.find(".canvas1").attr("width",j).attr("height",
m),C.find(".canvas5").attr("width",j).attr("height",m),C.find(".canvas9").attr("width",j).attr("height",m);(e||t!=j||n!=m||Sb.toString()!=uq.toString()||Ge!=vq)&&d.j.he();c==0||d.T==0?d.j.Nc(1,1E3,l,!1):d.j.animate(c,l,g);d.fa=d.L;Lh();a(".quickaccesstoolbar, .closetoolbar").css("right",f[0].offsetWidth-f[0].clientWidth+"px")},1)}function wq(){setTimeout(function(){C.find("div:not([unselectable])").filter(".kbb-sidegallerybar,.kbb-sidegallerybar *,.kbb-sidegalleryheader,.kbb-sidegalleryheader *,div:not(.id-textnote-gallery,.id-search-items-gallery)>.kbb-sidegallerybody,.kbb-sidegallerytoolbar,.kbb-sidegallerytoolbar *,.kbb-gallery-section>a,.kbb-gallery-section>a *,.kbb-gallery-item,.kbb-gallery-item *,.quickaccesstoolbar,.quickaccesstoolbar *,.kbb-tabbed-dialog-header,.kbb-tabbed-dialog-toolbar,.kbb-tabbed-dialog-toolbar *,.kbb-tabbed-dialog-tabs,.kbb-tabbed-dialog-tabs *,.itemtoolbar,.itemtoolbar *,.relationtoolbar,.relationtoolbar *,.newrelationbar,.newrelationbar *,.itemtext,.kbb-tableviewcolumn,.kbb-selector,.kbb-selector *,canvas,.itemselector,.relationselector,.editoverlay").myDisableSelection(!1)},
500)}function jg(c,b,l){function e(){Uc(c,i,i,i,g,h,i,i,-1,"","","","",ug,function(){function e(){d.B==Ia?C.find(".textlayer").find(".kbb-tableviewcell").each(function(){var c=a(this).data("pid"),c=d.j.q[d.j.F[c]];c.Pa=typeof c.zb!=="undefined"?c.zb:c.Q>=0&&typeof d.j.da[c.Q]!=="undefined"&&d.j.da[c.Q].templateName.length>0&&d.j.da[c.Q].templateName.charAt(0)=="#";c.Pa?a(this).addClass("kbb-item-hidden"):a(this).removeClass("kbb-item-hidden")}):d.j.Nc(0,1E3,!1,!0)}n.zb?h>=0?(d.Hb[h]="",b&&e(),l&&
l()):B({action:"getitem",id:c,database:O},function(a){a.ti>=0&&(d.Hb[a.ti]="");b&&e();l&&l()}):(b&&e(),l&&l())})}var f="",g="#",h=-1,n={};typeof d.j.F[c]!=="undefined"&&typeof d.j.q[d.j.F[c]]!=="undefined"?n=d.j.q[d.j.F[c]]:n.re=Eb.data("pid")>=0?Eb.val():"";n.zb=!0;typeof n.re==="undefined"?n.Q>=0&&typeof d.j.da[n.Q]!=="undefined"&&(f=d.j.da[n.Q].templateName):f=n.re;if(f.length>0)f.charAt(0)=="#"?(g=f.substr(1),n.zb=!1):g="#"+f;n.re=g;if(g=="")e();else{var j=!1;a.each(d.j.da,function(a,c){if(c.templateName.toLowerCase()==
g.toLowerCase())return j=!0,h=parseInt(a),!1});j?e():I({action:"searchtemplate",search:g,maxsearchresults:1,templatetype:0,database:O},function(a){a.n==0&&a.h.length>0&&a.h[0].v.toLowerCase()==g.toLowerCase()&&(h=a.h[0].i);e()})}}function xq(c,b,l,e,f,g,h,n,j,v,m,o,p,u,r,q,w,s){d.Bf();c=parseInt(c);b=parseInt(b);e=parseInt(e);f=parseInt(f)!=0;d.ma=parseInt(h)!=0;d.xa=parseInt(n)!=0;d.ta=parseInt(j)!=0;d.va=parseInt(v)!=0;d.ua=parseInt(m)!=0;d.Oa=parseInt(o)!=0;af=parseInt(w)!=0;d.D=parseFloat(p);
d.M=parseFloat(u);d.rotation=parseInt(r);d.$=parseInt(q);d.Xa=1-(1-dc)*d.$/100;d.K=1-(1-fc)*d.$/100;Oe(parseInt(s)!=0);Hb&&Hb.galleryitem("setselected",d.H);Fb&&Fb.toolbarbtn("setselected",d.H);Gb&&Gb.toolbarbtn("setselected",!d.H);xd(d.D,d.M,d.rotation,d.$);e<0&&(e=Xb);af&&(a(".kbb-sidegallery,.quickaccesstoolbar").hide(),a("body,.kmap,.ikmap").css({"background-color":"transparent"}),Eg=!0);c?d.load(c,b,"",e,f,!1,xe+1):d.load(P,-1,l,e,f,!1,xe+1)}function yq(c){var d=!1,c={action:"repository",id:c,
preview:0,database:O};U()?(d=Oc(c),d.r==0&&Oc({action:"shellexecute",file:d.f}),d=!0):qb()?(Pc(c,function(c){c=a.parseJSON(c);c.r==0&&Pc({action:"launchfile",file:c.f},fa())}),d=!0):Bb()?(dd(c,function(c){c=a.parseJSON(c);c.r==0&&dd({action:"launchfile",file:c.f},fa())}),d=!0):Cb()&&(fd(c,function(c){c=a.parseJSON(c);c.r==0&&fd({action:"launchurl",file:c.f},fa())}),d=!0);return d}function Hj(c,d,l){function e(c,b){b.r==0&&Ya(function(){a(g).attr("src",c+b.f).on("load",function(){var c=a(this).contents().find("body");
c.length==0&&(c=a(this));c.unbind("dblclick.kmEvents").bind("dblclick.kmEvents",function(){yq(d);return!1})}).appendTo(f);l=="f"&&f.panzoom({})})}a(".kbb-docheader > a.active").removeClass("active");c&&c.addClass("active");var f=a("#doccontent").empty().data("rid",d),g;l=="f"?(f.addClass("noscroll"),g="<img>"):(f.removeClass("noscroll"),g='<iframe frameborder="0"></iframe>');c={action:"repository",id:d,preview:1,database:O};U()?(c=Oc(c),e("file://",c)):qb()?Pc(c,function(c){e("ms-appdata:///temp/",
a.parseJSON(c))}):Bb()?dd(c,function(c){e("file:///",a.parseJSON(c))}):Cb()?fd(c,function(c){e("file:///",a.parseJSON(c))}):(a(g).attr("src",b.baseurl+nc+b.scriptextension+"?action=repository&id="+d+"&preview=1&database="+O).on("load",function(){var c=a(this).contents().find("body");c.length==0&&(c=a(this));c.unbind("dblclick.kmEvents").bind("dblclick.kmEvents",function(){if(b.baseurl==""){var a=window.location.href,c=a.lastIndexOf("/");c>=0&&window.open(a.substr(0,c+1)+nc+b.scriptextension+"?action=repository&id="+
d+"&preview=0&database="+O,"_blank","")}else window.open(b.baseurl+nc+b.scriptextension+"?action=repository&id="+d+"&preview=0&database="+O,"_blank","");return!1})}).appendTo(f),l=="f"&&f.panzoom({}))}function Sc(c,k,l){function e(c){if(c&&c.r==0){for(var b=0,k,f,t=[],g=0,h=0,b=0;b<c.a.length;b++)k=c.a[b],f=new Image,f.src="data:image/png;base64,"+k.p,t.push(f),k.r==l&&(h=b);var j=function(){if(g<100)for(b=0;b<t.length;b++)if(!t[b].complete){g++;setTimeout(j,10);return}a(".kbb-docheader>a").remove();
var d=a(".kbb-docheader");for(b=0;b<t.length;b++){var k="";f=t[b];if(typeof f.src!=="undefined"&&typeof f.src!=="unknown"&&f.width>0&&f.height>0&&f.complete)var l=Math.min(64/f.width,64/f.height),k='<img width="'+Math.round(f.width*l)+'" height="'+Math.round(f.height*l)+'" src="'+f.src+'"></img>';l=Ya(function(){return a('<a href=""><div class="tabbarimg">'+k+'</div><div class="tabbartext">'+c.a[b].n+"</div></a>").data("aid",c.a[b].a).data("rid",c.a[b].r).data("ft",c.a[b].f).click(function(){Hj(a(this),
a(this).data("rid"),a(this).data("ft"));return!1}).appendTo(d)});b==h&&l.addClass("active")}a("#doccontent").width(a("#doccontainer").width()).height(Math.max(0,a("#doccontainer").height()-a(".kbb-docheader").height()))};setTimeout(j,50);Hj(i,c.a[h].r,c.a[h].f);zb=a(Yf("html","body"));zb.length>0&&(Wg=zb.scrollLeft(),Xg=zb.scrollTop(),zb.animate({scrollLeft:0,scrollTop:0},0));a("html, body").addClass("noscroll-attachments");k=a(window).width();var M=a(window).height();a("body").width(k).height(M);
a("#docframe").show();a("#doccontainer").width(k).height(M);a("#doccontent").width(a("#doccontainer").width()).height(Math.max(0,a("#doccontainer").height()-a(".kbb-docheader").height()));a("#doccontainer").css({top:"0px",left:k+"px"}).animate({left:0},d.T==0?0:1E3,"smoothEasing",function(){a(".ikmap,.kbb-sidegallery,.quickaccesstoolbar").addClass("invisible");a("#doccontainer").css({left:"0px",right:"0px",top:"0px",bottom:"0px",width:"",height:""});cg()})}else cg()}xh=!1;d.j.Ga(k?-1:c,k?c:-1,!0,
!1,!0);d.j.Hc(i,i,!1);a.fn.C.close();bg(ba);a("#docframe").remove();Ya(function(){a('<div id="docframe"></div>').appendTo(a("body")).html('<div id="doccontainer"><div class="kbb-docheader"><div class="kbb-closebtn"></div><div class="kbb-attachments-toolbar"></div></div><div id="doccontent"><iframe src="" frameborder="0"></iframe></div></div>')});if(d.H){var f=a("<div></div>").appendTo(a(".kbb-attachments-toolbar")).toolbar({}),g=function(){var c=[],d=a(".kbb-docheader>a");kf(ba);for(var b=0;b<d.length;b++){var k=
a(d[b]).data("aid");k>=0&&c.push(k)}c={action:"updateattachments",sortedids:c,undotext:zq,undoproperties:kb(),database:O};B(c,function(){xh=!0;lf()})};f.toolbar("addtoolbarbutton","id-move-left",Aq,"tooltip",4,4,-1,!1,function(){var c=a(".kbb-docheader>a"),d=a(".kbb-docheader>a.active");if(d.length>0){var b=c.index(d);b>0&&(a(c[b-1]).before(d),g())}},i);f.toolbar("addtoolbarbutton","id-move-right",Bq,"tooltip",6,6,-1,!1,function(){var c=a(".kbb-docheader>a"),d=a(".kbb-docheader>a.active");if(d.length>
0){var b=c.index(d);b<c.length-1&&(a(c[b+1]).after(d),g())}},i);f.toolbar("addtoolbarbutton","id-delete-attachment",Cq,"tooltip",55,55,-1,!1,function(){var c=a(".kbb-docheader>a.active");if(c.length>0){var d=c.data("aid");d>=0&&(d={action:"deleteattachment",id:d,undotext:Dq,undoproperties:kb(),database:O},kf(ba),B(d,function(){var d=a(".kbb-docheader>a"),b=d.index(c),k=i;b+1<d.length?k=a(d[b+1]):b-1>=0&&(k=a(d[b-1]));c.remove();k?Hj(k,k.data("rid"),k.data("ft")):a("#doccontent").empty();xh=!0;lf()}))}},
i);f.toolbar("addtoolbarbutton","id-open-attachment",Eq,"tooltip",27,27,-1,!1,function(){var c=a("#doccontent").data("rid");if(!yq(c))if(b.baseurl==""){var d=window.location.href,k=d.lastIndexOf("/");k>=0&&window.open(d.substr(0,k+1)+nc+b.scriptextension+"?action=repository&id="+c+"&preview=0&database="+O,"_blank","")}else window.open(b.baseurl+nc+b.scriptextension+"?action=repository&id="+c+"&preview=0&database="+O,"_blank","")},i)}f=a(".kbb-closebtn");f.toolbaricon({index:80,hilightindex:81,width:19,
height:19,color:"#FFF",border:!0,hover:i});f.bindMouseOrTouchEvent("click",function(){Df(1E3)});a("#docframe").find("*").myDisableSelection(!1);B({action:"attachments",id:c,isrelation:k?1:0,database:O},function(a){e(a)})}function Df(c){bg(ba);var b=a(window).width(),l=a(window).height();a("#docframe").addClass("noscroll");a(".ikmap,.kbb-sidegallery,.quickaccesstoolbar").removeClass("invisible");a("#doccontainer").width(b).height(l).css({right:"",bottom:""}).animate({left:b},d.T==0?0:c,"smoothEasing",
function(){a("body").css({width:"",height:""});a("html, body").removeClass("noscroll-attachments");zb&&zb.length>0&&zb.animate({scrollLeft:Wg,scrollTop:Xg},0);a("#docframe").remove();xh&&(wb={},d.load(P,-1,"",0,!1,!1,xe+1),U()&&Oc({action:"onitemmodified",i:H(),r:-1,search:"",setasroot:0}));cg()})}function md(c){c.indexOf("://")<0&&(c="http://"+c);var b="iframe";qb()&&(b="x-ms-webview");d.j.Hc(i,i,!1);a.fn.C.close();bg(ba);a("#docframe").remove();Ya(function(){a('<div id="docframe"></div>').appendTo(a("body")).html('<div id="doccontainer"><div id="docheader"><table><tr><td style="width: 100%;"><div id="tabbar"></div></td><td><div id="closebtn"></div></td></tr></table></div><div id="doccontent"><'+
b+' src="" frameborder="0"></'+b+"></div></div>")});var l=a("#closebtn");l.toolbaricon({index:80,hilightindex:81,width:19,height:19,color:"#FFF",border:!0,hover:i});l.bindMouseOrTouchEvent("click",function(){Df(1E3)});zb=a(Yf("html","body"));zb.length>0&&(Wg=zb.scrollLeft(),Xg=zb.scrollTop(),zb.animate({scrollLeft:0,scrollTop:0},0));a("html, body").addClass("noscroll-attachments");try{a("#doccontainer "+b).attr("src",c)}catch(e){}c=a(window).width();l=a(window).height();a("body").width(c).height(l);
a("#docframe").show();a("#doccontainer").width(c).height(l);a("#doccontent").width(a("#doccontainer").width()).height(Math.max(0,a("#doccontainer").height()-a("#docheader").height()));a("#doccontainer").css({top:"0px",left:c+"px"}).animate({left:0},d.T==0?0:1E3,"smoothEasing",function(){a(".ikmap,.kbb-sidegallery,.quickaccesstoolbar").addClass("invisible");a("#doccontainer").css({left:"0px",right:"0px",top:"0px",bottom:"0px",width:"",height:""});cg()})}function Yn(a,d){if(a=="")return-1;var b,e,f=
d.indexOf(a);if(a.length<(/[\u3400-\u9FBF]/.test(a)?1:3)&&f>=0)for(;f>=0;)if(b=!0,f>0&&(b=" ([{\u00ab\u00bb\"'\u201e\u201c\u2018\u2019\u201c\u201d".indexOf(d.charAt(f-1))>=0),e=!0,f<d.length-a.length&&(e=" ,.!?;:)]}\u00ab\u00bb\"'\u201c\u2018\u2019\u201c\u201d".indexOf(d.charAt(f+a.length))>=0),b&&e)break;else f=d.indexOf(a,f+a.length);return f}function nb(c,k,l,e){function f(k){var j=0;if(k.nodeType==3){var v=k.data.toLowerCase(),m,o,p=-1,u=i;for(h=0;h<g.length;h++)if(o=g[h],m=Yn(o.t,v),m>=0&&(p<
0||m<p))p=m,u=o;if(p>=0){j=k.splitText(p);j.splitText(u.t.length);v=u.c;m=v=a('<span class="autohilite" style="background-color:#'+("00"+v[0].toString(16)).slice(-2)+("00"+v[1].toString(16)).slice(-2)+("00"+v[2].toString(16)).slice(-2)+'"></span>');var r=function(){Kc(i);var c=a(this).data("pid");c!=P&&d.load(c,-1,"",Xb,!0,!1,xe+1);return!1};o=function(c){Kc(i);var d=this;a.fn.C.closedelayed=!1;setTimeout(function(){a.fn.C.closedelayed||q.call(d,c)},10);return!1};var q=function(k){if(!(typeof k.originalEvent!==
"undefined"&&typeof k.originalEvent.type!=="undefined"&&typeof k.originalEvent.pointerType!=="undefined"&&(k.originalEvent.type=="MSPointerOver"||k.originalEvent.type=="pointerover")&&k.originalEvent.pointerType!=="mouse"&&k.originalEvent.pointerType!==4)){var e=!1,f=C.find(".textselector"),k=a(this).closest("span"),g=a(this).is("a")?a(this):a(this).find("a:first"),t=g.data("pid");l&&f.is(":visible")&&f.data("pid")==t&&(e=!0);if(!e){a.fn.C.close();l?C.find(".textselector a").attr("href",g.attr("href")).data("pid",
t).show().unbind("click.kmEvents").bind("click.kmEvents",r):C.find(".textselector a").hide();e={left:0,top:0};c[0].ownerDocument&&c[0].ownerDocument.defaultView&&c[0].ownerDocument.defaultView.frameElement&&(e=a(c[0].ownerDocument.defaultView.frameElement).offset(),e.left-=a(c[0].ownerDocument).scrollLeft(),e.top-=a(c[0].ownerDocument).scrollTop());var n=f.parent().offset(),q=k.offset(),g=q.left-n.left+e.left-10,n=q.top-n.top+e.top-10,q=k.width()+20,h=k.height()+20;f.css({left:g+"px",top:n+"px",width:q+
"px",height:h+"px"}).show();f=k.offset().left+e.left+k.width();f=f-k.width()/2>a(window).width()/2&&f>a(window).width()-370;window.lastTooltipItemID=t;window.lastTooltipRelationID=-1;k.C({alignment:f?{body:"left",pointer:"right"}:{body:"right",pointer:"left"},url:b.baseurl+nc+b.scriptextension,action:"tooltip",diagram:d,openAttachments:Sc,openDocument:md,rootItemID:P,id:t,idfrom:-1,idto:-1,hOffset:11+e.left,vOffset:15-k.height()/2-e.top,searchEngines:Wd,fadeIn:d.T!=0,onOpenCallback:function(c){if(typeof c!==
"undefined"){var c=[jd(c.n)],c=ze(c),d=a(a.fn.C.obj).find(".tttext");nb(d,c,l,!1)}},database:O});a.fn.C.obj.mouseleave(function(c){d.lc(c)||a.fn.C.close()})}return!1}};l&&u.i>=0&&(m=a('<a href="" style="color:#000"></a>').appendTo(v).data("pid",u.i).click(e?o:r));e&&u.i>=0&&v.unbindMouseOrTouchEvent("mouseenter.kmEvents").bindMouseOrTouchEvent("mouseenter.kmEvents",o);m[0].appendChild(j.cloneNode(!0));k.parentNode.replaceChild(v[0],j);j=1}}else if(k.nodeType==1&&k.childNodes)for(u=0;u<k.childNodes.length;u++)u+=
f(k.childNodes[u]);return j}for(var g=[],h=0;h<k.length;h++)a.type(k[h])==="string"?g.push({t:k[h],c:[255,255,0],i:-1}):g.push(k[h]);c.each(function(){var c=this,d=a(this).find("span.autohilite");d.length>0&&(d.children("a").contents().unwrap(),d.contents().unwrap(),a(this).find("span.autohilite").remove(),Ya(function(){a(c).html(a(c).html())}))});c.each(function(){f(this)})}function rd(c){function b(d,k,l){var f=ff(k[0],k[1],k[2]),k=hf(f[0],0.4*f[1],100),d=kd(d).split(/[\n]/);a.each(d,function(){var d=
a.trim(this);if(d!=""&&(typeof c==="undefined"||a.inArray(d,c)>=0)){var b=k,d=d.toLowerCase(),f=d.indexOf("(");f>0&&(d=d.substring(0,f));d=d.replace(/^\s\s*/,"").replace(/\s\s*$/,"");d!=""&&e.push({t:d,c:b,i:l})}})}var l=0,e=[];tb&&tb.is(":visible")&&(l=id.val().toLowerCase().split(/[\s]+/),a.each(l,function(){var a=this.trim();a!=""&&e.push({t:a,c:[255,255,0],i:-1})}));if(e.length==0)if(d.B==Ia)C.find(".textlayer").find(".kbb-tableviewcell .kbb-tableviewcellheader .kbb-tableviewcelltext").each(function(){var c=
a(this).closest(".kbb-tableviewcellheader").data("ich"),d=a(this).closest(".kbb-tableviewcell").data("pid");b("<html>"+a(this).html()+"</html>",c,d)});else if(d.L!=i)for(l=0;l<d.L.i.length;l++){var f=[255,255,0],g=d.L.i[l].i;if(d.j&&d.j.q&&d.j.q.length>0){var h=d.j.F[g];typeof h!=="undefined"&&(h=d.j.q[h],typeof h!=="undefined"&&h&&(f=h.pa("ich")[0]))}b(d.L.i[l].n,f,g)}return e}function ze(c){var d=rd(c);d.length==0&&a.each(c,function(){d.push({t:this.toLowerCase(),c:[255,255,0],i:-1})});return d}
function yh(){if(d.B==Ia){bb=Dg();var a=$d();if(a>=0){Ic=[];for(var b=1;b<bb.length+1;b++)Ic.push(b);d.Fa=-1;d.ca=0;d.load(a,-1,"",200,!0,!1,xe+1)}}else d.load(P,-1,"",200,!0,!1,xe+1)}function Ij(c,b,l,e,f,g){if(d.B==Ia){var h=a('<div class="screenshotlayer"><div></div></div>'),n=h.children("div");C.find(".textlayer .kbb-tableviewcolumn").clone().appendTo(n);h.prependTo(a("body"));h.find(".kbb-iconbtn,.kbb-tableviewcolumnexpandbtn,.kbb-tableviewcolumnclosebtn").hide();h.find(".kbb-tableviewcell").removeClass("kbb-tableviewcell-selected kbb-tableviewcell-rootitem");
var j=h.width(),v=h.height(),m=0,o=0,p=j,u=v;typeof l!=="undefined"&&(m=Math.max(0,Math.min(l,j-1)));typeof e!=="undefined"&&(o=Math.max(0,Math.min(e,v-1)));typeof f!=="undefined"&&(p=Math.max(1,Math.min(f,j-m)));typeof g!=="undefined"&&(u=Math.max(1,Math.min(g,v-o)));n.css({left:-m+"px",top:-o+"px"});html2canvas(h[0],{onrendered:function(d){h.remove();if(c=="")b(d);else{var l=new Image;a(l).on("load",function(){b(l)}).attr("src",d.toDataURL(c))}},width:p,height:u})}else if(d.B==La)if($a&&Jb&&pb&&
$a.render(Jb,pb),l=C.find(".canvas6")[0],c=="")b(l);else{var r=new Image;a(r).on("load",function(){b(r)}).attr("src",l.toDataURL(c))}else{var q=d.j,j=q.width,v=q.height,o=m=0,p=j,u=v;typeof l!=="undefined"&&(m=Math.max(0,Math.min(l,j-1)));typeof e!=="undefined"&&(o=Math.max(0,Math.min(e,v-1)));typeof f!=="undefined"&&(p=Math.max(1,Math.min(f,j-m)));typeof g!=="undefined"&&(u=Math.max(1,Math.min(g,v-o)));af=!0;h=a('<div class="screenshotlayer"><div></div></div>');h.width(j).height(v);n=h.children("div").css({left:-m+
"px",top:-o+"px"});C.find(".itemtext").each(function(){var c=a(this),d=c.clone().appendTo(n),c=c.children("a:first"),d=d.children("a:first");d.height(c.height());d.css("background-image","none")});h.prependTo(a("body"));h.find(".itemtext .kbb-iconbtn").hide();html2canvas(h[0],{onrendered:function(d){h.remove();var l=a("<canvas></canvas>");l.attr("width",p).attr("height",u);l=l[0];q.he(l,function(){q.Pc(1E3,!1,!0,!1,l,m,o);af=!1;l.getContext&&l.getContext("2d").drawImage(d,0,0);if(c=="")b(l);else{var e=
new Image;a(e).on("load",function(){b(e)}).attr("src",l.toDataURL(c))}},m,o)},width:p,height:u})}}function Fq(c){function b(){for(var a=0;a<d.L.r.length;a++)typeof d.L.r[a].pt!=="undefined"&&delete d.L.r[a].pt,typeof d.L.r[a].cp!=="undefined"&&delete d.L.r[a].cp}var l=i,e='<form><div style="margin-top:2px; margin-bottom:5px;"><label>'+Gq+'&nbsp;&nbsp;<input class="kbb-resolution" type="number" min="10" max="200" value="'+Jj+'"> %</label></div><div>'+Hq+'</div><div><textarea class="kbb-code-snippet" readonly spellcheck="false" wrap="soft">'+
Nd('<html>\n<head>\n  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"><\/script>\n  <script nomodule src="https://unpkg.com/@google/model-viewer/dist/model-viewer-legacy.js"><\/script>\n  <style>\n    .hotspot {border-radius:6px; border:none; outline:none; background-color:#EEE; color:black; --min-hotspot-opacity:0.15; cursor:pointer; font-size:16px; text-decoration:underline; padding:0.5em 1em; position:absolute; transform:translate3d(-50%, 25%, 0);}\n    .hotspot:hover {opacity:1; background-color:#FFA;}\n    .hotspot:focus {opacity:1; outline:none; background-color:#FFA;}\n    model-viewer {background-color:black; width:100%; height:100%;}\n  </style>  \n</head>\n<body>\n  <model-viewer id="mv-diagram" src="KnowledgeBase.glb" camera-controls></model-viewer>\n  <script>\n    // this script is only needed to make hyperlinks work\n    var modelViewer = document.querySelector("#mv-diagram");\n    modelViewer.addEventListener ("load", function ()\n    {\n        var symbols = Object.getOwnPropertySymbols (modelViewer);\n        var sceneSymbol = symbols.find (function (symbol)\n        {\n            return (symbol.description === "scene");\n        });\n        var scene = modelViewer[sceneSymbol];\n        var n = 0;\n        scene.traverse (function (node)\n        {\n            if (node.name && (node.name.indexOf ("link-") == 0))\n            {\n                var nodeData = JSON.parse (atob (node.name.substring (5)));\n                var hotspot = document.createElement ("button");\n                var url = document.createElement ("a");\n                url.setAttribute ("href", nodeData.url);\n                hotspot.textContent = url.hostname;\n                hotspot.slot = "hotspot-" + n++;\n                hotspot.classList.add ("hotspot");\n                var position = node.position.clone ();\n                position.set (nodeData.x, nodeData.y, nodeData.z);\n                hotspot.dataset.normal = hotspot.dataset.position = position.x + " " + position.y + " " + position.z;\n                modelViewer.appendChild (hotspot);\n                hotspot.addEventListener ("click", function ()\n                {\n                    window.open (nodeData.url, "_blank");\n                });\n            }\n        });\n    });\n  <\/script>\n</body>\n</html>')+
'</textarea></div><input type="submit" class="kbb-invisible" /></form>',f={};f[Da]=function(){var a=l.find(".kbb-resolution").val();a!=""&&(Jj=Math.max(10,Math.min(200,parseInt(a))));l.dialog("close");kf(ba);if(d.B!=La)Ke[d.B]=d.D,Le[d.B]=d.M,d.D=Ke[La],d.M=Le[La],b(),d.j.rf(d.L),d.j.sd(d.L);var e=new THREE.Scene,a=new THREE.Group,f={sc:!0};e.add(a);try{d.j.Ie(a,f,!0,d.Ja==2,Jj/100,function(){(new THREE.GLTFExporter).parse(e,function(a){if(d.B!=La)d.D=Ke[d.B],d.M=Le[d.B],b(),gb(0,-1,!1,!0,!1);lf();
if(c)download(a,c,"model/gltf-binary");else{for(var a=new Uint8Array(a),l="",e=0;e<a.length;e++)l+=String.fromCharCode(a[e]);a=btoa(l);l=fa();window.savefilecallback=l;B({action:"savefile",base64data:a,extension:"glb",mimetype:"model/gltf-binary"},l)}},{binary:!0,embedImages:!0})})}catch(g){if(d.B!=La)d.D=Ke[d.B],d.M=Le[d.B],b(),gb(0,-1,!1,!0,!1);lf()}};f[eb]=function(){l.dialog("close")};a.fn.C.close();l=a('<div class="kbb-export-3d-model-dialog" />').html(e).dialog({modal:!0,closeOnEscape:!1,resizable:!1,
buttons:f,title:Iq,width:400,position:Mb?{my:"center top",at:"center top"}:{my:"center",at:"center"},open:function(){a(this).parent(".ui-dialog").find("*").myDisableSelection(!1)},close:function(){a(this).dialog("destroy")}});l.find("form").bind("submit",function(){setTimeout(function(){f[Da]()},50);return!1})}var C=a(this),$a=i,pb=i,Jb=i,Na=i,Af=i,bf=new THREE.Raycaster,Jj=100,O=b.database,Pe="",Sb=[255,255,255],Ge="perspective",uq=Sb,vq=Ge,wc=1,kc=0,Jg=1,Ae=0,yf=1,z={},nf=[],of=[],zh=1,af=!1,Nf=
!1,Ah=i,P=-1,Bh="",bb=i,Ic=i,Of=-1,sd=!1,Nc=-1,Kj=!0,d=i,wb={},ec=i,Ie=i,Wa=i,Rb=i,ic=i,jc=i,Mc=i,Eg=!1,Ma=i,L=i,Xa=i,Wb=!1,ga=i,$b=!1,ib=i,ah=!1,cc=i,oc=i,Ib=!1,Fd=i,wd=i,zb=i,ho=0,io=0,Wg=0,Xg=0,Pf=!1,Kb=i,ad=i,na=i,Qa=i,Me=i,$c=-1,xc=-1,Ye="",ub=!1,Tb=i,Ac=!1,kh=i,qe=i,Ch=i,jh=i,hh="",ih="",Ke=[b.zoomfact,b.zoomfact,b.zoomfact],Le=[b.stretchfact,b.stretchfact,b.stretchfact],lo=[b.showcategories,b.showcategories,b.showcategories],mo=[b.shownotetag,b.shownotetag,b.shownotetag],no=[b.showdescriptiontag,
b.showdescriptiontag,b.showdescriptiontag],oo=[b.showmorerelationcount,b.showmorerelationcount,b.showmorerelationcount],po=[b.showhiddenrelationcount,b.showhiddenrelationcount,b.showhiddenrelationcount],Yb=i,bc=i,Te=i,If=i,yc=i,zc=i,on=i,pn=i,qn=i,rn=i,sn=i,tn=i,un=i,Gg=i,vn=i,wn=i,xn=i,yn=i,zn=i,An=i,Bn=i,Cn=i,Dn=i,En=i,Fn=i,Gn=i,qi=i,ri=i,si=i,ti=i,ui=i,vi=i,Vc=i,Jc=i,wi=i,In=i,Fg=i,xi=i,yi=i,zi=i,Ai=i,Hg=i,ae=i,Ee=i,vf=i,Bi=i,Wc=i,ro=i,Sg=i,Tg=i,Ug=i,fb=i,lc=i,Fe=i,Ln=i,Ci=i,Jn=i,Kn=i,Di=i,vd=
i,ce=i,Ei=i,Ka=i,Ri=i,Qf=i,Rf=i,Sf=i,Dh=i,Lj=i,Pi=i,Yd=i,Mj=i,Nj=i,Oj=i,Gd=i,Hd=i,ab=i,bd=i,ta=i,Hb=i,de=i,ee=i,fe=i,Fb=i,Gb=i,ge=i,he=i,ie=i,je=i,Pj=i,zf=i,Qj=i,ke=i,Ha=i,Gf=i,Zg=i,Fi=i,Ig=i,Mn=i,Gi=i,Hi=i,Ii=i,Ji=i,Ki=i,Li=i,He=i,Qi=i,be=i,wf=i,ud=i,xf=i,Nn=i,On=i,Pn=i,re=i,se=i,Se=i,Bc=i,Jq=i,Kq=i,Ab=i,Lb=i,Id=i,Rj=i,Cc=i,hb=i,Db=!0,Ne=i,Pg=i,Qg=i,Rg=i,Cf=i,Si=i,le=i,Qn=i,Rn=i,Sn=i,Tn=i,Un=i,Vn=i,tb=i,id=i,Je=i,Jd=i,Eb=i,hc=i,Vd=i,Lf=-1,ba="Please wait",Ll="Importing dataset %1 of %2",Zk="Importing image %1 of %2",
rg="Loading article %1 of %2",ai="Wikidata query is running, please wait",Zd="Loading image %1 of %2",Xh="Loading file %1 of %2",Sm="Loading note %1 of %2",Lq="Video capturing is running: %1%",Mq="Processing video data: %1%",jb="en",cn="en",Oa="en",to="Search",Xn="Select Related Item",Nq="Select Category",Kd="Items without Category",nn="There are no items in the selected category",Oq="Menu",Pq="M<br>e<br>n<br>u",Qq="Download<br>Database",Rq="Knowledge<br>Base",Sq="Edit<br>Diagram",Tq="Format<br>Diagram",
Uq="Search<br>Items",Vq="Items in<br>Category",Wq="Notes<br>on Item",Xq="Adjust<br>View",Yq="Navigate<br>in Diagram",Zq="Memorize<br>Items",$q="App<br>Settings",ar="Help<br>Assistant",Yk="Note",Ue="NOTES",ch=' on "',br="Knowledge Base",cr="Edit Diagram",dr="Format Diagram",Ni="Search Items",bo="Searching Items %1 to %2",er="Items in Category",fr="Adjust View",gr="Navigate in Diagram",hr="Help",ir="Edit<br>Item",jr="Wikipedia<br>Articles",kr="Insert<br>Images",lr="Edit<br>Attachments",mr="New<br>Item",
nr="New<br>Relation",or="Delete<br>Item",pr="Edit<br>Relation",Sj="Delete<br>Relation",qr="Copy<br>Item",rr="Cut<br>Item",sr="Paste<br>Item",tr="Undo<br>&nbsp;",ur="Redo<br>&nbsp;",vr="Reset<br>Position",wr="Reset all<br>Positions",nj="OK<br>&nbsp;",oj="Cancel<br>&nbsp;",Xp="Remove Format",Pp="Bold",Qp="Italic",Rp="Underline",Sp="Strike Through",Tp="Increase Font",Up="Decrease Font",Vp="Superscript",Wp="Subscript",Cj="Insert Hyperlink",Jp="Remove Hyperlink",Kp="Insert Horizontal Line",Lp="Spell Check",
Mp="HTML Source",fq="Numbered List",gq="List",dq="Indent",eq="Outdent",$p="Justify Left",aq="Justify Center",bq="Justify Right",cq="Justify Both",Hp="Insert Formula",Ej="Insert Table",lq="Delete Table",mq="Insert Row Above",nq="Insert Row Below",oq="Delete Row",pq="Insert Column Left",qq="Insert Column Right",rq="Delete Column",pj="As<br>Table",tj="Edit<br>Category",vj="Delete<br>Category",Vo="Name",Wo="Description",Xo="Hyperlink",rj="Category",op="Forward",pp="Backward",qp="Description",Yo="Hyperlink (must start with http(s)://, file://, ...):",
$o="Hyperlink to a diagram item",Zo="Open linked page in new browser window",sj="Category:",xr="Drag to<br>Endpoint",yr="Cancel<br>&nbsp;",zr="Create a new item",Ar="Copies the selected text into the edit control",Br="Automatically copies text when it is selected into the edit control",Cr="Closes the text notes window",Dr="Expands/collapses the text notes window",Tj="Shows the sidebar",Er="Pins the sidebar",Fr="Pins the Knowledge Base window",Gr="Pins the edit mode window",Hr="Pins the format diagram window",
Ir="Pins the search items window",Jr="Pins the items in category window",Kr="Pins the view mode window",Lr="Pins the diagram navigation window",Mr="Pins the help window",Nr="Synchronizes the text note window and the diagram",Or="Closes the sidebar",Pr="Closes the Knowledge Base window",Qr="Closes the edit mode window",Rr="Closes the format diagram window",Sr="Closes the search items window",Tr="Closes the items in category window",Ur="Closes the view mode window",Vr="Closes the diagram navigation window",
Wr="Closes the help window",Xr="SYNC",Mi="Start search",ao="Cancel search",Ng="Show all search results",co="Hide multiple search results",eo="Previous search",fo="Next search",bj="Already learned: %1%",cj="Item %1 of %2",Eo="Commit to memory only",$i="Memorize item",aj="Quiz item",Oo="Continue learning",No="<p>Do you want to continue the last exercise unit?</p>",Uj="Save changes",Dp="Delete notes",Vj='<p><span class="ui-icon ui-icon-alert" style="float: left; margin: 0 7px 25px 0;"></span>The notes on "%1" have been modified.</p><p>Do you want to save the changes?</p>',
Cp='<p><span class="ui-icon ui-icon-alert" style="float: left; margin: 0 7px 25px 0;"></span>Do you really want to delete the notes on</p><p>"%1"?</p>',Yr="About InfoRapid KnowledgeBase Builder",Zr="Keyboard Shortcuts",$r="Introduction to the KnowledgeBase Builder",as='If you\'re using the KnowledgeBase Builder for the first time, then please watch our following short introduction. It shows you the most important program functions in a quick run and hopefully arouses your interest in our wonderful application. You can also view this introduction at any time later via "Help Assistant" - "Introduction".',
bs="Start Introduction",cs='<p><span class="ui-icon ui-icon-alert" style="float: left; margin: 0 7px 25px 0;"></span>This command deletes all items from the Undo/Redo lists and removes empty space from the database. Do you want to continue?</p>',uj="Category name:",dp='<p><span class="ui-icon ui-icon-alert" style="float: left; margin: 0 7px 25px 0;"></span>Do you really want to delete the item category "%1" and reset all references to it?</p>',up='<p><span class="ui-icon ui-icon-alert" style="float: left; margin: 0 7px 25px 0;"></span>Do you really want to delete the relation category "%1" and reset all references to it?</p>',
bp="Edit item category",ep="Delete item category",sp="Edit relation category",vp="Delete relation category",Aq="Move<br>Left",Bq="Move<br>Right",Cq="Delete<br>Attachment",Eq="Open<br>Attachment",qd="Year",zg="Month",Ag="Week",Bg="Day",dn="Weekend",yd="Yes",zd="No",Da="OK",eb="Cancel",ml="Reset",gi="Save",ii="Send",To="Create new item",Uo="Edit item",np="Edit relation",Zn="more...",$n="less \u2039\u2039",ds="about_en.htm",es="shortcuts_en.htm",fs="Save View",gs="Update View",Wj="Name",hs="Save root item",
is="Set as initial view",bn="Insert Appointment",Um="Appointment for - Name:",Vm="Appointment for - Description:",Wm="Appointment for - Category:",Xm="Appointment Type - Name:",Ym="Appointment Type - Description:",Zm="Appointment Type - Category:",$m="Start Date / Time:",an="End Date / Time:",en="Start",fn="End",Dl="Insert Wikipedia Articles",wl="Search",xl="in",yl="Results",zl="Language Code",Al="en (English), de (German), fr (France)...",Bl="Download images for offline mode / printing",Cl="Overwrite items",
tl="Wikidata Import",ql="Enter SPARQL query",rl="create and test it here",sl="Example",Zh="Import Webpage",ol="URL",pl="The requested url was not found.",nl="Insert Images",bl="Open image file",cl="Take a photo",dl="Drop image files here",el="Paste image here (press Ctrl+V)",gl="Reduce image size to ",fl="Image size: ",hl=" pixel",al="Create new item",il="Alignment:",jl="Left",kl="Right",ll="With text",Kl="Import CSV Data",Hl="The first line contains item categories and data types",Il="Use item categories also as categories for the relations to the item",
El="Open CSV file",Fl="Drop CSV file here",Gl="or enter CSV data directly",od="or",Ul="Export CSV Data",Nl="Export names, descriptions and notes as pure text without HTML formatings",Ol="Additional item data:",Pl="Additional relation data:",kn="Name",ci="Description",di="Note",ei="URL",Ql="Forward name",Rl="Backward name",Sl="Description",Tl="Category",fi="Update Preview",Ml="Separator: ",Iq="Export 3D Model",Gq="Resolution",Hq="Embed 3D Model into your own website",Zl="Import XML Data",Vl="Open XML file",
Wl="Drop XML file here",Xl="or enter XML data directly",ki="Complex",$l="Simple",am="Attribute",hm="Insert Pseudocode",cm="Open Pseudocode file",dm="Drop Pseudocode file here",em="or enter Pseudocode directly",fm="Example",vg="Yes",rf="No",pm="Loop",qm="End",im="function CalcPrimeNumber (StartNumber) // calculates the prime number\n{\n\tcall CalcSquareNumber (3) // calculate the square number of 3\n\tif A > 0\n\t{\n\t\tA = A - 2\n\t\twhile A > 0\n\t\t{\n\t\t\tA = A - 1\n\t\t\tif (C > 0)\n\t\t\t{\n\t\t\t\tN = 0\n\t\t\t\tcontinue\n\t\t\t}\n\t\t\tB = B + 1\n\t\t}\n\t}\n\telse\n\t{\n\t\tB = B + 2\n\t\tswitch (MathType)\n\t\t{\n\t\t\tcase Algebra:\n\t\t\t\tC = C + 1\n\t\t\t\tbreak\n\t\t\tcase Statistics:\n\t\t\t\tD = D + 1\n\t\t\t\tbreak\n\t\t\tcase Arithmetic:\n\t\t\t\tE = E + 1\n\t\t\t\tbreak\n\t\t}\n\t}\n\n\tdo\n\t{\n\t\tA = A + 1\n\t}\n\twhile (A < 100)\n\n\tfor N = 0 To 100 Step 3\n\t{\n\t\tN = N + 2\n\t\tif (A > 0)\n\t\t{\n\t\t\tN = 10\n\t\t\tbreak\n\t\t}\n\t\tC = C + 2\n\t\tD = D + 2\n\t}\n\tA = 3\n\treturn\n}\n\nfunction CalcSquareNumber (Number)\n{\n\tSquareNumber = Number * Number // calculate the square number\n\tif SquareNumber > 5\n\t{\n\t\tSquareNumber = 0\n\t\treturn 3\n\t}\n\tSquareNumber = SquareNumber - 3\n\treturn SquareNumber\n}",
km="If",lm="Switch",li="While",nm="Do",om="For",mm="Default",rm="Function",jm="Return",mi="Call",xm="Insert Outlined Text",tm="Open Outlined Text File",um="Drop Outlined Text File here",vm="or enter Outlined Text directly",wm="Example",ym="Category1::Name 1(Description 1)\n\tCategory2::Name 2(Description 2)\n\t\tLine Category::Linie 1(Line Description 1)>>Category2::Name 3\n\tCategory2::Name 3(Description 3)\n\t\tLine Category::Linie 2(Line Description 2)>>Category2::Name 4\n\tCategory2::Name 4(Description 4)\n\t\tLine Category::Linie 3(Line Description 3)>>Category2::Name 5\n\tCategory2::Name 5(Description 5)\n\t\tLine Category::Linie 4(Line Description 4)>>Category2::Name 6\n\tCategory2::Name 6(Description 6)\n\t\tLine Category::Linie 5(Line Description 5)>>Category2::Name 2",
Rm="Analyze Text",Hm="Open text file for analysis",Im="Drop text file for analysis here",Jm="or enter text for analysis directly",Km="Insert Item Notes",Lm="Language in which the text is written",Bm="German",Cm="English",Dm="French",Em="Spanish",Fm="Italian",Gm="User defined",Mm="Additional stop words (separated by blanks)",Nm="Additional word endings (separated by blanks)",Om="Additional abbreviations (separated by blanks)",mn="Export as HTML Text Document",hn="Create Table of Contents",jn="Highlight Items",
Cg="Formatted with Images",ln="Numbered",Mo="Memorize items",yo="Memorize ",zo=" items of the current diagram in this exercise unit",Ao="Choose correct answer out of ",Bo=" answers",Co="This exercise unit should be started in <b>%1</b> day(s).",Jo="<b>%1</b> items should be repeated now.",Ko="<b>%1</b> more items should be repeated during the next 7 days.",Io="<b>%1</b> items have not been trained.",Lo="The diagram has been memorized to <b>%1%</b>.",Do="Also memorize items that are not waiting to learn",
Fo="Learn all items",Go="Learn only items with a text note",Ho="Learn only items without a text note",dj="Notes",ej="Description",vo="Exercise unit finished",uo="<p>Congratulations, you have successfully completed this exercise unit.</p><p>From %1 questions you have answered %2 correctly.</p><p>The learned items should be repeated in %3 day(s).</p>",xo="No items available for learning",wo="<p>The diagram does not contain items that can be learned.</p><p>In order that an item can be learned it must consist of a name and a description.</p><p>Item name and item description are alternately used as question and answer.</p>",
js="Settings",ks="Size of the user interface controls:",ls="Decrease [-]",ms="Increase [+]",ns="Reset [100%]",os="Save as Animated GIF video",ps="Depending on the video size, recording may take a long time and consume a huge amount of memory. Please start with small sizes. Depending on how powerful your device is, big videos may crash the app or take a long time to record.",qs="Video width in pixel",rs="Video height in pixel",ss="Rotation speed in percent",ts="Save as WebM video",jq="Row count",kq=
"Column count",Ip="Url",Op="Font",Np="Format<br>Font",Zp="Paragraph",Yp="Format<br>Paragraph",iq="Table",hq="Edit<br>Table",us="Undo",vs="Redo",Xj="Item",ws="Item Templates",Yj="Relation",xs="Relation Templates",ys="Insert",zs="Import / Export",As="Window",Zj="Diagram",Bs="Labels",Cs="Visible Diagram Section",Ds="Item Category Filter",Es="Relation Category Filter",Fs="Saved Views",Gs="Browse",Hs="Last Viewed",Is="Help Assistant",$j="Reduce Database Size",ak="New",lh="Edit",zp="Edit<br>Text",bk="Delete",
Js="Copy",Ks="Cut",Ls="Paste",Ap="Save note",Bp="Delete note",Ep="Undo",Fp="Redo",Ms="Actions",Ns="Highlight item names",Os="Analyze text",Ps="Create new item",Qs="Import Wikipedia article",Rs="Import Twitter tweets",Ss="Create new items automatically",Ts="Import Wikipedia articles automatically",Us="Import Twitter tweets automatically",Vs="Import Webpage when link is clicked",Ws="Hide on Click",Xs="End Hide on Click",Ys="Insert Wikipedia Articles",Zs="Wikidata Import",$s="Import Twitter Network",
at="Import Webpage",Bj="Insert Images",bt="Edit Attachments",ct="Appointment",dt="Pseudocode",et="Outlined Text",ft="Textanalysis",gt="Import CSV Data",ht="Export CSV Data",it="Import XML Data",jt="Export as Text Document",kt="New Item Template",lt="New Relation Template",mt="New",nt="Update",ot="Rename",pt="Delete",qt="Apply to Item",rt="New",st="Update",tt="Rename",ut="Delete",vt="Apply to Relation",ck="Color",vh="Text Color",mh="Font Name",nh="Font Size",wt="Shape",xt="Fit Image to Shape",yt="Symbols",
zt="Line Style",dk="Line Width",At="Arrows",Bt="Visible up to Level",Ct="Zoom",Ti="Distance",so="Column Width",Dt="Rotation",Et="Perspective",ek="Layout",Ft="Coloring",Gt="Item Transparency",Ht="Color Scheme",It="Color Scheme Offset",Jt="Invert Relation Colors",Dj="Background Color",Kt="Background Pattern",Lt="Full Screen",Mt="Show Diagram View",Nt="Show 3D View",Ot="Show Table View",Eh="Edit Mode",Pt="Browse Mode",Qt="Start rotating the diagram",Rt="Switch to Virtual Reality mode",St="Record a video of the rotating diagram",
Tt="Recording...",Ut="Stop the rotation",Vt="Reset Item Position",Wt="Reset all Item Positions",Xt="Expand Items",Yt="Show Cross Connections",Zt="Show Table Relations",$t="Text Orientation",au="Show all Labels",bu="Show Category Labels",cu="Show Note Labels",du="Show Description Labels",eu="Show More Item Count",fu="Show Hidden Item Count",gu="Show Item Shift",hu="Decrease Child Elements",iu="Mark Root Item",ju="Animate Transitions",ku="Shadows",lu="Color Gradient",mu="Highlight Labels",nu="Show all Items",
ou="Show all Relations",pu="Save View",qu="Update View",ru="Delete View",su="Browse Back",tu="Browse Forward",uu="About KnowledgeBase Builder",vu="Keyboard Shortcuts",wu="Intro",cf="Automatic",Cd="RGB Colors",Dd="Color Palette",xu="Solid Line",yu="Dotted Line",fk="Very thin",gk="Thin",hk="Medium",ik="Thick",jk="Very thick",zu="None",Au="Begin",Bu="End",Cu="Begin and End",Du="Level 1",Eu="Level 2",Fu="All Levels",oh="Ultra small",ph="Very small",qh="Small",rh="Medium",sh="Large",th="Very large",uh=
"Ultra large",Gu="Automatic",Hu="Circle",Iu="Rectangle",Ju="Rhombus",Ku="Hexagon",Lu="Triangle",Mu="Parallelogram",Nu="Trapezium",Ou="Mind Map<br>(curved lines)",Pu="Mind Map<br>(straight lines)",Qu="Mind Map radial<br>(straight lines)",Ru="Mind Map radial<br>(curved lines)",Su="Concept Map radial",Tu="Concept Map hierarchical",Uu="Hierarchical",Vu="Hierarchical Grouped",Wu="Hierarchical Grouped<br>(lines combined)",Xu="Grouped",Yu="Grouped<br>(lines combined)",Zu="1-Column Grouped",$u="1-Column Grouped<br>(lines combined)",
av="2-Columns Grouped",bv="2-Columns Grouped<br>(lines combined)",cv="Flowchart<br>(top -> bottom)",dv="Flowchart<br>(left -> right)",ev="Mind Map<br>(radial)",fv="Tree<br>(levelwise)",gv="Tree<br>(both sides)",hv="Tree<br>(relation direction)",iv="Spherical",jv="Same height",kv="Child count wise",lv="Item wise",kk="Level wise",mv="Parent wise",nv="Category wise",ov="To viewer",pv="Static",qv="Radial",rv="Greys",sv="Yellow - Green",tv="Yellow - Green- Blue",uv="Green - Blue",vv="Blue - Green",wv=
"Purple - Blue - Green",xv="Purple - Blue",yv="Blue - Purple",zv="Red - Purple",Av="Purple - Red",Bv="Orange - Red",Cv="Yellow - Orange - Red",Dv="Yellow - Orange - Brown",Ev="Purples",Fv="Blues",Gv="Greens",Hv="Oranges",Iv="Reds",Jv="Purple - Orange",Kv="Brown - Blue - Green",Lv="Purple - Red - Green",Mv="Purple - Yellow - Green",Nv="Red - Blue",Ov="Red - Grey",Pv="Red - Yellow - Blue",Qv="Spectral",Rv="Red - Yellow - Green",Sv="Accent",Tv="Dark",Uv="Paired",Vv="Pastel 1",Wv="Pastel 2",Xv="Set 1",
Yv="Set 2",Zv="Set 3",$v="Automatic",aw="None",bw="Perspective",cw="Squared",dw="Circles",ew="Triangles",fw="Max. Number of visible Items",gw="Max. Number of visible Levels",Tf="Max. Child Items in Level ",hw="Edit",iw="Browse",jw="Rotate",kw="VR",lw="Record",mw="Stop",nw="Diagram",ow="3D",pw="Table",Jl="Import CSV data",bm="Import XML data",sm="Insert Pseudocode",zm="Insert Outlined Text",Tm="Analyze Text",vl="Import Wikipedia articles",ul="Wikidata Import",lk="Add Wikidata Images to Items",gn="Insert Appointment",
qw="Apply Item Template",rw="Apply Relation Template",$k="Insert images",pf="New item",Fh="Delete item",gh="Cut item",ap="Edit item category name",cp="Delete item category",rp="Edit relation category name",tp="Delete relation category",hp="New note",gp="Delete note",fp="Edit note",ug="Edit item",mk="Edit item color",nk="Edit item text color",ok="Edit item font name",pk="Edit item font size",sw="Edit item shape",tw="Edit fit image to shape",uw="Select item symbols",qk="Hide item",Wn="New relation",
Uf="Delete relation",wp="Edit relation",rk="Edit relation color",sk="Edit relation text color",vw="Edit line style",tk="Edit line width",ww="Edit line arrows",xw="Edit relation visible up to level",kj="Move relation start point",pe="Move relation end point",Dq="Delete attachment",zq="Change attachment sequence",Vf="Edit diagram layout",uk="Edit item transparency",yw="Edit diagram coloring",zw="Edit color scheme",vk="Edit color scheme offset",Aw="Edit invert relation colors",wk="Edit diagram background color",
Bw="Edit diagram background pattern",Xi="Edit display mode",xk="Expand/Collapse Items",yk="Edit decrease child elements",zk="Edit mark root item",Ak="Edit show cross connections",Bk="Edit show table relations",Ck="Text orientation to viewer",Dk="Animate Transitions on/off",Ek="Edit max. number of visible items",Fk="Edit max. number of visible levels",cd="Edit max. child items in level ",Cw="Edit diagram shading",Dw="Edit color gradient",Ew="Edit highlight labels",Fw="Save View",Gw="Update View",Hw=
"Delete View",fj='Item "%1" learned',jj="Move item",kp="Reset item shift",Aj="Reset all item shifts",Wd=[["https://www.google.com/search?q=*u*","Google Web Search"],["https://www.google.com/search?q=site:en.wikipedia.org *u*","Wikipedia Search"],["https://www.google.com/books?q=*u*","Google Book Search"],["https://scholar.google.com/scholar?q=*u*","Google Scholar"],["https://www.google.com/images?q=*u*","Google Image Search"],["https://www.youtube.com/results?search_query=*u*","YouTube Video Search"],
["https://www.google.com/news?q=*u*","Google News Search"],["https://www.google.com/maps?q=*u*","Google Maps Search"],["https://www.google.com/search?tbm=shop&q=*u*","Google Product Search"],["https://www.bing.com/search?q=*u*","Bing Web Search"],["https://www.bing.com/images/search?q=*u*","Bing Image Search"],["https://www.bing.com/videos/search?q=*u*","Bing Video Search"],["https://www.bing.com/news/search?q=*u*","Bing News Search"],["https://www.bing.com/maps/?q=*u*","Bing Map Search"]];b.language==
"de"&&(ba="Bitte warten",Ll="Importiere Datensatz %1 von %2",Zk="Importiere Bild %1 von %2",rg="Lade Artikel %1 von %2",ai="Wikidata-Abfrage l\u00e4uft, bitte warten",Zd="Lade Bild %1 von %2",Xh="Lade Datei %1 von %2",Sm="Lade Notiz %1 von %2",Lq="Videoaufzeichnung l\u00e4uft: %1%",Mq="Bearbeite Videodaten: %1%",Oa=cn=jb="de",to="Suchen",Xn="Endpunkt ausw\u00e4hlen",Nq="Kategorie ausw\u00e4hlen",Kd="Elemente ohne Kategorie",nn="Die ausgew\u00e4hlte Kategorie enth\u00e4lt keine Elemente",Oq="Men\u00fc",
Pq="M<br>e<br>n<br>\u00fc",Qq="Datenbank<br>herunterladen",Rq="Wissens-<br>datenbank",Sq="Diagramm<br>bearbeiten",Tq="Diagramm<br>formatieren",Uq="Elemente<br>suchen",Vq="Elemente in<br>Kategorie",Wq="Notizen zum<br>Element",Xq="Ansicht<br>einstellen",Yq="Im Diagramm<br>navigieren",Zq="Elemente aus-<br>wendig lernen",$q="Programm-<br>einstellungen",ar="Hilfe<br>Assistent",Yk="Notiz",Ue="NOTIZEN",ch=' zu "',br="Wissensdatenbank",cr="Diagramm bearbeiten",dr="Diagramm formatieren",Ni="Elemente suchen",
bo="Durchsuche Elemente %1 bis %2",er="Elemente in Kategorie",fr="Ansicht einstellen",gr="Im Diagramm navigieren",hr="Hilfe",ir="Element<br>bearbeiten",jr="Wikipedia<br>Artikel",kr="Bilder<br>einf\u00fcgen",lr="Anhang<br>bearbeiten",mr="Neues<br>Element",nr="Neue<br>Verbindung",or="Element<br>l\u00f6schen",pr="Verbindung<br>bearbeiten",Sj="Verbindung<br>l\u00f6schen",qr="Element<br>kopieren",rr="Element<br>ausschneiden",sr="Element<br>einf\u00fcgen",tr="R\u00fcck-<br>g\u00e4ngig",ur="Wieder-<br>herstellen",
vr="Position<br>zur\u00fccksetzen",wr="Alle Positionen<br>zur\u00fccksetzen",nj="OK<br>&nbsp;",oj="Abbrechen<br>&nbsp;",Xp="Formatierung entfernen",Pp="Fett",Qp="Kursiv",Rp="Unterstrichen",Sp="Durchgestrichen",Tp="Schrift gr\u00f6\u00dfer",Up="Schrift kleiner",Vp="Hochgestellt",Wp="Tiefgestellt",Cj="Hyperlink einf\u00fcgen",Jp="Hyperlink entfernen",Kp="Horizontale Linie einf\u00fcgen",Lp="Rechtschreibpr\u00fcfung",Mp="HTML-Quelltext",fq="Nummerierte Liste",gq="Liste",dq="Einr\u00fccken",eq="Ausr\u00fccken",
$p="Linksb\u00fcndig",aq="Zentriert",bq="Rechtsb\u00fcndig",cq="Beidseitig",Hp="Formel einf\u00fcgen",Ej="Tabelle einf\u00fcgen",lq="Tabelle l\u00f6schen",mq="Zeile oberhalb einf\u00fcgen",nq="Zeile unterhalb einf\u00fcgen",oq="Zeile l\u00f6schen",pq="Spalte links einf\u00fcgen",qq="Spalte rechts einf\u00fcgen",rq="Spalte l\u00f6schen",pj="Als<br>Tabelle",tj="Kategorie<br>bearbeiten",vj="Kategorie<br>l\u00f6schen",Vo="Name",Wo="Beschreibung",Xo="Hyperlink",rj="Kategorie",op="Vorw\u00e4rts",pp="R\u00fcckw\u00e4rts",
qp="Beschreibung",Yo="Hyperlink (muss mit http(s)://, file://, ... beginnen):",$o="Hyperlink auf ein Diagrammelement",Zo="Verlinkte Seite in neuem Browserfenster \u00f6ffnen",sj="Kategorie:",xr="Zum Endpunkt<br>ziehen",yr="Abbrechen<br>&nbsp;",zr="Neues Element erstellen",Ar="Kopiert den selektierten Text in das Eingabefeld",Br="Kopiert den selektierten Text automatisch in das Eingabefeld",Cr="Schlie\u00dft das Textnotizen-Fenster",Dr="Vergr\u00f6\u00dfert/verkleinert das Textnotizen-Fenster",Tj=
"Zeigt die Seitenleiste an",Er="Pinnt die Seitenleiste fest",Fr="Pinnt das Wissensdatenbank-Fenster fest",Gr="Pinnt das Bearbeiten-Fenster fest",Hr="Pinnt das Diagramm-formatieren-Fenster fest",Ir="Pinnt das Elemente-suchen-Fenster fest",Jr="Pinnt das Elemente-in-Kategorie-Fenster fest",Kr="Pinnt das Ansicht-Fenster fest",Lr="Pinnt das Navigieren-Fenster fest",Mr="Pinnt das Hilfe-Fenster fest",Nr="Synchronisiert das Textnotizen-Fenster und das Diagramm",Or="Schlie\u00dft die Seitenleiste",Pr="Schlie\u00dft das Wissensdatenbank-Fenster",
Qr="Schlie\u00dft das Bearbeiten-Fenster",Rr="Schlie\u00dft das Diagramm-formatieren-Fenster",Sr="Schlie\u00dft das Elemente-suchen-Fenster",Tr="Schlie\u00dft das Elemente-in-Kategorie-Fenster",Ur="Schlie\u00dft das Ansicht-Fenster",Vr="Schlie\u00dft das Navigieren-Fenster",Wr="Schlie\u00dft das Hilfe-Fenster",Xr="SYNC",Mi="Suche starten",ao="Suche abbrechen",Ng="Alle Suchergebnisse einblenden",co="Mehrfache Suchergebnisse ausblenden",eo="Vorherige Suche",fo="N\u00e4chste Suche",bj="Bereits gelernt: %1%",
cj="Element %1 von %2",Eo="Elemente nur einpr\u00e4gen",$i="Element einpr\u00e4gen",aj="Element abfragen",Oo="Lernen fortsetzen",No="<p>M\u00f6chten Sie die letzte \u00dcbungseinheit fortsetzen?</p>",Uj="\u00c4nderungen speichern",Dp="Textnotiz l\u00f6schen",Vj='<p><span class="ui-icon ui-icon-alert" style="float: left; margin: 0 7px 25px 0;"></span>Die Notizen zu "%1" wurden ge\u00e4ndert.</p><p>M\u00f6chten Sie die \u00c4nderungen speichern?</p>',Cp='<p><span class="ui-icon ui-icon-alert" style="float: left; margin: 0 7px 25px 0;"></span>M\u00f6chten Sie die Notizen zu</p><p>"%1"</p><p>wirklich l\u00f6schen?</p>',
Yr="\u00dcber InfoRapid KnowledgeBase Builder",Zr="Tastenk\u00fcrzel",$r="Einf\u00fchrung in den KnowledgeBase Builder",as='Falls Sie den KnowledgeBase Builder zum ersten Mal benutzen, so schauen Sie sich doch bitte kurz die folgende Einf\u00fchrung an. Sie zeigt Ihnen im Schnelldurchlauf die wichtigsten Programmfunktionen und weckt hoffentlich Ihr Interesse an unserer bemerkenswerten Anwendung. Sie k\u00f6nnen sich die Einf\u00fchrung auch jederzeit sp\u00e4ter unter "Hilfe-Assistent" - "Einf\u00fchrung" anzeigen lassen.',
bs="Einf\u00fchrung starten",cs='<p><span class="ui-icon ui-icon-alert" style="float: left; margin: 0 7px 25px 0;"></span>Dieser Befehl l\u00f6scht alle Eintr\u00e4ge aus den R\u00fcckg\u00e4ngig-/Wiederherstellen-Listen und entfernt leeren Platz aus der Datenbank. M\u00f6chten Sie fortfahren?</p>',uj="Name der Kategorie:",dp='<p><span class="ui-icon ui-icon-alert" style="float: left; margin: 0 7px 25px 0;"></span>Soll die Elementkategorie "%1" wirklich gel\u00f6scht und alle Referenzen darauf zur\u00fcckgesetzt werden?</p>',
up='<p><span class="ui-icon ui-icon-alert" style="float: left; margin: 0 7px 25px 0;"></span>Soll die Verbindungskategorie "%1" wirklich gel\u00f6scht und alle Referenzen darauf zur\u00fcckgesetzt werden?</p>',bp="Elementkategorie bearbeiten",ep="Elementkategorie l\u00f6schen",sp="Verbindungskategorie bearbeiten",vp="Verbindungskategorie l\u00f6schen",Aq="Nach links<br>verschieben",Bq="Nach rechts<br>verschieben",Cq="Anhang<br>l\u00f6schen",Eq="Anhang<br>\u00f6ffnen",qd="Jahr",zg="Monat",Ag="Woche",
Bg="Tag",dn="Wochenende",yd="Ja",zd="Nein",Da="OK",eb="Abbrechen",ml="Zur\u00fccksetzen",gi="Speichern",ii="Senden",To="Neues Element erstellen",Uo="Element bearbeiten",np="Verbindung bearbeiten",Zn="mehr...",$n="weniger \u2039\u2039",ds="about_de.htm",es="shortcuts_de.htm",fs="Ansicht speichern",gs="Ansicht aktualisieren",Wj="Name",hs="Wurzelelement speichern",is="Als Startansicht setzen",bn="Termin einf\u00fcgen",Um="Termin f\u00fcr - Name:",Vm="Termin f\u00fcr - Beschreibung:",Wm="Termin f\u00fcr - Kategorie:",
Xm="Art des Termins - Name:",Ym="Art des Termins - Beschreibung:",Zm="Art des Termins - Kategorie:",$m="Beginn Datum / Zeit:",an="Ende Datum / Zeit:",en="Beginn",fn="Ende",Dl="Wikipedia-Artikel einf\u00fcgen",wl="Suche",xl="in",yl="Ergebnisse",zl="Sprachcode",Al="de (Deutsch), en (Englisch), fr (Franz\u00f6sisch)...",Bl="Bilder f\u00fcr Offline-Modus / Drucken herunterladen",Cl="Elemente \u00fcberschreiben",tl="Wikidata-Import",ql="SPARQL-Abfrage eingeben",rl="hier erstellen und testen",sl="Beispiel",
Zh="Webseite importieren",ol="URL",pl="Die angegebene URL wurde nicht gefunden.",nl="Bilder einf\u00fcgen",bl="Bilddatei \u00f6ffnen",cl="Foto aufnehmen",dl="Bilddateien hierher ziehen",el="Bild hier einf\u00fcgen (Strg+V dr\u00fccken)",gl="Bilder verkleinern auf ",fl="Bildgr\u00f6\u00dfe: ",hl=" Pixel",al="Neues Element erstellen",il="Ausrichtung:",jl="Links",kl="Rechts",ll="Im Text",Kl="CSV-Daten importieren",Hl="Die erste Zeile enth\u00e4lt Elementkategorien und Datentypen",Il="Elementkategorien auch als Kategorien f\u00fcr die Verbindungslinien zum Element verwenden",
El="CSV-Datei \u00f6ffnen",Fl="CSV-Datei hierher ziehen",Gl="oder CSV-Daten direkt eingeben",od="oder",Ul="CSV-Daten exportieren",Nl="Namen, Beschreibungen und Notizen als reinen Text ohne HTML-Formatierungen exportieren",Ol="Zus\u00e4tzliche Elementdaten:",Pl="Zus\u00e4tzliche Verbindungsdaten:",kn="Name",ci="Beschreibung",di="Notiz",ei="URL",Ql="Name vorw\u00e4rts",Rl="Name r\u00fcckw\u00e4rts",Sl="Beschreibung",Tl="Kategorie",fi="Vorschau aktualisieren",Ml="Trennzeichen: ",Iq="3D-Modell exportieren",
Gq="Aufl\u00f6sung",Hq="3D-Modell in eigene Webseite einbinden",Zl="XML-Daten importieren",Vl="XML-Datei \u00f6ffnen",Wl="XML-Datei hierher ziehen",Xl="oder XML-Daten direkt eingeben",ki="Komplex",$l="Einfach",am="Attribut",hm="Pseudocode einf\u00fcgen",cm="Pseudocode-Datei \u00f6ffnen",dm="Pseudocode-Datei hierher ziehen",em="oder Pseudocode direkt eingeben",fm="Beispiel",vg="Ja",rf="Nein",pm="Schleife",qm="Ende",im="function BerechnePrimzahl (StartZahl) // Berechnet die Primzahl\n{\n\tcall BerechneQuadrat (3) // Berechnet die Quadratzahl zu 3\n\tif A > 0\n\t{\n\t\tA = A - 2\n\t\twhile A > 0\n\t\t{\n\t\t\tA = A - 1\n\t\t\tif (C > 0)\n\t\t\t{\n\t\t\t\tN = 0\n\t\t\t\tcontinue\n\t\t\t}\n\t\t\tB = B + 1\n\t\t}\n\t}\n\telse\n\t{\n\t\tB = B + 2\n\t\tswitch (MatheGebiet)\n\t\t{\n\t\t\tcase Algebra:\n\t\t\t\tC = C + 1\n\t\t\t\tbreak\n\t\t\tcase Statistik:\n\t\t\t\tD = D + 1\n\t\t\t\tbreak\n\t\t\tcase Arithmetik:\n\t\t\t\tE = E + 1\n\t\t\t\tbreak\n\t\t}\n\t}\n\n\tdo\n\t{\n\t\tA = A + 1\n\t}\n\twhile (A < 100)\n\n\tfor N = 0 Bis 100 Schrittweite 3\n\t{\n\t\tN = N + 2\n\t\tif (A > 0)\n\t\t{\n\t\t\tN = 10\n\t\t\tbreak\n\t\t}\n\t\tC = C + 2\n\t\tD = D + 2\n\t}\n\tA = 3\n\treturn\n}\n\nfunction BerechneQuadrat (Zahl)\n{\n\tQuadratZahl = Zahl * Zahl // Berechnet die Quadratzahl\n\tif QuadratZahl > 5\n\t{\n\t\tQuadratZahl = 0\n\t\treturn 3\n\t}\n\tQuadratZahl = QuadratZahl - 3\n\treturn QuadratZahl\n}",
km="Falls",lm="Vergleiche",li="Solange",nm="Wiederhole",om="Von",mm="Ansonsten",rm="Funktion",jm="R\u00fccksprung",mi="Aufruf",xm="Gegliederten Text einf\u00fcgen",tm="Gegliederte Textdatei \u00f6ffnen",um="Gegliederte Textdatei hierher ziehen",vm="oder gegliederten Text direkt eingeben",wm="Beispiel",ym="Kategorie1::Name 1(Beschreibung 1)\n\tKategorie2::Name 2(Beschreibung 2)\n\t\tLinienkategorie::Linie 1(Linienbeschreibung 1)>>Kategorie2::Name 3\n\tKategorie2::Name 3(Beschreibung 3)\n\t\tLinienkategorie::Linie 2(Linienbeschreibung 2)>>Kategorie2::Name 4\n\tKategorie2::Name 4(Beschreibung 4)\n\t\tLinienkategorie::Linie 3(Linienbeschreibung 3)>>Kategorie2::Name 5\n\tKategorie2::Name 5(Beschreibung 5)\n\t\tLinienkategorie::Linie 4(Linienbeschreibung 4)>>Kategorie2::Name 6\n\tKategorie2::Name 6(Beschreibung 6)\n\t\tLinienkategorie::Linie 5(Linienbeschreibung 5)>>Kategorie2::Name 2",
Rm="Text analysieren",Hm="Textdatei zur Analyse \u00f6ffnen",Im="Textdatei zur Analyse hierher ziehen",Jm="oder Text zur Analyse direkt eingeben",Km="Elementnotizen einf\u00fcgen",Lm="Sprache in welcher der Text verfasst ist",Bm="Deutsch",Cm="Englisch",Dm="Franz\u00f6sisch",Em="Spanisch",Fm="Italienisch",Gm="Benutzerdefiniert",Mm="Zus\u00e4tzliche Stoppw\u00f6rter (durch Leerzeichen getrennt)",Nm="Zus\u00e4tzliche Wortendungen (durch Leerzeichen getrennt)",Om="Zus\u00e4tzliche Abk\u00fcrzungen (durch Leerzeichen getrennt)",
mn="Als HTML-Textdokument exportieren",hn="Inhaltsverzeichnis erstellen",jn="Elemente farbig markieren",Cg="Formatiert mit Bildern",ln="Durchnummeriert",Mo="Elemente auswendig lernen",yo="",zo=" Elemente aus dem angezeigten Diagramm in dieser \u00dcbungseinheit lernen",Ao="Richtige Antwort aus ",Bo=" Antworten ausw\u00e4hlen",Co="Diese \u00dcbungseinheit sollte in <b>%1</b> Tag(en) gestartet werden.",Jo="<b>%1</b> Elemente sollten jetzt wiederholt werden.",Ko="<b>%1</b> weitere Elemente sollten innerhalb der n\u00e4chsten 7 Tage wiederholt werden.",
Io="<b>%1</b> Elemente wurden noch nicht trainiert.",Lo="Das Diagramm wurden zu <b>%1%</b> auswendig gelernt.",Do="Auch Elemente lernen, die noch nicht zum Lernen anstehen",Fo="Alle Elemente lernen",Go="Nur Elemente mit Textnotiz lernen",Ho="Nur Elemente ohne Textnotiz lernen",dj="Notizen",ej="Beschreibung",vo="\u00dcbungseinheit beendet",uo="<p>Herzlichen Gl\u00fcckwunsch, Sie haben diese \u00dcbungseinheit erfolgreich beendet.</p><p>Von %1 Fragen haben Sie %2 richtig beantwortet.</p><p>Die gelernten Elemente sollten in %3 Tag(en) wiederholt werden.</p>",
xo="Keine Elemente zum Lernen vorhanden",wo="<p>Das Diagramm enth\u00e4lt keine Elemente, die gelernt werden k\u00f6nnen.</p><p>Damit ein Element gelernt werden kann muss es einen Namen und eine Beschreibung enthalten.</p><p>Elementname und Elementbeschreibung werden abwechselnd als Frage und Antwort verwendet.</p>",js="Einstellungen",ks="Gr\u00f6\u00dfe der Bedienelemente:",ls="Verkleinern [-]",ms="Vergr\u00f6\u00dfern [+]",ns="Zur\u00fccksetzen [100%]",os="Als animiertes GIF Video speichern",ps=
"Abh\u00e4ngig von der Videogr\u00f6\u00dfe kann die Aufnahme viel Zeit und Speicherplatz in Anspruch nehmen. Bitte beginnen Sie mit kleinen Gr\u00f6\u00dfen. Je nachdem, wie leistungsf\u00e4hig Ihr Ger\u00e4t ist, k\u00f6nnen gro\u00dfe Videos die App zum Absturz bringen oder sehr lange dauern.",qs="Breite des Videos in Pixel",rs="H\u00f6he des Videos in Pixel",ss="Drehgeschwindigkeit in Prozent",ts="Als WebM-Video speichern",jq="Anzahl Zeilen",kq="Anzahl Spalten",Ip="Url",Op="Schriftart",Np="Schriftart<br>formatieren",
Zp="Absatz",Yp="Absatz<br>formatieren",iq="Tabelle",hq="Tabelle<br>bearbeiten",us="R\u00fcckg\u00e4ngig",vs="Wiederherstellen",Xj="Element",ws="Elementvorlagen",Yj="Verbindung",xs="Verbindungsvorlagen",ys="Einf\u00fcgen",zs="Import / Export",As="Fenster",Zj="Diagramm",Bs="Labels",Cs="Sichtbarer Ausschnitt",Ds="Elementkategorienfilter",Es="Verbindungskategorienfilter",Fs="Gespeicherte Ansichten",Gs="Bl\u00e4ttern",Hs="Zuletzt angesehen",Is="Hilfe-Assistent",$j="Datenbankgr\u00f6\u00dfe verringern",
ak="Neu",lh="Bearbeiten",zp="Text<br>bearbeiten",bk="L\u00f6schen",Js="Kopieren",Ks="Ausschneiden",Ls="Einf\u00fcgen",Ap="Notiz speichern",Bp="Notiz l\u00f6schen",Ep="R\u00fcckg\u00e4ngig",Fp="Wiederherstellen",Ms="Aktionen",Ns="Elementnamen farbig markieren",Os="Text analysieren",Ps="Neues Element erstellen",Qs="Wikipedia-Artikel importieren",Rs="Twitter-Tweets importieren",Ss="Neues Element automatisch erstellen",Ts="Wikipedia-Artikel automatisch importieren",Us="Twitter-Tweets automatisch importieren",
Vs="Verlinkte Webseite bei Klick importieren",Ws="Bei Klick ausblenden",Xs="Ausblenden beenden",Ys="Wikipedia-Artikel einf\u00fcgen",Zs="Wikidata-Import",$s="Twitter-Netzwerk importieren",at="Webseite importieren",Bj="Bilder einf\u00fcgen",bt="Anhang bearbeiten",ct="Termin",dt="Pseudocode",et="Gegliederten Text",ft="Textanalyse",gt="CSV-Daten importieren",ht="CSV-Daten exportieren",it="XML-Daten importieren",jt="Als Textdokument exportieren",kt="Neue Elementvorlage",lt="Neue Verbindungsvorlage",mt=
"Neu",nt="Aktualisieren",ot="Umbenennen",pt="L\u00f6schen",qt="Auf Element anwenden",rt="Neu",st="Aktualisieren",tt="Umbenennen",ut="L\u00f6schen",vt="Auf Verbindung anwenden",ck="Farbe",vh="Textfarbe",mh="Schriftart",nh="Schriftgr\u00f6\u00dfe",wt="Form",xt="Bild an Form anpassen",yt="Symbole",zt="Linienstil",dk="Linienbreite",At="Pfeile",Bt="Sichtbar bis Ebene",Ct="Zoom",Ti="Abstand",so="Spaltenbreite",Dt="Drehung",Et="Perspektive",ek="Layout",Ft="F\u00e4rbung",Gt="Elementtransparenz",Ht="Farbschema",
It="Offset im Farbschema",Jt="Verbindungsfarben umkehren",Dj="Hintergrundfarbe",Kt="Hintergrundmuster",Lt="Vollbild",Mt="Diagrammansicht anzeigen",Nt="3D-Ansicht anzeigen",Ot="Tabellenansicht anzeigen",Eh="Editier-Modus",Pt="Bl\u00e4tter-Modus",Qt="Rotieren des Diagramms starten",Rt="In den Virtual Reality Modus wechseln",St="Zeichnet ein Video des rotierenden Diagramms auf",Tt="Aufnahme l\u00e4uft...",Ut="Rotieren des Diagramms beenden",Vt="Elementposition zur\u00fccksetzen",Wt="Alle Elementpositionen zur\u00fccksetzen",
Xt="Elemente aufklappen",Yt="Querverbindungen anzeigen",Zt="Tabellenverbindungen anzeigen",$t="Textausrichtung",au="Alle Label anzeigen",bu="Kategorielabel anzeigen",cu="Notizlabel anzeigen",du="Beschreibungslabel anzeigen",eu="Anzahl weiterer Elemente anzeigen",fu="Anzahl ausgeblendeter Elemente anzeigen",gu="Elementverschiebung anzeigen",hu="Kindelemente verkleinern",iu="Wurzelelement markieren",ju="\u00dcberg\u00e4nge animieren",ku="Schatten",lu="Farbverlauf",mu="Beschriftungen hervorheben",nu=
"Alle Elemente einblenden",ou="Alle Verbindungen einblenden",pu="Ansicht speichern",qu="Ansicht aktualisieren",ru="Ansicht l\u00f6schen",su="Zur\u00fcckbl\u00e4ttern",tu="Vorw\u00e4rtsbl\u00e4ttern",uu="\u00dcber KnowledgeBase Builder",vu="Tastenk\u00fcrzel",wu="Einf\u00fchrung",cf="Automatisch",Cd="RGB-Farben",Dd="Farbpalette",xu="Durchgezogene Linie",yu="Gepunktete Linie",fk="Sehr d\u00fcnn",gk="D\u00fcnn",hk="Mittel",ik="Dick",jk="Sehr dick",zu="Keine",Au="Anfang",Bu="Ende",Cu="Anfang und Ende",
Du="Ebene 1",Eu="Ebene 2",Fu="Alle Ebenen",oh="Ultra klein",ph="Sehr klein",qh="Klein",rh="Mittel",sh="Gro\u00df",th="Sehr gro\u00df",uh="Ultra gro\u00df",Gu="Automatisch",Hu="Kreis",Iu="Rechteck",Ju="Raute",Ku="Sechseck",Lu="Dreieck",Mu="Parallelogramm",Nu="Trapez",Ou="MindMap<br>(geschwungene Linien)",Pu="MindMap<br>(gerade Linien)",Qu="MindMap radial<br>(gerade Linien)",Ru="MindMap radial<br>(geschwungene Linien)",Su="Concept-Map radial",Tu="Concept-Map hierarchisch",Uu="Hierarchisch",Vu="Hierarchisch gruppiert",
Wu="Hierarchisch gruppiert<br>(Linien kombiniert)",Xu="Gruppiert",Yu="Gruppiert<br>(Linien kombiniert)",Zu="1-Spaltig gruppiert",$u="1-Spaltig gruppiert<br>(Linien kombiniert)",av="2-Spaltig gruppiert",bv="2-Spaltig gruppiert<br>(Linien kombiniert)",cv="Flussdiagramm<br>(oben -> unten)",dv="Flussdiagramm<br>(links -> rechts)",ev="MindMap<br>(radial)",fv="Baum<br>(ebenenweise)",gv="Baum<br>(beidseitig)",hv="Baum<br>(Verbindungsrichtung)",iv="Kugelf\u00f6rmig",jv="Gleiche H\u00f6he",kv="Abh\u00e4ngig von Kinderzahl",
lv="Elementweise",kk="Ebenenweise",mv="Elternelementweise",nv="Kategorieweise",ov="Zum Betrachter",pv="Statisch",qv="Radial",rv="Graustufen",sv="Gelb - Gr\u00fcn",tv="Gelb - Gr\u00fcn- Blau",uv="Gr\u00fcn - Blau",vv="Blau - Gr\u00fcn",wv="Lila - Blau - Gr\u00fcn",xv="Lila - Blau",yv="Blau - Lila",zv="Rot - Lila",Av="Lila - Rot",Bv="Orange - Rot",Cv="Gelb - Orange - Rot",Dv="Gelb - Orange - Braun",Ev="Lilat\u00f6ne",Fv="Blaut\u00f6ne",Gv="Gr\u00fcnt\u00f6ne",Hv="Oranget\u00f6ne",Iv="Rott\u00f6ne",
Jv="Lila - Orange",Kv="Braun - Blau - Gr\u00fcn",Lv="Lila - Rot - Gr\u00fcn",Mv="Lila - Gelb - Gr\u00fcn",Nv="Rot - Blau",Ov="Rot - Grau",Pv="Rot - Gelb - Blau",Qv="Spektralfarben",Rv="Rot - Gelb - Gr\u00fcn",Sv="Akzent",Tv="Dunkel",Uv="Gepaart",Vv="Pastell 1",Wv="Pastell 2",Xv="Serie 1",Yv="Serie 2",Zv="Serie 3",$v="Automatisch",aw="Keines",bw="Perspektive",cw="Kariert",dw="Kreise",ew="Dreiecke",fw="Max. Anzahl sichtbarer Elemente",gw="Max. Anzahl sichtbarer Ebenen",Tf="Max. Kindelemente in Ebene ",
hw="Editieren",iw="Bl\u00e4ttern",jw="Rotieren",kw="VR",lw="Aufnehmen",mw="Stop",nw="Diagramm",ow="3D",pw="Tabelle",Jl="CSV-Daten importieren",bm="XML-Daten importieren",sm="Pseudocode einf\u00fcgen",zm="Gegliederten Text einf\u00fcgen",Tm="Text analysieren",vl="Wikipedia-Artikel importieren",ul="Wikidata-Import",lk="Wikidata-Bilder zu Elementen hinzuf\u00fcgen",gn="Termin einf\u00fcgen",qw="Elementvorlage anwenden",rw="Verbindungsvorlage anwenden",$k="Bilder einf\u00fcgen",pf="Neues Element",Fh=
"Element l\u00f6schen",gh="Element ausschneiden",ap="Name der Elementkategorie \u00e4ndern",cp="Elementkategorie l\u00f6schen",rp="Name der Verbindungskategorie \u00e4ndern",tp="Verbindungskategorie l\u00f6schen",hp="Neue Notiz",gp="Notiz l\u00f6schen",fp="Notiz bearbeiten",ug="Element bearbeiten",mk="Elementfarbe \u00e4ndern",nk="Textfarbe f\u00fcr Element \u00e4ndern",ok="Schriftart des Elements \u00e4ndern",pk="Schriftgr\u00f6\u00dfe des Elements \u00e4ndern",sw="Form des Elements \u00e4ndern",
tw="Bild an Form anpassen \u00e4ndern",uw="Symbole f\u00fcr Element ausw\u00e4hlen",qk="Element ausblenden",Wn="Neue Verbindung",Uf="Verbindung l\u00f6schen",wp="Verbindung bearbeiten",rk="Linienfarbe \u00e4ndern",sk="Textfarbe f\u00fcr Verbindungslinie \u00e4ndern",vw="Linienstil \u00e4ndern",tk="Linienbreite \u00e4ndern",ww="Pfeile an den Linienenden \u00e4ndern",xw="Verbindung sichtbar bis Ebene \u00e4ndern",kj="Startpunkt verschieben",pe="Endpunkt verschieben",Dq="Anhang l\u00f6schen",zq="Reihenfolge der Anh\u00e4nge \u00e4ndern",
Vf="Diagrammlayout \u00e4ndern",uk="Elementtransparenz \u00e4ndern",yw="Diagrammf\u00e4rbung \u00e4ndern",zw="Farbschema \u00e4ndern",vk="Offset im Farbschema \u00e4ndern",Aw="Verbindungsfarben umkehren \u00e4ndern",wk="Hintergrundfarbe im Diagramm \u00e4ndern",Bw="Hintergrundmuster im Diagramm \u00e4ndern",Xi="Ansicht \u00e4ndern",xk="Elemente auf-/zuklappen",yk="Kindelemente verkleinern \u00e4ndern",zk="Wurzelelement markieren \u00e4ndern",Ak="Querverbindungen anzeigen \u00e4ndern",Bk="Tabellenverbindungen anzeigen \u00e4ndern",
Ck="Text zu Betrachter ausrichten",Dk="\u00dcberg\u00e4nge animieren ein/aus",Ek="Max. Anzahl sichtbarer Elemente \u00e4ndern",Fk="Max. Anzahl sichtbarer Ebenen \u00e4ndern",cd="Max. Kindelemente \u00e4ndern in Ebene ",Cw="Schattierte Darstellung \u00e4ndern",Dw="Farbverlauf \u00e4ndern",Ew="Beschriftungen hervorheben \u00e4ndern",Fw="Ansicht speichern",Gw="Ansicht aktualisieren",Hw="Ansicht l\u00f6schen",fj='Element "%1" gelernt',jj="Element verschieben",kp="Elementverschiebung zur\u00fccksetzen",
Aj="Alle Elementverschiebungen zur\u00fccksetzen",Wd=[["https://www.google.de/search?q=*u*","Google Websuche"],["https://www.google.com/search?q=site:de.wikipedia.org *u*","Wikipedia Suche"],["https://www.google.de/books?q=*u*","Google Buchsuche"],["https://scholar.google.de/scholar?q=*u*","Google Scholar"],["https://www.google.de/images?q=*u*","Google Bildersuche"],["https://www.youtube.de/results?search_query=*u*","YouTube Videosuche"],["https://www.google.de/news?q=*u*","Google Nachrichtensuche"],
["https://www.google.de/maps?q=*u*","Google Kartensuche"],["https://www.google.de/search?tbm=shop&q=*u*","Google Produktsuche"],["https://www.bing.de/search?q=*u*","Bing Websuche"],["https://www.bing.de/images/search?q=*u*","Bing Bildersuche"],["https://www.bing.de/videos/search?q=*u*","Bing Videosuche"],["https://www.bing.de/news/search?q=*u*","Bing Nachrichtensuche"],["https://www.bing.de/maps/?q=*u*","Bing Kartensuche"]]);var nd=1024;if(typeof window.localStorage!=="undefined"){var qc=window.localStorage.getItem("maximportimageSize");
qc&&!isNaN(qc)&&(nd=Math.max(150,parseInt(qc)))}var Be=48;typeof window.localStorage!=="undefined"&&(qc=window.localStorage.getItem("importimageSize"))&&!isNaN(qc)&&(Be=Math.max(12,Math.min(1024,parseInt(qc))));var og=0;typeof window.localStorage!=="undefined"&&(qc=window.localStorage.getItem("importwikipediaprojectindex"))&&!isNaN(qc)&&(og=Math.max(0,Math.min(7,parseInt(qc))));var pg=10;typeof window.localStorage!=="undefined"&&(qc=window.localStorage.getItem("importwikipediamaxresults"))&&!isNaN(qc)&&
(pg=Math.max(1,Math.min(50,parseInt(qc))));var qg=jb;typeof window.localStorage!=="undefined"&&(jb=window.localStorage.getItem("importwikipedialanguagecode"))&&jb.length>0&&(qg=jb);var sg=!0;typeof window.localStorage!=="undefined"&&(jb=window.localStorage.getItem("importwikipediadownloadimages"))&&!isNaN(jb)&&(sg=parseInt(jb)!=0);var tg=!1;typeof window.localStorage!=="undefined"&&(jb=window.localStorage.getItem("importwikipediaupdateexistingitems"))&&!isNaN(jb)&&(tg=parseInt(jb)!=0);typeof window.localStorage!==
"undefined"&&window.localStorage.getItem("importtwittermaxtweets");typeof window.localStorage!=="undefined"&&(jb=window.localStorage.getItem("importtwitterlanguagecode"));typeof window.localStorage!=="undefined"&&window.localStorage.getItem("importtwitterlocation");typeof window.localStorage!=="undefined"&&window.localStorage.getItem("importtwitterlatesttweets");typeof window.localStorage!=="undefined"&&(jb=window.localStorage.getItem("importtwitterwithimages"));typeof window.localStorage!=="undefined"&&
window.localStorage.getItem("importtwitterwithcategories");typeof window.localStorage!=="undefined"&&(jb=window.localStorage.getItem("importtwitterupdateexistingitems"));var Qe=20;typeof window.localStorage!=="undefined"&&(jb=window.localStorage.getItem("memorizeitemsunitsize"))&&!isNaN(jb)&&(Qe=Math.max(1,Math.min(999,parseInt(jb))));var Re=4;typeof window.localStorage!=="undefined"&&(jb=window.localStorage.getItem("memorizeitemspossibleanswercount"))&&!isNaN(jb)&&(Re=Math.max(2,Math.min(100,parseInt(jb))));
var wg=Oa;typeof window.localStorage!=="undefined"&&(jb=window.localStorage.getItem("analyzetextlanguagecode"))&&jb.length>0&&(wg=jb);var sf="";typeof window.localStorage!=="undefined"&&(Oa=window.localStorage.getItem("analyzetextadditionalstopwords"))&&Oa.length>0&&(sf=Oa);var xg="";typeof window.localStorage!=="undefined"&&(Oa=window.localStorage.getItem("analyzetextadditionalwordendings"))&&Oa.length>0&&(xg=Oa);var yg="";typeof window.localStorage!=="undefined"&&(Oa=window.localStorage.getItem("analyzetextadditionalabbreviations"))&&
Oa.length>0&&(yg=Oa);var Gh=320;typeof window.localStorage!=="undefined"&&(Oa=window.localStorage.getItem("recordvideowidth"))&&!isNaN(Oa)&&(Gh=Math.max(5,Math.min(2048,parseInt(Oa))));var Hh=240;typeof window.localStorage!=="undefined"&&(Oa=window.localStorage.getItem("recordvideoheight"))&&!isNaN(Oa)&&(Hh=Math.max(5,Math.min(2048,parseInt(Oa))));var df=100;typeof window.localStorage!=="undefined"&&(Oa=window.localStorage.getItem("recordrotationspeed"))&&!isNaN(Oa)&&(df=Math.max(5,Math.min(2048,
parseInt(Oa))));var Ld=!1;typeof window.localStorage!=="undefined"&&(Oa=window.localStorage.getItem("webmformat"))&&!isNaN(Oa)&&(Ld=parseInt(Oa)!=0);var ng="";typeof window.localStorage!=="undefined"&&(Oa=window.localStorage.getItem("importwikidataquery"))&&Oa.length>0&&(ng=Oa);var ig=i;window.showimportimagedialog=function(c,d,b){C.find(".ikmap").hasClass("invisible")&&Df(0);a(".kbb-import-image-dialog").length==0&&ob(H(),c,d,b,!0,i)};window.onbackbtnpressed=function(c){var b=function(){if(C.find(".ikmap").hasClass("invisible"))return Df(1E3),
!0;var b=!1;a(".ui-dialog").each(function(){if(a(this).is(":visible"))return a(this).find(".ui-dialog-content").dialog("close"),b=!0,!1});if(b)return!0;C.find(".kbb-tabbed-dialog").each(function(){if(a(this).is(":visible"))return a(this).tabbeddialog("enddialog",!0),b=!0,!1});if(b)return!0;if(a.fn.C.obj&&a(a.fn.C.obj).is(":visible"))return a.fn.C.close(),!0;if(C.find(".itemtoolbar").is(":visible"))return Lc(),!0;var k=!1;C.find(".kbb-sidegalleryremainder>.kbb-sidegallery").each(function(){if(a(this).sidegallery("close",
d.T==0?0:500))return k=!0,!1});if(k)return!0;if(c)if(d.B==Ia){var e=C.find(".textlayer .kbb-tableviewcolumn");if(e.length>1)return a(e[e.length-1]).remove(),Kf(!0),!0}else if(ec&&ec.Ge())return!0;return!1}();Bb()&&B({action:"onbackbtnpressedcallback",backbtnhandled:b?1:0},fa());return b};window.addImagesToItems=function(){function c(c,d,b){a(".waitinl").addClass("waitinllarge");a("div.waitanim span.waittext").text(c.replace("%1",d+1).replace("%2",b))}for(var b=[],l="en",e={},f=0;f<d.j.q.length;f++){var g=
d.j.q[f];g.text!=""&&g.html==i&&b.push(g.text)}Pb=!1;kf(ba);(function(d){function f(a,c){ca(a,!1,function(a){var d=i;if(a)try{d=JSON.parse(a)}catch(b){}c(d)})}function g(a,c){function d(){b<4&&a.length-b>0?f(k+encodeURIComponent(a.substring(0,a.length-b)),function(a){a&&a.success&&a.success==1&&a.search&&a.search.length>0&&a.search[0].id?c(a):(b++,d())}):c(i)}var b=0,k="https://www.wikidata.org/w/api.php?action=wbsearchentities&format=json&limit=1&continue=0&type=item&language="+encodeURIComponent(l)+
"&uselang="+encodeURIComponent(l)+"&search=";d()}function t(){if(!Pb){if(j<b.length){var d=b[j];j++;g(d,function(c){c?f("https://www.wikidata.org/w/api.php?action=wbgetclaims&property=P18&format=json&entity="+encodeURIComponent(c.search[0].id),function(c){c&&c.claims&&c.claims.P18&&c.claims.P18.length>0&&c.claims.P18[0].mainsnak&&c.claims.P18[0].mainsnak.datavalue&&c.claims.P18[0].mainsnak.datavalue.value?ca("https://commons.wikimedia.org/w/thumb.php?f="+encodeURIComponent(c.claims.P18[0].mainsnak.datavalue.value)+
"&w=101",!0,function(c){c&&(c={data:c.replace(/\r/g,"").replace(/\n/g,"")},c["~img"]=a("<img />").attr("src",c.data)[0],e[d]=c);m++;t()}):(m++,t())}):(m++,t())})}m<b.length&&c(Zd,m,b.length)}}function h(){setTimeout(function(){var c=!1;m>=b.length&&(c=!0,a.each(e,function(){if(this["~img"])if(this["~img"].complete)this.width=this["~img"].naturalWidth,this.height=this["~img"].naturalHeight;else return c=!1}));Pb||c?d():h()},500)}var j=0,m=0,u=0;c(Zd,0,b.length);for(u=0;u<10;u++)t();h()})(function(){a("div.waitanim span.waittext").text(ba);
a(".waitinl").removeClass("waitinllarge");Pb?lf():B({action:"getnextundopos",database:O},function(a){if(a>=0){var c,b,k=0,l=!1,f=function(){k<d.j.q.length?(c=d.j.q[k],k++,c&&c.text!=""&&c.html==i&&e[c.text]?(b='<html><span style="display:inline-table"><img src="'+e[c.text].data+'" style="width:'+e[c.text].width/20+"em;height:"+e[c.text].height/20+'em;margin:0.2em 0.4em 0 0;float:left" /><span style="display:table-cell;vertical-align:middle">'+Nd(c.text)+"</span></span></html>",Uc(c.I,b,i,i,i,-1,i,
i,-1,"","","","",lk,function(){l=!0;f()})):f()):l?B({action:"combineundoactionsupto",undostepid:a,description:lk,database:O},function(){d.load(-1,-1,"",Xb,!1,!0,xe+1);lf()}):lf()};f()}else lf()})})};window.addShrinkDatabaseGalleryItemToSection=function(c,b){return c.sidegallery("addgalleryitemtosection",b,"id-shrink-database",$j,"tooltip",138,139,-1,!0,!1,function(){var c=i,b={};b[yd]=function(){c.dialog("close");var a={action:"shrinkdatabase",database:O};kf(ba);B(a,function(){d.load(P,-1,"",0,!1,
!1,xe+1);lf()})};b[zd]=function(){c.dialog("close")};c=a("<div />").html(cs).dialog({modal:!0,closeOnEscape:!1,resizable:!1,buttons:b,title:$j,width:400,position:Mb?{my:"center top",at:"center top"}:{my:"center",at:"center"},open:function(){a(this).parent(".ui-dialog").find("*").myDisableSelection(!1)},close:function(){a(this).dialog("destroy")}})})};window.newitem=function(a,d,b){var e=Ga(),f=aa();Hc(e,f+1,a,d,b,"","","","",i)};var eh=i,Bd;p.prototype.ag=function(){return this.curpos>=0&&this.curpos<
this.history.length?this.history[this.curpos].i:-1};p.prototype.add=function(a,d){var b=i,b=0;this.curpos=Math.max(-1,this.curpos);this.curpos=Math.min(this.history.length-1,this.curpos);if(!(this.curpos>=0&&this.history[this.curpos].i==a)){this.curpos>0&&this.history.splice(0,this.curpos);b=new E(a,d);this.history.unshift(b);this.curpos=0;for(b=1;b<this.history.length;b++)this.history[b].i==a&&(this.history.splice(b,1),b--);if(this.history.length>50)this.history.splice(50,this.history.length-50),
this.curpos=Math.min(this.history.length-1,this.curpos)}for(b=0;b<this.history.length;b++)this.history[b].i==a&&(this.history[b].n=d);try{if(this.databaseid&&this.databaseid.length>0&&typeof window.localStorage!=="undefined"){var e=JSON.stringify(this);window.localStorage.setItem("db_"+this.databaseid+"_history",e)}}catch(f){}this.Gf();Kq.galleryitem("setenabled",this.curpos>0);Jq.galleryitem("setenabled",this.curpos<this.history.length-1)};p.prototype.oe=function(){var a=this.history[this.curpos].i;
d.load(a,-1,"",Xb,!0,!1,xe+1);U()&&Oc({action:"onitemselected",i:a,r:-1,search:"",setasroot:1,redraw:1})};p.prototype.Ge=function(){this.curpos=Math.max(-1,this.curpos);this.curpos=Math.min(this.history.length-1,this.curpos);return this.curpos+1<this.history.length?(this.curpos++,this.oe(),!0):!1};p.prototype.pg=function(){this.curpos=Math.max(-1,this.curpos);this.curpos=Math.min(this.history.length-1,this.curpos);this.curpos-1>=0&&(this.curpos--,this.oe())};p.prototype.Gf=function(){var a=0,d=this;
Rj.gallerysection("clear");for(a=Math.max(0,this.curpos);a<Math.min(this.curpos+10,this.history.length);a++)Rj.gallerysection("addgalleryitem","id-last-viewed-item-"+a,this.history[a].n,"tooltip",6,7,!0,a==this.curpos?1:-1,a!=this.curpos,!1,function(a){d.curpos=a.data("pos");d.oe()}).data("pos",a)};A.prototype.add=function(a){var d=0;this.curpos=Math.max(-1,this.curpos);this.curpos=Math.min(this.searchhistory.length-1,this.curpos);if(!(this.curpos>=0&&this.searchhistory[this.curpos]==a)){this.curpos>
0&&this.searchhistory.splice(0,this.curpos);this.searchhistory.unshift(a);this.curpos=0;for(d=1;d<this.searchhistory.length;d++)this.searchhistory[d]==a&&(this.searchhistory.splice(d,1),d--);if(this.searchhistory.length>50)this.searchhistory.splice(50,this.searchhistory.length-50),this.curpos=Math.min(this.searchhistory.length-1,this.curpos)}try{if(this.databaseid&&this.databaseid.length>0&&typeof window.localStorage!=="undefined"){var b=JSON.stringify(this);window.localStorage.setItem("db_"+this.databaseid+
"_searchhistory",b)}}catch(e){}this.ae()};A.prototype.kg=function(){this.curpos=Math.max(-1,this.curpos);this.curpos=Math.min(this.searchhistory.length-1,this.curpos);if(this.curpos+1<this.searchhistory.length)return this.curpos++,this.searchhistory[this.curpos];this.ae();return""};A.prototype.jg=function(){this.curpos=Math.max(-1,this.curpos);this.curpos=Math.min(this.searchhistory.length-1,this.curpos);if(this.curpos-1>=0)return this.curpos--,this.searchhistory[this.curpos];this.ae();return""};
A.prototype.ae=function(){tb&&(tb.find(".kbb-nextsearchbtn").toolbarbtn("setenabled",this.curpos>0),tb.find(".kbb-previoussearchbtn").toolbarbtn("setenabled",this.curpos<this.searchhistory.length-1))};r.prototype.fd=function(){try{if(this.databaseid&&this.databaseid.length>0&&typeof window.localStorage!=="undefined"){var a=JSON.stringify(this);window.localStorage.setItem("db_"+this.databaseid+"_filter",a)}}catch(d){}};r.prototype.cb=function(c){return JSON.stringify(a.map(this[c],function(a,c){return parseInt(c)}))};
r.prototype.tg=function(){this.excludeitems={};this.excludeitemtemplates={};this.fd()};r.prototype.ff=function(c){var b=this;a.each(c,function(a){b.excludeitemtemplates[a]=""});d.j.W=-1;this.fd()};r.prototype.wg=function(a,b){b?delete this.excludeitemtemplates[a]:this.excludeitemtemplates[a]="";if(!b&&d.j.W>=0){var e=d.j.q[d.j.F[d.j.W]];if(e&&e.Q==a)d.j.W=-1}this.fd()};r.prototype.dg=function(a){return typeof this.excludeitemtemplates[a]!=="undefined"};r.prototype.ug=function(){this.excluderelations=
{};this.excluderelationtemplates={};this.fd()};r.prototype.xg=function(a,b){b?delete this.excluderelationtemplates[a]:this.excluderelationtemplates[a]="";if(!b&&d.j.aa>=0){var e=d.j.R[d.j.ja[d.j.aa]];if(e&&e.Na==a)d.j.aa=-1}this.fd()};r.prototype.fg=function(a){return typeof this.excluderelationtemplates[a]!=="undefined"};r.prototype.jb=function(c,k,e){var f=this;I({action:"searchtemplate",search:"",maxsearchresults:1E3,templatetype:e,database:O},function(g){g.n==0&&(c.gallerysection("clear"),b.editmode&&
e==0&&(Se=c.gallerysection("addgalleryitem","id-hide-items-on-click-item",Ws,"tooltip",156,157,!1,d.Ia?1:0,!0,!1,function(c,b){Qb();if(d.Ia=b){var k={action:"getnextundopos",database:O};B(k,function(c){d.pc=c;d.Hb={};a(".quickaccesstoolbar").addClass("invisible");a(".closetoolbar").removeClass("invisible").toolbar("showbtn","id-hide-items-on-click-item",!0).toolbar("setlast");if(d.B==Ia&&(bb=Dg(),$d()>=0)){Ic=[];for(c=1;c<bb.length+1;c++)Ic.push(c);d.Fa=-1;d.ca=0;d.j.Hf(d.L)}})}else a(".quickaccesstoolbar").removeClass("invisible"),
a(".closetoolbar").addClass("invisible"),d.pc>=0&&(k={action:"combineundoactionsupto",undostepid:d.pc,description:qk,database:O},B(k,function(){d.pc=-1;f.ff(d.Hb);yh();a.isEmptyObject(d.Hb)||f.jb(Ab,i,0);d.Hb={}}))})),c.gallerysection("addgalleryitem",e==0?"id-show-all-items":"id-show-all-relations",e==0?nu:ou,"tooltip",154,155,!1,-1,!0,!1,function(){e==0?f.tg():f.ug();yh();c.gallerysection("setallselectedexcept",e==0?["id-show-all-items","id-hide-items-on-click-item"]:["id-show-all-relations"])}),
g.h.forEach(function(a,d){c.gallerysection("addgalleryitem",(e==0?"id-item-category-":"id-relation-category-")+d,a.n.trim()==""?"&nbsp;":a.n,"tooltip",-1,-1,!1,e==0?f.dg(a.i)?0:1:f.fg(a.i)?0:1,!0,!1,function(c,d){e==0?f.wg(a.i,d):f.xg(a.i,d);yh()})}));k&&k()})};x.prototype.Uf=function(a,b,e,f){b=new s(b,e?Dg():-1,d.D,d.M,d.rotation,d.$,d.la,d.ha,d.Aa,d.Ba,d.Ca,d.Da,ab.sidegallery("ispinned"),bd?bd.sidegallery("ispinned"):!1,ta.sidegallery("ispinned"),Ka.sidegallery("ispinned"),tb.sidegallery("ispinned"),
Jd.sidegallery("ispinned"),Yd.toolbarbtn("isselected"),Ha.sidegallery("ispinned"),Bc.sidegallery("ispinned"),Cc.sidegallery("ispinned"),d.H,d.G,d.za,d.B,d.na,d.Za,d.ga,d.Ja,d.T,d.Ka,d.Wa,d.ma,d.xa,d.ta,d.va,d.ua,d.Oa,JSON.stringify(Wa));if(a&&(e=Id.gallerysection("getselected"),e.length>0))e=e.data("pos"),this.initialviewindex==e?this.initialviewindex=-1:this.initialviewindex>e&&this.initialviewindex--,this.bookmarks.splice(e,1);this.bookmarks.unshift(b);f?this.initialviewindex=0:this.initialviewindex>=
0&&this.initialviewindex++;if(this.bookmarks.length>50)this.bookmarks.splice(50,this.bookmarks.length-50),this.initialviewindex>=50&&(this.initialviewindex=-1);this.save(a?Gw:Fw);this.He(0)};x.prototype.remove=function(){var a=Id.gallerysection("getselected");if(a.length>0)a=a.data("pos"),this.bookmarks.splice(a,1),this.initialviewindex==a?this.initialviewindex=-1:this.initialviewindex>a&&this.initialviewindex--,this.save(Hw),this.He(-1)};x.prototype.save=function(a){kf(ba);a={action:"setdiagramproperty",
name:"bookmarks",value:JSON.stringify(this),undotext:a,undoproperties:kb(),database:O};B(a,function(){lf()})};x.prototype.vf=function(c){var k=a.extend(new s("",-1,1,1,0,0,100,100,100,100,100,100,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,0,0,0,0,0,1,0,1,1,1,!1,!0,!0,!0,!0,!1,JSON.stringify(new r(""))),c);Bf(k.tv);d.D=k.z;d.M=k.s;d.rotation=k.rot;typeof c.persp!=="undefined"?d.$=c.persp:(d.$=k["3dm"]>0?75:0,k.persp=d.$);d.Xa=1-(1-dc)*d.$/100;d.K=1-(1-fc)*d.$/100;if(k.tv<=Fa||k.tv==La)d.la=k.mi,d.ha=k.ml,d.Aa=
k.c1,d.Ba=k.c2,d.Ca=k.c3,d.Da=k.c4,d.G=k.dl,d.za=k.dl3d,d.Za=k.dce,d.ga=k.mri,d.Ka=k.wcl;if(k.tv==La)d.Ja=k.to3d;d.Wa=k.wtr;d.na=k.iex;d.T=k.atran;d.ma=k.a;d.xa=k.nt;d.ta=k.dt;d.Oa=k.sft;d.va=k.mr;d.ua=k.hr;Wa=a.extend(new r(""),JSON.parse(k.f));xd(d.D,d.M,d.rotation,d.$);b.editmode&&Oe(k.e);Hb&&Hb.galleryitem("setselected",k.e);Fb&&Fb.toolbarbtn("setselected",k.e);Gb&&Gb.toolbarbtn("setselected",!k.e);if(b.editmode){var e=!1,f="",c=function(a,c,d){c==i?typeof z[a]!=="undefined"&&(delete z[a],e=!0,
f!=""&&(f+=", "),f+=d):c!==z[a]&&(z[a]=c,e=!0,f!=""&&(f+=", "),f+=d)};if(k.tv<=Fa||k.tv==La)c("dl",d.G,Vf),c("dl3d",d.za,Vf),c("dce",d.Za,yk),c("mri",d.ga,zk),c("wcl",d.Ka,Ak),c("mi",d.la,Ek),c("ml",d.ha,Fk),c("c1",d.Aa,cd+1),c("c2",d.Ba,cd+2),c("c3",d.Ca,cd+3),c("c4",d.Da,cd+4);k.tv==La&&c("to3d",d.Ja,Ck);c("wtr",d.Wa,Bk);c("tv",d.B,Xi);c("iex",d.na,xk);c("atran",d.T,Dk);e&&(kf(ba),c={action:"setdiagramproperty",name:"dp",value:JSON.stringify(z),undotext:f,undoproperties:kb(),database:O},B(c,function(){lf()}))}return k};
x.prototype.He=function(c){var b=0,e=this;re&&re.galleryitem("setenabled",c>=0);se&&se.galleryitem("setenabled",c>=0);Id.gallerysection("clearexcept",["id-add-bookmark","id-update-bookmark","id-remove-bookmark"]);for(b=0;b<this.bookmarks.length;b++)Id.gallerysection("addgalleryitem","id-bookmark-"+b,this.bookmarks[b].n,"tooltip",b==this.initialviewindex?192:6,b==this.initialviewindex?193:7,!1,b==c?1:-1,!0,!1,function(c){Id.gallerysection("setselected","id-bookmark-"+c.data("pos"));re&&re.galleryitem("setenabled",
!0);se&&se.galleryitem("setenabled",!0);c=e.vf(e.bookmarks[c.data("pos")]);Qf&&Qf.toolbarbtn("setselected",c.skg);Rf&&Rf.toolbarbtn("setselected",c.seg);Sf&&Sf.toolbarbtn("setselected",c.sfg);Dh.toolbarbtn("setselected",c.ssg);Lj.toolbarbtn("setselected",c.sig);Yd.toolbarbtn("setselected",c.t);Mj.toolbarbtn("setselected",c.svg);Nj.toolbarbtn("setselected",c.sdg);Oj.toolbarbtn("setselected",c.shg);de.toolbarbtn("setselected",d.B<=Fa);ee.toolbarbtn("setselected",d.B==La);fe.toolbarbtn("setselected",
d.B==Ia);Fi.galleryitem("setselected",d.na>0);Gi.galleryitem("setselected",d.ma||d.xa||d.ta||d.va||d.ua||d.Oa);Hi.galleryitem("setselected",d.ma);Ii.galleryitem("setselected",d.xa);Ji.galleryitem("setselected",d.ta);Ki.galleryitem("setselected",d.va);Li.galleryitem("setselected",d.ua);He.galleryitem("setselected",d.Oa);Ab&&Ab.gallerysection("isexpanded")&&Wa.jb(Ab,i,0);Lb&&Lb.gallerysection("isexpanded")&&Wa.jb(Lb,i,1);ab.sidegallery("showpinned",c.ssb);bd&&bd.sidegallery("showpinned",c.skg);ta.sidegallery("showpinned",
c.seg);Ka.sidegallery("showpinned",c.sfg);tb.sidegallery("showpinned",c.ssg);Jd.sidegallery("showpinned",c.sig);c.sig&&a.trim(hc.html()).length==0&&(Eb.val(Kd).data("pid",-1).data("fid",-1).data("fn",Kd),Eb.parent().find(".kbb-selectcategoryhint").hide(),Ce(-1));hb.sidegallery("show",c.t,0,fa());Ha.sidegallery("showpinned",c.svg);Bc.sidegallery("showpinned",c.sdg);Cc.sidegallery("showpinned",c.shg);if(!ab.sidegallery("ispinned")){var b=C.find(".kbb-sidegallery:not(.id-sidebar-closed-horizontal,.id-sidebar-closed-vertical,.id-sidebar):visible").length>
0;Gd.sidegallery("show",b,0,i);Hd.sidegallery("show",!b,0,i)}c=$d(c.i);d.Fa=0;d.ca=-1;d.load(c,-1,"",Xb,!0,!1,xe+1);d.B==Ia&&Db&&d.kb(c,!1);U()&&(Oc({action:"onitemselected",i:c,r:-1,search:"",setasroot:1,redraw:1}),Oc({action:"onsettingschanged",zoomfact:d.D,stretchfact:d.M,rotation:d.rotation,perspective:d.$}))}).data("pos",b)};x.prototype.rg=function(){var c=-1;if(this.initialviewindex>=0&&this.initialviewindex<this.bookmarks.length){c=this.vf(this.bookmarks[this.initialviewindex]);Qf&&Qf.toolbarbtn("setselected",
c.skg);Rf&&Rf.toolbarbtn("setselected",c.seg);Sf&&Sf.toolbarbtn("setselected",c.sfg);Dh.toolbarbtn("setselected",c.ssg);Lj.toolbarbtn("setselected",c.sig);Yd.toolbarbtn("setselected",c.t);Mj.toolbarbtn("setselected",c.svg);Nj.toolbarbtn("setselected",c.sdg);Oj.toolbarbtn("setselected",c.shg);ab.sidegallery("showpinned",c.ssb);bd&&bd.sidegallery("showpinned",c.skg);ta.sidegallery("showpinned",c.seg);Ka.sidegallery("showpinned",c.sfg);tb.sidegallery("showpinned",c.ssg);Jd.sidegallery("showpinned",c.sig);
c.sig&&a.trim(hc.html()).length==0&&(Eb.val(Kd).data("pid",-1).data("fid",-1).data("fn",Kd),Eb.parent().find(".kbb-selectcategoryhint").hide(),Ce(-1));hb.sidegallery("show",c.t,0,fa());Ha.sidegallery("showpinned",c.svg);Bc.sidegallery("showpinned",c.sdg);Cc.sidegallery("showpinned",c.shg);Id.gallerysection("setselected","id-bookmark-"+this.initialviewindex);re&&re.galleryitem("setenabled",!0);se&&se.galleryitem("setenabled",!0);if(!ab.sidegallery("ispinned")){var d=C.find(".kbb-sidegallery:not(.id-sidebar-closed-horizontal,.id-sidebar-closed-vertical,.id-sidebar):visible").length>
0;Gd.sidegallery("show",d,0,i);Hd.sidegallery("show",!d,0,i)}c=$d(c.i)}return c};o.prototype.kd=function(a,d){var b=a.i[d];this.O=b.x;this.N=b.y;this.Fb=b.z;this.V=b.r;this.Ob=b.t;this.ie=b.w;this.U=b.l;this.jd(a,d,!1);if(this.A!=i)b.J=this.A.J,b.Zc=this.A.Zc,b.cd=this.A.cd,b.Yc=this.A.Yc,b.Wc=this.A.Wc,b.Vc=this.A.Vc,b.bd=this.A.bd,b.$c=this.A.$c,b.Xc=this.A.Xc,b.nc=this.A.nc,b.Qc=this.A.Qc,b.pd=this.A.pd,b.Gb=this.A.Gb,b.md=this.A.md,b.qb=this.A.qb,b.Nb=this.A.Nb,b.ab=this.A.ab,b.zc=this.A.zc,b.Fc=
this.A.Fc,b.Ub=this.A.Ub,this.A=b};o.prototype.jd=function(c,d,b){d=c.i[d];this.text=jd(a.trim(d.n));this.html=hd(a.trim(d.n));this.ba=jd(a.trim(d.dt));this.Z=hd(a.trim(d.dt));this.Wd=this.Xd="";for(var e=0;e<d.tb.length;e++){var f=jd(a.trim(d.tb[e].n));f&&(this.Xd+=f);(f=hd(a.trim(d.tb[e].n)))&&(this.Wd+=f);(f=jd(a.trim(d.tb[e].v)))&&(this.Xd+=f);(f=hd(a.trim(d.tb[e].v)))&&(this.Wd+=f)}this.I=d.i;this.Q=d.ti;this.Ta=d.p>=0?c.i[d.p].i:-1;this.Yb=d.a;this.ef=d.d!=0;this.Rd=d.mr;this.le=d.hr;this.we=
d.sn;this.Ha=d.u;d.k.length>0?(this.image=new Image,this.image.src="data:image/png;base64,"+d.k,this.Tb=d.f&&d.f!=0,this.$a=d.s&&d.s!=0,b||(wb[this.I]={i:this.image,f:this.Tb,s:this.$a})):typeof wb[this.I]!=="undefined"?(this.image=wb[this.I].i,this.Tb=wb[this.I].f,this.$a=wb[this.I].s):(this.image=i,this.$a=this.Tb=!1);try{this.properties=d.o&&d.o.length>0?a.parseJSON(d.o):i}catch(g){this.properties=i}this.$b=typeof d.ar!=="undefined"?parseInt(d.ar):268435455};o.prototype.Ud=function(a,b){var e=
1E3-b,f=this.sa()*(e*this.ib+b*this.V)/1E3,g=Math.max(44*d.D,3*f*(this.U==0&&d.ga!=0?1.75:1)),f=Math.max(44*d.D,2*f*(this.U==0&&d.ga!=0?1.75:1));a.selector("show",(e*this.Wb+b*this.O)/1E3-g/2,(e*this.Xb+b*this.N)/(1E3*d.K)*d.K-f/2,g,f,d.D);a.selector("showicon",d.H&&(this.I!=P||d.G==2||d.G==3));a.data("pid",this.I)};o.prototype.Ma=function(a){var b=i;if(this.Q>=0&&typeof d.j.da[this.Q]!=="undefined"){var e=d.j.da[this.Q].properties;e&&typeof e[a]!=="undefined"&&e[a]!==i&&(b=e[a])}else this.properties&&
typeof this.properties[a]!=="undefined"&&this.properties[a]!==i&&(b=this.properties[a]);return b};o.prototype.xb=function(a){return(this.$b&a)!=0};o.prototype.pa=function(a){var b=this.Ma("ic"),e=!1;if(b==i){var f=2,b="RdYlBu",e=0;typeof z.col!=="undefined"&&z.col!==i&&(f=z.col);typeof z.ics!=="undefined"&&z.ics!==i&&(b=z.ics);typeof z.ico!=="undefined"&&z.ico!==i&&(e=z.ico);var g=3+Object.keys(colorbrewer[b]).length-1,b=colorbrewer[b][(f==1?Math.max(3,Math.min(g,d.ha+1)):g).toString()],g=0;switch(f){case 0:g=
(this.I+e)%b.length;break;case 1:g=(Math.max(0,this.U)+e)%b.length;break;case 2:this.Ta>=0?(g=(this.Ta+e)%b.length,(f=d.j.q[d.j.F[this.Ta]])&&(f.Ta+e)%b.length==g&&(g=(this.Ta+1+e)%b.length)):g=(this.I+parseInt(0.75*b.length)+e)%b.length;break;case 3:g=(this.Q+1+e)%b.length}b=Nh(b[g]);e=!0}a!="ici"&&(f={icd:[75,80],ich:[45,100]},b=ff(b[0],b[1],b[2]),b=hf(b[0],b[1]>5?f[a][0]:b[1],f[a][1]));return[b,e]};o.prototype.Rb=function(a){var b=this.Ma("tc"),e=!1;if(b===i){a=this.pa(a)[0];if(d.B<=Fa&&typeof z.ia!==
"undefined"&&z.ia!==i)b=z.ia,b<1&&(e=1-b,a=[b*a[0]+e*Sb[0],b*a[1]+e*Sb[1],b*a[2]+e*Sb[2]]);b=mg(a,[255,255,255],[0,0,0]);e=!0}return[b,e]};o.prototype.Pb=function(){var a=this.Ma("fn");a===i&&(a="Verdana");return a};o.prototype.sa=function(){var a=this.Ma("iw");a===i&&(a=1);return a};o.prototype.Dc=function(){var a=this.Ma("is");a===i&&(a="default");return a};o.prototype.ec=function(){if(this.image){var a=this.Ma("iis");a===i&&(a=0);return a}else return-1};o.prototype.df=function(){var a=this.Ma("sym");
a===i&&(a=[]);return a};m.prototype.kd=function(a,d,b,e,f){this.jd(a,d,b,e,f);this.ob=1;this.La=typeof a.pt!=="undefined"?a.pt:i;this.Cc=typeof a.ptd!=="undefined"?a.ptd:i};m.prototype.jd=function(c,d,b,e,f){this.Ea=c.r;this.Na=c.tr;this.ra=d;this.Va=b;this.ub=e;this.vb=f;this.label=c.l==""?c.s:c.l;this.index=c.n;this.count=c.c;this.Ha=c.u;this.Hg=c.v;try{this.properties=c.o&&c.o.length>0?a.parseJSON(c.o):i}catch(g){this.properties=i}this.$b=typeof c.ar!=="undefined"?parseInt(c.ar):268435455};m.prototype.Ma=
function(a){var b=i;if(this.Na>=0&&typeof d.j.Ab[this.Na]!=="undefined"){var e=d.j.Ab[this.Na].properties;e&&typeof e[a]!=="undefined"&&e[a]!==i&&(b=e[a])}else this.properties&&typeof this.properties[a]!=="undefined"&&this.properties[a]!==i&&(b=this.properties[a]);return b};m.prototype.xb=function(a){return(this.$b&a)!=0};m.prototype.pa=function(a,d,b){var e=this.Ma("rc"),f=!1;e===i&&(e=d?d.pa():a.pa(b)[0],f=!0);return[e,f]};m.prototype.Rb=function(a,d,b){var e=this.Ma("tc"),f=!1;e===i&&(e=mg(yf?
this.pa(a,d,b)[0]:Sb,[239,239,239],[34,34,34]),f=!0);return[e,f]};m.prototype.ke=function(){var a=this.Ma("ls");a===i&&(a=0);return a};m.prototype.cf=function(){var a=this.Ma("lw");a===i&&(a=1);return a};m.prototype.Gd=function(){var a=this.Ma("la");a===i&&(a=2);return a};m.prototype.Hd=function(){var a=this.Ma("lfn");a===i&&(a="Verdana");return a};m.prototype.Id=function(){var a=this.Ma("lfs");a===i&&(a=1);return a};m.prototype.Fd=function(c,b,e){function f(e,l){var g=e.length;if(g!=l){var t;for(t=
g==0?{x:Oh(Ph(c,b),2).x*1,y:Oh(Ph(c,b),2).y*d.K}:e[Math.floor((g-1)/2)];e.length<l;)e.splice(Math.floor((g-1)/2)+1,0,a.extend({},t))}}var g=[];if(e==0)this.Ic&&(g=a.extend(!0,[],this.Ic));else if(e==1E3)this.La&&(g=a.extend(!0,[],this.La));else if(this.Ic||this.La){var h=1E3-e,j=[],n=[];this.Ic&&(j=a.extend(!0,[],this.Ic));this.La&&(n=a.extend(!0,[],this.La));var m=Math.max(j.length,n.length),v=0;f(j,m);f(n,m);for(v=0;v<m;v++)g.push(Oh(Ph(Z(j[v],h),Z(n[v],e)),1E3))}g.forEach(function(a){var c=d.K;
c==0?(a.x=0,a.y=0):(a.x/=1,a.y/=c)});return g};m.prototype.je=function(){var a=this.gb,b=this.Sa,e=this.fb,f=this.Ra,g=e-a,h=f-b,j=Math.sqrt(g*g+h*h),n=(a+e)/2,m=(b+f)/2,h=this.bb==0?a:n+2*this.bb*(-h/j),g=this.bb==0?b:m+2*this.bb*(g/j),j=i;if(d.Ec()||d.yb())j=this.Fd(X(this.gb,this.Sa),X(this.fb,this.Ra),1E3),j.unshift(X(this.gb,this.Sa/d.K)),j.push(X(this.fb,this.Ra/d.K));a=d.j.Me(n,m/d.K,a,b/d.K,h,g/d.K,e,f/d.K,j);a.y*=d.K;return a};j.prototype.kd=function(c){this.F=a.map(c.lm,function(a,c){return parseInt(c)});
this.xd=c.x0;this.Bd=c.y0;this.yd=c.x1;this.Cd=c.y1;this.zd=c.x2;this.Dd=c.y2;this.Ad=c.x3;this.Ed=c.y3;this.ob=1};j.prototype.Rc=function(a){var b=1E3-a;return[{x:(b*this.ye+a*this.xd)/1E3,y:(b*this.Ce+a*this.Bd)/(1E3*d.K)},{x:(b*this.ze+a*this.yd)/1E3,y:(b*this.De+a*this.Cd)/(1E3*d.K)},{x:(b*this.Ae+a*this.zd)/1E3,y:(b*this.Ee+a*this.Dd)/(1E3*d.K)},{x:(b*this.Be+a*this.Ad)/1E3,y:(b*this.Fe+a*this.Ed)/(1E3*d.K)}]};j.prototype.pa=function(){return hf((110+this.bg*151)%360,80,100)};f.prototype.Jf=
function(a){for(var d=0,d=C.find(".ikmap"),b=d.width()/2,e=d.height()/2,f=0,g=0,h=-1,n=-1,d=0;d<a.i.length;d++)this.q.push(new o(a,d,!0,b,e)),this.F[a.i[d].i]=this.q.length-1;if(typeof a.gp!=="undefined")for(d=0;d<a.gp.length;d++)this.Qa.push(new j(a.gp[d],!0,b,e)),this.Sb[a.gp[d].id]=this.Qa.length-1;for(d=0;d<a.r.length;d++)f=this.F[a.r[d].f],g=this.F[a.r[d].t],h=typeof a.r[d].gf!=="undefined"?this.Sb[a.r[d].gf]:-1,n=typeof a.r[d].gt!=="undefined"?this.Sb[a.r[d].gt]:-1,this.R.push(new m(a.r[d],
f,g,h,n,!0)),this.ja[a.r[d].r]=this.R.length-1;this.Ke(a);this.ve()};f.prototype.sd=function(a){var d=0,b=0,e=0,e=b=0,f=-1,g=-1;this.vc=a.i.length>0?a.i[0].i:-1;this.q.length==0||typeof this.F[this.vc]==="undefined"?(d=C.find(".ikmap"),b=d.width()/2,e=d.height()/2):(b=this.q[this.F[this.vc]].Wb,e=this.q[this.F[this.vc]].Xb);for(d=0;d<a.i.length;d++)typeof this.F[a.i[d].i]==="undefined"?(this.q.push(new o(a,d,!1,b,e)),this.F[a.i[d].i]=this.q.length-1):this.q[this.F[a.i[d].i]].kd(a,d);if(typeof a.gp!==
"undefined")for(d=0;d<a.gp.length;d++)typeof this.Sb[a.gp[d].id]==="undefined"?(f=new j(a.gp[d],!1,b,e),f.ye=b,f.Ce=e,f.ze=b,f.De=e,f.Ae=b,f.Ee=e,f.Be=b,f.Fe=e,this.Qa.push(f),this.Sb[a.gp[d].id]=this.Qa.length-1):this.Qa[this.Sb[a.gp[d].id]].kd(a.gp[d]);for(d=0;d<a.r.length;d++)b=this.F[a.r[d].f],e=this.F[a.r[d].t],f=typeof a.r[d].gf!=="undefined"?this.Sb[a.r[d].gf]:-1,g=typeof a.r[d].gt!=="undefined"?this.Sb[a.r[d].gt]:-1,typeof this.ja[a.r[d].r]==="undefined"?(this.R.push(new m(a.r[d],b,e,f,g,
!1)),this.ja[a.r[d].r]=this.R.length-1):this.R[this.ja[a.r[d].r]].kd(a.r[d],b,e,f,g);this.Ke(a);this.ve()};f.prototype.Ke=function(c){var d=0;if(typeof c.it!=="undefined")for(d=0;d<c.it.length;d++)this.da[c.it[d].ti]={templateName:c.it[d].tn,properties:c.it[d].o&&c.it[d].o.length>0?a.parseJSON(c.it[d].o):i};if(typeof c.rt!=="undefined")for(d=0;d<c.rt.length;d++)this.Ab[c.rt[d].tr]={templateName:c.rt[d].tn,properties:c.rt[d].o&&c.rt[d].o.length>0?a.parseJSON(c.rt[d].o):i}};f.prototype.$f=function(a,
b){for(var e=[],f,g,h,j=0;j<this.R.length;j++)f=this.R[j],g=d.j.q[f.ra].I,h=d.j.q[f.Va].I,(g==a||h==a)&&(g==b||h==b)&&e.push(f);return e};f.prototype.ve=function(){var a=0;this.Zb=[];for(var d=this.q,a=0;a<this.q.length;a++)this.Zb[a]=a;this.Zb.sort(function(a,c){return d[a].U==0?1:d[c].U==0?-1:d[a].N-d[c].N})};f.prototype.xe=function(a,b,e,f,g,h,j,n){var m=0,v=d.na&&jd(a.dt).length>10?qa:pa,o=Ze(a,h),h=o.r,o=o.f;b==i?(a.x=0,a.y=0):(e!=i&&(m=Math.atan2(b.y-e.y,b.x-e.x)),f+=m,e=0.025*(b.c+a.c)+0.1*
b.c*a.c/(b.c+a.c),n=(1+e)*g+0.5*d.M*(a[n]+b[n]),a.x=b.x+Math.round(((0.4+e)*g+0.5*d.M*(a[j]+b[j]))*Math.cos(f)),a.y=b.y+Math.round(n*Math.sin(f)));a.r=Math.round(Ca*h*d.D);a.t=Math.round(Ea*o*d.D);a.w=Math.round(o*v*d.D);a.xo=a.x;a.yo=a.y};f.prototype.bf=function(c){for(var d=0,b,e,f,g={},h=[],d=0;d<c.r.length;d++)if(b=c.r[d],f=a.trim(b.l).toLowerCase(),f!="")e=c.r[d].f,b=c.r[d].t,e="f\u00a7"+e+"\u00a7"+f,typeof g[e]==="undefined"?g[e]=[d]:g[e].push(d),b="t\u00a7"+b+"\u00a7"+f,typeof g[b]==="undefined"?
g[b]=[d]:g[b].push(d);for(d=0;d<c.r.length;d++)if(b=c.r[d],f=a.trim(b.l).toLowerCase(),f!="")e=c.r[d].f,b=c.r[d].t,e="f\u00a7"+e+"\u00a7"+f,b="t\u00a7"+b+"\u00a7"+f,g[e].length>=2?g[b].splice(a.inArray(d,g[b]),1):g[e].splice(a.inArray(d,g[e]),1);a.each(g,function(a,b){if(b.length>1){h.push({ria:b,dir:a.charAt(0)});for(d=0;d<b.length;d++)c.r[b[d]].cp=h.length-1}});return h};f.prototype.sf=function(c,b,e,f,g,h,j,n,m,v,o){var p={},r={},u={},s={},q=0,w=0,x=100*d.M*(0.75+Math.min(1,c.r.length/150)),B=
1.1*Math.PI,K=0,A=0,C=-1,z=-1,E=0,I=0,F=0,N=0,J=0,H=0,Y={},y=A=K=w=J=0,Q=K=0,aa=0,y=v?d.rotation:0,v=y*2*Math.PI/360,P=Math.sin(v),T=Math.cos(v),R=y>45&&y<135||y>225&&y<315,sa=y>45&&y<225,v=R?"eh":"ew",ka=R?"ew":"eh",q=A=i,K=-1,K=A=i;Nf=e;for(y=0;y<c.i.length;y++)Y[c.i[y].i]=y,c.i[y].pdat=Math.PI,c.i[y].pda=Math.PI,N=Math.max(N,c.i[y].c);for(y=0;y<c.i.length;y++)wh(c,y,N);for(y=0;y<c.r.length;y++)if(typeof p[c.r[y].f]==="undefined"?p[c.r[y].f]=1:p[c.r[y].f]++,typeof p[c.r[y].t]==="undefined"?p[c.r[y].t]=
1:p[c.r[y].t]++,r[c.r[y].f+"-"+c.r[y].t]=c.r[y].r,H+=Math.max(c.r[y].l.length,c.r[y].s.length),J=Y[c.r[y].f],w=Y[c.r[y].t],J!=w&&J>=0&&J<c.i.length&&w>=0&&w<c.i.length){if(c.i[J].k.length>0||typeof wb[c.i[J].i]!=="undefined")J=Ze(c.i[J],N),J=J.r,H+=0.7*Ca*J;if(c.i[w].k.length>0||typeof wb[c.i[w].i]!=="undefined")J=Ze(c.i[w],N),J=J.r,H+=0.7*Ca*J}H*=5;c.r.length>0&&(H/=c.r.length);x+=H;for(y=0;y<c.i.length;y++)typeof u[c.i[y].l]==="undefined"?u[c.i[y].l]=1:u[c.i[y].l]++,typeof p[c.i[y].i]==="undefined"?
p[c.i[y].i]=1:p[c.i[y].i]++,typeof s[c.i[y].i]==="undefined"&&(s[c.i[y].i]=0),c.i[y].p>=0&&c.i[c.i[y].p].p>=0&&s[c.i[c.i[c.i[y].p].p].i]++;if(typeof u["0"]!=="undefined"&&typeof u["1"]!=="undefined")if(q=u["0"],w=q+u["1"],I=c.i[0].c,F=s[c.i[0].i],g)for(y=q;y<w;y++)if(K=Math.PI*(1+0.1*c.i[y].c)/(I+0.1*F),typeof r[c.i[y].i+"-"+c.i[0].i]==="undefined")B-=2*K;else{B-=K;z=y;break}else if(typeof this.F[c.i[0].i]!=="undefined"&&d.fa!=i)if(y=this.q[this.F[c.i[0].i]].A,y.p>=0){J=d.fa.i[y.p];B=Math.atan2(J.yo-
y.yo,J.xo-y.xo);for(y=q;y<w;y++)if(K=Math.PI*(1+0.1*c.i[y].c)/(I+0.1*F),c.i[y].i==J.i){B-=K;break}else B-=2*K}else if(typeof this.F[c.i[q].i]!=="undefined")w=this.q[this.F[c.i[q].i]].A,B=Math.atan2(w.yo-y.yo,w.xo-y.xo),K=Math.PI*(1+0.1*c.i[q].c)/(I+0.1*F),B-=K;q=0;typeof u["0"]!=="undefined"&&(this.xe(c.i[q],i,i,0,x,N,v,ka),q+=u["0"]);if(typeof u["1"]!=="undefined"){w=q+u["1"];I=c.i[0].c;F=s[c.i[0].i];for(y=q;y<w;y++)K=Math.PI*(1+0.1*c.i[y].c)/(I+0.1*F),B+=K,this.xe(c.i[y],c.i[c.i[y].p],i,B,x,N,v,
ka),B+=K;for(y=q;y<w;y++)K=y-1,A=y+1,y==q&&(K=w-1),y==w-1&&(A=q),c.i[y].pda=Math.min(2*Math.PI/3,c.i[y].pda+0.5*(c.i[K].pdat+c.i[A].pdat));q=w}for(J=2;;)if(typeof u[J]==="undefined")break;else{w=q+u[J];for(y=q;y<w;y++){A=c.i[y].p;if(A==C)y!=z&&E++;else{C=A;I=c.i[A].c;F=s[c.i[A].i];B=-c.i[A].pda;z=-1;if(g){for(K=y;K<w;K++)if(c.i[K].p==C){if(typeof r[c.i[K].i+"-"+c.i[A].i]!=="undefined"){z=K;break}}else break;if(z>=0){E=0;B=-c.i[A].pda*(1+0.1*c.i[z].c)/(I+0.1*F);for(K=y;K<w&&E<Math.floor(I/2);K++)if(c.i[K].p==
C)K!=z&&(B-=2*c.i[A].pda*(1+0.1*c.i[K].c)/(I+0.1*F),E++);else break}}E=0;y==z&&E--}z>=0&&E==Math.floor(I/2)&&(B+=2*c.i[A].pda*(1+0.1*c.i[z].c)/(I+0.1*F));K=y==z?0:c.i[A].pda*(1+0.1*c.i[y].c)/(I+0.1*F);B+=K;this.xe(c.i[y],c.i[A],c.i[c.i[A].p],y==z?0:B,x,N,v,ka);B+=K}for(y=q;y<w;y++)K=y-1,A=y+1,y==q&&(K=w-1),y==w-1&&(A=q),c.i[y].pda=Math.min(2*Math.PI/3,c.i[y].pda+0.5*(c.i[K].pdat+c.i[A].pdat));q=w;J++}if(Nf){if(o)for(y=0;y<c.i.length;y++)if(q=c.i[y],q.p>=0&&q.p<c.i.length&&q.o&&q.o.length>0&&(K=c.i[q.p].i,
A=a.parseJSON(q.o)))if((A=A[o])&&K>=0)if(K=A[K.toString()])q.x=c.i[q.p].x+K.ox+K.x,q.y=c.i[q.p].y+K.oy+K.y}else{for(var r=[],s=[],J=z=E=0,w=i,ia=d.M/Math.pow(d.Xa,0.6),C=j&&n?0.4:1,z=E=0,x=[],z=[],E=[],I=[],F=[],N=[],B=[],p=[],q=!1,u=i,ia=1+(ia-1)*0.5,y=0;y<c.i.length;y++){q=c.i[y];typeof b[q.i]==="undefined"||typeof b[q.i].lx==="undefined"||typeof b[q.i].ly==="undefined"?(Q=q.x,aa=q.y):(Q=b[q.i].lx,aa=b[q.i].ly);q.lx=Q;q.ly=aa;r.push({x:Q,y:aa,width:(35*C+q[v])*d.M,height:(35*C+q[ka])*d.M});if(o&&
q.o&&q.o.length>0&&(J=q.p,w=y,J!=w&&J>=0&&J<c.i.length&&(K=c.i[J].i,A=a.parseJSON(q.o))))if((A=A[o])&&K>=0)if(K=A[K.toString()+(j?":"+q.l.toString():"")])e={axis:"x",left:J,right:w,equality:"true",gap:K.ox+K.x},x.push(e),e={axis:"y",left:J,right:w,equality:"true",gap:K.oy+K.y},x.push(e);m>0&&(z.push(-1),E.push(-1),I.push(-1),F.push(-1),N.push(-1),B.push(0),p.push(0))}if(m>0){for(y=0;y<c.r.length;y++)if(J=Y[c.r[y].f],w=Y[c.r[y].t],J!=w&&J>=0&&J<c.i.length&&w>=0&&w<c.i.length)K=c.i[J].l,A=c.i[w].l,
A<K&&(q=J,J=w,w=q),z[w]==-1&&(z[w]=J);for(y=0;y<c.i.length;y++)q=c.i[y],z[y]<0&&(z[y]=q.p),z[y]>=0&&(F[y]=E[z[y]],m==2&&(z[y]>0&&B[z[y]]%2==0&&(F[y]=-1),N[y]=I[z[y]],I[z[y]]=E[z[y]],B[z[y]]++,N[y]>=0&&(p[y]=R?0.5*(c.i[N[y]][ka]+q[ka]):sa?c.i[N[y]][ka]:q[ka],F[y]>=0&&(p[y]=Math.max(p[y],p[F[y]]),p[F[y]]=p[y]))),E[z[y]]=y);for(y=0;y<c.i.length;y++)q=c.i[y],z[y]>=0&&(q.l==1?(F[y]>=0?(e={axis:"x",left:F[y],right:y,gap:100*d.M+(R?sa?c.i[F[y]][v]:q[v]:0.5*(c.i[F[y]][v]+q[v]))},x.push(e),e={axis:"y",left:F[y],
right:y,equality:"true",gap:0}):e={axis:"y",left:0,right:y,equality:"true",gap:150*d.M},x.push(e)):m==2?(F[y]>=0&&(e={axis:"x",left:F[y],right:y,gap:(n?1:2)*20*d.M+(R?sa?q[v]:c.i[F[y]][v]:0.5*(c.i[F[y]][v]+q[v]))},x.push(e),e={axis:"y",left:F[y],right:y,equality:"true",gap:0},x.push(e)),N[y]>=0&&(e={axis:"x",left:N[y],right:y,equality:"true",gap:0},x.push(e),p[y]>0&&(e={axis:"y",left:N[y],right:y,equality:"true",gap:(n?1:2)*35*d.M+p[y]},x.push(e),r[y].height*=0.5)),F[y]<0&&N[y]<0&&(e={axis:"y",left:z[y],
right:y,gap:0},x.push(e)),y>0&&(e={axis:"y",left:0,right:y,gap:0},x.push(e))):F[y]>=0||q.l==2?(e={axis:"x",left:F[y]>=0?F[y]:z[y],right:y,equality:"true",gap:0},x.push(e),e={axis:"y",left:F[y]>=0?F[y]:z[y],right:y,equality:"true",gap:(F[y]>=0?35:75)*d.M+(R?0.5*(c.i[F[y]>=0?F[y]:z[y]][ka]+q[ka]):sa?c.i[F[y]>=0?F[y]:z[y]][ka]:q[ka])},x.push(e),F[y]>=0&&(r[y].height*=0.5)):(e={axis:"y",left:z[y],right:y,gap:0},x.push(e)))}if(h){u=this.bf(c);for(y=0;y<u.length;y++)J=Y[c.r[u[y].ria[0]].f],w=Y[c.r[u[y].ria[0]].t],
E=c.r[u[y].ria[0]].l.length*10+100,r.push({x:0.5*(r[J].x+r[w].x),y:0.5*(r[J].y+r[w].y),width:E,height:150})}for(y=0;y<c.r.length;y++)if(J=Y[c.r[y].f],w=Y[c.r[y].t],J!=w&&J>=0&&J<c.i.length&&w>=0&&w<c.i.length)E=c.i[J][v]+c.i[w][v],z=c.i[J][ka]+c.i[w][ka],K=c.i[J].l,A=c.i[w].l,q=!1,m>0&&A<K&&(q=J,J=w,w=q,q=!0),E=d.M*(25*C+0.5*Math.min(E,z)),z=25*d.M+0.5*z,h&&typeof c.r[y].cp!=="undefined"?(b=c.r[y].cp,s.push({source:J,target:c.i.length+b,i:y,ld:(0.75+(u[b].dir=="f"?0.005:0.05)*Math.pow(u[b].ria.length,
0.5))*E,rev:q}),s.push({source:c.i.length+b,target:w,i:y,ld:(1.25+(u[b].dir=="t"?0.005:0.05)*Math.pow(u[b].ria.length,0.5))*E,rev:q}),g&&Math.abs(A-K)==1&&(e={axis:"y",left:J,right:c.i.length+b,gap:(0.25+(u[b].dir=="f"?0.015:0.15)*Math.pow(u[b].ria.length,0.5))*z},x.push(e),e={axis:"y",left:c.i.length+b,right:w,gap:(0.75+(u[b].dir=="t"?0.015:0.15)*Math.pow(u[b].ria.length,0.5))*z},x.push(e))):s.push({source:J,target:w,i:y,ld:E,rev:q}),g&&Math.abs(A-K)==1&&(e={axis:"y",left:J,right:w,gap:z},x.push(e));
var L=i,g=cola.adaptor({});g.nodes(r);g.links(s);g.avoidOverlaps(!1);g.symmetricDiffLinkLengths(45,d.M);g._linkDistance=function(a){return Math.min(45*a.length,1.3*a.ld)};j&&g.powerGraphGroups(function(a){return(L=a).groups.forEach(function(a){var c=0,d=0;typeof a.leaves!=="undefined"&&a.leaves.length>0&&!R&&(a.leaves.forEach(function(a){d+=a.width}),d/=a.leaves.length);d>0&&d<80&&(c=80-d);return a.padding=(R?30:10)*ia+c})});x.length>0&&g.constraints(x);m=performance.now();g.start(1,0,0,0,!1);y=1+
performance.now()-m;y=Math.max(Math.min(15,Math.floor(2500/y)),Math.min(25,Math.floor(1E3/y)));if(y>0){g.start(y,0,y,0,!1);g.avoidOverlaps(!0);g.start(0,0,y,0,!1);if(f&&!h){for(y=0;y<c.i.length;y++)q=c.i[y],w=r[y],J=2.5*q.r*ia/Math.pow(d.Xa,0.15),y==0&&(J*=2),E=w.width,z=w.height,w.bounds.x=w.x-0.4*E,w.bounds.X=w.x+0.4*E,w.bounds.y=w.y-0.8*z+J,w.bounds.Y=w.y+J,w.width=0.8*E,w.height=0.8*z,w.innerBounds=w.bounds;g.prepareEdgeRouting();m=performance.now();for(y=0;y<s.length&&performance.now()<m+5E3;y++)try{var oa=
s[y],O=oa.i,V=[],ca=g.routeEdge(oa);V.push({x:oa.source.x,y:oa.source.y});a.each(ca,function(){typeof this.vv!=="undefined"&&V.push({x:this.x,y:this.y})});V.push({x:oa.target.x,y:oa.target.y});(V=Qh(V))?(V.forEach(function(a){Q=a.x;aa=a.y;a.x=T*Q-P*aa;a.y=P*Q+T*aa}),oa.rev&&V.reverse(),c.r[O].pt=V):typeof c.r[O].pt!=="undefined"&&delete c.r[O].pt}catch(da){}}if(j&&L){var Ga,Ja,xb,ga,ba,ob,na,vc={},ta=function(a,d){var b=ob<0;typeof a.leaves!=="undefined"&&a.leaves.forEach(function(a){if(ba||a.x-d<
Ga)Ga=a.x-d;if(ba||a.x+d>Ja)Ja=a.x+d;if(ba||a.y-d<xb)xb=a.y-d;if(ba||a.y+d>ga)ga=a.y+d;ba=!1;b&&(ob=ob>=0?Math.min(ob,c.i[a.index].i):c.i[a.index].i);na[c.i[a.index].i]=1;vc[c.i[a.index].i]=c.gp.length});typeof a.groups!=="undefined"&&a.groups.forEach(function(a){ta(a,d+30)})};c.gp=[];typeof L.groups!=="undefined"&&a.each(L.groups,function(){ba=!0;ob=-1;na={};ta(this,30);c.gp.push({x0:T*Ga-P*xb,y0:P*Ga+T*xb,x1:T*Ja-P*xb,y1:P*Ja+T*xb,x2:T*Ja-P*ga,y2:P*Ja+T*ga,x3:T*Ga-P*ga,y3:P*Ga+T*ga,id:ob,lm:na,
rim:{}})});if(n&&typeof L.powerEdges!=="undefined"){a.each(L.powerEdges,function(){var d=this.source,b=this.target,e=-1,k=-1,f=-1,l=-1;typeof d.id!=="undefined"?e=d.id:f=d.index;typeof b.id!=="undefined"?k=b.id:l=b.index;e>=0&&(k>=0?c.gp[e].rim=a.extend(c.gp[e].rim,c.gp[k].lm):l>=0&&(c.gp[e].rim[c.i[l].i]=1));k>=0&&(e>=0?c.gp[k].rim=a.extend(c.gp[k].rim,c.gp[e].lm):f>=0&&(c.gp[k].rim[c.i[f].i]=1))});for(y=0;y<c.r.length;y++){f=c.r[y].f;j=c.r[y].t;oa=n=-1;typeof vc[f]!=="undefined"&&(n=vc[f]);typeof vc[j]!==
"undefined"&&(oa=vc[j]);if(n>=0&&typeof c.gp[n].rim[j]!=="undefined")c.r[y].gf=c.gp[n].id,typeof c.r[y].pt!=="undefined"&&delete c.r[y].pt;if(oa>=0&&typeof c.gp[oa].rim[f]!=="undefined")c.r[y].gt=c.gp[oa].id,typeof c.r[y].pt!=="undefined"&&delete c.r[y].pt}}}for(y=0;y<c.i.length;y++)c.i[y].sx=r[y].x,c.i[y].sy=r[y].y,c.i[y].x=T*r[y].x-P*r[y].y,c.i[y].y=P*r[y].x+T*r[y].y;if(h)for(y=0;y<c.r.length;y++)if(typeof c.r[y].cp!=="undefined")b=c.i.length+c.r[y].cp,c.r[y].pt=[{x:T*r[b].x-P*r[b].y,y:P*r[b].x+
T*r[b].y}],c.r[y].ptd=u[c.r[y].cp].dir}else Nf=!0}if(Nf)for(y=0;y<c.i.length;y++)c.i[y].sx=c.i[y].x,c.i[y].sy=c.i[y].y,c.i[y].x=T*c.i[y].sx-P*c.i[y].sy,c.i[y].y=P*c.i[y].sx+T*c.i[y].sy};f.prototype.ng=function(c,b,e,f){function g(a){for(a+="";a.length<8;)a="0"+a;return a}var h=0,j=0,n=0,m=-1,v=i,o=i,p=i,r=0,v=[],u=[],r=-1,s={},r=i,r=0,q=i,q=i,w=0,h=d.rotation;if(h>45&&h<135||h>225&&h<315)e=="TB"?(e="LR",h-=270,h<0&&(h+=360)):(e="TB",h+=270,h>=360&&(h-=360));var h=h*2*Math.PI/360,x=Math.sin(h),A=Math.cos(h),
B=new window.dagre.graphlib.Graph({directed:!0,multigraph:!0,compound:!1});Nf=!1;B.setGraph({nodesep:15+10*d.M,ranksep:50*(d.M-1),edgesep:20,marginx:0,marginy:0,rankdir:e});for(h=0;h<c.i.length;h++)v.push(h),q=c.i[h],typeof b[q.i]==="undefined"||typeof b[q.i].lo==="undefined"?r=h:(r=b[q.i].lo,r<1E6&&(r+=1E6)),q.lo=r,w=Math.max(w,q.c);v.sort(function(a,d){var b=c.i[a],e=c.i[d],k=b.sn,f=e.sn,l=b.lo,g=e.lo;return(b.p>=0?c.i[b.p].i:-1)==(e.p>=0?c.i[e.p].i:-1)&&k!=f&&l<1E6&&g<1E6?k-f:l-g});for(var C=b=
0,z=-1,E=0,F=0,J,h=0;h<c.i.length;h++){r=v[h];q=c.i[r];r=wh(c,r,w);b=C=e=="LR"&&q.p==z?2*r.h-b:r.h;z=q.p;F=E=0;if(f&&q.o&&q.o.length>0&&(J=a.parseJSON(q.o))&&J[f])E=J[f].x,F=J[f].y;B.setNode(g(h),{width:r.w+(e=="LR"?5*q.c:0),height:C+(e=="TB"?10*q.c:0),shiftx:E,shifty:F});s[q.i]=h}for(h=0;h<c.r.length;h++)u.push(h);u.sort(function(a,d){var b=c.r[a],e=c.r[d],k=s[b.f],f=s[b.t],b=s[e.f],l=s[e.t],e=Math.max(k,f),g=Math.max(b,l),k=Math.min(k,f),b=Math.min(b,l);return e!=g?e-g:k-b});for(h=0;h<c.r.length;h++)r=
u[h],q=c.r[r],q.f!=q.t&&B.setEdge(g(s[q.f]),g(s[q.t]),{i:r,width:20,height:20,labelpos:"c"},g(h));window.dagre.layout(B);for(h=0;h<c.i.length;h++)q=c.i[h],f=Ze(q,w),e=f.r,f=f.f,v=B.node(g(s[q.i])),r=d.na&&jd(q.dt).length>10?qa:pa,q.xo=v.x,q.yo=v.y,q.sx=v.x,q.sy=v.y,q.x=A*v.x-x*v.y,q.y=x*v.x+A*v.y,q.r=Math.round(Ca*e*d.D),q.t=Math.round(Ea*f*d.D),q.w=Math.round(f*r*d.D);B.edges().forEach(function(a){o=B.edge(a);m=parseInt(o.i);p=o.points;(p=Qh(p))?(p.forEach(function(a){j=a.x;n=a.y;a.x=A*j-x*n;a.y=
x*j+A*n}),c.r[m].pt=p):typeof c.r[m].pt!=="undefined"&&delete c.r[m].pt})};f.prototype.rf=function(c){function b(a){q=Math.min(q,a.x);w=Math.max(w,a.x);x=Math.min(x,a.y);A=Math.max(A,a.y);B=Math.min(B,a.z);C=Math.max(C,a.z)}function e(a,c){a.x-=z;a.y-=E;a.z-=J;var b=c.f;a.r=Math.round(Ca*c.r*d.D*s);a.t=Math.round(Ea*b*d.D*s);a.w=Math.round(b*pa*d.D*s)}var f=[],g=[],h={},j,n,m,v,o,p,r,u=0,s=0.8,q=1E6,w=-1E6,x=1E6,A=-1E6,B=1E6,C=-1E6,z,E,J,F=[],I,N=d.za>0&&d.za!=4;this.sf(c,{},!0,!1,N,!1,!1,!1,0,!1,
i);for(n=0;n<c.i.length;n++)j=c.i[n],h[j.i]=n,u=Math.max(u,j.c),f.push({x:0.1*j.x,y:-10*j.l,z:0.1*j.y});j=this.bf(c);for(n=0;n<j.length;n++)m=h[c.r[j[n].ria[0]].f],v=h[c.r[j[n].ria[0]].t],f.push({x:0.5*(f[m].x+f[v].x),y:0.5*(f[m].y+f[v].y),z:0.5*(f[m].z+f[v].z)});for(n=0;n<c.r.length;n++)if(m=h[c.r[n].f],v=h[c.r[n].t],m!=v&&m>=0&&m<c.i.length&&v>=0&&v<c.i.length&&(typeof c.r[n].cp!=="undefined"?(o=c.r[n].cp,g.push({source:m,target:c.i.length+o,ld:0.75+(j[o].dir=="f"?0.025:0.25)*Math.pow(j[o].ria.length,
0.333)}),g.push({source:c.i.length+o,target:v,ld:0.75+(j[o].dir=="t"?0.025:0.25)*Math.pow(j[o].ria.length,0.333)})):g.push({source:m,target:v,ld:1.5}),N&&(p=c.i[m],o=c.i[v],p=p.l,r=o.l,Math.abs(r-p)==1))){I=55;a.trim(c.r[n].l)!=""&&(I*=1.5);if(d.za==3||p<r)o=m,m=v,v=o;d.za==2&&(p=Math.min(p,r),n%2==0&&(o=m,m=v,v=o),p%2==1&&(I*=0.5));m={axis:"y",left:m,right:v,gap:I*d.M};F.push(m)}h=d.za==4?10:1;for(j=0;j<h;j++){f.push({x:0,y:0,z:0});for(n=0;n<f.length-j-1;n++)g.push({source:f.length-1,target:n,ld:1.5})}n=
new cola.Layout3D(f,g,function(a){return 35*d.M*a.ld});n.useJaccardLinkLengths=!1;N&&(n.constraints=F);n.start(100);F=n.result;for(n=0;n<c.i.length;n++)j=c.i[n],j.x=F[0][n],j.y=F[1][n],j.z=F[2][n],b(j);for(n=0;n<c.r.length;n++)if(typeof c.r[n].cp!=="undefined")o=c.i.length+c.r[n].cp,c.r[n].pt=[{x:F[0][o],y:F[1][o],z:F[2][o]}],b(c.r[n].pt[0]);z=0.5*(q+w);E=0.5*(x+A);J=0.5*(B+C);for(n=0;n<c.i.length;n++)e(c.i[n],Ze(c.i[n],u));for(n=0;n<c.r.length;n++)typeof c.r[n].cp!=="undefined"&&e(c.r[n].pt[0],{r:1,
f:1})};f.prototype.og=function(a,b,e){var f=C.find(".kmappage").width(),g=C.find(".kmappage").height(),h=0,j=0,n=0,m=0,v=0,o=0,v=i,p=0,r=0,u=0,s=0,q=0,w=0,m=!1,n={};if(a.i.length<1)this.width=C.find(".kmappage").width()-1,this.height=C.find(".kmappage").height()-1,this.Ac=this.Bc=0,this.hd=this.gd=!1;else{for(q=0;q<a.i.length;q++)w=Math.max(w,a.i[q].c);if(!e&&b&&a.i.length==b.i.length&&a.r.length==b.r.length){m=!0;for(q=0;q<a.i.length;q++)if(a.i[q].i!=b.i[q].i){m=!1;break}if(m)for(q=0;q<a.r.length;q++)if(a.r[q].r!=
b.r[q].r){m=!1;break}}if(m){for(q=0;q<a.i.length;q++)e=a.i[q],n=b.i[q],e.x=n.x,e.y=n.y,typeof n.lx!=="undefined"&&(e.lx=n.lx),typeof n.ly!=="undefined"&&(e.ly=n.ly),typeof n.lo!=="undefined"&&(e.lo=n.lo),e.xo=n.xo,e.yo=n.yo,e.sx=n.sx,e.sy=n.sy,e.r=n.r,e.t=n.t,e.w=n.w;for(q=0;q<a.r.length;q++)typeof b.r[q].pt!=="undefined"&&(a.r[q].pt=b.r[q].pt),typeof b.r[q].ptd!=="undefined"&&(a.r[q].ptd=b.r[q].ptd),typeof b.r[q].gf!=="undefined"&&(a.r[q].gf=b.r[q].gf),typeof b.r[q].gt!=="undefined"&&(a.r[q].gt=
b.r[q].gt);if(typeof b.gp!=="undefined"&&typeof a.gp==="undefined"){a.gp=[];for(q=0;q<b.gp.length;q++)a.gp.push({x0:b.gp[q].x0,y0:b.gp[q].y0,x1:b.gp[q].x1,y1:b.gp[q].y1,x2:b.gp[q].x2,y2:b.gp[q].y2,x3:b.gp[q].x3,y3:b.gp[q].y3,id:b.gp[q].id,lm:b.gp[q].lm})}}else{if(b)for(q=0;q<b.i.length;q++)n[b.i[q].i]=b.i[q];b=Ua[d.G];d.hf()?this.sf(a,n,d.cg(),d.Ec(),d.Kd(),d.hc(),d.jc(),d.eg(),d.Zf(),!0,b):this.ng(a,n,d.Md()?"TB":"LR",b);for(q=0;q<a.i.length;q++)a.i[q].x=Math.round(a.i[q].x*d.D),a.i[q].y=Math.round(a.i[q].y*
d.Xa*d.D);for(q=0;q<a.r.length;q++)typeof a.r[q].pt!=="undefined"&&a.r[q].pt.forEach(function(a){a.x=Math.round(a.x*d.D);a.y=Math.round(a.y*d.Xa*d.D)});typeof a.gp!=="undefined"&&a.gp.forEach(function(a){a.x0=Math.round(a.x0*d.D);a.y0=Math.round(a.y0*d.Xa*d.D);a.x1=Math.round(a.x1*d.D);a.y1=Math.round(a.y1*d.Xa*d.D);a.x2=Math.round(a.x2*d.D);a.y2=Math.round(a.y2*d.Xa*d.D);a.x3=Math.round(a.x3*d.D);a.y3=Math.round(a.y3*d.Xa*d.D)})}v=wh(a,0,w);p=a.i[0].x-0.5*v.w*d.D;r=a.i[0].x+0.5*v.w*d.D;u=a.i[0].y-
v.h*d.D;s=a.i[0].y;for(q=1;q<a.i.length;q++)v=wh(a,q,w),n=a.i[q].x-0.5*v.w*d.D,m=a.i[q].x+0.5*v.w*d.D,v=a.i[q].y-v.h*d.D,o=a.i[q].y,n<p?p=n:m>r&&(r=m),v<u?u=v:o>s&&(s=o);for(q=0;q<a.r.length;q++)typeof a.r[q].pt!=="undefined"&&a.r[q].pt.forEach(function(a){a.x<p?p=a.x:a.x>r&&(r=a.x);a.y<u?u=a.y:a.y>s&&(s=a.y)});typeof a.gp!=="undefined"&&a.gp.forEach(function(a){a.x0<p?p=a.x0:a.x0>r&&(r=a.x0);a.x1<p?p=a.x1:a.x1>r&&(r=a.x1);a.x2<p?p=a.x2:a.x2>r&&(r=a.x2);a.x3<p?p=a.x3:a.x3>r&&(r=a.x3);a.y0<u?u=a.y0:
a.y0>s&&(s=a.y0);a.y1<u?u=a.y1:a.y1>s&&(s=a.y1);a.y2<u?u=a.y2:a.y2>s&&(s=a.y2);a.y3<u?u=a.y3:a.y3>s&&(s=a.y3)});h=p-125*d.D;j=u-125*d.D;this.width=r-h+125*d.D;this.height=s-j+125*d.D;this.gd=!af;this.hd=!af;this.Bc=this.width;this.Ac=this.height;if(this.width<f)h-=(f-this.width)/2,this.width=f,this.gd=!1;if(this.height<g)j-=(g-this.height)/2,this.height=g,this.hd=!1;for(q=0;q<a.i.length;q++)a.i[q].x-=h,a.i[q].y-=j;for(q=0;q<a.r.length;q++)typeof a.r[q].pt!=="undefined"&&a.r[q].pt.forEach(function(a){a.x-=
h;a.y-=j});typeof a.gp!=="undefined"&&a.gp.forEach(function(a){a.x0-=h;a.y0-=j;a.x1-=h;a.y1-=j;a.x2-=h;a.y2-=j;a.x3-=h;a.y3-=j})}};f.prototype.animate=function(c,b,e){var f=!1,g=0;Mh(0);this.Oc=a({step:0}).animate({step:1E3},{duration:c*Math.min(2,1+this.q.length/100),easing:typeof e!=="undefined"?e:"swing",step:function(){this.step>0&&(g=f?Math.floor(this.step+0.5):0,d.j.Nc(0,g,b,!1),f=!0)},complete:function(){g!=1E3&&d.j.Nc(0,1E3,b,!1);Lh();d.j.Oc=i}})};f.prototype.he=function(c,b,e,f){function g(){typeof b!==
"undefined"&&b()}typeof c==="undefined"&&(c=C.find(".canvas1")[0]);var h=C.find(".ikmap"),j=Math.max(h.width(),parseInt(a(c).attr("width"))),h=Math.max(h.height(),parseInt(a(c).attr("height"))),n=0,m=0;typeof e==="undefined"||typeof f==="undefined"?(e=[C.find(".canvas9"),a(c)],e=this.Kb!=this.Bb||this.Lb!=this.Cb?oe(e,this.Bb,this.Cb):oe(e),n=e.l,m=e.t):(n=e,m=f);uq=Sb;vq=Ge;e=Rh.getDataURL(c,Ge,j,h,-n,-m,d.D,Sb);if(e=="")g();else{var v=new Image;a(v).on("load",function(){if(c.getContext){var a=c.getContext("2d");
try{a.drawImage(v,0,0)}catch(d){}g()}}).attr("width",j.toString()).attr("height",h.toString()).attr("src",e)}};f.prototype.fe=function(){if(Ch)d.kf(Ch),Ch=i;else if(!Qa.is(":visible")&&(xc>=0||na.text().length>0)){var c=Yg(na[0],ad,Kb),b=na.attr("contenteditable")==="true";if(d.gc&&!d.Db){var e=rd();nb(na,e,!b&&!d.lb&&!d.nb&&!d.mb,!b&&!d.lb&&!d.nb&&!d.mb);xb()}b&&lb(na);b=a(Kb.activeElement);bh(na[0],c,ad,Kb);(b.length==0||b[0]!=na[0])&&na.blur()}if(U()||Bb()){c=this.Bc;b=this.Ac;if(d.B==Ia||d.B==
La)b=C.find(".ikmap"),c=b.width(),b=b.height();B({action:"diagramready",diagramWidth:c,diagramHeight:b,database:O},fa())}Sh=!0};f.prototype.Rf=function(){function a(){if(f<100)for(b=0;b<d.j.q.length;b++)if(e=d.j.q[b],e.image&&!e.image.complete){f++;setTimeout(a,10);return}try{d.j.Sf()}catch(g){}lf()}var b=0,e,f=0;kf(ba);a()};f.prototype.Ie=function(c,b,e,f,g,h){function j(a,c,d,g){var q=a.width(),n=a.height();o++;html2canvas(a,{onrendered:function(j){a.remove();var t=e?new THREE.MeshBasicMaterial({transparent:!0}):
new THREE.SpriteMaterial;t.map=new THREE.Texture(j);t.map.needsUpdate=!0;t.needsUpdate=!0;if(e){var j=new THREE.Vector3(0,0.5*n/(m*v)+g,0),w=new THREE.PlaneBufferGeometry(q/(m*v),n/(m*v));if(f){w.lookAt(c.position);var u=new THREE.Object3D;u.lookAt(c.position);u.updateMatrix();j.applyMatrix4(u.matrix)}w=new THREE.Mesh(w,t);w.position.copy(j);w.iid=d.I;c.add(w);w=new THREE.PlaneBufferGeometry(q/(m*v),n/(m*v));w.applyMatrix((new THREE.Matrix4).makeRotationY(Math.PI));f&&w.lookAt(c.position);w=new THREE.Mesh(w,
t);w.position.copy(j);w.iid=d.I;c.add(w);if(d.Ha!="")t=d.Ha,t.length>3&&t.substring(t.length-3)=="\u00a7if"&&(t=t.substring(0,t.length-3)),w.name="link-"+btoa(JSON.stringify({x:d.O,y:d.N,z:d.Fb,url:t}))}else t=new THREE.Sprite(t),t.scale.set(q/(m*v),n/(m*v),1),t.center.set(0.5,-g*m*v/n),t.position.set(0,0,0),t.iid=d.I,c.add(t);b.sc=!0;p++;p==o&&setTimeout(function(){h()},10)}})}function n(a,d,b,e,f,k,l,h){var q=b.position.clone().sub(e.position).normalize();bf.set(e.position,q);q=bf.intersectObject(b);
q.length>0&&(k=q[0].point);q=e.position.clone().sub(b.position).normalize();bf.set(b.position,q);q=bf.intersectObject(e);q.length>0&&(l=q[0].point);b=l.clone().sub(k);l=b.length();b.normalize();e=k.clone().add(b.clone().multiplyScalar((a?18*h:0)+0.5*(l-(a?18*h:0)-(d?18*h:0))));q=[];a?(q.push(new THREE.Vector2(0,0)),q.push(new THREE.Vector2(6*h,18*h)),q.push(new THREE.Vector2(h,18*h))):q.push(new THREE.Vector2(h,0));d?(q.push(new THREE.Vector2(h,l-18*h)),q.push(new THREE.Vector2(6*h,l-18*h)),q.push(new THREE.Vector2(0,
l))):q.push(new THREE.Vector2(h,l));a=new THREE.LatheGeometry(q,Math.ceil(g*(a||d?24:8)));f=new THREE.MeshPhongMaterial({color:new THREE.Color($e(f))});f=new THREE.Mesh(a,f);a=new THREE.Vector3(0,1,0);f.position.set(k.x,k.y,k.z);f.quaternion.setFromUnitVectors(a,b);c.add(f);return e}var m=4*g,v=2,o=0,p=0,r=0,u=i,s=i,q=i,w=i,x,A,B,C,E,F,J,I;E=0;for(var N=!1,H=!1,Y=[],aa,P,y,Q,T,R,ka,r=0;r<this.q.length;r++)if(q=this.q[r],q.V===0||typeof q.O==="undefined")Y.push(i);else{x=d.na>0&&(q.ba.length>0||q.Z&&
q.Z.length>64);F=q.Dc();E=q.pa("icd")[0];A=q.sa();w=0.8*A*q.ie;u=0.1*A*q.Ob;B=0.2*(q.image&&q.image.complete?2.5:1)*A*q.V;switch(F){case "default":case "circle":y=new THREE.SphereBufferGeometry(B,Math.ceil(g*25),Math.ceil(g*25));break;case "rect":y=new THREE.BoxBufferGeometry(2*B,2*B,2*B);break;case "rhomb":y=new THREE.OctahedronBufferGeometry(Math.sqrt(2)*B);break;case "hexagon":y=new THREE.OctahedronBufferGeometry(Math.sqrt(4/3)*B,1);break;case "triangle":y=new THREE.ConeBufferGeometry(Math.cos(Math.PI/
6)*2*B,2*B,3,1);break;case "para":y=new THREE.BoxBufferGeometry(2*B,2*B,2*B);y.applyMatrix((new THREE.Matrix4).makeShear(0,0.2,0.2));break;case "trapez":y=new THREE.CylinderBufferGeometry(0.75*Math.sqrt(2)*B,1.25*Math.sqrt(2)*B,2*B,4,1)}Q=new THREE.MeshStandardMaterial({metalness:0.3});q.image&&q.image.complete?(Q.map=new THREE.Texture(q.image),Q.map.needsUpdate=!0,Q.needsUpdate=!0):Q.color=new THREE.Color($e(E));Q=new THREE.Mesh(y,Q);Q.position.set(q.O,q.N,q.Fb);Q.updateMatrixWorld();c.add(Q);Y.push(Q);
b.sc=!0;q.Pa=typeof q.zb!=="undefined"?q.zb:q.Q>=0&&typeof d.j.da[q.Q]!=="undefined"&&d.j.da[q.Q].templateName.length>0&&d.j.da[q.Q].templateName.charAt(0)=="#";C=1;typeof z.ia!=="undefined"&&z.ia!==i&&(C=z.ia);C=q.Pa?"0.1":C;C=2*C-C*C;E=q.pa("ici")[0];A=q.Rb("ici")[0];F=[255,255,255];T=a('<div class="screenshotlayer" style="width:'+w*m+"px;font-family:"+q.Pb()+";font-size:"+u*m+'px;text-align:center"></div>');w=a("<div></div>").appendTo(T);R=a('<div style="padding:0.4em 0.6em;color:'+$e(A)+";background-color:"+
gf(E,C)+';border-radius:0.5em"></div>').appendTo(w);q.html?Ya(function(){R.html((ye()?"<wbr>":"")+q.html)}):R.text(q.text);Za(R,!1);ef(R,q,!1);x&&(R.css("padding-bottom","0"),R.css("border-bottom-left-radius","0"),R.css("border-bottom-right-radius","0"),ka=a('<div style="overflow:hidden;font-size:70%;padding:0.4em 0.6em;color:#000;background-color:'+gf(F,C)+";border-bottom-left-radius:0.5em;border-bottom-right-radius:0.5em;border:0.15em solid "+gf(E,C)+'"></div>').appendTo(w),q.Z?Ya(function(){ka.html((ye()?
"<wbr>":"")+q.Z)}):ka.text(q.ba),Za(ka,!1));T.prependTo(a("body"));T.css("width",w.outerWidth()+1+"px");j(T,Q,q,B)}var L,sa,V;x={};F={};for(r=0;r<this.R.length;r++)if(w=this.R[r],w.ob>0&&w.ra!=w.Va&&(E=w.Gd(),N=E==1||E==3,H=E==2||E==3,u=this.q[w.ra],s=this.q[w.Va],!(u.V===0||s.V===0)))if(J=Y[w.ra],I=Y[w.Va],!(J==i||I==i)){E=w.pa(kc!=0?s:u,i,"icd")[0];A=Math.min(u.sa(),s.sa());B=0.03*A*Math.min(u.V,s.V);aa=new THREE.Vector3(u.O,u.N,u.Fb);P=new THREE.Vector3(s.O,s.N,s.Fb);C=w.ob;T=w.label;var ia=!1;
C>0&&T!=""&&w.La&&w.La.length==1?(A=new THREE.Vector3(w.La[0].x,w.La[0].y,w.La[0].z),L=T+"\u00a7"+Math.round(w.La[0].x)+"\u00a7"+Math.round(w.La[0].y)+"\u00a7"+Math.round(w.La[0].z),sa=w.ra+"\u00a7"+L,V=L+"\u00a7"+w.Va,typeof x[L]==="undefined"?(y=new THREE.SphereBufferGeometry(B,Math.ceil(g*25),Math.ceil(g*25)),Q=new THREE.MeshStandardMaterial({metalness:0.3}),Q.color=new THREE.Color($e(E)),Q=new THREE.Mesh(y,Q),Q.position.set(A.x,A.y,A.z),Q.updateMatrixWorld(),c.add(Q),x[L]=Q):ia=!0,typeof F[sa]===
"undefined"&&n(N,H,J,x[L],E,aa,A,B),typeof F[V]==="undefined"&&n(N,H,x[L],I,E,A,P,B),F[sa]=1,F[V]=1):A=n(N,H,J,I,E,aa,P,B);if(C>0&&T!=""&&!ia)y=w.Rb(kc!=0?s:u,i,"icd")[0],Q=w.Hd(),u=0.04*Math.min(400,u.Ob+s.Ob)*w.Id()*m,B=document.createElement("canvas"),s=B.getContext("2d"),s.font=u+"px "+Q,w=s.measureText(T).width,N=1.8*u,C=1,typeof z.ia!=="undefined"&&z.ia!==i&&(C=z.ia),C=2*C-C*C,B.width=w+N,B.height=N,s.font=u+"px "+Q,s.textBaseline="middle",s.textAlign="left",Q=0.25*N,s.beginPath(),s.moveTo(Q,
0),s.arc(Q,Q,Q,1.5*Math.PI,Math.PI,!0),s.arc(Q,B.height-Q,Q,Math.PI,0.5*Math.PI,!0),s.arc(B.width-Q,B.height-Q,Q,0.5*Math.PI,0,!0),s.arc(B.width-Q,Q,Q,0,1.5*Math.PI,!0),s.closePath(),s.fillStyle=gf(E,C),s.fill(),s.fillStyle=$e(y),s.fillText(T,0.5*N,0.5*N),E=e?new THREE.MeshBasicMaterial({transparent:!0}):new THREE.SpriteMaterial,E.map=new THREE.Texture(B),E.map.needsUpdate=!0,E.needsUpdate=!0,e?(C=new THREE.Vector3(0,0.4925*B.height/(m*v),0),y=new THREE.PlaneBufferGeometry(B.width/(m*v),B.height/
(m*v)),f&&(y.lookAt(A),T=new THREE.Object3D,T.lookAt(A),T.updateMatrix(),C.applyMatrix4(T.matrix)),y=new THREE.Mesh(y,E),y.position.copy(A),y.position.add(C),c.add(y),y=new THREE.PlaneBufferGeometry(B.width/(m*v),B.height/(m*v)),y.applyMatrix((new THREE.Matrix4).makeRotationY(Math.PI)),f&&y.lookAt(A),y=new THREE.Mesh(y,E),y.position.copy(A),y.position.add(C),c.add(y)):(E=new THREE.Sprite(E),E.scale.set(B.width/(m*v),B.height/(m*v),1),E.center.set(0.5,0.075),E.position.set(A.x,A.y,A.z),c.add(E))}};
f.prototype.Sf=function(){function c(){if(!(Na==i||$a==i))if(F)J=!0;else{var d=q.getDelta();Na.update(d);if(x==i&&(j.width()!=m||j.height()!=n))m=j.width(),n=j.height(),h.sc=!0;if(h.sc&&($a.render(Jb,pb),h.sc=!1,x))if(z=Na.getAzimuthalAngle(),z>E&&(E+=2*Math.PI),E-z>2*Math.PI)zf(!0);else{a("div.waitanim span.waittext").text(Lq.replace("%1",parseInt(100*(E-z)/(2*Math.PI))));try{x.capture(C.find(".ikmap>.canvas6")[0])}catch(b){zf(!1),a("div.waitanim span.waittext").text(ba),a(".waitinl").removeClass("waitinllarge"),
lf()}}Af=requestAnimationFrame(c)}}function e(c,f,k){if(!a(a.fn.C.obj).is(":visible")||window.lastTooltipItemID!=c){a.fn.C.close();var l=f+2,l=l-1>m/2&&l>m-370;window.lastTooltipItemID=c;window.lastTooltipRelationID=-1;a.fn.C({alignment:l?{body:"left",pointer:"right"}:{body:"right",pointer:"left"},url:b.baseurl+nc+b.scriptextension,action:"tooltip",diagram:d,openAttachments:Sc,openDocument:md,rootItemID:P,id:c,idfrom:-1,idto:-1,hOffset:13,vOffset:3-Math.min(-14,0),left:f,top:k,width:2,moveTop:!d.H,
searchEngines:Wd,fadeIn:d.T!=0,onOpenCallback:function(c){if(typeof c!=="undefined"){var c=[jd(c.n)],c=ze(c),d=a(a.fn.C.obj).find(".tttext");nb(d,c,!0,!1)}},database:O})}}function f(){N&&(N.paused=!N.paused)}P=this.vc;var g=this,h={sc:!0};ko();ge.show();typeof navigator.xr!=="undefined"&&he.show();ie.hide();je.hide();ke.hide();for(var j=C.find(".ikmap"),m=j.width(),n=j.height(),o=0,v=i,p=0,r=100,s,u=0,B=0,o=0;o<this.q.length;o++)if(v=this.q[o],v.V!==0&&(p=Math.max(p,Math.pow(v.O*v.O+v.N*v.N+v.Fb*
v.Fb,0.5)),v.U==0&&d.za!=4))u=v.O,B=v.Fb;p+=r;pb=new THREE.PerspectiveCamera(75,m/n,0.1,1E5);pb.position.z=p;$a=new THREE.WebGLRenderer({antialias:!0,canvas:C.find(".ikmap>.canvas6")[0]});$a.setClearColor($e(Sb));$a.setSize(m,n);Jb=new THREE.Scene;s=new THREE.Group;Jb.add(s);Jb.add(pb);$a.render(Jb,pb);o=new THREE.PointLight("#FFF",1,0,2);o.position.set(p,p,-0.25*p);pb.add(o);o=new THREE.AmbientLight("#FFF");Jb.add(o);this.Ie(s,h,d.Ja>0,d.Ja==2,1,function(){g.fe()});Jb.updateMatrixWorld();var q=new THREE.Clock;
Na=new THREE.OrbitControls(pb,$a.domElement);Na.enableDamping=!0;Na.dampingFactor=U()?0.2:0.1;Na.autoRotate=!1;Na.autoRotateSpeed=U()?2:0.5;Na.screenSpacePanning=!1;Na.minDistance=0.1;Na.maxDistance=5E4;Na.enableKeys=!1;Na.panSpeed=0.1;Na.rotateSpeed=0.1;Na.zoomSpeed=0.5;Na.target.set(u,0,B);Na.addEventListener("change",function(){h.sc=!0});var w=0,A=-1;j.find(".canvas6").unbindMouseOrTouchEvent("mousedown.draw3d").bindMouseOrTouchEvent("mousedown.draw3d",function(){w=(new Date).getTime();A=a(a.fn.C.obj).is(":visible")?
window.lastTooltipItemID:-1;a.fn.C.close()}).unbindMouseOrTouchEvent("click.draw3d").bindMouseOrTouchEvent("click.draw3d",function(c){if((new Date).getTime()-w<300&&!c.target.isContentEditable&&!a(c.target).is(":input")){var b=j.offset(),f=fg(c),c=lg(c),l=f-b.left,b=c-b.top,g=Jb.children[0],l=2*(l/m)-1,b=-2*(b/n)+1;bf.setFromCamera(new THREE.Vector3(l,b,0.5),pb);b=bf.intersectObject(g,!0);for(l=0;l<b.length;l++)if(g=b[l],typeof g.object!=="undefined"&&typeof g.object.iid!=="undefined"&&(g=g.object.iid,
g>=0))return A==g?g!=P&&(d.load(g,-1,"",Xb,!0,!1,xe+1),U()&&Oc({action:"onitemselected",i:g,r:-1,search:"",setasroot:1,redraw:1})):(e(g,f,c),U()?Oc({action:"onitemselected",i:g,r:-1,search:"",setasroot:0,redraw:0}):d.j.Ga(g,-1,!1,!1,!0)),!1}return!0});var x=i,E,z;Pj=function(){if($a&&x==i){var c=i,d=i,b=i,e=i,f=i,k=document.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp")==0;Na.enableDamping=!1;Na.autoRotate=!1;var l="<form>";l+='<div style="margin-bottom:12px">'+ps+"</div>";
l+='<div><label><span style="display:inline-block;width:250px">'+qs+'</span><input class="kbb-video-width" type="number" min="5" max="2048" value="'+Gh+'"></label></div>';l+='<div><label><span style="display:inline-block;width:250px">'+rs+'</span><input class="kbb-video-height" type="number" min="5" max="2048" value="'+Hh+'"></label></div>';l+='<div><label><span style="display:inline-block;width:250px">'+ss+'</span><input class="kbb-video-rotation-speed" type="number" min="10" max="1000" value="'+
df+'"></label></div>';k&&(l+='<div style="margin-top:0px; margin-bottom:12px;"><label><input class="kbb-video-webm-format" type="checkbox"'+(Ld?" checked":"")+">"+ts+"</label></div>");l+='<input type="submit" class="kbb-invisible" />';l+="</form>";var g={},h=!0;g[Da]=function(){h=!1;m=Math.min(2048,Math.max(5,d.val()));n=Math.min(2048,Math.max(5,b.val()));df=Math.min(1E3,Math.max(10,e.val()));Ld=k?f.is(":checked"):!1;c.dialog("close");typeof window.localStorage!=="undefined"&&(Gh=m,window.localStorage.setItem("recordvideowidth",
Gh),Hh=n,window.localStorage.setItem("recordvideoheight",Hh),window.localStorage.setItem("recordrotationspeed",df),window.localStorage.setItem("webmformat",Ld?1:0));ie.hide();ke.hide();je.show();kf(ba);a(".waitinl").addClass("waitinllarge");pb.aspect=m/n;pb.updateProjectionMatrix();$a.setSize(m,n);Na.autoRotateSpeed*=0.25*df;Na.autoRotate=!0;E=Na.getAzimuthalAngle();x=new CCapture({framerate:25,verbose:!1,format:Ld?"webm":"gif",workersPath:U()?"":"js/",onProgress:function(c){a("div.waitanim span.waittext").text(Mq.replace("%1",
parseInt(100*c)))}});x.start()};g[eb]=function(){c.dialog("close")};c=a('<div class="kbb-record-video" />').html(l).dialog({modal:!0,closeOnEscape:!1,resizable:!1,buttons:g,title:os,width:350,position:Mb?{my:"center top",at:"center top"}:{my:"center",at:"center"},open:function(){a(this).parent(".ui-dialog").find("*").myDisableSelection(!1)},close:function(){a(this).dialog("destroy");if(h)Na.enableDamping=!0,Na.autoRotate=!0}});d=c.find(".kbb-video-width");b=c.find(".kbb-video-height");e=c.find(".kbb-video-rotation-speed");
f=c.find(".kbb-video-webm-format");c.find("form").bind("submit",function(){setTimeout(function(){g[Da]()},50);return!1})}};zf=function(c){if($a&&x){ge.show();typeof navigator.xr!=="undefined"&&he.show();ie.hide();je.hide();ke.hide();x.stop();var d=C.find(".ikmap");m=d.width();n=d.height();pb.aspect=m/n;pb.updateProjectionMatrix();$a.setSize(m,n);Na.autoRotateSpeed/=0.25*df;Na.autoRotate=!1;Na.enableDamping=!0;$a.render(Jb,pb);c&&x.save(function(c){window.savevideo?window.savevideo(c,Ld):download(c,
Ld?"Video.webm":"AnimatedGif.gif",Ld?"video/webm":"image/gif");a("div.waitanim span.waittext").text(ba);a(".waitinl").removeClass("waitinllarge");lf();return!1});x=i}};var F=i,J=!1,I=i,N=i,H=i;Qj=function(){function a(c){function e(a,c){g.push(a.x);g.push(a.y);g.push(a.z);g.push(a.w);h.push(c)}c.addEventListener("end",b);$a.xr.setSession(c);F=c;d.Ja!=2&&s.translateZ(-p+0.25*r);var c=$a.xr.getController(0),k=$a.xr.getController(1);c&&c.addEventListener("selectstart",f);k&&k.addEventListener("selectstart",
f);var g=[],h=[],c=0,k=new THREE.Vector3(0,1,0),q=(new THREE.Vector3(-1,1,0)).normalize(),n=(new THREE.Vector3(1,1,0)).normalize();e((new THREE.Quaternion).setFromAxisAngle(k,0),c);c+=15;e((new THREE.Quaternion).setFromAxisAngle(k,Math.PI),c);c+=15;e((new THREE.Quaternion).setFromAxisAngle(k,2*Math.PI),c);d.Ja<=0&&(e((new THREE.Quaternion).setFromAxisAngle(q,0),c),c+=15,e((new THREE.Quaternion).setFromAxisAngle(q,Math.PI),c),c+=15,e((new THREE.Quaternion).setFromAxisAngle(q,2*Math.PI),c),e((new THREE.Quaternion).setFromAxisAngle(n,
0),c),c+=15,e((new THREE.Quaternion).setFromAxisAngle(n,Math.PI),c),c+=15,e((new THREE.Quaternion).setFromAxisAngle(n,2*Math.PI),c));c=new THREE.QuaternionKeyframeTrack(".quaternion",h,g);I=new THREE.AnimationClip("Action",-1,[c]);H=new THREE.AnimationMixer(s);N=H.clipAction(I);N.play();d.Ja==2&&(N.paused=!0)}function b(){F.removeEventListener("end",b);F=i;H.stopAllAction();H.uncacheClip(I);H.uncacheAction(N);H=N=I=i;d.Ja!=2&&s.translateZ(p-0.25*r);J&&(J=!1,c())}F===i?navigator.xr.isSessionSupported("immersive-vr").then(function(c){if(c)navigator.xr.requestSession("immersive-vr",
{optionalFeatures:["local-floor","bounded-floor","hand-tracking"]}).then(a),$a.xr.enabled=!0,$a.setAnimationLoop(function(){if(H){var a=q.getDelta();H.update(a)}$a.render(Jb,pb)})}):F.end()};c()};f.prototype.Nc=function(a,b,e,f){function g(){if(n<100)for(h=0;h<d.j.q.length;h++)if(j=d.j.q[h],j.image&&!j.image.complete){n++;setTimeout(g,10);return}d.j.Pc(b,e,f,!0)}var h=0,j,n=0;a==0?g():setTimeout(g,a)};f.prototype.Pc=function(c,b,e,f,g,h,j){var k;var n=1E3-c;if(c==1E3)P=this.vc;if(!e){C.find(".ikmap>.canvas5,.ikmap>.textlayer").css({"-ms-transform":"",
"-moz-transform":"","-webkit-transform":"",transform:"","-ms-transform-origin":"","-moz-transform-origin":"","-webkit-transform-origin":"","transform-origin":""});C.find(".itemselector").hide().appendTo(C.find(".textlayer"));var m=C.find(".itemtoolbar");m.is(":visible")&&m.hide();m=a(".ttip");m.is(":visible")&&m.hide()}if(typeof g==="undefined"){if(Pf){m=C.find(".canvas9")[0];if(m.getContext){var v=a(m).width(),o=a(m).height(),g=m.getContext("2d");g.clearRect(0,0,v,o)}Pf=!1}g=C.find(".canvas5")[0]}var m=
C.find(".kmappage"),p=0,r=0;typeof h==="undefined"||typeof j==="undefined"?(v=[C.find(".canvas9"),C.find(".canvas1"),a(g)],v=!e&&b&&(this.Kb!=this.Bb||this.Lb!=this.Cb)?oe(v,(n*this.Kb+c*this.Bb)/1E3,(n*this.Lb+c*this.Cb)/1E3):oe(v),p=v.l,r=v.t):(p=h,r=j);if(g.getContext){var v=0,v=a(g).width(),o=a(g).height(),u=i,s=i,q=u=i,w=i,B=i,A=i,x,E=q=s=0,z=0,F=B=0,J=0,I=0,N,H,I=1,aa=J=0,F=1+wc*0.5/Math.pow(d.K,0.4),T=1+wc*0.3/Math.pow(d.K,0.4),R=1+wc*0.1/Math.pow(d.K,0.4),y=0,Q=0,L=z=E=1,V,O=0,ca=V=0,sa=0,
Ga=Q=0,ia=0,h=L=0,ia=Ga=j=h=A=h=!1,da,oa,O=0,Ja=!1,O=!1,xb=i,ga=i,ba,g=g.getContext("2d");g.save();f&&g.clearRect(0,0,v,o);this.q.length!=this.Zb.length&&this.ve();g.setTransform(1,0,0,1,-p,-r);g.scale(1,d.K);for(v=0;v<this.Qa.length;v++)if(A=this.Qa[v],L=(n*A.wc+c*A.ob)/1E3,L>0)u=A.Rc(c),sa=A.pa(),g.fillStyle=gf(sa,0.25*L),Th(g,u,9*d.D),g.fill(),g.lineWidth=(1+1.35*wc)*d.D,g.strokeStyle=gf(sa,0.5*L),g.stroke();g.setTransform(1,0,0,1,-p,-r);g.scale(1.2,0.8*d.K);for(v=0;v<this.q.length;v++)if(u=this.q[this.Zb[v]],
u.Pa=typeof u.zb!=="undefined"?u.zb:u.Q>=0&&typeof this.da[u.Q]!=="undefined"&&this.da[u.Q].templateName.length>0&&this.da[u.Q].templateName.charAt(0)=="#",u.ec()==0&&!(u.ib==0&&c<300)&&!(u.V==0&&c>300)&&(z=u.Dc(),L=u.sa(),s=(n*u.Wb+c*u.O)/1E3,q=(n*u.Xb+c*u.N)/(1E3*d.K),B=L*(n*u.ib+c*u.V)/1E3,u.image&&u.image.complete&&u.image.width>0&&u.image.height>0&&(u.V>0||c<150)))A=4.5*B/Fc[z],L=Math.max(2*A/u.image.width,2*A/u.image.height),A=Math.round(u.image.width*L),L=Math.round(u.image.height*L),g.drawImage(u.image,
s/1.2-0.5*A*Fc[z],q/0.8,A*Fc[z],L*Fc[z]);g.setTransform(1,0,0,1,-p,-r);g.scale(1,d.K);for(var o=4*d.D,ob,vc={},na={},v=this.R.length-1;v>=0;v--)if(q=this.R[v],q.Uc=!1,(A=q.Ea==this.aa)&&d.H&&(Ga=!0),L=(n*q.wc+c*q.ob)/1E3,L>0&&(u=this.q[q.ra],s=this.q[q.Va],w=q.ub>=0?this.Qa[q.ub]:i,B=q.vb>=0?this.Qa[q.vb]:i,da=u.Dc(),oa=s.Dc(),E=u.sa(),z=s.sa(),ob=w&&B?q.ub<q.vb?"g"+q.ub+"g"+q.vb:"g"+q.vb+"g"+q.ub:w?q.ub<q.Va?"g"+q.ub+"i"+q.Va:"i"+q.Va+"g"+q.ub:B?q.vb<q.ra?"g"+q.vb+"i"+q.ra:"i"+q.ra+"g"+q.vb:"",w?
(N=w.Rc(c),x=Oh(Ph(N[0],N[2]),2)):(x=Ph(Z({x:u.Wb,y:u.Xb},n/1E3),Z({x:u.O,y:u.N},c/1E3)),x.y/=d.K),B?(H=B.Rc(c),f=Oh(Ph(H[0],H[2]),2)):(f=Ph(Z({x:s.Wb,y:s.Xb},n/1E3),Z({x:s.O,y:s.N},c/1E3)),f.y/=d.K),w&&(x=Uh(N,f)),B&&(f=Uh(H,x)),E=E*(n*u.ib+c*u.V)/1E3,z=z*(n*s.ib+c*s.V)/1E3,J=Vh(f,x),!((u.ib==0||s.ib==0)&&c<300)))if(!((u.V==0||s.V==0)&&c>150))if(!w||!(w.wc==0&&c<300))if(!B||!(B.wc==0&&c<300))if(!w||!(w.ob==0&&c>150))if(!B||!(B.ob==0&&c>150)){if(u.Pa||s.Pa)L/=5;q.count==1?(sa=$h(J)*0.1,O=Oi({x:J.y,
y:J.x}),ca=sa*Math.sin(2*O),d.gg()&&(ca=0)):(sa=Math.max(30*d.D,$h(J)*0.1),V=(s.I>u.I?1:-1)*(q.index%2==0?-1:1),ca=q.count%2==0?V*sa*(0.5+Math.floor(q.index/2)):V*sa*Math.floor((1+q.index)/2));if(d.Ec()||d.yb())ca=0;ba=q.Fd(x,f,c);I=c>500?q.Cc:q.zf;O=q.Gd();Ja=O==1||O==3;O=O==2||O==3;I?(I=="f"?(xb=[0.4,0.5,0.6],ga=[0.5]):I=="t"&&(xb=[0.5],ga=[0.4,0.5,0.6]),O=Ja=!1):d.hc()&&q.label!=""?(xb=[0.25,0.75],ga=i,O=Ja=!1):ga=xb=i;J=Yi({x:-J.y,y:J.x});V=Ph(Oh(Ph(x,f),2),Z(J,2*ca));I=q.cf()*d.D*(d.Ec()?w||
B?1.35:0.9:1);J=O&&!Ja?F:Ja&&!O?R:T;aa=Ja&&!O?F:O&&!Ja?R:T;y=O&&!Ja?0.05:0.025;Q=Ja&&!O?0.05:0.025;J=I*J*(1+wc*y*E);I=I*aa*(1+wc*Q*z);ba.length>0&&(V=ba[0]);u.U==0&&d.ga!=0||Ja||w||u.ec()==1&&u.image&&u.image.complete&&u.image.width>0&&u.image.height>0?(u.ec()==1&&u.image&&u.image.complete&&u.image.width>0&&u.image.height>0?E*=(4.5+(u.U==0&&d.ga!=0?0.9+(Ja?0.15:0):0.15))/Fc[da]:u.U==0&&d.ga!=0&&(E*=1+(0.9+(Ja?0.15:0))/Fc[da]),Ja&&(d.Ec()||(E+=o/Fc[da])),aa=w?Zi(f,x,Ja?-o:0):da=="default"||da=="circle"?
wj(x,V,1.2*E*Fc[da],0.8*E*Fc[da]):Gk(x,V,Hk(x,2.4*E*Fc[da],1.6*E*Fc[da],da))):aa=x;ba.length>0&&(V=ba[ba.length-1]);s.U==0&&d.ga!=0||O||B||s.ec()==1&&s.image&&s.image.complete&&s.image.width>0&&s.image.height>0?(s.ec()==1&&s.image&&s.image.complete&&s.image.width>0&&s.image.height>0?z=z*(4.5+(s.U==0&&d.ga!=0?0.9+(O?0.15:0):0.15))/Fc[oa]:s.U==0&&d.ga!=0&&(z*=1+(0.9+(O?0.15:0))/Fc[oa]),O&&(d.Ec()||(z+=o/Fc[oa])),Q=B?Zi(x,f,O?-o:0):oa=="default"||oa=="circle"?wj(f,V,1.2*z*Fc[oa],0.8*z*Fc[oa]):Gk(f,V,
Hk(f,2.4*z*Fc[oa],1.6*z*Fc[oa],oa))):Q=f;ba.unshift(aa);ba.push(Q);sa>0&&(ca*=$h(Vh(Q,aa))/(sa/0.1));if(A&&d.H)g.fillStyle=gf(mg(Sb,[255,255,255],[0,0,0]),0.33),d.Tc()?this.ud(g,aa,Q,4*J,4*I,ca,Ja,O):this.se(g,ba,2*(J+I),Ja,O,xb,ga);sa=q.pa(kc!=0?s:u,kc!=0?B:w,"icd")[0];g.fillStyle=gf(sa,0.9*L);if(ob==""||typeof vc[ob]==="undefined")w&&!Ja&&(g.beginPath(),g.arc(aa.x,aa.y,2*J,0,2*Math.PI,!0),g.closePath(),g.fill()),B&&!O&&(g.beginPath(),g.arc(Q.x,Q.y,2*I,0,2*Math.PI,!0),g.closePath(),g.fill()),d.Tc()?
q.ke()==0?this.ud(g,aa,Q,J,I,ca,Ja,O):this.Pf(g,aa,Q,J,I,ca,Ja,O):q.ke()==0?this.se(g,ba,0.5*(J+I),Ja,O,xb,ga):this.Qf(g,ba,0.5*(J+I),Ja,O,xb,ga),ob!=""&&(vc[ob]=1);q.gb=aa.x;q.Sa=aa.y*d.K;q.fb=Q.x;q.Ra=Q.y*d.K;q.bb=ca;q.ed=J;q.dd=I;Q=2.625*(I+6)*d.D;ba.length>2&&(V=ba[1]);aa=w?Zi(f,x,Ja?-Q:0):da=="default"||da=="circle"?wj(x,V,1.2*E*Fc[da]+(Ja?Q:0),0.8*E*Fc[da]+(Ja?Q:0)):Gk(x,V,Hk(x,2.4*E*Fc[da]+(Ja?Q:0),1.6*E*Fc[da]+(Ja?Q:0),da));ba.length>2&&(V=ba[ba.length-2]);Q=B?Zi(x,f,O?-Q:0):oa=="default"||
oa=="circle"?wj(f,V,1.2*z*Fc[oa]+(O?Q:0),0.8*z*Fc[oa]+(O?Q:0)):Gk(f,V,Hk(f,2.4*z*Fc[oa]+(O?Q:0),1.6*z*Fc[oa]+(O?Q:0),oa));da=q.Rb(kc!=0?s:u,kc!=0?B:w,"icd")[0];V=ca>=0?1:-1;if(ob==""||typeof na[ob]==="undefined")if(oa=13,d.Tc()?this.jf(g,aa,Q,V,ca,J+I,q.label,q.Hd(),oa*q.Id()*L*d.D,yf?sa:i,da,L,q.Na>=0&&typeof this.Ab[q.Na]!=="undefined"&&d.ma?this.Ab[q.Na].templateName:"",!1):(ca=-1,ba[0]=aa,ba[ba.length-1]=Q,ba.length%2==0?ca=Math.round((ba.length-2)/2):(ca=Math.round((ba.length-3)/2),Ik(ba[ca+
2],ba[ca+1])>Ik(ba[ca+1],ba[ca])&&ca++),aa=ba[ca],ca=ba[ca+1],d.hc()&&(ba.length==3?(aa=ba[1],ca=ba[1]):(k=aa={x:0.5*(aa.x+ca.x),y:0.5*(aa.y+ca.y)},ca=k),oa=16),this.jf(g,aa,ca,V,0,J+I,q.label,q.Hd(),oa*q.Id()*L*d.D,yf?sa:i,da,L,q.Na>=0&&typeof this.Ab[q.Na]!=="undefined"&&d.ma?this.Ab[q.Na].templateName:"",d.hc())),ob!=""&&(q.label.length>0||q.Na>=0&&typeof this.Ab[q.Na]!=="undefined"&&d.ma))na[ob]=1;q.Uc=!0;A&&d.H&&(A=Math.max(44*d.D,w?Jk(N)-Kk(N):3*E/(Ja?1.15:1)),L=Math.max(44*d.D,w?(Lk(N)-Mk(N))*
d.K:2*E/(Ja?1.15:1)),w=x.x-A/2,ia=x.y*d.K-L/2,yc.selector("show",w,ia,A,L,d.D),A=Math.max(44*d.D,B?Jk(H)-Kk(H):3*z/(O?1.15:1)),L=Math.max(44*d.D,B?(Lk(H)-Mk(H))*d.K:2*z/(O?1.15:1)),w=f.x-A/2,ia=f.y*d.K-L/2,zc.selector("show",w,ia,A,L,d.D),yc.data("pid",q.Ea).data("pfrom",u.I).data("pto",s.I),zc.data("pid",q.Ea).data("pfrom",u.I).data("pto",s.I),ia=!0)}ia||(yc.hide(),zc.hide());if(!Ga)this.aa=-1;g.setTransform(1,0,0,1,-p,-r);g.scale(1.2,0.8*d.K);bc.hide();for(v=0;v<this.q.length;v++)if(u=this.q[this.Zb[v]],
(A=u.I==this.W)&&(h=!0),!(u.ib==0&&c<300)&&!(u.V==0&&c>300)&&(z=u.Dc(),L=u.sa(),s=(n*u.Wb+c*u.O)/1E3,q=(n*u.Xb+c*u.N)/(1E3*d.K),B=L*(n*u.ib+c*u.V)/1E3,Ga=0.5*B,sa=u.pa("icd")[0],A&&!ia&&(u.Ud(Yb,c),j=!0),u.ec()==1&&u.image&&u.image.complete&&u.image.width>0&&u.image.height>0&&(u.V>0||c<150)?(N=B,H=N/2.5,Ga=0.5*H,B=4.5*B/Fc[z],L=Math.max(2*B/u.image.width,2*B/u.image.height),A=Math.round(u.image.width*L),L=Math.round(u.image.height*L),g.save(),g.beginPath(),z=="default"||z=="circle"?g.arc(s/1.2,q/
0.8,B*Fc[z],0,2*Math.PI,!0):Nk(g,Hk(X(s/1.2,q/0.8),2*B*Fc[z],2*B*Fc[z],z)),g.closePath(),g.clip(),g.drawImage(u.image,s/1.2-0.5*A*Fc[z],q/0.8-B*Fc[z],A*Fc[z],L*Fc[z]),g.restore(),g.fillStyle=$e(sa),g.beginPath(),g.arc(s/1.2,q/0.8,H,0,2*Math.PI,!0),g.closePath(),g.fill(),g.strokeStyle="rgba(255,255,255,0.6)",g.lineWidth=Ga,g.beginPath(),g.arc(s/1.2,q/0.8,H-Ga/2,0,2*Math.PI,!0),g.closePath(),g.stroke(),g.lineWidth=0.3*N,g.strokeStyle=$e(sa),g.beginPath(),z=="default"||z=="circle"?g.arc(s/1.2,q/0.8,
B*Fc[z],0,2*Math.PI,!0):Nk(g,Hk(X(s/1.2,q/0.8),2*B*Fc[z],2*B*Fc[z],z)),g.closePath(),g.stroke(),F=0.3*N):(g.fillStyle=gf(sa,u.Pa?0.2:1),g.beginPath(),z=="default"||z=="circle"?g.arc(s/1.2,q/0.8,B*Fc[z],0,2*Math.PI,!0):Nk(g,Hk(X(s/1.2,q/0.8),2*B*Fc[z],2*B*Fc[z],z)),g.closePath(),g.fill(),g.strokeStyle="rgba(255,255,255,"+(u.Pa?"0.1":"0.6")+")",g.lineWidth=Ga,g.beginPath(),z=="default"||z=="circle"?g.arc(s/1.2,q/0.8,B*Fc[z]-Ga/2,0,2*Math.PI,!0):Nk(g,Hk(X(s/1.2,q/0.8),2*B*Fc[z]-Ga,2*B*Fc[z]-Ga,z)),g.closePath(),
g.stroke(),F=0.3*B),u.U==0&&d.ga!=0))g.lineWidth=F,g.strokeStyle=gf(sa,u.Pa?0.2:1),g.beginPath(),z=="default"||z=="circle"?g.arc(s/1.2,q/0.8,B*Fc[z]+3*F,0,2*Math.PI,!0):Nk(g,Hk(X(s/1.2,q/0.8),2*(B*Fc[z]+3*F),2*(B*Fc[z]+3*F),z)),g.closePath(),g.stroke();j||Yb.hide();if(!h)this.W=-1;g.setTransform(1,0,0,1,-p,-r);for(v=0;v<this.q.length;v++)if(u=this.q[this.Zb[v]],!(u.ib==0&&c<300))if(u.V==0&&c>300){if(u.A.J!=i)u.A.J.remove(),u.A.J=i}else h=e?!1:ka(u),u.A.J!=i&&Y(u,v,h);for(v=0;v<this.q.length;v++)if(u=
this.q[v],u.A.J!=i&&u.A.Vd)if(N=d.na>0&&(u.ba.length>0||u.Z&&u.Z.length>64),u.text==""&&(u.html==i||u.html.length<64)&&!N&&u.A.tb.length==0)u.A.qb=0.75*u.A.Gb;else if(N=u.A.J.find("span:first"),u.A.qb=N.outerWidth(),u.A.qb==0)u.A.qb=0.75*u.A.Gb;for(v=0;v<this.q.length;v++)if(u=this.q[v],u.A.J!=i&&u.A.Vd)H=u.A.J.children("a"),u.A.Nb=u.A.qb+1,u.A.J.css("width",u.A.Nb+"px"),N=d.na>0&&(u.ba.length>0||u.Z&&u.Z.length>64),u.text==""&&(u.html==i||u.html.length<64)&&!N&&u.A.tb.length==0?(u.A.ab=0.25*u.A.Gb,
H.css("height",u.A.ab+"px")):H.css("height")!=i&&H.css("height","");for(v=0;v<this.q.length;v++)if(u=this.q[v],N=d.na>0&&(u.ba.length>0||u.Z&&u.Z.length>64),u.A.J!=i&&(u.text!=""||u.html&&u.html.length>=64||N||u.A.tb.length>0)&&u.A.Vd)if(N=u.A.J.find("span:first"),u.A.ab=N.outerHeight(),u.A.ab==0)u.A.ab=0.25*u.A.Gb;for(v=0;v<this.q.length;v++)if(u=this.q[this.Zb[v]],u.A.J!=i&&(L=u.sa(),s=(n*u.Wb+c*u.O)/1E3,q=(n*u.Xb+c*u.N)/1E3,B=L*(n*u.ib+c*u.V)/1E3,h=L*u.Ob,ia=q-u.A.ab-(16*d.D+B),u.A.Ib=Math.round(s-
u.A.Nb/2),u.A.Jb=Math.round(ia),u.A.J.css({left:u.A.Ib+"px",top:u.A.Jb+"px"}),N=u.A.J.find(".kbb-iconbtn"),N.length>0&&(A=Math.min(2.5*h/10,0.5*u.A.ab),Ga=2*d.D,H=0.5*(Math.pow(2,0.5)-1)*A+1,p=0.5*u.A.ab-0.5*A-Ga-H,r=-0.9*A-Ga-H,N.iconbtn("setwidth",A),N.css({left:r+"px",top:p+"px","border-width":Ga+"px",padding:H+"px"}).show()),N=u.A.J.find(".kbb-item-labels"),N.length>0&&(H=h/6,p=-0.6*H,r=u.A.Nb/2-u.A.qb/2,N.find("td").css("max-width",Math.max(5*H,u.A.Nb-0.25*H)+"px"),N.css({left:r+"px",top:p+"px"}).show()),
sa=u.pa("ici")[0],N=d.na>0&&(u.ba.length>0||u.Z&&u.Z.length>64),this.Tf(g,s-u.A.qb/2,ia,u.A.qb,u.A.ab,s,q,4*d.D,sa,u.Pa,N),N=u.df(),N.length>0&&ja.complete&&ja.width>0&&ja.height>0&&(u.V>0||c<150))){H=(u.U==0&&d.ga!=0?1.2:1)*0.25*h;p=ia+u.A.ab+0.2*H;r=s-0.075*H*(1+d.$/100)-0.5*H*N.length;for(h=0;h<N.length;h++){if(Jg!=0)j=r+H+2E3,F=0.2*(1+2*d.$/100),T=p+H,g.save(),g.transform(1,0,-F,0.5,F*T-j,0.5*T),g.shadowColor="rgba(0, 0, 0, 0.35)",g.shadowOffsetX=j,g.shadowOffsetY=0,g.shadowBlur=3*d.D,g.drawImage(ja,
N[h]*ja.height,0,ja.height,ja.height,r,p,H,H),g.restore();g.drawImage(ja,N[h]*ja.height,0,ja.height,ja.height,r,p,H,H);r+=H}}g.restore()}c==1E3&&td(this);if(!e&&(c==1E3&&(this.width!=C.find(".ikmap").width()&&C.find(".ikmap").width(this.width),this.height!=C.find(".ikmap").height()&&C.find(".ikmap").height(this.height),m.css({"overflow-x":this.gd?"scroll":"hidden","overflow-y":this.hd?"scroll":"hidden"})),b&&(this.Kb!=this.Bb||this.Lb!=this.Cb)&&Zf(m,(n*this.Kb+c*this.Bb)/1E3,(n*this.Lb+c*this.Cb)/
1E3),c==1E3)){this.Cb=this.Lb=this.Bb=this.Kb=0;var ta=this;setTimeout(function(){wq();ta.fe()},10)}};f.prototype.Ff=function(){var a=C.find(".textlayer"),b=a.find(".kbb-bk-orange"),e=a.find(".kbb-bk-grey"),f=a.find(".kbb-bk-yellow"),g=a.find(".kbb-bk-darkblue"),a=a.find(".kbb-bk-blue");d.va?b.show():b.hide();d.ua?e.show():e.hide();d.xa?f.show():f.hide();d.ta?g.show():g.hide();d.ma?a.show():a.hide()};f.prototype.Hf=function(c){function b(c,d,f,k,g,h,q,n,j,m,t,w,v,o){c=!c.hasClass("kbb-tableviewcell")?
a('<div class="kbb-tableviewcell'+(j&&j.Pa?" kbb-item-hidden":"")+'"></div>').data("pid",d).data("sn",f).data("iar",k).data("rid",g).data("rar",h).appendTo(c):c;m!=""&&a(m).appendTo(c);m=a('<div class="'+(o?"kbb-tableviewcellheader":"kbb-tableviewcellbody")+'"></div>').appendTo(c);d=a('<div class="kbb-tableviewcelltext"></div>').appendTo(m);o&&a('<div class="kbb-tableviewcellarrow"></div>').appendTo(m);e(d,q,n,j);m.data("tc",t).data("bc",w).data("ich",v);return c}function e(c,b,f,k){b?Ya(function(){c.html(b)}):
c.text(f);Za(c,!1);k&&Ya(function(){ef(c,k,!1);if(k.image){var b=a('<div class="kbb-imgbtn'+(k.$a?" kbb-active":"")+(k.Tb?" kbb-border":"")+'"><img src="'+k.image.src+'"></img></div>');b.data("pid",k.I).data("c",k.$a).data("u",k.Ha);b.prependTo(c);k.$a&&b.bindMouseOrTouchEvent("click",n).bindMouseOrTouchEvent("mousedown",ha(!1))}if(k.Ha!=""){var e=k.Ha;e.length>3&&e.substring(e.length-3)=="\u00a7if"&&(e=e.substring(0,e.length-3));for(var f=0,l=[255,255,255],b=0;b<ma.length;b++)if(e.search(ma[b].p)>=
0){f=ma[b].i;l=ma[b].b;break}Ya(function(){return a("<div></div>").iconbtn({iconindex:f,iconhilightindex:f+1,iconhilightbackgroundcolor:l,link:e,width:64*d.D}).prependTo(c).data("pid",k.I).data("c",!1).data("u",k.Ha)}).bindMouseOrTouchEvent("click",n).bindMouseOrTouchEvent("mousedown",ha(!1))}});c.find("img").attr("draggable","false")}function f(a,c){r=o.find(".kbb-tableviewcolumn");var b=a.closest(".kbb-tableviewcolumn"),e=a.data("pid"),k=a.data("rid"),l=b.data("pid"),g=!1;lj(a);U()?Oc({action:"onitemselected",
i:e,r:k,search:"",setasroot:0,redraw:0}):d.j.Ga(e,k,!1,!1,!0);if(c){if(e!=l)b.find(".kbb-tableviewcell-rootitem").removeClass("kbb-tableviewcell-rootitem"),a.addClass("kbb-tableviewcell-rootitem"),d.Fa=r.index(b)+1,d.ca=d.Fa,sd=!0,d.load(e,-1,"",0,!1,!1,xe+1),U()&&Oc({action:"onitemselected",i:e,r:-1,search:"",setasroot:1,redraw:1}),g=!0}else d.Ia&&jg(e,!0,i);b=J.scrollTop();e=J.height();k=a.position().top-J.position().top;l=a.outerHeight(!0);k+l>e?J.scrollTop(b+k+Math.min(0,l-e)):k<0&&J.scrollTop(b+
k);return g}function g(c){if(Ib||Ma&&(L.zoom||L.dragged))return!1;Qb();Kc(i);var b=a(this),e=C.find(".itemtoolbar"),c=d.H&&!d.Ia&&((b.data("iar")&(rc|sc|Dc|Ec))!=0||(b.data("rar")&sc)!=0)&&typeof c.isTrigger==="undefined"&&(!e.is(":visible")||e.data("psc")[0]!=this);!f(a(this),!d.H)&&Db&&(b=b.data("pid"),d.kb(b,!1));c&&m.call(this,i);return!1}function h(){if(d.H){r=o.find(".kbb-tableviewcolumn");var c=a(this),b=c.closest(".kbb-tableviewcolumn"),e=c.data("pid"),b=b.data("pid");e==b?Rc(e):!f(c,!0)&&
Db&&d.kb(e,!1)}}function j(c){var b=c.handleObj,e=a.data(c.target),k=(new Date).getTime(),l=e.qa?k-e.qa:0;l<300&&l>30?(e.qa=i,c.type=b.origType,d.H&&(r=o.find(".kbb-tableviewcolumn"),c=a(this),e=c.closest(".kbb-tableviewcolumn"),b=c.data("pid"),e=e.data("pid"),b==e?Rc(b):!f(c,!0)&&Db&&d.kb(b,!1))):e.qa=k}function n(){if(Ib||Ma&&(L.zoom||L.dragged))return!1;Qb();Kc(i);if(a(this).data("c"))Sc(a(this).data("pid"),!1,-1);else{var c=a(this).data("u"),b=!1;c.length>3&&c.substring(c.length-3)=="\u00a7if"&&
(b=!0,c=c.substring(0,c.length-3));var e=c.length>=7&&c.substring(0,7).toLowerCase()=="file://";if(c.length>=9&&c.substring(0,9).toLowerCase()=="itemid://")c=parseInt(c.substring(9)),isNaN(c)||(d.load(c,-1,"",Xb,!0,!1,xe+1),U()&&Oc({action:"onitemselected",i:c,r:-1,search:"",setasroot:1,redraw:1}));else if(b&&!e)md(c);else if(U())Oc({action:"shellexecute",file:c});else if(Cb())fd({action:"launchurl",file:c},fa());else if((qb()||Bb())&&e)B({action:"launchfile",file:c},fa());else if(qb())try{var f=
new window.Windows.Foundation.Uri(c);window.Windows.System.Launcher.launchUriAsync(f)}catch(k){}else window.open(c,"_blank","")}return!1}function m(c){Lc();if(!c||!vb(c))if(!Ib&&!(Ma&&(L.zoom||L.dragged)||ib&&cc==i))if(c=a(this),c.hasClass("kbb-tableviewcell-selected")){var b=C.find(".itemtoolbar");if(b.is(":visible")){var e=b.data("psc");if(e&&typeof e!=="undefined"&&e[0]==this)return}a.fn.C.close();if(d.H&&!d.Ia&&((c.data("iar")&(rc|sc|Dc|Ec))!=0||(c.data("rar")&sc)!=0)){e=c.position();o.find(".kbb-tableviewcell-hover").removeClass("kbb-tableviewcell-hover");
c.addClass("kbb-tableviewcell-hover");b.data("psc",c);db(".id-new-item",!0,(c.data("iar")&pc)!=0&&(c.data("iar")&rc)!=0);db(".id-new-relation",!0,(c.data("iar")&rc)!=0);db(".id-edit-item",!0,(c.data("iar")&(Dc|Ec))!=0);db(".id-delete-item",!0,(c.data("iar")&sc)!=0);db(".id-delete-relation",!0,(c.data("rar")&sc)!=0&&c.data("rid")>=0);var f=c.data("pid");db(".id-open-attachments",!0,d.j.q[d.j.F[f]].$a);db(".id-undo",!0,nf.length>0);db(".id-redo",!0,of.length>0);db(".id-paste-item",!0,Vd);db(".id-reset-item-shift",
!0,!1);db(".id-reset-item-shifts",!0,!1);f=c.parents(".kbb-tableviewheader").length>0;Yh(b,e.left,e.top+c.outerHeight(!0)-(f?1:c.outerHeight()-1),f)}}}function v(c){vb(c)||Jf(a(this),c)||Lc()}this.sd(c);P=this.vc;var p=C.find(".kmappage"),o=C.find(".textlayer"),r=o.find(".kbb-tableviewcolumn"),u=i,s=-1,q=-2,w=-1,A=$d(),x=Bx(),z=!1;if(d.Fa>=0)d.Fa<r.length&&(r.splice(0,d.Fa),r.remove(),r=o.find(".kbb-tableviewcolumn")),d.Fa=-1;d.ca>=0&&d.ca<r.length&&(u=a(r[d.ca]),u.data("pid")!=P&&(u=a(r[r.length-
1]),u.data("pid")!=P&&(u=i)));var E=a('<div class="kbb-tableviewcolumn"></div>');if(u){var s=u.find(".kbb-tableviewbody").scrollTop(),F=u.find(".kbb-tableviewcell-selected");F.length>0&&(q=F.data("rid"));F=u.find(".kbb-tableviewcell-rootitem");F.length>0&&(w=F.data("rid"));u.replaceWith(E)}else E.appendTo(o);r=o.find(".kbb-tableviewcolumn");Nc>=0&&(q=Nc,Nc=-1);var F=a('<div class="kbb-tableviewheader"></div>').appendTo(E),J=a('<div class="kbb-tableviewbody"></div>').appendTo(E),I,H=0,aa=0,Y=i,T,O,
R=i,y,Q,V={},ka;o.find(".kbb-tableviewcell").each(function(){ka=V[a(this).data("pid")];typeof ka==="undefined"?V[a(this).data("pid")]=[a(this)]:ka.push(a(this))});for(H=0;H<c.i.length;H++)if(Y=this.q[this.F[c.i[H].i]],ka=V[Y.I],Y.Pa=typeof Y.zb!=="undefined"?Y.zb:Y.Q>=0&&typeof this.da[Y.Q]!=="undefined"&&this.da[Y.Q].templateName.length>0&&this.da[Y.Q].templateName.charAt(0)=="#",typeof ka!=="undefined")for(aa=0;aa<ka.length;aa++)I=ka[aa],e(I.find(".kbb-tableviewcellheader .kbb-tableviewcelltext"),
Y.html,Y.text,Y),e(I.find(".kbb-tableviewcellbody .kbb-tableviewcelltext"),Y.Z,Y.ba,i),I.css("font-family",Y.Pb());H=r.index(E);H>0&&a(r[H-1]).data("pid");for(var ca=[],H=0;H<c.i.length;H++)ca[H]=H;d.Ia&&ca.sort(function(a,d){return a==0?-1:d==0?1:c.i[d].mr-c.i[a].mr});for(aa=0;aa<c.i.length;aa++){H=ca[aa];Y=this.q[this.F[c.i[H].i]];R=H>0&&H-1<c.r.length&&(c.r[H-1].f==c.i[H].i||c.r[H-1].t==c.i[H].i)?this.R[this.ja[c.r[H-1].r]]:i;I=Y.Rb("ici")[0];T=Y.pa("ici")[0];O=Y.pa("ich")[0];y=ff(T[0],T[1],T[2]);
Q=hf(y[0],0.6*y[1],40);y=[255,255,255];var da=N(Y);I=b(H==0?F:J,Y.I,H==0?0:c.i[H].sn,Y.$b,R?R.Ea:-1,R?R.$b:0,Y.html,Y.text,Y,da,H==0?[255,255,255]:I,H==0?Q:T,O,!0);I.css("font-family",Y.Pb());H==0?(T=a('<div class="kbb-tableviewcolumnclosebtn"></div>').prependTo(I),Q=a('<div class="kbb-tableviewcolumnexpandbtn"></div>').prependTo(I),Q.toolbaricon({index:84,hilightindex:85,width:19,height:19,color:"#FFF",border:!0,hover:i}),Q.bind("click",function(){if(Ib||Ma&&(L.zoom||L.dragged))return!1;Kc(i);var c=
a(this).closest(".kbb-tableviewcolumn"),b=c.data("pid"),e=-1,f={};bb=[];c.find(".kbb-tableviewcell").each(function(){e=a(this).data("pid");e!=b&&typeof f[e]==="undefined"&&(d.j.q[d.j.F[e]].Rd>0&&bb.push(e),f[e]=1)});var k=$d();if(k>=0){Of=c.position().left;var l=o.find(".kbb-tableviewcolumn");d.Fa=l.index(c)+1;d.ca=d.Fa;d.load(k,-1,"",0,!0,!0,xe+1);U()&&Oc({action:"onitemselected",i:k,r:-1,search:"",setasroot:1,redraw:1});d.kb(k,!1)}return!1}),T.toolbaricon({index:80,hilightindex:81,width:19,height:19,
color:"#FFF",border:!0,hover:i}),T.bind("click",function(){if(Ib||Ma&&(L.zoom||L.dragged))return!1;Kc(i);a(this).closest(".kbb-tableviewcolumn").remove();Kf(!1);return!1})):Lx(I);if(R&&R.Ea==q||R==i&&q==-1)lj(I),q=-2;R&&R.Ea==w&&(I.addClass("kbb-tableviewcell-rootitem"),w=-1);!z&&A==Y.I&&(I.addClass("kbb-tableviewcell-rootitem"),z=!0);I.bind("click",g);I.bind("dblclick",h);I.bind("touchstart",j);I.bindMouseOrTouchEvent("mouseenter.kmEvents",m).bindMouseOrTouchEvent("mouseleave.kmEvents",v);I=b(H==
0?J:I,Y.I,H==0?0:c.i[H].sn,Y.$b,R?R.Ea:-1,R?R.$b:0,Y.Z,Y.ba,i,"",[0,0,0],y,O,!1);I.css("font-family",Y.Pb());if(H==0)I.addClass("kbb-tableviewheaderdescription"),I.bind("click",g),I.bind("dblclick",h),I.bind("touchstart",j),I.bindMouseOrTouchEvent("mouseenter.kmEvents",m).bindMouseOrTouchEvent("mouseleave.kmEvents",v),E.data("pid",Y.I),P=Y.I}J.scroll(function(){Lc();Ma&&!L.zoom&&!L.dragged&&(Ma=i,a("html,body").removeClass("cursormove"))});E.bindMouseOrTouchEvent("mousemove",function(c){(a(a.fn.C.obj).is(":visible")||
C.find(".textselector").is(":visible"))&&!d.lc(c)&&a.fn.C.close()});o.find(".kbb-tableviewcell").each(function(){var c=a(this).hasClass("kbb-tableviewheaderdescription"),b=a(this).find(".kbb-tableviewcellheader"),e=a(this).find(".kbb-tableviewcellbody"),f=b.find("kbb-tableviewcellarrow"),c=a(this).hasClass("kbb-tableviewheaderdescription"),k=!1;(d.na>0||c)&&a.trim(a(this).find(".kbb-tableviewcellbody .kbb-tableviewcelltext").html()).length>0?a(this).hasClass("kbb-tableviewcell-expanded")||(e.show(),
a(this).addClass("kbb-tableviewcell-expanded").removeClass("kbb-tableviewcell-collapsed"),k=!0):a(this).hasClass("kbb-tableviewcell-collapsed")||(e.hide(),a(this).addClass("kbb-tableviewcell-collapsed").removeClass("kbb-tableviewcell-expanded"),k=!0);k&&(c&&(c=a(this).closest(".kbb-tableviewcolumn").find(".kbb-tableviewheader .kbb-tableviewcellheader"),c.length==1&&a(this).css("border-color",$e(c.data("bc")))),b.length>0&&(b.css("color",$e(b.data("tc"))).css("background-color",$e(b.data("bc"))),f.css("border-color",
$e(mg(b.data("bc"),[255,255,255],[0,0,0]))),a(this).css("border-color",$e(b.data("bc")))),e.length>0&&e.css("color",$e(e.data("tc"))).css("background-color",$e(e.data("bc"))))});Kf(u==i&&bb==i);s>0&&J.scrollTop(s);A>=0?(d.Fa=-1,d.ca=x,d.load(A,-1,"",0,!1,!1,xe+1)):(u=rd(),nb(o.find(".kbb-tableviewcellbody"),u,!0,!0),td(this),this.Ff(),wq(),this.fe(),d.ge?d.ge=!1:d.ca=r.length-1,bb&&Of>=0&&(p.css("overflow-x")=="scroll"&&parseInt(p.scrollLeft())!=parseInt(Of)&&p.animate({scrollLeft:Of},d.T==0?0:ac,
"smoothEasing",i),Of=-1),bb=i)};f.prototype.oc=function(a,b,e,f,g,h,j){if(Ik(e,b)>0){var n=g+6*d.D,m=2.25*n,v=3*n,o=Ok(e,b),p=Pk(o),r=Ph(Ph(b,Z(p,f+n)),Z(o,v)),u=Ph(Ph(b,Z(p,f)),Z(o,m)),s=Vh(Ph(e,Z(p,g)),Z(o,m)),q=Vh(Ph(e,Z(p,g+n)),Z(o,v)),w=Vh(Vh(e,Z(p,g+n)),Z(o,v)),B=Vh(Vh(e,Z(p,g)),Z(o,m)),A=Ph(e,Z(p,g)),g=Vh(e,Z(p,g)),m=Ph(Vh(b,Z(p,f)),Z(o,m)),n=Ph(Vh(b,Z(p,f+n)),Z(o,v)),v=Vh(b,Z(p,f)),f=Ph(b,Z(p,f));a.beginPath();h?(Qk(a,b),Rk(a,r),Rk(a,u)):Qk(a,f);j?(Rk(a,s),Rk(a,q),Rk(a,e),Rk(a,w),Rk(a,B)):
(Rk(a,A),Rk(a,g));h?(Rk(a,m),Rk(a,n)):Rk(a,v);a.closePath();a.fill()}};f.prototype.se=function(a,b,e,f,g,h,j){function n(a,c,d,f,g){var h=Ok(b[c],b[a]),j=Pk(h),a=Ph(b[c],Z(Ok(b[a],b[c]),g*(Ik(b[a],b[c])+u))),c=Ph(a,Z(j,e)),g=Ph(Ph(a,Z(j,e+p)),Z(h,u)),n=Ph(Ph(a,Z(j,e)),Z(h,r));v.splice(d,0,Ph(Vh(a,Z(j,e)),Z(h,r)),Ph(Vh(a,Z(j,e+p)),Z(h,u)),Vh(a,Z(j,e)));v.splice(f,0,c,g,n);o+=3}function m(a,c,d,f,g,h){var c=Ok(b[c],b[a]),j=Pk(c),n=Z(c,r),g=v[g];g.x+=n.x;g.y+=n.y;h=v[h];h.x+=n.x;h.y+=n.y;h=Ph(Ph(b[a],
Z(j,e+p)),Z(c,u));v.splice(d,0,Ph(Vh(b[a],Z(j,e+p)),Z(c,u)),b[a]);v.splice(f,0,h)}var v=[];Sk(b,v,e,!1);var o=v.length-1;Sk(b,v,e,!0);var p=e+6*d.D,r=2.25*p,u=3*p;if(h&&b.length>=2)for(var s=0;s<h.length;s++)n(1,0,1+3*s,v.length-1+3-3*s,h[s]);if(j&&b.length>=3)for(s=0;s<j.length;s++)n(b.length-1,b.length-2,o,o+2+3,j[s]);g&&b.length>=2&&o>=0&&o<v.length-1&&m(b.length-1,b.length-2,o+1,o+1+2,o,o+1);f&&b.length>=2&&m(0,1,v.length+2,0,0,v.length-1);if(v.length>1){s=0;a.beginPath();Qk(a,v[0]);for(s=1;s<
v.length;s++)Rk(a,v[s]);a.closePath();a.fill()}};f.prototype.Qf=function(a,b,e,f,g,h,j){function n(d,f,g){var h=Ok(b[f],b[d]),j=Pk(h),d=g==1?b[d]:Ph(b[f],Z(Ok(b[d],b[f]),g*(Ik(b[d],b[f])+o))),f=Ph(Ph(d,Z(j,e+m)),Z(h,o)),j=Ph(Vh(d,Z(j,e+m)),Z(h,o)),h=Ph(d,Z(h,v));a.beginPath();Qk(a,f);Rk(a,d);Rk(a,j);Rk(a,h);a.closePath();a.fill()}var m=e+6*d.D,v=2*m,o=3*m;if(h&&b.length>=2)for(var p=0;p<h.length;p++)n(1,0,h[p]);if(j&&b.length>=3)for(p=0;p<j.length;p++)n(b.length-1,b.length-2,j[p]);f&&b.length>=2&&
n(0,1,1);g&&n(b.length-1,b.length-2,1);p=0;h=[];Tk(b,h,4*e,f?v+3.5*e:2*e,g?v+2*e:2*e);for(p=0;p<h.length;p++)a.beginPath(),Uk(a,h[p],1.2*e),a.closePath(),a.fill()};f.prototype.ud=function(a,b,e,f,g,h,j,n){if(h==0)this.oc(a,b,e,f,g,j,n);else if(Ik(e,b)>0){var m=g+6*d.D,v=2.25*m,p=3*m,o=Ok(e,b),r=Pk(o),s=(f+g)/2,B=Ph(Oh(Ph(b,Vh(e,Z(o,v))),2),Z(r,2*h)),q=Ok(B,b),w=Pk(q),A=Ok(e,B),x=Pk(A),h=Ph(Ph(b,Z(w,f+m)),Z(q,p)),o=Ph(Ph(b,Z(w,f)),Z(q,v)),z=Ph(B,Z(r,s)),C=Vh(Ph(e,Z(x,g)),Z(A,v)),E=Vh(Ph(e,Z(x,g+m)),
Z(A,p)),F=Vh(Vh(e,Z(x,g+m)),Z(A,p)),A=Vh(Vh(e,Z(x,g)),Z(A,v)),J=Ph(e,Z(x,g)),g=Vh(e,Z(x,g)),r=Vh(B,Z(r,s)),v=Ph(Vh(b,Z(w,f)),Z(q,v)),m=Ph(Vh(b,Z(w,f+m)),Z(q,p)),p=Vh(b,Z(w,f)),f=Ph(b,Z(w,f));a.beginPath();j?(Qk(a,b),Rk(a,h),Rk(a,o)):Qk(a,f);n?(Vk(a,z,C),Rk(a,E),Rk(a,e),Rk(a,F),Rk(a,A)):(Vk(a,z,J),Rk(a,g));j?(Vk(a,r,v),Rk(a,m)):Vk(a,r,p);a.closePath();a.fill()}};f.prototype.Pf=function(a,b,e,f,g,h,j,n){if(Ik(e,b)>0){var m=g+6*d.D,p=2*m,o=3*m,r=Ok(e,b),s=Pk(r),u=Ph(Oh(Ph(b,Vh(e,Z(r,p))),2),Z(s,2*h)),
B=Ok(u,b),q=Pk(B),u=Ok(e,u),w=Pk(u),r=1,A=0,x=0,z=0,A=x=0,A=Ph(Ph(b,Z(q,f+m)),Z(B,o)),q=Ph(Vh(b,Z(q,f+m)),Z(B,o)),x=Ph(b,Z(B,p)),z=Vh(Ph(e,Z(w,g+m)),Z(u,o)),m=Vh(Vh(e,Z(w,g+m)),Z(u,o)),p=Vh(e,Z(u,p));j&&(a.beginPath(),Qk(a,A),Rk(a,b),Rk(a,q),Rk(a,x),a.closePath(),a.fill(),b=Ph(b,Z(B,o)));n&&(a.beginPath(),Qk(a,z),Rk(a,e),Rk(a,m),Rk(a,p),a.closePath(),a.fill(),e=Vh(e,Z(u,o)));u=Ph(Oh(Ph(b,e),2),Z(s,2*h));do A=1-r,x=A*A,z=r*r,h=Ph(Ph(Z(b,x),Z(u,2*r*A)),Z(e,z)),x=A*f+r*g,a.beginPath(),Uk(a,h,1.2*x),
a.closePath(),a.fill(),h=Ph(Ph(Z(b,-2*A),Z(u,2-4*r)),Z(e,2*r)),A=4*((1-r)*f+r*g)/$h(h),r-=A;while(r>=0)}};f.prototype.Je=function(a,d,b,e,f,g,h){for(var j=0,m=0,p=0,o=0,r=0,s=0,j=m=0;j<10;j++)m=j/9,p=1-m,o=p*p,r=m*m,s=o*d+2*m*p*e+r*g,m=o*b+2*m*p*f+r*h,a.push(X(s,m))};f.prototype.Me=function(a,d,b,e,f,g,h,j,m){if(m)return Uh(m,X(a,d));else{var p=m=0,o=0,r=0,s=o=p=m=0,s=r=0;Math.abs(h-b)>Math.abs(j-e)?(m=a,p=b,o=f,s=h):(m=d,p=e,o=g,s=j);r=p-2*o+s;if(r==0)return X(a,d);s=o*o+r*m-p*s;if(s<0)return X(a,
d);s=Math.sqrt(s);m=(p-o+s)/r;if(m<0||m>1)m=(p-o-s)/r;if(m<0||m>1)return X(a,d);p=1-m;o=p*p;r=m*m;return X(o*b+2*m*p*f+r*h,o*e+2*m*p*g+r*j)}};f.prototype.Rc=function(a,d,b,e,f,g,h){var j=[],m=b-a,p=e-d,o=Math.sqrt(m*m+p*p);if(o>0)if(p=-p/o,m/=o,h==0)j.push(X(a+f*p,d+f*m)),j.push(X(b+g*p,e+g*m)),j.push(X(b-g*p,e-g*m)),j.push(X(a-f*p,d-f*m));else{var o=2*h+(f+g)/2,h=2*h-(f+g)/2,r=(a+b)/2,s=(d+e)/2;this.Je(j,a+f*p,d+f*m,r+o*p,s+o*m,b+g*p,e+g*m);this.Je(j,b-g*p,e-g*m,r+h*p,s+h*m,a-f*p,d-f*m)}return j};
f.prototype.jf=function(a,d,b,e,f,g,h,j,m,p,o,r,s,u){var B=[153,204,255],q=[0,0,0];if(h.length>0||s&&s.length>0){var w=b.x-d.x,A=b.y-d.y,x=Math.sqrt(w*w+A*A),z=0,C=x/2;f+=0.5*e*g;var E=0,F=0;a.save();if(u)f=0,a.textBaseline="middle";else if(a.textBaseline=e<0?"bottom":"top",x>0)b.x>=d.x?z=Math.atan2(A,w):(z=Math.atan2(-A,-w),C=-C,f=-f,a.textBaseline=e<0?"top":"bottom");a.translate(d.x,d.y);a.rotate(z);a.textAlign="center";if(h.length>0){a.font=m+"px "+j;E=a.measureText(h).width;F=1.6*m;if(p)a.fillStyle=
gf(p,r),a.fillRect(C-0.5*E-0.5*F,f+(a.textBaseline=="top"?-0.25*g:a.textBaseline=="bottom"?0.25*g-F:-0.5*F),E+F,F+(a.textBaseline=="top"||a.textBaseline=="bottom"?0.25*g:0));a.fillStyle=gf(o,r);a.fillText(h,C,f+(a.textBaseline=="top"||a.textBaseline=="bottom"?0.15*F*(a.textBaseline=="top"?1:-1):0));C-=0.5*E+0.5*F;f+=F*(a.textBaseline=="top"?1:a.textBaseline=="bottom"?-1:-0.5);a.textAlign="left"}if(a.textBaseline=="middle")a.textBaseline="bottom";if(s.length>0){m*=0.8;a.font=m+"px "+j;E=a.measureText(s).width;
F=1.6*m;if(B)a.fillStyle=gf(B,r),a.fillRect(C-(a.textAlign=="left"?0:0.5*E+0.5*F),f+(a.textBaseline=="top"?0:-F),E+F,F);a.fillStyle=gf(q,r);a.fillText(s,C+(a.textAlign=="left"?0.5*F:0),f+0.15*F*(a.textBaseline=="top"?1:-1))}a.restore()}};f.prototype.Tf=function(a,b,e,f,g,h,j,n,m,p,o){function r(d){a.beginPath();d>0&&(a.moveTo(u+n+d,B+d),a.arc(u+n+d,B+n+d,n,1.5*Math.PI,Math.PI,!0),a.arc(u+n+d,w-n-d,n,Math.PI,0.5*Math.PI,!0),a.arc(q-n-d,w-n-d,n,0.5*Math.PI,0,!0),a.arc(q-n-d,B+n+d,n,0,1.5*Math.PI,!0));
a.moveTo(u+n,B);a.arc(q-n,B+n,n,1.5*Math.PI,0,!1);a.arc(q-n,w-n,n,0,0.5*Math.PI,!1);a.lineTo(h+A,w);a.lineTo(h,j);a.lineTo(h-A,w);a.arc(u+n,w-n,n,0.5*Math.PI,Math.PI,!1);a.arc(u+n,B+n,n,Math.PI,1.5*Math.PI,!1);a.closePath()}var s=1.25*d.D,u=b-0-0.5*s,B=e-0-0.5*s,q=b+f+0+0.5*s,w=e+g+0+0.5*s,A=0.4*(j-g-e),e=1;typeof z.ia!=="undefined"&&z.ia!==i&&(e=z.ia);p=p?"0.1":e;if(Jg!=0)b=b+f+2E3,f=0.2*(1+2*d.$/100),a.save(),a.transform(1,0,-f,0.5,f*j-b,0.5*j),r(0),a.shadowColor=gf([0,0,0],0.35*p),a.shadowOffsetX=
b,a.shadowOffsetY=0,a.shadowBlur=3*d.D,a.fillStyle=gf([0,0,0],p),a.fill(),a.restore();r(o?2:0);Ae&&w>B?(f=ff(m[0],m[1],m[2]),b=hf(f[0],Math.max(0,f[1]-50),100),f=hf(f[0],f[1]>5?Math.min(100,f[1]+25):f[1],Math.max(0,f[2]-25)),e=a.createLinearGradient(0,B,0,w),e.addColorStop(0,gf(b,p)),e.addColorStop(0.5,gf(m,p)),e.addColorStop(1,gf(f,p)),a.fillStyle=e):a.fillStyle=gf(m,p);a.fill();if(!o)r(0),f=ff(m[0],m[1],m[2]),m=hf(f[0],f[1],0.75*f[2]),a.save(),a.clip(),a.lineWidth=2*s,a.strokeStyle=gf(m,p),a.stroke(),
a.restore()};f.prototype.Qb=function(a){for(var b=C.find(".ikmap").offset(),e=fg(a)-b.left,b=lg(a)-b.top,f=i,g=i,j=i,g=1,j=15*d.D,m=0,g=[],n=0,a=(vb(a)?20:5)*d.D,n=0;n<this.q.length;n++){f=this.q[n];g=f.sa();m=g*f.V+j;if(d.H&&m>0&&Math.pow(Math.pow((e-f.O)/(0.6*m),2)+Math.pow((b-f.N)/(0.4*m),2),0.5)<1)return new h(e,b,n,-1,-1);if(f.A.J!=i){var g=[],p=f.A.J.outerWidth(),m=f.A.J.outerHeight(),o=f.A.Ib+0.25*p,p=f.A.Ib+0.75*p,r=f.A.Jb+0.25*m,f=f.A.Jb+0.75*m;g.push(X(o,r));g.push(X(p,r));g.push(X(p,f));
g.push(X(o,f));if(Lg(e,b,g))return new h(e,b,n,-1,-1)}}for(n=0;n<this.q.length;n++)if(f=this.q[n],g=f.sa(),m=g*f.V+j,f.A.J!=i&&(g=[],o=f.O-0.6*m,p=f.O+0.6*m,r=f.N-0.4*m,f=f.N+0.4*m,g.push(X(o,r)),g.push(X(p,r)),g.push(X(p,f)),g.push(X(o,f)),Lg(e,b,g)))return new h(e,b,n,-1,-1);for(n=0;n<this.R.length;n++)if(g=this.R[n],g.Uc&&(d.Tc()?g=this.Rc(g.gb,g.Sa,g.fb,g.Ra,4*g.ed+a,4*g.dd+a,g.bb):(f=2*(g.ed+g.dd)+a,o=g.Fd(X(g.gb,g.Sa),X(g.fb,g.Ra),1E3),o.forEach(function(a){var c=d.K;a.x*=1;a.y*=c}),o.unshift(X(g.gb,
g.Sa)),o.push(X(g.fb,g.Ra)),g=[],Sk(o,g,f,!1),Sk(o,g,f,!0)),Lg(e,b,g)))return new h(e,b,-1,n,-1);for(n=0;n<this.q.length;n++){f=this.q[n];g=f.sa();m=g*f.V+j;if(d.H&&m>0&&Math.pow(Math.pow((e-f.O)/(1.2*m),2)+Math.pow((b-f.N)/(0.8*m),2),0.5)<1)return new h(e,b,n,-1,-1);if(f.A.J!=i&&(g=[],p=f.A.J.outerWidth(),m=f.A.J.outerHeight(),o=f.A.Ib,p=f.A.Ib+p,r=f.A.Jb,f=f.A.Jb+m,g.push(X(o,r)),g.push(X(p,r)),g.push(X(p,f)),g.push(X(o,f)),Lg(e,b,g)))return new h(e,b,n,-1,-1)}for(n=0;n<this.q.length;n++)if(f=this.q[n],
g=f.sa(),m=g*f.V+j,f.A.J!=i&&(g=[],o=f.O-1.2*m-a,p=f.O+1.2*m+a,r=f.N-0.8*m-a,f=f.N+0.8*m+a,g.push(X(o,r)),g.push(X(p,r)),g.push(X(p,f)),g.push(X(o,f)),Lg(e,b,g)))return new h(e,b,n,-1,-1);for(n=0;n<this.Qa.length;n++)if(j=this.Qa[n],g=[],o=j.O-a,p=j.O+j.Jg+a,r=j.N-a,f=j.N+j.Ig+a,g.push(X(o,r)),g.push(X(p,r)),g.push(X(p,f)),g.push(X(o,f)),Lg(e,b,g))return new h(e,b,-1,-1,n);return i};f.prototype.Hc=function(c,e,f){function g(c,e,k,h){if(!Ib&&!Wb&&!($b||Ma&&(L.zoom||L.dragged))){a.fn.C.close();var j=
d.j.R[d.j.ja[c]];if(j){var m=C.find(".relationselector");m.data("rid",c).unbind("click.kmEvents").bind("click.kmEvents",function(a){d.H&&(U()?Oc({action:"onrelationselected",i:e.I,r:c,redraw:1}):d.j.Ga(-1,c,!0,!1,!0),d.pe(a,!0));return!1}).unbind("dblclick.kmEvents").bind("dblclick.kmEvents",function(){if(Ma&&L.zoom)return!1;d.H&&Xe(d.j.R[d.j.ja[c]].Ea)}).unbind("touchstart.kmEvents").bind("touchstart.kmEvents",function(b){if(Ma&&L.zoom)return!1;var e=b.handleObj,f=a.data(b.target),g=(new Date).getTime(),
k=f.qa?g-f.qa:0;k<300&&k>30?(f.qa=i,b.type=e.origType,d.H&&Xe(d.j.R[d.j.ja[c]].Ea)):f.qa=g});var q=h.x>a(window).width()/2&&h.x>a(window).width()-370,n=h.x-20,h=h.y-20;m.css({left:n+"px",top:h+"px",width:"40px",height:"40px"}).show();var p=!1;if(d.H&&(c==d.j.aa||f)&&!d.Ia&&j.xb(sc|Dc|Ec)){var p=C.find(".kmappage"),o=C.find(".relationtoolbar"),p=m.offset().top-p.offset().top-o.outerHeight()<0;db(".id-edit-relation",!1,j.xb(Dc|Ec));db(".id-delete-relation",!1,j.xb(sc));Yh(o,n-10,h+(p?35:5),p)}if(!p&&
(!d.H||d.H&&(c==d.j.aa||f)&&!d.Ia))window.lastTooltipRelationID=c,window.lastTooltipItemID=-1,m.C({alignment:q?{body:"left",pointer:"right"}:{body:"right",pointer:"left"},url:b.baseurl+nc+b.scriptextension,diagram:d,openAttachments:Sc,openDocument:md,rootItemID:P,id:c,idfrom:e.I,idto:k.I,action:"reltip",hOffset:0,vOffset:-6,moveTop:!d.H,searchEngines:Wd,fadeIn:d.T!=0,onOpenCallback:function(c){if(typeof c!=="undefined"){var c=[jd(c.nf),jd(c.nt)],c=ze(c),d=a(a.fn.C.obj).find(".tttitle,.tttext");nb(d,
c,!0,!1)}},database:O}),a.fn.C.obj.mouseleave(function(c){d.lc(c)||(c=d.j.Qb(c))&&c.Ua>=0||a.fn.C.close()})}}}var h=!Qx(c,this.Sd),j=c&&c.eb>=0&&c.eb<this.q.length,m=c&&c.Ua>=0&&c.Ua<this.R.length,n=this.Sd&&this.Sd.Ua>=0;this.Sd=c;var p=a(a.fn.C.obj);if(h||m&&f&&(!p.is(":visible")||!C.find(".relationtoolbar").is(":visible")))bc.hide(),Ah!=i&&clearTimeout(Ah),m?Ah=setTimeout(function(){Ah=i;if(!C.find(".editoverlay").is(":visible")&&!Ib&&!Wb&&!($b||Ma&&(L.zoom||L.dragged))){var b=d.j.R[c.Ua];if(!(b==
i||typeof b==="undefined"||typeof b.Ea==="undefined"||typeof b.ra==="undefined"||typeof b.Va==="undefined"||typeof b.gb==="undefined"||typeof b.Sa==="undefined"||typeof b.fb==="undefined"||typeof b.Ra==="undefined"||typeof b.bb==="undefined")){var e=b.Ea,f=d.j.q[b.ra],k=d.j.q[b.Va],l=b.gb,h=b.Sa,j=b.fb,m=b.Ra,n=j-l,p=m-h,o=Math.sqrt(n*n+p*p),p=b.bb==0?l:(l+j)/2+2*b.bb*(-p/o),n=b.bb==0?h:(h+m)/2+2*b.bb*(n/o),o=i,r=C.find(".canvas9")[0],t=0,s=0,s=oe([a(r)]),t=s.l,s=s.t;if(r.getContext){var B=a(r).width(),
A=a(r).height(),r=r.getContext("2d");r.save();r.clearRect(0,0,B,A);A=b.Gd();B=A==1||A==3;A=A==2||A==3;r.setTransform(1,0,0,1,-t,-s);r.scale(1,d.K);r.fillStyle=gf(mg(Sb,[255,255,255],[0,0,0]),0.25);d.Tc()?d.j.ud(r,X(b.gb,b.Sa/d.K),X(b.fb,b.Ra/d.K),4*b.ed,4*b.dd,b.bb,B,A):(s=t=i,b.Cc?(b.Cc=="f"?(t=[0.4,0.5,0.6],s=[0.5]):b.Cc=="t"&&(t=[0.5],s=[0.4,0.5,0.6]),A=B=!1):d.hc()&&b.label!=""&&(t=[0.25,0.75],s=i,A=B=!1),o=b.Fd(X(b.gb,b.Sa),X(b.fb,b.Ra),1E3),o.unshift(X(b.gb,b.Sa/d.K)),o.push(X(b.fb,b.Ra/d.K)),
d.j.se(r,o,2*(b.ed+b.dd),B,A,t,s));r.restore();Pf=!0}b=d.j.Me(c.x,c.y/d.K,l,h/d.K,p,n/d.K,j,m/d.K,o);b.y*=d.K;g(e,f,k,b)}}},40):n&&Pf&&(h=C.find(".canvas9")[0],h.getContext&&(m=a(h).width(),n=a(h).height(),h.getContext("2d").clearRect(0,0,m,n)),Pf=!1),j&&!vb(e)&&(a.fn.C.close(),this.q[c.eb].Ud(bc,1E3))};f.prototype.Vb=function(a){U()?Oc({action:"onitemselected",i:a,r:-1,search:"",setasroot:0,redraw:1}):this.Ga(a,-1,!0,!1,!0)};f.prototype.Ga=function(a,b,e,f,g){d.H||(b=-1);var h=a!=this.W,j=b!=this.aa,
m=i;a>=0&&typeof this.F[a]!=="undefined"&&(m=this.q[this.F[a]]);this.W=a;this.aa=b;if(d.B==Ia||d.B==La)h&&td(this);else if(e&&(h&&(Yb.hide(),m&&m.Ud(Yb,1E3),td(this)),j&&this.Nc(0,1E3,!1,!0),f)){e=a;if(e<0&&b>=0&&typeof this.ja[b]!=="undefined"&&this.R[this.ja[b]].Uc)e=this.q[this.R[this.ja[b]].ra].I;e>=0&&typeof this.F[e]!=="undefined"&&(b=this.q[this.F[e]],b.V>0&&hj(b.O,b.N,200,Xb,1))}m&&(d.B<=Fa||d.B==La)&&Db&&g&&d.kb(a,!1);return h||j};e.prototype.hf=function(){return!this.yb()};e.prototype.Md=
function(){return this.G==2};e.prototype.ne=function(){return this.G==3};e.prototype.yb=function(){return this.Md()||this.ne()};e.prototype.Ec=function(){return this.G==4||this.G==5||this.G==6||this.G==9||this.G==10||this.G==11||this.G==12||this.G==13||this.G==14||this.G==15||this.G==16};e.prototype.Kd=function(){return this.G==4||this.G==9||this.G==10||this.G==16};e.prototype.jc=function(){return this.G==5||this.G==6||this.G==9||this.G==10||this.G==11||this.G==12||this.G==13||this.G==14};e.prototype.eg=
function(){return this.G==6||this.G==10||this.G==12||this.G==14};e.prototype.Tc=function(){return this.G==0||this.G==1||this.G==7||this.G==8};e.prototype.cg=function(){return this.G==1||this.G==7};e.prototype.gg=function(){return this.G==1||this.G==8};e.prototype.hc=function(){return this.G==15||this.G==16};e.prototype.Zf=function(){return this.G==11||this.G==12?1:this.G==13||this.G==14?2:0};e.prototype.Bf=function(){this.j&&this.j.Oc!=i&&this.j.Oc.stop(!0,!0)};e.prototype.hb=function(a,d){if(!(this.B==
Ia&&this.j)){var b=new f;a!=i&&b.Jf(a);this.L=d;if(this.j)b.W=this.j.W,b.aa=this.j.aa;this.j=b}};e.prototype.xf=function(a,d){if(a!=Pe||d){Bf(Fa);pi();Ab&&Ab.gallerysection("isexpanded")&&Ab.gallerysection("setexpanded",!1,0);Lb&&Lb.gallerysection("isexpanded")&&Lb.gallerysection("setexpanded",!1,0);if(this.fa)for(var b=0;b<this.fa.i.length;b++){var e=this.fa.i[b];delete e.Zc;delete e.cd;delete e.Yc;delete e.Wc;delete e.Vc;delete e.bd;delete e.$c;delete e.Xc;delete e.nc;delete e.Qc;delete e.pd;delete e.Gb;
delete e.md;delete e.qb;delete e.Nb;delete e.ab;delete e.zc;delete e.Fc;delete e.Ub}this.za=this.G=-1;this.$=0;this.K=this.Xa=1;this.Da=this.Ca=this.Ba=this.Aa=this.ha=this.la=this.T=this.Ja=this.Wa=this.Ka=this.ga=this.Za=this.na=this.B=-1;this.j=i;P=-1;hb&&hb.sidegallery("settextbtnselected",!0);Kj=Db=!0;ec=new p(a);Wa=new r(a);Rb=i;wb={};Ic=bb=Mc=i;xc=$c=-1;Ye="";ub=!1;Tb=i;Ac=!1;ih=hh="";Qa.is(":visible")?Qa.val(""):na.html("");hb.sidegallery("setheadertext",Ue);tb&&tb.find(".kbb-searchresults").empty();
id&&id.val("");Ie=new A(a);Pe=a}return ec.ag()};e.prototype.fc=function(a,d){B({action:"map",id:a,search:"",maxitems:1,maxlevel:1,maxchildslevel1:1,maxchildslevel2:1,maxchildslevel3:1,maxchildslevel4:1,crosslinks:0,tablerelations:0,hierarchical:0,bookmarks:0,expanded:0,displaymode:Fa,imagecache:"[]",excludeitemids:"[]",excludeitemtemplateids:"[]",excluderelationids:"[]",excluderelationtemplateids:"[]",textnoterecordid:-1,updatetextnote:1,database:O},function(a){a&&a.a&&a.a.h?d(gc(a.a.h)):d("")},function(){d("")})};
e.prototype.kf=function(c){if(c&&c.i.length>0){var b=!1;if(c.a&&c.a.r>=0){if(c.a.h)xc=c.a.r,$c=c.i[0].i,Ye=Ed(c.i[0].n),Ya(function(){var a=gc(c.a.h);Ac=a=="";Qa.is(":visible")?(Qa.val(Vg(a,!0)),qf(Qa)):(na.html(a),na.find("iframe").attr("sandbox",""),Za(na,na.attr("contenteditable")==="true"),na.attr("contenteditable")==="true"&&lb(na))}),b=!0}else xc=-1,$c=c.i[0].i,Ye=Ed(c.i[0].n),Qa.is(":visible")?Qa.val(""):na.html(""),b=Ac=!0;b&&(ub=!1,Tb=i,a(Kb).scrollLeft(0).scrollTop(0),me(Ac&&this.H&&!d.sb,
d.sb));b=Ed(c.i[0].n);hb.sidegallery("setheadertext",Ue+(b!=""?ch+b+'"':""))}};e.prototype.kb=function(c,b){if(b||c!=$c){var e=this,f=function(){var a=hb.is(":visible");qe!=i&&clearTimeout(qe);qe=setTimeout(function(){qe=i;B({action:"map",id:c,search:"",maxitems:1,maxlevel:1,maxchildslevel1:1,maxchildslevel2:1,maxchildslevel3:1,maxchildslevel4:1,crosslinks:0,tablerelations:0,hierarchical:0,bookmarks:0,expanded:0,displaymode:Fa,imagecache:"[]",excludeitemids:"[]",excludeitemtemplateids:"[]",excluderelationids:"[]",
excluderelationtemplateids:"[]",textnoterecordid:-1,updatetextnote:1,database:O},function(a){e.kf(a)},fa())},a?100:2E3)};if(d.H&&ub){var g=i,h={};h[yd]=function(){g.dialog("close");Xc(f)};h[zd]=function(){g.dialog("close");f()};a.fn.C.close();g=a("<div />").html(Vj.replace("%1",Ye)).dialog({modal:!0,closeOnEscape:!1,resizable:!1,buttons:h,title:Uj,width:400,position:Mb?{my:"center top",at:"center top"}:{my:"center",at:"center"},close:function(c){typeof c.originalEvent!=="undefined"&&f();a(this).dialog("destroy")},
open:function(){a(this).parent(".ui-dialog").find("*").myDisableSelection(!1)}})}else f()}};e.prototype.load=function(c,b,e,f,g,h,j){function m(){p.We(c,b,e,f,g,h,j)}c<0&&(c=P);var p=this,o=(e!=""||C.find(".itemtext").length==0||c!=P&&Db)&&(this.B<=Fa||this.B==La||sd&&Db);if(d.H&&ub&&o){var r=i,o={};o[yd]=function(){r.dialog("close");Xc(m)};o[zd]=function(){r.dialog("close");m()};a.fn.C.close();r=a("<div />").html(Vj.replace("%1",Ye)).dialog({modal:!0,closeOnEscape:!1,resizable:!1,buttons:o,title:Uj,
width:400,position:Mb?{my:"center top",at:"center top"}:{my:"center",at:"center"},close:function(c){typeof c.originalEvent!=="undefined"&&m();a(this).dialog("destroy")},open:function(){a(this).parent(".ui-dialog").find("*").myDisableSelection(!1)}})}else m()};e.prototype.We=function(c,b,e,f,g,h,j){var m=this,o=i;ld(i);kf(ba);this.Bf();if(Kj)Kj=!1,o={action:"map",id:-1,search:"",maxitems:1,maxlevel:1,maxchildslevel1:1,maxchildslevel2:1,maxchildslevel3:1,maxchildslevel4:1,crosslinks:0,tablerelations:0,
hierarchical:0,bookmarks:1,expanded:0,displaymode:Fa,imagecache:"[]",excludeitemids:"[]",excludeitemtemplateids:"[]",excluderelationids:"[]",excluderelationtemplateids:"[]",textnoterecordid:-1,updatetextnote:0,database:O},U()||kf(ba),B(o,function(d){d.bm&&d.bm.length>0&&(Rb=new x(d.bm),Eg?Eg=!1:(z=d.p&&d.p.length>0?a.parseJSON(d.p):{},d=Rb.rg(),d>=0&&(c=d,b=-1)));sd=!0;m.We(c,b,e,f,g,h,j);U()||lf()},function(){U()||lf()});else if(this.Ld)this.Pe=j,this.vd=c,this.Oe=b,this.Te=e,this.Qe=f,this.Se=g,
this.Re=h;else{var s=(e!=""||C.find(".itemtext").length==0||c!=P&&Db)&&(this.B<=Fa||this.B==La||sd&&Db)&&c!=$c;sd=!1;s&&qe!=i&&(clearTimeout(qe),qe=i);this.Ld=!0;this.vd=-1;C.find(".searchhint").show();C.find(".search").val("").autocomplete("close").autocomplete("search","");var A=function(e,l){var j=!0;if(e){if(e.n==0){Bh="";xe=e.d;z=e.p&&e.p.length>0?a.parseJSON(e.p):{};e.bm&&e.bm.length>0&&(Rb=new x(e.bm));Sb=typeof z.bc!=="undefined"&&z.bc!==i?z.bc:[255,255,255];Ge=typeof z.bp!=="undefined"&&
z.bp!==i?z.bp:"perspective";wc=typeof z.lw!=="undefined"&&z.lw!==i?z.lw:1;if(d.G<0)d.G=typeof z.dl!=="undefined"&&z.dl!==i?z.dl:typeof z.drm!=="undefined"&&z.drm!==i?z.drm!=0?1:0:0;if(d.za<0)d.za=typeof z.dl3d!=="undefined"&&z.dl3d!==i?z.dl3d:0;d.B<0&&(typeof z.tv!=="undefined"&&z.tv!==i?Bf(z.tv==La?Fa:z.tv):Bf(Fa));if(d.na<0)d.na=typeof z.iex!=="undefined"&&z.iex!==i?z.iex:0;if(d.Za<0)d.Za=typeof z.dce!=="undefined"&&z.dce!==i?z.dce:0;if(d.ga<0)d.ga=typeof z.mri!=="undefined"&&z.mri!==i?z.mri:1;
if(d.Ka<0)d.Ka=typeof z.wcl!=="undefined"&&z.wcl!==i?z.wcl:1;if(d.Wa<0)d.Wa=typeof z.wtr!=="undefined"&&z.wtr!==i?z.wtr:1;if(d.Ja<0)d.Ja=typeof z.to3d!=="undefined"&&z.to3d!==i?z.to3d:0;if(d.T<0)d.T=typeof z.atran!=="undefined"&&z.atran!==i?z.atran:1;kc=typeof z.irc!=="undefined"&&z.irc!==i?z.irc:0;Jg=typeof z.swm!=="undefined"&&z.swm!==i?z.swm:1;Ae=typeof z.cgm!=="undefined"&&z.cgm!==i?z.cgm:0;yf=typeof z.hrl!=="undefined"&&z.hrl!==i?z.hrl:1;if(m.la<1)m.la=typeof z.mi!=="undefined"&&z.mi!==i?z.mi:
100;if(m.ha<1)m.ha=typeof z.ml!=="undefined"&&z.ml!==i?z.ml:100;if(m.Aa<1)m.Aa=typeof z.c1!=="undefined"&&z.c1!==i?z.c1:100;if(m.Ba<1)m.Ba=typeof z.c2!=="undefined"&&z.c2!==i?z.c2:100;if(m.Ca<1)m.Ca=typeof z.c3!=="undefined"&&z.c3!==i?z.c3:100;if(m.Da<1)m.Da=typeof z.c4!=="undefined"&&z.c4!==i?z.c4:100;nf=e.ui?e.ui:[];of=e.ri?e.ri:[];C.find(".kmap,.kmappage,.ikmap").css("background-color",$e(Sb));m.hb(m.fa,e);if(e.i.length>0)c=e.i[0].i,Bh=Ed(e.i[0].n),b==-1&&(b=c),ec==i&&(ec=new p("")),ec.add(c,Bh),
j=!1;s&&(Ch=e);gb(f,b,g,h,!0);m.B==Ia?m.j.Hf(e):m.B==La&&td(m.j);m.Ld=!1;m.vd>=0&&m.load(m.vd,m.Oe,m.Te,m.Qe,m.Se,m.Re,m.Pe)}}else m.Ld=!1;d.H&&j&&l?C.find(".newfirstitembtn").show():C.find(".newfirstitembtn").hide()},o=JSON.stringify(a.map(wb,function(a,c){return parseInt(c)}));Wa==i&&(Wa=new r(""));o={action:"map",id:c,search:e,maxitems:this.la,maxlevel:this.ha,maxchildslevel1:this.Aa,maxchildslevel2:this.Ba,maxchildslevel3:this.Ca,maxchildslevel4:this.Da,crosslinks:this.Ka,tablerelations:this.Wa,
hierarchical:this.Kd()?1:0,bookmarks:Rb==i?1:0,expanded:this.na,displaymode:this.B,imagecache:o,excludeitemids:Wa.cb("excludeitems"),excludeitemtemplateids:Wa.cb("excludeitemtemplates"),excluderelationids:Wa.cb("excluderelations"),excluderelationtemplateids:Wa.cb("excluderelationtemplates"),textnoterecordid:P<0?-1:xc,updatetextnote:s?1:0,database:O};Rb==i&&(Rb=new x(""));U()||kf(ba);B(o,function(a){A(a,!0);U()||lf()},function(){A({i:[],r:[],a:i,p:"",d:-1,n:0,l:0},!1);U()||lf()})}lf()};e.prototype.lc=
function(c){function b(a,c){var f=C.find(a);if(f.is(":visible")){var g=f.offset(),k=f.outerWidth(),h=f.outerHeight(),f=[];f.push(X(g.left,g.top));f.push(X(g.left,g.top+h));f.push(X(g.left+k,g.top+h));f.push(X(g.left+k,g.top));if(c!=""){var j=C.find(c);if(j.is(":visible")){var h=j.offset(),m=j.outerWidth(),j=j.outerHeight(),n=!1;h.top>g.top&&(n=f[1],f[1]=f[0],f[0]=n,n=f[3],f[3]=f[2],f[2]=n,n=!0);h.left+m>g.left+k&&(f.splice(3,1),f.push(X(h.left+m,h.top+(n?0:j))));f.push(X(h.left+m,h.top+(n?j:0)));
f.push(X(h.left,h.top+(n?j:0)));h.left<g.left&&(f.splice(0,1),f.push(X(h.left,h.top+(n?0:j))))}}if(Lg(d,e,f))return!0}else if(c!=""&&(j=C.find(c),j.is(":visible")&&(h=j.offset(),m=j.outerWidth(),j=j.outerHeight(),f=[],f.push(X(h.left,h.top)),f.push(X(h.left,h.top+j)),f.push(X(h.left+m,h.top+j)),f.push(X(h.left+m,h.top)),Lg(d,e,f))))return!0;return!1}var d=c.pageX,e=c.pageY,f=a(a.fn.C.obj);if(f.is(":visible")){var c=f.offset(),g=f.outerWidth(),h=f.outerHeight(),j=f.find(".ttip-pointer"),m=j.offset(),
p=j.outerWidth(),j=j.outerHeight(),f=f.find("ul.kbb-popupmenu>li>ul"),o=f.offset(),r=f.outerWidth(),s=f.outerHeight();if(d>=m.left&&d<m.left+p&&e>=m.top&&e<m.top+j)return!0;if(f.is(":visible")&&d>=o.left&&d<o.left+r&&e>=o.top&&e<o.top+s)return!0;if(d>=c.left&&d<c.left+g&&e>=c.top&&e<c.top+h)return!0}return b(".itemselector",".itemtoolbar")?!0:b(".relationselector",".relationtoolbar")?!0:b(".textselector","")?!0:!1};e.prototype.pe=function(c,b){if((Ma==i||!L.zoom&&!L.dragged)&&this.j!=i&&!Ib&&!Xa&&
!ga){var e=this.j.Qb(c);e&&(e.eb>=0||e.Ua>=0||e.Sc>=0&&d.Ia)?C.find(".canvas9").addClass("cursorpointer"):C.find(".canvas9").removeClass("cursorpointer");this.j.Hc(e,c,b)}if((a(a.fn.C.obj).is(":visible")||C.find(".itemselector").is(":visible")||C.find(".relationselector").is(":visible"))&&!this.lc(c))(e=this.j.Qb(c))&&e.Ua>=0||a.fn.C.close()};e.prototype.click=function(c){if(Ib||Wb||$b||Ma&&(L.zoom||L.dragged))return!1;C.find(".searchhint").show();C.find(".search").val("").autocomplete("close").autocomplete("search",
"");a(document.activeElement).blur();if(this.j!=i&&(c=this.j.Qb(c),c!=i))if(c.eb>=0)return this.j.Vb(this.j.q[c.eb].I),!0;else if(c.Ua>=0){if(c=this.j.R[c.Ua],this.H)return U()?Oc({action:"onrelationselected",i:this.j.q[c.ra].I,r:c.Ea,redraw:1}):this.j.Ga(-1,c.Ea,!0,!1,!0),!0}else if(c.Sc>=0&&d.Ia){var b=0,e=this.j.Qa[c.Sc],f=function(){b<e.F.length?(b++,jg(e.F[b-1],b==e.F.length,f)):lf()};kf(ba);f();return!0}this.j.Ga(-1,-1,!0,!1,!0)||Qb();return!0};e.prototype.Ne=function(a){if(!Ma||!L.zoom){if(this.H&&
this.j!=i&&(a=this.j.Qb(a),a!=i&&a.Ua>=0)){Xe(this.j.R[a.Ua].Ea);return}if(this.j.Bc>0&&this.j.Ac>0){var a=C.find(".kmappage").width(),b=C.find(".kmappage").height(),a=this.D*Math.min(a/this.j.Bc,b/this.j.Ac),a=Math.min(3,Math.max(1/3,a));this.D=Math.abs(a-this.D)<0.03?1:a;this.hb(this.L,this.L);gb(500,-2,!0,!0,!1);xd(this.D,this.M,this.rotation,this.$);U()&&Oc({action:"onsettingschanged",zoomfact:this.D})}}};e.prototype.Nf=function(a){a.data.dc.click(a);return!1};e.prototype.Lf=function(){function c(c){c.target&&
a(c.target).closest(".kbb-popup-frame").length==0&&C.find(".kbb-popup-frame:visible").hide()}function b(a,c,e){var f=performance.now(),f=Math.max(L.tl+1,f),l=!1,h=!1,j=C.find(".kmappage");a==i&&(c=L.xl+0.9*L.vx*(f-L.tl),e=L.yl+0.9*L.vy*(f-L.tl));if(Ma&&a==i)h=l=!0;else if(d.B==Ia){if(!L.dragged&&Math.abs(e-L.y)>=Math.abs(c-L.x)){var m=Jf(C.find(".kbb-tableviewbody"),a);m&&m.e[0].scrollHeight>m.e[0].clientHeight&&(L.tvsc=m.e)}if(L.tvsc){if(L.yl!=e)h=L.tvsc[0].scrollTop,L.tvsc[0].scrollTop+=L.yl-e,
h=L.tvsc[0].scrollTop!=h}else l=j[0].scrollLeft,Wk(j,L.xl-c,0),l=j[0].scrollLeft!=l}else l=j[0].scrollLeft,h=j[0].scrollTop,Wk(j,L.xl-c,L.yl-e),l=j[0].scrollLeft!=l,h=j[0].scrollTop!=h;L.vx=l?(c-L.xl)/(f-L.tl):0;L.vy=h?(e-L.yl)/(f-L.tl):0;if(a)L.xl=c,L.yl=e;L.tl=f;L.dragged=!0;if(Math.abs(L.vx)>0.1||Math.abs(L.vy)>0.1)g=setTimeout(function(){g=i;b(i,0,0)},25)}var e=this;C.find(".canvas9").bindMouseOrTouchEvent("mousemove.diagram",function(c){(!Ma||!L.zoom&&!L.dragged)&&!c.target.isContentEditable&&
!a(c.target).is(":input")&&e.pe(c,!1)}).bindMouseOrTouchEvent("click.diagram",function(c){if((!Ma||!L.zoom&&!L.dragged)&&!c.target.isContentEditable&&!a(c.target).is(":input"))return e.pe(c,!0),e.click(c)}).bind("dblclick.diagram",function(c){(!Ma||!L.zoom&&!L.dragged)&&!c.target.isContentEditable&&!a(c.target).is(":input")&&e.Ne(c)}).bind("touchstart.diagram",function(c){if((!Ma||!L.zoom&&!L.dragged)&&!c.target.isContentEditable&&!a(c.target).is(":input")){var b=c.handleObj,d=a.data(c.target),f=
(new Date).getTime(),g=d.qa?f-d.qa:0;g<300&&g>30?(d.qa=i,c.type=b.origType,["clientX","clientY","pageX","pageY"].forEach(function(a){c[a]=c.originalEvent.changedTouches[0][a]}),setTimeout(function(){Ob.ids.length<=1&&e.Ne(c)},250)):d.qa=f}});C.find(".ikmap").bindMouseOrTouchEvent("mousedown.panzoom",function(c){if(e.j==i||e.j.q==i||e.j.q.length==0||d.B==La)return!0;Ib=!1;if(!C.find(".editoverlay").is(":visible")&&Xa==i&&ga==i&&Ma==i&&(ib==i||cc!=i))if((!U()||a(c.target).attr("href")==i)&&!c.target.isContentEditable&&
!a(c.target).is(":input")&&!a(c.target).is(".itemselector,.relationselector,.textselector,.itemtoolbar,.relationtoolbar")){if(Ma==i){var b=fg(c),f=lg(c);if(Ob.ids.length>1)f=Ob[Ob.ids[0]],b=f.pageX,f=f.pageY;g!=i&&(clearTimeout(g),g=i);Ma=c;L={x:b,y:f,xl:b,yl:f,tl:performance.now(),vx:0,vy:0,dragged:!1,zoom:!1,startdistance:100,newdistance:100,tps:Ob.ids.length,tvsc:i};a("html,body").addClass("cursormove")}if(d.B<=Fa)return!1}else Ma=i});qb()||C.find(".canvas9").bind("contextmenu",{dc:this},e.Nf);
mb()?document.addEventListener("pointerdown",c,!0):rb()?document.addEventListener("MSPointerDown",c,!0):(document.addEventListener("mousedown",c,!0),document.addEventListener("touchstart",c,!0));var f=i,g=i;a(document).bindMouseOrTouchEvent("mousemove.panzoom",function(c){if(d.B==La)return!0;if(Xa==i&&ga==i&&(ib==i||cc!=i)&&Ma){if(Ob.ids.length==2){f!=i&&(clearTimeout(f),f=i);var e=Ob[Ob.ids[0]],l=Ob[Ob.ids[1]];if(L.zoom){if(l=Math.pow(Math.pow(l.pageX-e.pageX,2)+Math.pow(l.pageY-e.pageY,2),0.5),
Math.abs(l-L.newdistance)>3)L.newdistance=l,l=Math.max(1/3,Math.min(3,d.D*L.newdistance/L.startdistance)),Vi(l),xd(l,d.M,d.rotation,d.$)}else L.zoom=!0,L.startdistance=Math.pow(Math.pow(l.pageX-e.pageX,2)+Math.pow(l.pageY-e.pageY,2),0.5),L.newdistance=L.startdistance}if(C.find(".kmappage").css("overflow-x")=="scroll"||C.find(".kmappage").css("overflow-y")=="scroll"||d.B==Ia){l=fg(c);e=lg(c);if(Ob.ids.length>1&&(e=Ob[Ob.ids[0]],l=e.pageX,e=e.pageY,Ob.ids.length>L.tps))L.x=l,L.y=e,L.xl=l,L.yl=e,L.tps=
Ob.ids.length;var h=vb(c)?15:15;if(L.dragged||Math.pow(Math.pow(l-L.x,2)+Math.pow(e-L.y,2),0.5)>h&&Xa==i&&ga==i&&(ib==i||cc!=i)&&!C.find(".editoverlay").is(":visible"))g!=i&&(clearTimeout(g),g=i),L.dragged||a("html,body").addClass("cursormove"),b(c,l,e),Ma=c}return!1}});a(document).bindMouseOrTouchEvent("mouseup.panzoom",function(){if(d.B==La)return!0;if(Xa==i&&ga==i&&(ib==i||cc!=i)&&Ma){if(L.zoom){f!=i&&clearTimeout(f);var c=Math.max(1/3,Math.min(3,d.D*L.newdistance/L.startdistance));f=setTimeout(function(){Ib=
!0;setTimeout(function(){Ib=!1},250);Ma=f=i;L.zoom=!1;a("html,body").removeClass("cursormove");d.B<=Fa&&d.hb(d.L,d.L);var b=c/d.D;d.D=c;xd(d.D,d.M,d.rotation,d.$);Ve(b,0);U()&&Oc({action:"onsettingschanged",zoomfact:d.D})},25)}else Ob.ids.length==0&&(L.dragged&&(Ib=!0,setTimeout(function(){Ib=!1},250)),Ma=i,a("html,body").removeClass("cursormove"));if(d.B<=Fa)return!1}})};var Fj=0,Gj=0,sq=0.1,tq=0.1,xh=!1;window.setDatabaseID=function(a,b){return d.xf(a,parseInt(b)!=0)};window.selectItem=function(a,
b,e){d==i||d.j==i||d.j.q==i||d.j.Ga(parseInt(a),parseInt(b),parseInt(e)!=0,!0,!0)};window.loadDiagram=xq;window.getItemIDFromPoint=function(a,b){if(d==i||d.j==i||d.j.q==i)return-1;for(var e=C.find(".ikmap").offset(),f=i,g=0,h=0,f=1,j=0,m=i,p=0,a=parseInt(a)-e.left,b=parseInt(b)-e.top,p=0;p<d.j.q.length;p++){m=d.j.q[p];f=m.sa();j=f*m.V;if(j>0&&Math.pow(Math.pow((a-m.O)/(j*2.4),2)+Math.pow((b-m.N)/(j*1.6),2),0.5)<1)return m.I;if(m.A.J!=i&&(f=m.A.J.offset(),f.left-=e.left,f.top-=e.top,g=m.A.J.outerWidth(),
h=m.A.J.outerHeight(),a>=f.left&&a<f.left+g&&b>=f.top&&b<Math.max(f.top+h,m.N+0.8*j)))return m.I}return-1};window.updateItemsInCategoryGallery=function(){Eb.val()==""?pi():Ce(Eb.data("pid"))};window.importCSV=sb;window.winImportCSV=function(){sb(Cb())};window.exportCSV=bi;window.winExportCSV=function(){bi(!0)};window.importXML=ji;window.winImportXML=function(){ji(Cb())};window.exportDiagramAsImage=function(c){kf(ba);Ij("",function(b){b=b.toDataURL("image/png");if(typeof window.navigator!=="undefined"&&
window.navigator.msSaveBlob){for(var b=b.replace(/^data:image\/(png|jpg);base64,/,""),b=atob(b),d=b.length,e=new Uint8Array(d),f=0;f<d;f++)e[f]=b.charCodeAt(f);b=new Blob([e.buffer],{type:"image/png"});window.navigator.msSaveBlob(b,c)}else{var g=a('<a href="data:'+b+'" download="'+c+'">')[0];(function(){try{if(document.createEvent){var a=document.createEvent("MouseEvents");a.initEvent("click",!0,!0);g.dispatchEvent(a);return}}catch(c){}try{if(document.createEventObject){var b=document.createEventObject();
g.fireEvent("onclick",b);return}}catch(d){}try{g.click&&g.click()}catch(e){}})()}lf()})};window.exportDiagramAs3DModel=Fq;window.exportTextDocument=ni;window.winExportTextDocument=function(){ni(!0)};window.setUserInterfaceScaleFact=function(a){zh=parseFloat(a)};a.ui.autocomplete.prototype._renderItem=function(c,b){return a("<li><a>"+(b.label.trim()==""?"&nbsp;":b.label)+"</a></li>").appendTo(c)};C.addClass("kbb-diagram");a('<div class="textselector"><a href=""></a></div>').appendTo(C);d=new e;C.data("setcurrentdatabase",
function(a){O=a;wb={}});C.data("loaddiagram",xq);C.data("navigateTo",function(a,b){d.load(parseInt(a),-1,b,Xb,!0,!1,xe+1)});C.data("onResize",function(){gb(0,-1,!1,!1,!0)});C.data("getScreenshot",Ij);C.data("saveScreenshot",function(){kf(ba);Ij("",function(a){function b(){}a=a.toDataURL("image/png").replace(/^data:image\/(png|jpg);base64,/,"");lf();window.savefilecallback=b;B({action:"savefile",base64data:a,extension:"png",mimetype:"image/png"},b)})});C.data("save3DModel",Fq);ic=new Pd("ItemTemplates",
"Templates",d,td);jc=new Pd("RelationTemplates","Templates",d,td);(function(){function c(){return d.T}function e(a){if(!ab.sidegallery("ispinned")){var c=C.find(".kbb-sidegallery:not(.id-sidebar-closed-horizontal,.id-sidebar-closed-vertical,.id-sidebar):visible").not(a).length>0;Gd.sidegallery("show",c,0,i);Hd.sidegallery("show",!c,0,i)}a=a.sidegallery("getid").replace(/-gallery$/,"");ab.sidegallery("setsidebarbtnselected",a,!1);a=="id-textnote"&&jf()&&Xk()}function f(){gb(0,P,!1,!1,!1)}function g(){}
function h(c,b,d){var e=c?ic:jc,f=c?r:s,g=i,k="<form><div>"+Wj+'</div><div><input class="kbb-template-name" type="text" value="'+Nd(d.TemplateName)+'"></div></form>',l={};l[Da]=function(){var c=g.find(".kbb-template-name"),k=a.trim(c.val());k==""?c.focus():(g.dialog("close"),d.TemplateName=k,d.lcTemplateName=k.toLowerCase(),b?Xd(e,f,d):Sd(e,f,d))};l[eb]=function(){g.dialog("close")};g=a('<div class="id-new-template-dialog" />').html(k).dialog({modal:!0,closeOnEscape:!1,resizable:!1,buttons:l,title:c?
kt:lt,width:400,position:Mb?{my:"center top",at:"center top"}:{my:"center",at:"center"},open:function(){a(this).parent(".ui-dialog").find("*").myDisableSelection(!1)},close:function(){a(this).dialog("destroy")}});g.find("form").bind("submit",function(){setTimeout(function(){l[Da]()},50);return!1})}function j(c){if(Rb){var b=i,d=Bh,e=!1,f=!1;if(c){var g=Id.gallerysection("getselected");if(g.length>0)f=g.data("pos"),d=Rb.bookmarks[f].n,e=Rb.bookmarks[f].i>=0,f=Rb.initialviewindex==f}var d="<form><div><div>"+
Wj+'</div><div><input class="kbb-bookmark-name" type="text" value="'+Nd(d)+'"></div></div><div><label><input class="kbb-bookmark-save-root-item" type="checkbox"'+(e?" checked":"")+">"+hs+'</label></div><div><label><input class="kbb-bookmark-set-as-initial-view" type="checkbox"'+(f?" checked":"")+">"+is+"</label></div></form>",k={};k[Da]=function(){var a=b.find(".kbb-bookmark-name"),d=a.val(),e=b.find(".kbb-bookmark-save-root-item").is(":checked"),f=b.find(".kbb-bookmark-set-as-initial-view").is(":checked");
d==""?a.focus():(b.dialog("close"),Rb.Uf(c,d,e,f))};k[eb]=function(){b.dialog("close")};b=a('<div class="id-add-bookmark-dialog" />').html(d).dialog({modal:!0,closeOnEscape:!1,resizable:!1,buttons:k,title:c?gs:fs,width:400,position:Mb?{my:"center top",at:"center top"}:{my:"center",at:"center"},open:function(){a(this).parent(".ui-dialog").find("*").myDisableSelection(!1)},close:function(){a(this).dialog("destroy")}});b.find("form").bind("submit",function(){setTimeout(function(){k[Da]()},50);return!1})}}
function m(c,d){if(!a(".ui-dialog").is(":visible")){var e=i,f={};f[Da]=function(){e.dialog("close")};a.fn.C.close();e=Ya(function(){return a('<div><iframe src="'+b.htmldir+d+'" width="100%" height="400px" frameBorder="0" style="width:100%;height:400px;border:0;"></iframe></div>').dialog({modal:!0,closeOnEscape:!1,resizable:!1,buttons:f,title:c,width:600,position:Mb?{my:"center top",at:"center top"}:{my:"center",at:"center"},open:function(){a(this).parent(".ui-dialog").find("*").myDisableSelection(!1)},
close:function(){a(this).dialog("destroy")}})})}}var n=[],p=[];Gd=a("<div></div>").appendTo(C).sidegallery({id:"id-sidebar-closed-horizontal",width:"auto",toolbar:!0,header:!1});Hd=a("<div></div>").appendTo(C).sidegallery({id:"id-sidebar-closed-vertical",width:"44px",toolbar:!0,header:!1});ab=a("<div></div>").appendTo(C).sidegallery({id:"id-sidebar",width:"100px",toolbar:!1,header:!0,headerText:"",closeBtnTooltip:Or,pinBtnTooltip:Er,onClose:function(){var a=C.find(".kbb-sidegallery:not(.id-sidebar-closed-horizontal,.id-sidebar-closed-vertical,.id-sidebar):visible").length>
0;Gd.sidegallery("show",a,0,i);Hd.sidegallery("show",!a,0,i)},onRemainderSizeChanged:f,onSideGalleryPin:g,animateTransitions:c});n.push(ab);p.push(ab);var o=a('<div class="kbb-sidegalleryremainder"></div>').appendTo(C);b.knowledgebasegallery&&(bd=a("<div></div>").appendTo(o).sidegallery({id:"id-knowledgebase-gallery",width:"268px",toolbar:!1,header:!0,headerText:br,sideGalleryGroup:n,closeBtnTooltip:Pr,pinBtnTooltip:Fr,onClose:e,onRemainderSizeChanged:f,onSideGalleryPin:g,animateTransitions:c}),n.push(bd),
p.push(bd),o=a('<div class="kbb-sidegalleryremainder"></div>').appendTo(o));ta=a("<div></div>").appendTo(o).sidegallery({id:"id-editmode-gallery",width:"268px",toolbar:!1,header:!0,headerText:cr,sideGalleryGroup:n,closeBtnTooltip:Qr,pinBtnTooltip:Gr,onClose:e,onRemainderSizeChanged:f,onSideGalleryPin:g,animateTransitions:c});n.push(ta);p.push(ta);o=a('<div class="kbb-sidegalleryremainder"></div>').appendTo(o);Ka=a("<div></div>").appendTo(o).sidegallery({id:"id-format-diagram-gallery",width:"268px",
toolbar:!1,header:!0,headerText:dr,sideGalleryGroup:n,closeBtnTooltip:Rr,pinBtnTooltip:Hr,onClose:e,onRemainderSizeChanged:f,onSideGalleryPin:g,animateTransitions:c});n.push(Ka);p.push(Ka);o=a('<div class="kbb-sidegalleryremainder"></div>').appendTo(o);Ha=a("<div></div>").appendTo(o).sidegallery({id:"id-viewmode-gallery",width:"268px",toolbar:!1,header:!0,headerText:fr,sideGalleryGroup:n,closeBtnTooltip:Ur,pinBtnTooltip:Kr,onClose:e,onRemainderSizeChanged:f,onSideGalleryPin:g,animateTransitions:c});
n.push(Ha);p.push(Ha);o=a('<div class="kbb-sidegalleryremainder"></div>').appendTo(o);Bc=a("<div></div>").appendTo(o).sidegallery({id:"id-diagramnavigation-gallery",width:"268px",toolbar:!1,header:!0,headerText:gr,sideGalleryGroup:n,closeBtnTooltip:Vr,pinBtnTooltip:Lr,onClose:e,onRemainderSizeChanged:f,onSideGalleryPin:g,animateTransitions:c});n.push(Bc);p.push(Bc);o=a('<div class="kbb-sidegalleryremainder"></div>').appendTo(o);Cc=a("<div></div>").appendTo(o).sidegallery({id:"id-help-gallery",width:"268px",
toolbar:!1,header:!0,headerText:hr,sideGalleryGroup:n,closeBtnTooltip:Wr,pinBtnTooltip:Mr,onClose:e,onRemainderSizeChanged:f,onSideGalleryPin:g,animateTransitions:c});n.push(Cc);p.push(Cc);o=a('<div class="kbb-sidegalleryremainder"></div>').appendTo(o);Jd=a("<div></div>").appendTo(o).sidegallery({id:"id-items-in-category-gallery",width:"268px",toolbar:!0,header:!0,headerText:er,sideGalleryGroup:n,closeBtnTooltip:Tr,pinBtnTooltip:Jr,onClose:e,onRemainderSizeChanged:f,onSideGalleryPin:g,animateTransitions:c});
n.push(Jd);p.push(Jd);o=a('<div class="kbb-sidegalleryremainder"></div>').appendTo(o);tb=a("<div></div>").appendTo(o).sidegallery({id:"id-search-items-gallery",width:["25%","45%","66%","100%"],expandindex:Ra?1:0,toolbar:!0,header:!0,headerText:Ni,sideGalleryGroup:n,closeBtnTooltip:Sr,pinBtnTooltip:Ir,onClose:e,onRemainderSizeChanged:f,onSideGalleryPin:g,animateTransitions:c});n.push(tb);p.push(tb);o=a('<div class="kbb-sidegalleryremainder"></div>').appendTo(o);hb=a("<div></div>").appendTo(o).sidegallery({id:"id-textnote-gallery",
width:["33%","50%","67%","100%"],expandindex:Ra?1:0,overlaymode:!1,toolbar:!0,header:!0,headerText:Ue,textBtnText:Xr,sideGalleryGroup:p,closeBtnTooltip:Cr,expandBtnTooltip:Dr,textBtnTooltip:Nr,textBtnSelected:Db?1:0,closeDiagramTooltipOnBody:!1,onClose:e,onRemainderSizeChanged:f,onTextBtnClick:function(a,c){(Db=c)&&d.kb(H(),!1)},animateTransitions:c});p.push(hb);o=a('<div class="kbb-sidegalleryremainder"></div>').appendTo(o);a('<div class="diagramcontainer kmap"></div>').appendTo(o);ta.sidegallery("addgallery");
on=ta.sidegallery("addgallerysection","id-editmode-undo",us,!1);pn=ta.sidegallery("addgallerysection","id-editmode-redo",vs,!1);ta.sidegallery("addgallerysection","id-editmode-item",Xj,!0);ta.sidegallery("addgalleryitemtosection","id-editmode-item","id-new-item",ak,"tooltip",51,52,-1,!0,!1,function(){Hc(d.B==Ia?Ga():H(),d.B==Ia?aa()+1:-1,"","","","","","","",i)});qn=ta.sidegallery("addgalleryitemtosection","id-editmode-item","id-edit-item",lh,"tooltip",33,34,-1,!0,!1,function(){Rc(H())});rn=ta.sidegallery("addgalleryitemtosection",
"id-editmode-item","id-delete-item",bk,"tooltip",55,56,-1,!0,!1,function(){dh(H(),Fh)});sn=ta.sidegallery("addgalleryitemtosection","id-editmode-item","id-copy-item",Js,"tooltip",338,339,-1,!0,!1,function(){fh(H(),i)});tn=ta.sidegallery("addgalleryitemtosection","id-editmode-item","id-cut-item",Ks,"tooltip",342,343,-1,!0,!1,function(){yj(H(),Ga())});un=ta.sidegallery("addgalleryitemtosection","id-editmode-item","id-paste-item",Ls,"tooltip",340,341,-1,!0,!1,function(){zj()});b.wikipediaimport&&ta.sidegallery("addgalleryitemtosection",
"id-editmode-item","id-import-wikipedia-article",Ys,"tooltip",198,199,-1,!0,!1,function(){Tc(H(),"")});b.wikidataimport&&ta.sidegallery("addgalleryitemtosection","id-editmode-item","id-wikidata-import",Zs,"tooltip",198,199,-1,!0,!1,function(){ux()});b.twitterimport&&ta.sidegallery("addgalleryitemtosection","id-editmode-item","id-import-twitter",$s,"tooltip",222,223,-1,!0,!1,function(){H()});b.webpageimport&&ta.sidegallery("addgalleryitemtosection","id-editmode-item","id-import-webpage",at,"tooltip",
316,317,-1,!0,!1,function(){vc(H(),"")});ta.sidegallery("addgalleryitemtosection","id-editmode-item","id-import-image",Bj,"tooltip",194,195,-1,!0,!1,function(){ob(H(),"","","",!0,i)});Gg=ta.sidegallery("addgalleryitemtosection","id-editmode-item","id-open-attachments",bt,"tooltip",288,289,-1,!0,!1,function(){Sc(H(),!1,-1)});var r=ta.sidegallery("addgallerysection","id-editmode-item-template",ws,!1);vn=ta.sidegallery("addgalleryitemtosection","id-editmode-item-template","id-new-template",mt,"tooltip",
65,66,-1,!0,!1,function(){var c=H();if(c>=0){var b={action:"getitem",id:c,database:O};B(b,function(e){if(e.r!=0){var f=e.n,g=e.t,k=e.u,l=e.ti,j=e.tn,m=e.o;d.fc(c,function(c){var d=Qd(jd(a.trim(f)),f,g,k,l,j,m,c);l>=0?(b={action:"getitemtemplate",id:l,database:O},B(b,function(a){a.r!=0&&(d.Properties=a.o);h(!0,!1,d)})):h(!0,!1,d)})}})}},!0);wn=ta.sidegallery("addgalleryitemtosection","id-editmode-item-template","id-update-template",nt,"tooltip",33,34,-1,!0,!1,function(){te(ic,function(a){var c=H();
if(c>=0){var b={action:"getitem",id:c,database:O};B(b,function(e){e.r!=0&&d.fc(c,function(c){a.Modified=performance.now();a.Name=e.n;a.Description=e.t;a.DirectLinkURL=e.u;a.CategoryID=e.ti;a.CategoryName=e.tn;a.Properties=e.o;a.TextNoteHtml=c;e.ti>=0?(b={action:"getitemtemplate",id:e.ti,database:O},B(b,function(c){c.r!=0&&(a.Properties=c.o);Xd(ic,r,a)})):Xd(ic,r,a)})})}})},!0);xn=ta.sidegallery("addgalleryitemtosection","id-editmode-item-template","id-rename-template",ot,"tooltip",190,191,-1,!0,!1,
function(){te(ic,function(a){h(!0,!0,a)})},!0);yn=ta.sidegallery("addgalleryitemtosection","id-editmode-item-template","id-delete-template",pt,"tooltip",55,56,-1,!0,!1,function(){ne(ic,r)},!0);zn=ta.sidegallery("addgalleryitemtosection","id-editmode-item-template","id-apply-template",qt,"tooltip",6,7,-1,!0,!1,function(){te(ic,function(c){var b=H();if(b>=0){if(b==$c&&c.Name&&c.Name!=""){var d=Ed(c.Name);hb.sidegallery("setheadertext",Ue+(d!=""?ch+d+'"':""))}var e=c.TextNoteHtml,f="",g="",k="";if(e!=
""){var l=a("<div></div>");Ya(function(){l.html(e)});d=Qc(l[0],i,0,i,0,i);d.sp=0;d.ep=0;var h=Vb(d,!1);d.ep=Math.min(40,h.d.length);h=Vb(d,!1);g=h.n;k=h.d;f=d.t}var j=i;j===i&&(j={});var m=i,n=i;c.Properties&&c.Properties!=""&&(n=a.parseJSON(c.Properties))&&a.isEmptyObject(n)&&(n=i);var o="",p=c.CategoryID,r=function(){if(n){for(var a=function(a,c,b){b==i?typeof a[c]!=="undefined"&&delete a[c]:a[c]=b},d=["ic","tc","fn","iw","is","iis","sym"],l=0;l<d.length;l++)a(j,d[l],typeof n[d[l]]!=="undefined"?
n[d[l]]:i),m&&a(m,d[l],typeof n[d[l]]!=="undefined"?n[d[l]]:i);j=JSON.stringify(j);m&&(m=JSON.stringify(m))}else m=j=i;Uc(b,c.Name==""?i:c.Name,c.Description==""?i:c.Description,c.DirectLinkURL==""?i:c.DirectLinkURL,o,p,j,m,-1,e,f,g,k,qw,i)};p>=0?B({action:"getitemtemplate",id:p,database:O},function(c){c.r!=0?(o=c.tn,c.o&&c.o!=""&&(m=a.parseJSON(c.o))&&a.isEmptyObject(m)&&(m=i)):p=-1;r()}):r()}})},!0);Td(ic,r);ta.sidegallery("addgallerysection","id-editmode-relation",Yj,!0);ta.sidegallery("addgalleryitemtosection",
"id-editmode-relation","id-new-relation",ak,"tooltip",53,54,-1,!0,!1,function(){mp(d.B==Ia?Ga():H(),d.B==Ia?aa()+1:-1)});An=ta.sidegallery("addgalleryitemtosection","id-editmode-relation","id-edit-relation",lh,"tooltip",33,34,-1,!0,!1,function(){var a=J();a>=0&&Xe(a)});Bn=ta.sidegallery("addgalleryitemtosection","id-editmode-relation","id-delete-relation",bk,"tooltip",55,56,-1,!0,!1,function(){var a=J();a>=0&&We(a,i,Uf)});var s=ta.sidegallery("addgallerysection","id-editmode-relation-template",xs,
!1);Cn=ta.sidegallery("addgalleryitemtosection","id-editmode-relation-template","id-new-template",rt,"tooltip",65,66,-1,!0,!1,function(){var a=J();if(a>=0){var c={action:"getrelation",id:a,database:O};B(c,function(a){if(a.r!=0){var b=a.ti,d={TemplateName:a.n,lcTemplateName:a.n.toLowerCase(),UUID:Rd(),Modified:performance.now(),Name:(a.nt!=0?"T:":"")+a.n,BackName:(a.bt!=0?"T:":"")+a.b,Description:a.t,CategoryID:b,CategoryName:a.tn,Properties:a.o};b>=0?(c={action:"getrelationtemplate",id:b,database:O},
B(c,function(a){a.r!=0&&(d.Properties=a.o);h(!1,!1,d)})):h(!1,!1,d)}})}},!0);Dn=ta.sidegallery("addgalleryitemtosection","id-editmode-relation-template","id-update-template",st,"tooltip",33,34,-1,!0,!1,function(){te(jc,function(a){var c=J();if(c>=0){var b={action:"getrelation",id:c,database:O};B(b,function(c){if(c.r!=0)a.Modified=performance.now(),a.Name=(c.nt!=0?"T:":"")+c.n,a.BackName=(c.bt!=0?"T:":"")+c.b,a.Description=c.t,a.CategoryID=c.ti,a.CategoryName=c.tn,a.Properties=c.o,c.ti>=0?(b={action:"getrelationtemplate",
id:c.ti,database:O},B(b,function(c){c.r!=0&&(a.Properties=c.o);Xd(jc,s,a)})):Xd(jc,s,a)})}})},!0);En=ta.sidegallery("addgalleryitemtosection","id-editmode-relation-template","id-rename-template",tt,"tooltip",190,191,-1,!0,!1,function(){te(jc,function(a){h(!1,!0,a)})},!0);Fn=ta.sidegallery("addgalleryitemtosection","id-editmode-relation-template","id-delete-template",ut,"tooltip",55,56,-1,!0,!1,function(){ne(jc,s)},!0);Gn=ta.sidegallery("addgalleryitemtosection","id-editmode-relation-template","id-apply-template",
vt,"tooltip",6,7,-1,!0,!1,function(){te(jc,function(c){var b=J();if(b>=0){var e=d.j.R[d.j.ja[b]].properties;e===i&&(e={});var f=i,g=i;c.Properties&&c.Properties!=""&&(g=a.parseJSON(c.Properties))&&a.isEmptyObject(g)&&(g=i);var k="",l=c.CategoryID,h=function(){if(g){for(var a=function(a,c,b){b==i?typeof a[c]!=="undefined"&&delete a[c]:a[c]=b},d=["rc","tc","ls","lw","la","lfn","lfs"],h=0;h<d.length;h++)a(e,d[h],typeof g[d[h]]!=="undefined"?g[d[h]]:i),f&&a(f,d[h],typeof g[d[h]]!=="undefined"?g[d[h]]:
i);e=JSON.stringify(e);f&&(f=JSON.stringify(f))}else f=e=i;mc(b,-1,-1,-1,-1,-1,c.Name==""?i:c.Name,c.BackName==""?i:c.BackName,c.Description==""?i:c.Description,k,l,e,f,rw)};l>=0?B({action:"getrelationtemplate",id:l,database:O},function(c){c.r!=0?(k=c.tn,c.o&&c.o!=""&&(f=a.parseJSON(c.o))&&a.isEmptyObject(f)&&(f=i)):l=-1;h()}):h()}})},!0);Td(jc,s);ta.sidegallery("addgallerysection","id-insert",ys,!0);ta.sidegallery("addgalleryitemtosection","id-insert","id-appointment",ct,"tooltip",260,261,-1,!0,
!1,function(){zx()});ta.sidegallery("addgalleryitemtosection","id-insert","id-pseudocode",dt,"tooltip",88,89,-1,!0,!1,function(){wx()});ta.sidegallery("addgalleryitemtosection","id-insert","id-outlinedtext",et,"tooltip",268,269,-1,!0,!1,function(){xx()});ta.sidegallery("addgalleryitemtosection","id-insert","id-analyzetext",ft,"tooltip",296,297,-1,!0,!1,function(){Am(!U()&&!qb()&&!Bb()&&!jf(),i)});b.importexport&&(ta.sidegallery("addgallerysection","id-import-export",zs,!0),ta.sidegallery("addgalleryitemtosection",
"id-import-export","id-export-text-document",jt,"tooltip",198,199,-1,!0,!1,function(){ni(!1)}),ta.sidegallery("addgalleryitemtosection","id-import-export","id-import-xml-data",it,"tooltip",138,139,-1,!0,!1,function(){ji(!0)}),ta.sidegallery("addgalleryitemtosection","id-import-export","id-import-csv-data",gt,"tooltip",138,139,-1,!0,!1,function(){sb(!0)}),ta.sidegallery("addgalleryitemtosection","id-import-export","id-export-csv-data",ht,"tooltip",136,137,-1,!0,!1,function(){bi(!1)}));Ka.sidegallery("addgallery");
Fg=Ka.sidegallery("addgallerysection","id-format-diagram-relation",Yj,!0);xi=Ka.sidegallery("addcolorpickergalleryitemtosection","id-format-diagram-relation","id-relation-color",ck,"tooltip",Cd,Dd,!1,function(a){Zc("rc",a,rk)});yi=xi.colorpickergalleryitem("addcustombutton","id-automatic-relation-color",cf,"tooltip",106,107,0,!0,!0,function(){Zc("rc",i,rk)});zi=Ka.sidegallery("addcolorpickergalleryitemtosection","id-format-diagram-relation","id-relation-text-color",vh,"tooltip",Cd,Dd,!1,function(a){Zc("tc",
a,sk)});Ai=zi.colorpickergalleryitem("addcustombutton","id-automatic-relation-text-color",cf,"tooltip",106,107,0,!0,!0,function(){Zc("tc",i,sk)});Bi=Ka.sidegallery("addcomboboxgalleryitemtosection","id-format-diagram-relation","id-relation-font-name",mh,"tooltip",!1,!1,function(a){a=parseInt(a.match(/\d+(?=\D*$)/));Zc("lfn",Sa[a],ok)});for(n=0;n<Sa.length;n++)Bi.comboboxgalleryitem("addcomboboxitem","id-font-name-"+n,Sa[n],"tooltip",296,297);Wc=Ka.sidegallery("addcomboboxgalleryitemtosection","id-format-diagram-relation",
"id-relation-font-size",nh,"tooltip",!1,!1,function(a){var c=1;a=="id-ultra-small-font-size"?c=0.7:a=="id-very-small-font-size"?c=0.8:a=="id-small-font-size"?c=0.9:a=="id-medium-font-size"?c=1:a=="id-large-font-size"?c=1.2:a=="id-very-large-font-size"?c=1.6:a=="id-ultra-large-font-size"&&(c=2.4);Zc("lfs",c,pk)});Wc.comboboxgalleryitem("addcomboboxitem","id-ultra-small-font-size",oh,"tooltip",246,247);Wc.comboboxgalleryitem("addcomboboxitem","id-very-small-font-size",ph,"tooltip",248,249);Wc.comboboxgalleryitem("addcomboboxitem",
"id-small-font-size",qh,"tooltip",250,251);Wc.comboboxgalleryitem("addcomboboxitem","id-medium-font-size",rh,"tooltip",252,253);Wc.comboboxgalleryitem("addcomboboxitem","id-large-font-size",sh,"tooltip",254,255);Wc.comboboxgalleryitem("addcomboboxitem","id-very-large-font-size",th,"tooltip",256,257);Wc.comboboxgalleryitem("addcomboboxitem","id-ultra-large-font-size",uh,"tooltip",258,259);Hg=Ka.sidegallery("addcomboboxgalleryitemtosection","id-format-diagram-relation","id-relation-line-style",zt,"tooltip",
!1,!1,function(a){var c=0;a=="id-solid-line"?c=0:a=="id-dotted-line"&&(c=1);Zc("ls",c,vw)});Hg.comboboxgalleryitem("addcomboboxitem","id-solid-line",xu,"tooltip",100,101);Hg.comboboxgalleryitem("addcomboboxitem","id-dotted-line",yu,"tooltip",98,99);ae=Ka.sidegallery("addcomboboxgalleryitemtosection","id-format-diagram-relation","id-relation-line-width",dk,"tooltip",!1,!1,function(a){var c=1;a=="id-very-thin-line"?c=0.25:a=="id-thin-line"?c=0.5:a=="id-medium-line"?c=1:a=="id-thick-line"?c=2:a=="id-very-thick-line"&&
(c=4);Zc("lw",c,tk)});ae.comboboxgalleryitem("addcomboboxitem","id-very-thin-line",fk,"tooltip",234,235);ae.comboboxgalleryitem("addcomboboxitem","id-thin-line",gk,"tooltip",236,237);ae.comboboxgalleryitem("addcomboboxitem","id-medium-line",hk,"tooltip",126,127);ae.comboboxgalleryitem("addcomboboxitem","id-thick-line",ik,"tooltip",238,239);ae.comboboxgalleryitem("addcomboboxitem","id-very-thick-line",jk,"tooltip",240,241);Ee=Ka.sidegallery("addcomboboxgalleryitemtosection","id-format-diagram-relation",
"id-relation-line-arrows",At,"tooltip",!1,!1,function(a){var c=2;a=="id-arrows-none"?c=0:a=="id-arrows-start"?c=1:a=="id-arrows-end"?c=2:a=="id-arrows-start-end"&&(c=3);Zc("la",c,ww)});Ee.comboboxgalleryitem("addcomboboxitem","id-arrows-none",zu,"tooltip",126,127);Ee.comboboxgalleryitem("addcomboboxitem","id-arrows-start",Au,"tooltip",128,129);Ee.comboboxgalleryitem("addcomboboxitem","id-arrows-end",Bu,"tooltip",130,131);Ee.comboboxgalleryitem("addcomboboxitem","id-arrows-start-end",Cu,"tooltip",
132,133);vf=Ka.sidegallery("addcomboboxgalleryitemtosection","id-format-diagram-relation","id-relation-visible-up-to-level",Bt,"tooltip",!1,!1,function(a){var c=999999999;a=="id-level-1"?c=1:a=="id-level-2"?c=2:a=="id-level-all"&&(c=999999999);mc(d.j.aa,-1,-1,-1,-1,c,i,i,i,i,-1,i,i,xw)});vf.comboboxgalleryitem("addcomboboxitem","id-level-1",Du,"tooltip",326,327);vf.comboboxgalleryitem("addcomboboxitem","id-level-2",Eu,"tooltip",328,329);vf.comboboxgalleryitem("addcomboboxitem","id-level-all",Fu,"tooltip",
330,331);qi=Ka.sidegallery("addgallerysection","id-format-diagram-item",Xj,!0);ri=Ka.sidegallery("addcolorpickergalleryitemtosection","id-format-diagram-item","id-item-color",ck,"tooltip",Cd,Dd,!1,function(a){Yc("ic",a,mk)});si=ri.colorpickergalleryitem("addcustombutton","id-automatic-item-color",cf,"tooltip",106,107,0,!0,!0,function(){Yc("ic",i,mk)});ti=Ka.sidegallery("addcolorpickergalleryitemtosection","id-format-diagram-item","id-item-text-color",vh,"tooltip",Cd,Dd,!1,function(a){Yc("tc",a,nk)});
ui=ti.colorpickergalleryitem("addcustombutton","id-automatic-item-text-color",cf,"tooltip",106,107,0,!0,!0,function(){Yc("tc",i,nk)});vi=Ka.sidegallery("addcomboboxgalleryitemtosection","id-format-diagram-item","id-item-font-name",mh,"tooltip",!1,!1,function(a){a=parseInt(a.match(/\d+(?=\D*$)/));Yc("fn",Sa[a],ok)});for(n=0;n<Sa.length;n++)vi.comboboxgalleryitem("addcomboboxitem","id-font-name-"+n,Sa[n],"tooltip",296,297);Vc=Ka.sidegallery("addcomboboxgalleryitemtosection","id-format-diagram-item",
"id-item-font-size",nh,"tooltip",!1,!1,function(a){var c=1;a=="id-ultra-small-font-size"?c=0.7:a=="id-very-small-font-size"?c=0.8:a=="id-small-font-size"?c=0.9:a=="id-medium-font-size"?c=1:a=="id-large-font-size"?c=1.2:a=="id-very-large-font-size"?c=1.6:a=="id-ultra-large-font-size"&&(c=2.4);Yc("iw",c,pk)});Vc.comboboxgalleryitem("addcomboboxitem","id-ultra-small-font-size",oh,"tooltip",246,247);Vc.comboboxgalleryitem("addcomboboxitem","id-very-small-font-size",ph,"tooltip",248,249);Vc.comboboxgalleryitem("addcomboboxitem",
"id-small-font-size",qh,"tooltip",250,251);Vc.comboboxgalleryitem("addcomboboxitem","id-medium-font-size",rh,"tooltip",252,253);Vc.comboboxgalleryitem("addcomboboxitem","id-large-font-size",sh,"tooltip",254,255);Vc.comboboxgalleryitem("addcomboboxitem","id-very-large-font-size",th,"tooltip",256,257);Vc.comboboxgalleryitem("addcomboboxitem","id-ultra-large-font-size",uh,"tooltip",258,259);Jc=Ka.sidegallery("addcomboboxgalleryitemtosection","id-format-diagram-item","id-item-shape",wt,"tooltip",!1,!1,
function(a){var c="default";a=="id-shape-circle"?c="circle":a=="id-shape-rect"?c="rect":a=="id-shape-rhomb"?c="rhomb":a=="id-shape-hexagon"?c="hexagon":a=="id-shape-triangle"?c="triangle":a=="id-shape-para"?c="para":a=="id-shape-trapez"&&(c="trapez");Yc("is",c,sw)});Jc.comboboxgalleryitem("addcomboboxitem","id-shape-default",Gu,"tooltip",174,175);Jc.comboboxgalleryitem("addcomboboxitem","id-shape-circle",Hu,"tooltip",174,175);Jc.comboboxgalleryitem("addcomboboxitem","id-shape-rect",Iu,"tooltip",176,
177);Jc.comboboxgalleryitem("addcomboboxitem","id-shape-rhomb",Ju,"tooltip",178,179);Jc.comboboxgalleryitem("addcomboboxitem","id-shape-hexagon",Ku,"tooltip",180,181);Jc.comboboxgalleryitem("addcomboboxitem","id-shape-triangle",Lu,"tooltip",182,183);Jc.comboboxgalleryitem("addcomboboxitem","id-shape-para",Mu,"tooltip",184,185);Jc.comboboxgalleryitem("addcomboboxitem","id-shape-trapez",Nu,"tooltip",186,187);wi=Ka.sidegallery("addgalleryitemtosection","id-format-diagram-item","id-item-draw-image-in-shape",
xt,"tooltip",194,195,0,!0,!1,function(a,c){Yc("iis",c?1:0,tw)});In=Ka.sidegallery("addiconpickergalleryitemtosection","id-format-diagram-item","id-item-symbols",yt,"tooltip",!1,function(a){Yc("sym",a,uw)});Ri=Ka.sidegallery("addgallerysection","id-format-diagram",Zj,!0);Di=Ka.sidegallery("addcolorpickergalleryitemtosection","id-format-diagram","id-background-color",Dj,"tooltip",Cd,Dd,!1,function(a){Ta("bc",a,0,!1,!1,wk)});Ei=Di.colorpickergalleryitem("addcustombutton","id-automatic-background-color",
cf,"tooltip",106,107,0,!0,!0,function(){Ta("bc",i,0,!1,!1,wk)});vd=Ka.sidegallery("addcomboboxgalleryitemtosection","id-format-diagram","id-background-pattern",Kt,"tooltip",!1,!1,function(a){var c="none",c=a=="id-automatic"?i:a.substring(3);Ta("bp",c,0,!1,!1,Bw)});vd.comboboxgalleryitem("addcomboboxitem","id-automatic",$v,"tooltip",150,151);vd.comboboxgalleryitem("addcomboboxitem","id-none",aw,"tooltip",146,147);vd.comboboxgalleryitem("addcomboboxitem","id-perspective",bw,"tooltip",150,151);vd.comboboxgalleryitem("addcomboboxitem",
"id-checkered-paper",cw,"tooltip",152,153);vd.comboboxgalleryitem("addcomboboxitem","id-edge-circles",dw,"tooltip",166,167);vd.comboboxgalleryitem("addcomboboxitem","id-triangles",ew,"tooltip",168,169);var A=i;Ln=Ka.sidegallery("addslidergalleryitemtosection","id-format-diagram","id-item-alpha",Gt,"tooltip",104,105,0,100,1,100,"%",function(){Ta("ia",1,0,!1,!1,uk)},i,function(a,c){d.B<=Fa&&(A!=i&&clearTimeout(A),A=setTimeout(function(){A=i;z.ia=c/100;d.j.Pc(1E3,!1,!1,!0)},25))},function(a,c){A!=i&&
clearTimeout(A);Ta("ia",c/100,0,!1,!1,uk)});var u={Greys:rv,YlGn:sv,YlGnBu:tv,GnBu:uv,BuGn:vv,PuBuGn:wv,PuBu:xv,BuPu:yv,RdPu:zv,PuRd:Av,OrRd:Bv,YlOrRd:Cv,YlOrBr:Dv,Purples:Ev,Blues:Fv,Greens:Gv,Oranges:Hv,Reds:Iv,PuOr:Jv,BrBG:Kv,PRGn:Lv,PiYG:Mv,RdBu:Nv,RdGy:Ov,RdYlBu:Pv,Spectral:Qv,RdYlGn:Rv,Accent:Sv,Dark2:Tv,Paired:Uv,Pastel1:Vv,Pastel2:Wv,Set1:Xv,Set2:Yv,Set3:Zv};Ci=Ka.sidegallery("addcomboboxgalleryitemtosection","id-format-diagram","id-item-color-scheme",Ht,"tooltip",!1,!1,function(a){Ta("ics",
a,0,!1,!1,zw)});a.each(colorbrewer,function(a,c){Ci.comboboxgalleryitem("addcomboboxcoloritem",a,u[a],"tooltip",Nh(c["4"][3]))});var x=i;Jn=Ka.sidegallery("addslidergalleryitemtosection","id-format-diagram","id-item-color-offset",It,"tooltip",106,107,1,12,1,1,"",function(){Ta("ico",0,0,!1,!1,vk)},i,function(a,c){d.B<=Fa&&(x!=i&&clearTimeout(x),x=setTimeout(function(){x=i;z.ico=c-1;d.j.Pc(1E3,!1,!1,!0)},25))},function(a,c){x!=i&&clearTimeout(x);Ta("ico",c-1,0,!1,!1,vk)});Fe=Ka.sidegallery("addcomboboxgalleryitemtosection",
"id-format-diagram","id-coloring",Ft,"tooltip",!1,!1,function(a){var c=0;switch(a){case "id-level-wise":c=1;break;case "id-parent-wise":c=2;break;case "id-category-wise":c=3}Ta("col",c,0,!1,!1,yw)});Fe.comboboxgalleryitem("addcomboboxitem","id-item-wise",lv,"tooltip",190,191);Fe.comboboxgalleryitem("addcomboboxitem","id-level-wise",kk,"tooltip",270,271);Fe.comboboxgalleryitem("addcomboboxitem","id-parent-wise",mv,"tooltip",88,89);Fe.comboboxgalleryitem("addcomboboxitem","id-category-wise",nv,"tooltip",
158,159);Kn=Ka.sidegallery("addgalleryitemtosection","id-format-diagram","id-invert-relation-colors",Jt,"tooltip",96,97,0,!0,!1,function(a,c){Ta("irc",c?1:0,0,!1,!1,Aw)});ce=Ka.sidegallery("addcomboboxgalleryitemtosection","id-format-diagram","id-diagram-line-width",dk,"tooltip",!1,!1,function(a){var c=1;a=="id-very-thin-line"&&(c=0.25);a=="id-thin-line"?c=0.5:a=="id-medium-line"?c=1:a=="id-thick-line"?c=2:a=="id-very-thick-line"&&(c=3);Ta("lw",c,0,!1,!1,tk)});ce.comboboxgalleryitem("addcomboboxitem",
"id-very-thin-line",fk,"tooltip",234,235);ce.comboboxgalleryitem("addcomboboxitem","id-thin-line",gk,"tooltip",236,237);ce.comboboxgalleryitem("addcomboboxitem","id-medium-line",hk,"tooltip",126,127);ce.comboboxgalleryitem("addcomboboxitem","id-thick-line",ik,"tooltip",238,239);ce.comboboxgalleryitem("addcomboboxitem","id-very-thick-line",jk,"tooltip",240,241);Nn=Ka.sidegallery("addgalleryitemtosection","id-format-diagram","id-shadow-mode",ku,"tooltip",120,121,0,!0,!1,function(a,c){Ta("swm",c?1:0,
0,!1,!1,Cw)});On=Ka.sidegallery("addgalleryitemtosection","id-format-diagram","id-color-gradient",lu,"tooltip",106,107,0,!0,!1,function(a,c){Ta("cgm",c?1:0,0,!1,!1,Dw)});Pn=Ka.sidegallery("addgalleryitemtosection","id-format-diagram","id-highlight-relation-labels",mu,"tooltip",160,161,0,!0,!1,function(a,c){Ta("hrl",c?1:0,0,!1,!1,Ew)});n=tb.sidegallery("addemptycelltotoolbar");p=Ya(function(){return tb.sidegallery("setbodyhtml",'<div class="kbb-searchresults"></div>')});id=Ex(n,p.find(".kbb-searchresults"));
n.closest("table").width("100%");n=Jd.sidegallery("addemptycelltotoolbar");hc=Jd.sidegallery("addgallery");Eb=tf(n,"id-select-category",0,Nq,Kd,Ce);Ha.sidegallery("addgallery");b.editmode&&Ha.sidegallery("addgalleryitem","id-add-bookmark",pu,"tooltip",67,68,-1,!0,!1,function(){j(!1)});Id=Ha.sidegallery("addgallerysection","id-viewmode-bookmarks",Fs,!1);b.editmode&&(re=Ha.sidegallery("addgalleryitemtosection","id-viewmode-bookmarks","id-update-bookmark",qu,"tooltip",74,75,-1,!0,!1,function(){j(!0)}),
se=Ha.sidegallery("addgalleryitemtosection","id-viewmode-bookmarks","id-remove-bookmark",ru,"tooltip",69,70,-1,!0,!1,function(){Rb&&Rb.remove()}));ro=Ha.sidegallery("addslidergalleryitem","id-viewmode-zoom",Ct,"tooltip",59,59,0,200,5,100," %",function(a){d.B<=Fa&&d.hb(d.L,d.L);var c=1/d.D;d.D=1;Ve(c,500);a.slidergalleryitem("setvalue",100);U()&&Oc({action:"onsettingschanged",zoomfact:d.D})},i,function(a,c){Vi(c>=100?2*c/100-1:1/(3-2*c/100))},function(a,c){d.B<=Fa&&d.hb(d.L,d.L);var b=(c>=100?2*c/
100-1:1/(3-2*c/100))/d.D;d.D*=b;Ve(b,0);U()&&Oc({action:"onsettingschanged",zoomfact:d.D})});window.addEventListener("wheel",function(a){if(a.ctrlKey||a.metaKey)a.preventDefault(),ip(a.deltaY>0?Math.pow(1.025,a.deltaY/100):1/Math.pow(1.025,a.deltaY/-100))},{passive:!1});Sg=Ha.sidegallery("addslidergalleryitem","id-viewmode-stretch",Ti,"tooltip",61,61,0,200,5,100," %",function(a){d.hb(d.L,d.L);var c=1/d.M;d.M=1;Ve(c,500);a.slidergalleryitem("setvalue",100);U()&&Oc({action:"onsettingschanged",stretchfact:d.M})},
fa(),fa(),function(a,c){d.B<=Fa&&d.hb(d.L,d.L);var b=(c>=100?2*c/100-1:1/(3-2*c/100))/d.M;d.M*=b;Ve(b,500);U()&&Oc({action:"onsettingschanged",stretchfact:d.M})});Tg=Ha.sidegallery("addslidergalleryitem","id-viewmode-rotate",Dt,"tooltip",318,318,0,360,5,0," \u00b0",function(a){d.hb(d.L,d.L);d.rotation=0;gb(500,-2,!1,!0,!0);a.slidergalleryitem("setvalue",0);U()&&Oc({action:"onsettingschanged",rotation:d.rotation})},fa(),fa(),function(a,c){d.hb(d.L,d.L);d.rotation=c;gb(500,-2,!1,!0,!0);U()&&Oc({action:"onsettingschanged",
rotation:d.rotation})});Ug=Ha.sidegallery("addslidergalleryitem","id-viewmode-rotate",Et,"tooltip",320,320,0,100,5,0," %",function(a){d.hb(d.L,d.L);d.Xa=1;d.K=1;d.$=0;gb(500,-2,!1,!0,!0);a.slidergalleryitem("setvalue",0);U()&&Oc({action:"onsettingschanged",perspective:d.$})},fa(),fa(),function(a,c){d.hb(d.L,d.L);d.Xa=1-(1-dc)*c/100;d.K=1-(1-fc)*c/100;d.$=c;gb(500,-2,!1,!0,!0);U()&&Oc({action:"onsettingschanged",perspective:d.$})});b.fullscreen||(Ha.sidegallery("addgallerysection","id-viewmode-window",
As,!0),Ha.sidegallery("addgalleryitemtosection","id-viewmode-window","id-full-screen",Lt,"tooltip",0,1,0,!0,!0,function(a,c){U()?Oc({action:"fullscreen",fullscreen:c?1:0}):go(c)}));Ha.sidegallery("addgallerysection","id-viewmode-diagram",Zj,!0);fb=Ha.sidegallery("addcomboboxgalleryitemtosection","id-viewmode-diagram","id-diagram-layout",ek,"tooltip",!0,!1,function(a){var c=0;switch(a){case "id-mindmap-circular-straight":c=1;break;case "id-flowchart-topbottom":c=2;break;case "id-flowchart-leftright":c=
3;break;case "id-hierarchical":c=4;break;case "id-network-grouped":c=5;break;case "id-relations-grouped":c=6;break;case "id-mindmap-circular-curved":c=7;break;case "id-mindmap-compact-straight":c=8;break;case "id-hierarchical-grouped":c=9;break;case "id-hierarchical-relations-grouped":c=10;break;case "id-one-column-grouped":c=11;break;case "id-one-column-relations-grouped":c=12;break;case "id-two-columns-grouped":c=13;break;case "id-two-columns-relations-grouped":c=14;break;case "id-concept-map-radial":c=
15;break;case "id-concept-map-hierarchical":c=16}d.G=c;if(d.fa)for(a=0;a<d.fa.i.length;a++){var e=d.fa.i[a];typeof e.lx!=="undefined"&&delete e.lx;typeof e.ly!=="undefined"&&delete e.ly;typeof e.lo!=="undefined"&&delete e.lo}b.editmode?Ta("dl",c,Xb,!0,!0,Vf):d.load(P,-1,"",Xb,!0,!0,xe+1)});fb.comboboxgalleryitem("addcomboboxitem","id-mindmap-compact-straight",Pu,"tooltip",244,245);fb.comboboxgalleryitem("addcomboboxitem","id-mindmap-compact-curved",Ou,"tooltip",172,173);fb.comboboxgalleryitem("addcomboboxitem",
"id-mindmap-circular-straight",Qu,"tooltip",124,125);fb.comboboxgalleryitem("addcomboboxitem","id-mindmap-circular-curved",Ru,"tooltip",242,243);fb.comboboxgalleryitem("addcomboboxitem","id-concept-map-radial",Su,"tooltip",242,243);fb.comboboxgalleryitem("addcomboboxitem","id-concept-map-hierarchical",Tu,"tooltip",290,291);fb.comboboxgalleryitem("addcomboboxitem","id-network-grouped",Xu,"tooltip",226,227);fb.comboboxgalleryitem("addcomboboxitem","id-relations-grouped",Yu,"tooltip",228,229);fb.comboboxgalleryitem("addcomboboxitem",
"id-one-column-grouped",Zu,"tooltip",332,333);fb.comboboxgalleryitem("addcomboboxitem","id-one-column-relations-grouped",$u,"tooltip",332,333);fb.comboboxgalleryitem("addcomboboxitem","id-two-columns-grouped",av,"tooltip",334,335);fb.comboboxgalleryitem("addcomboboxitem","id-two-columns-relations-grouped",bv,"tooltip",334,335);fb.comboboxgalleryitem("addcomboboxitem","id-hierarchical",Uu,"tooltip",290,291);fb.comboboxgalleryitem("addcomboboxitem","id-hierarchical-grouped",Vu,"tooltip",336,337);fb.comboboxgalleryitem("addcomboboxitem",
"id-hierarchical-relations-grouped",Wu,"tooltip",336,337);fb.comboboxgalleryitem("addcomboboxitem","id-flowchart-topbottom",cv,"tooltip",88,89);fb.comboboxgalleryitem("addcomboboxitem","id-flowchart-leftright",dv,"tooltip",170,171);lc=Ha.sidegallery("addcomboboxgalleryitemtosection","id-viewmode-diagram","id-diagram-layout",ek,"tooltip",!1,!1,function(a){var c=0;switch(a){case "id-mindmap3d-radial":c=0;break;case "id-tree3d-vertical-levelwise":c=1;break;case "id-tree3d-vertical-levelwise-both-sides":c=
2;break;case "id-tree3d-vertical-relation-direction":c=3;break;case "id-spherical3d":c=4}d.za=c;b.editmode?Ta("dl3d",c,Xb,!0,!0,Vf):d.load(P,-1,"",Xb,!0,!0,xe+1)}).hide();lc.comboboxgalleryitem("addcomboboxitem","id-mindmap3d-radial",ev,"tooltip",124,125);lc.comboboxgalleryitem("addcomboboxitem","id-tree3d-vertical-levelwise",fv,"tooltip",290,291);lc.comboboxgalleryitem("addcomboboxitem","id-tree3d-vertical-levelwise-both-sides",gv,"tooltip",292,293);lc.comboboxgalleryitem("addcomboboxitem","id-tree3d-vertical-relation-direction",
hv,"tooltip",294,295);lc.comboboxgalleryitem("addcomboboxitem","id-spherical3d",iv,"tooltip",316,317);ud=Ha.sidegallery("addcomboboxgalleryitemtosection","id-viewmode-diagram","id-text-orientation-3d",$t,"tooltip",!1,!1,function(a){var c=0;switch(a){case "id-to-viewer":c=0;break;case "id-static":c=1;break;case "id-radial":c=2}d.Ja=c;b.editmode?Ta("to3d",c,0,!1,!1,Ck):d.load(P,-1,"",0,!1,!1,xe+1)}).hide();ud.comboboxgalleryitem("addcomboboxitem","id-to-viewer",ov,"tooltip",266,267);ud.comboboxgalleryitem("addcomboboxitem",
"id-static",pv,"tooltip",320,321);ud.comboboxgalleryitem("addcomboboxitem","id-radial",qv,"tooltip",124,125);be=Ha.sidegallery("addcomboboxgalleryitemtosection","id-viewmode-diagram","id-decrease-child-elements",hu,"tooltip",!1,!1,function(a){var c=0;switch(a){case "id-same-height":c=0;break;case "id-childcount-wise":c=1;break;case "id-levelwise":c=2}d.Za=c;b.editmode?Ta("dce",c,Xb,!0,!1,yk):d.load(P,-1,"",Xb,!0,!1,xe+1)});be.comboboxgalleryitem("addcomboboxitem","id-same-height",jv,"tooltip",190,
191);be.comboboxgalleryitem("addcomboboxitem","id-childcount-wise",kv,"tooltip",88,89);be.comboboxgalleryitem("addcomboboxitem","id-levelwise",kk,"tooltip",270,271);Gf=Ha.sidegallery("addgalleryitemtosection","id-viewmode-diagram","id-reset-item-shift",Vt,"tooltip",322,323,-1,!0,!1,function(){jp(H())},!0);Zg=Ha.sidegallery("addgalleryitemtosection","id-viewmode-diagram","id-reset-item-shifts",Wt,"tooltip",348,349,-1,!0,!1,function(){lp()},!0);Fi=Ha.sidegallery("addgalleryitemtosection","id-viewmode-diagram",
"id-expand-items",Xt,"tooltip",154,155,0,!0,!0,function(a,c){d.na=c?1:0;b.editmode?Ta("iex",c?1:0,Xb,!1,!1,xk):d.load(P,-1,"",Xb,!1,!1,xe+1)});wf=Ha.sidegallery("addgalleryitemtosection","id-viewmode-diagram","id-mark-root-item",iu,"tooltip",266,267,0,!0,!1,function(a,c){d.ga=c?1:0;b.editmode?Ta("mri",c?1:0,200,!0,!1,zk):d.load(P,-1,"",200,!0,!1,xe+1)});Ig=Ha.sidegallery("addgalleryitemtosection","id-viewmode-diagram","id-with-cross-links",Yt,"tooltip",122,123,0,!0,!0,function(a,c){d.Ka=c?1:0;b.editmode?
Ta("wcl",c?1:0,Xb,!0,!1,Ak):d.load(P,-1,"",Xb,!0,!1,xe+1)});Mn=Ha.sidegallery("addgalleryitemtosection","id-viewmode-diagram","id-with-table-relations",Zt,"tooltip",262,263,0,!0,!0,function(a,c){d.Wa=c?1:0;b.editmode?Ta("wtr",c?1:0,Xb,!0,!1,Bk):d.load(P,-1,"",Xb,!0,!1,xe+1)});b.editmode&&(Hb=Ha.sidegallery("addgalleryitemtosection","id-viewmode-diagram","id-edit-mode",Eh,"tooltip",74,75,d.H?1:0,!0,!0,function(c,b){function e(){Oe(b);b||d.j.Ga(-1,-1,!0,!1,!0);Fb&&Fb.toolbarbtn("setselected",b);Gb&&
Gb.toolbarbtn("setselected",!b)}a.fn.C.close();b?e():Xc(e)}));xf=Ha.sidegallery("addgalleryitemtosection","id-viewmode-diagram","id-animate-transitions",ju,"tooltip",96,97,0,!0,!1,function(a,c){d.T=c?1:0;b.editmode&&Ta("atran",c?1:0,0,!1,!1,Dk)});Ha.sidegallery("addgallerysection","id-viewmode-labels",Bs,!1);Gi=Ha.sidegallery("addgalleryitemtosection","id-viewmode-labels","id-show-labels",au,"tooltip",190,191,d.ma||d.xa||d.ta||d.va||d.ua||d.Oa?1:0,!0,!0,function(a,c){var b=d.ma!=c,e=d.xa!=c,f=d.ta!=
c,g=d.va!=c,k=d.ua!=c,l=d.Oa!=c;d.ma=c;d.xa=c;d.ta=c;d.va=c;d.ua=c;d.Oa=c;gb(0,-1,!1,!1,!1);U()&&(b&&Oc({action:"onsettingschanged",showcategories:d.ma?1:0}),e&&Oc({action:"onsettingschanged",shownotetag:d.xa?1:0}),f&&Oc({action:"onsettingschanged",showdescriptiontag:d.ta?1:0}),g&&Oc({action:"onsettingschanged",showmorerelationCount:d.va?1:0}),k&&Oc({action:"onsettingschanged",showhiddenrelationCount:d.ua?1:0}),l&&Oc({action:"onsettingschanged",showitemshift:d.Oa?1:0}))});Hi=Ha.sidegallery("addgalleryitemtosection",
"id-viewmode-labels","id-show-categories",bu,"tooltip",158,159,d.ma?1:0,!0,!0,function(a,c){d.ma=c;gb(0,-1,!1,!1,!1);U()&&Oc({action:"onsettingschanged",showcategories:d.ma?1:0})});Ii=Ha.sidegallery("addgalleryitemtosection","id-viewmode-labels","id-show-note-tag",cu,"tooltip",190,191,d.xa?1:0,!0,!0,function(a,c){d.xa=c;gb(0,-1,!1,!1,!1);U()&&Oc({action:"onsettingschanged",shownotetag:d.xa?1:0})});Ji=Ha.sidegallery("addgalleryitemtosection","id-viewmode-labels","id-show-description-tag",du,"tooltip",
190,191,d.ta?1:0,!0,!0,function(a,c){d.ta=c;gb(0,-1,!1,!1,!1);U()&&Oc({action:"onsettingschanged",showdescriptiontag:d.ta?1:0})});Ki=Ha.sidegallery("addgalleryitemtosection","id-viewmode-labels","id-show-more-relation-count",eu,"tooltip",162,163,d.va?1:0,!0,!0,function(a,c){d.va=c;gb(0,-1,!1,!1,!1);U()&&Oc({action:"onsettingschanged",showmorerelationCount:d.va?1:0})});Li=Ha.sidegallery("addgalleryitemtosection","id-viewmode-labels","id-show-hidden-relation-count",fu,"tooltip",164,165,d.ua?1:0,!0,
!0,function(a,c){d.ua=c;gb(0,-1,!1,!1,!1);U()&&Oc({action:"onsettingschanged",showhiddenrelationCount:d.ua?1:0})});He=Ha.sidegallery("addgalleryitemtosection","id-viewmode-labels","id-show-item-shift",gu,"tooltip",324,325,d.Oa?1:0,!0,!0,function(a,c){d.Oa=c;gb(0,-1,!1,!1,!1);U()&&Oc({action:"onsettingschanged",showitemshift:d.Oa?1:0})});Qi=Ha.sidegallery("addgallerysection","id-viewmode-visible-diagram-section",Cs,!1);n=Ha.sidegallery("addpropertysheettosection","id-viewmode-visible-diagram-section",
"id-visible-diagram-section");n.propertysheet("adddescription",fw);Qn=n.propertysheet("addinput",d.la<1?100:d.la,1,1E4,"int",function(a,c){if(c!=d.la)d.la=c,b.editmode&&d.la<=250?Ta("mi",d.la,Xb,!0,!1,Ek):d.load(P,-1,"",Xb,!0,!1,xe+1)});n.propertysheet("adddescription",gw);Rn=n.propertysheet("addinput",d.ha<1?100:d.ha,1,1E4,"int",function(a,c){if(c!=d.ha)d.ha=c,b.editmode?Ta("ml",d.ha,Xb,!0,!1,Fk):d.load(P,-1,"",Xb,!0,!1,xe+1)});n.propertysheet("adddescription",Tf+1);Sn=n.propertysheet("addinput",
d.Aa<1?100:d.Aa,1,1E4,"int",function(a,c){if(c!=d.Aa)d.Aa=c,b.editmode?Ta("c1",d.Aa,Xb,!0,!1,cd+1):d.load(P,-1,"",Xb,!0,!1,xe+1)});n.propertysheet("adddescription",Tf+2);Tn=n.propertysheet("addinput",d.Ba<1?100:d.Ba,1,1E4,"int",function(a,c){if(c!=d.Ba)d.Ba=c,b.editmode?Ta("c2",d.Ba,Xb,!0,!1,cd+2):d.load(P,-1,"",Xb,!0,!1,xe+1)});n.propertysheet("adddescription",Tf+3);Un=n.propertysheet("addinput",d.Ca<1?100:d.Ca,1,1E4,"int",function(a,c){if(c!=d.Ca)d.Ca=c,b.editmode?Ta("c3",d.Ca,Xb,!0,!1,cd+3):d.load(P,
-1,"",Xb,!0,!1,xe+1)});n.propertysheet("adddescription",Tf+4);Vn=n.propertysheet("addinput",d.Da<1?100:d.Da,1,1E4,"int",function(a,c){if(c!=d.Da)d.Da=c,b.editmode?Ta("c4",d.Da,Xb,!0,!1,cd+4):d.load(P,-1,"",Xb,!0,!1,xe+1)});Ab=Ha.sidegallery("addgallerysection","id-viewmode-itemcategoryfilter",Ds,!1,function(a,c){Wa.jb(a,c,0)});Lb=Ha.sidegallery("addgallerysection","id-viewmode-relationcategoryfilter",Es,!1,function(a,c){Wa.jb(a,c,1)});Bc.sidegallery("addgallery");Bc.sidegallery("addgallerysection",
"id-navigation-browse",Gs,!0);Jq=Bc.sidegallery("addgalleryitemtosection","id-navigation-browse","id-browse-back",su,"tooltip",4,5,-1,!0,!1,function(){ec&&ec.Ge()},!0);Kq=Bc.sidegallery("addgalleryitemtosection","id-navigation-browse","id-browse-forward",tu,"tooltip",6,7,-1,!0,!1,function(){ec&&ec.pg()},!0);Rj=Bc.sidegallery("addgallerysection","id-navigation-last-viewed",Hs,!0);Cc.sidegallery("addgallery");Cc.sidegallery("addgalleryitem","id-help-about",uu,"tooltip",144,145,-1,!0,!1,function(){window.showAboutDialog()});
Cc.sidegallery("addgalleryitem","id-help-shortcuts",vu,"tooltip",190,191,-1,!0,!1,function(){window.showShortcutsDialog()});window.showAboutDialog=function(){m(Yr,ds)};window.showShortcutsDialog=function(){m(Zr,es)};Cc.sidegallery("addgallerysection","id-help-assistant",Is,!0);b.editmode&&Cc.sidegallery("addgalleryitemtosection","id-help-assistant","id-help-intro",wu,"tooltip",232,233,-1,!0,!1,function(){xp(b.language,C,d,B,O)})})();(function(){function c(){Ra?ab.sidegallery("show",!0,d.T==0?0:250,
i):(ab.sidegallery("showpinned",!0),gb(0,P,!1,!1,!1));Gd.sidegallery("false",!0,0,i);Hd.sidegallery("false",!0,0,i)}function e(c,b){var f=c.toolbarbtn("getid");if(b&&(f=="id-editmode"||f=="id-format-diagram"))Oe(!0),Hb&&Hb.galleryitem("setselected",!0),Fb&&Fb.toolbarbtn("setselected",!0),Gb&&Gb.toolbarbtn("setselected",!1);f=="id-items-in-category"&&b&&a.trim(hc.html()).length==0&&(Eb.val(Kd).data("pid",-1).data("fid",-1).data("fn",Kd),Eb.parent().find(".kbb-selectcategoryhint").hide(),Ce(-1));C.find("."+
f+"-gallery").sidegallery("show",b,d.T==0?0:500,function(a){a&&gb(0,P,!1,!1,!1)})}Gd.sidegallery("addtoolbarbuttoninverse","id-show-sidebar",Oq,Tj,-1,-1,!0,!0,-1,c,i);Hd.sidegallery("addtoolbarbuttoninverse","id-show-sidebar",Pq,Tj,-1,-1,!1,!1,-1,c,i);ab.sidegallery("addsidebar");Gd.sidegallery("show",!1,0,i);Hd.sidegallery("show",Ra,0,i);ab.sidegallery("showpinned",!Ra);b.downloadbutton&&!U()&&!qb()&&!Bb()&&!Cb()&&ab.sidegallery("addsidebarbutton","id-download-knowledgebase",Qq,"tooltip",138,138,
-1,function(){window.open(b.baseurl+nc+b.scriptextension+"?action=downloaddatabase&databasename="+b.database,"_self")});b.knowledgebasegallery&&(Qf=ab.sidegallery("addsidebarbutton","id-knowledgebase",Rq,"tooltip",67,67,0,e));b.editmode&&(Rf=ab.sidegallery("addsidebarbutton","id-editmode",Sq,"tooltip",74,74,0,e),Sf=ab.sidegallery("addsidebarbutton","id-format-diagram",Tq,"tooltip",31,31,0,e));Dh=ab.sidegallery("addsidebarbutton","id-search-items",Uq,"tooltip",59,59,0,e);Lj=ab.sidegallery("addsidebarbutton",
"id-items-in-category",Vq,"tooltip",158,158,0,e);Pi=ab.sidegallery("addsidebarbutton","id-memorize-items",Zq,"tooltip",208,208,-1,function(){Qb();Gx()});Yd=ab.sidegallery("addsidebarbutton","id-textnote",Wq,"tooltip",63,63,0,e);Mj=ab.sidegallery("addsidebarbutton","id-viewmode",Xq,"tooltip",76,76,0,e);Nj=ab.sidegallery("addsidebarbutton","id-diagramnavigation",Yq,"tooltip",78,78,0,e);(U()||qb()||Bb())&&ab.sidegallery("addsidebarbutton","id-settings",$q,"tooltip",220,220,-1,function(){function c(){b.find(".kbb-user-interface-size").text(parseInt(100*
d+0.5)+"%");var e=d/zh;a("body").css("zoom",e)}Qb();var b=i,d=zh,e="<form>";e+="<div>"+ks+' <span class="kbb-user-interface-size">'+parseInt(100*d+0.5)+"%</span></div>";e+='<div><button class="kbb-decrease-user-interface" type="button">'+ls+'</button><button class="kbb-increase-user-interface" type="button">'+ms+'</button><button class="kbb-reset-user-interface" type="button">'+ns+"</button></div>";e+='<input type="submit" class="kbb-invisible" />';e+="</form>";var f={};f[Da]=function(){b.dialog("close");
B({action:"setuserinterfacescalefact",scalefact:d},function(){qb()?window.scaleView():Bb()&&window.location.reload(!0)});zh=d;a("body").css("zoom","normal")};f[eb]=function(){a("body").css("zoom",1);b.dialog("close");a("body").css("zoom","normal")};b=a('<div class="kbb-settings-dialog" />').html(e).dialog({modal:!0,closeOnEscape:!1,resizable:!1,buttons:f,title:js,width:500,position:{my:"left top",at:"left top"},open:function(){a(this).parent(".ui-dialog").find("*").myDisableSelection(!1)}});b.find(".kbb-decrease-user-interface").button().bind("click",
function(){d=Math.max(0.3,d-0.05);c();return!1});b.find(".kbb-increase-user-interface").button().bind("click",function(){d=Math.min(3,d+0.05);c();return!1});b.find(".kbb-reset-user-interface").button().bind("click",function(){d=1;c();return!1});b.find("form").bind("submit",function(){setTimeout(function(){f[Da]()},50);return!1})});Oj=ab.sidegallery("addsidebarbutton","id-help",ar,"tooltip",232,232,0,e)})();(function(){var c=a('<div class="quickaccesstoolbar"></div>').appendTo(C.find(".diagramcontainer")).toolbar({vertical:!1});
b.editmode?(Fb=c.toolbar("addtoolbartextbutton","id-edit-mode",hw,Eh,!0,!1,-1,!1,function(a,c){c||Ui(!0)},i),Gb=c.toolbar("addtoolbartextbutton","id-browse-mode",iw,Pt,!1,!0,-1,!1,function(a,c){c||Ui(!1)},i),Fb.toolbarbtn("setselected",d.H),Gb.toolbarbtn("setselected",!d.H)):c.addClass("noedit");ge=c.toolbar("addtoolbartextbutton","id-rotate",jw,Qt,!0,typeof navigator.xr==="undefined",-1,!1,function(){if(Na)Na.autoRotate=!0,ge.hide(),he.hide(),ie.show(),je.hide(),ke.show()},i).hide();he=c.toolbar("addtoolbartextbutton",
"id-vr",kw,Rt,!1,!0,-1,!1,function(){Qj&&Qj()},i).hide();ie=c.toolbar("addtoolbartextbutton","id-record",lw,St,!0,!1,-1,!1,function(){Pj&&Pj()},i).hide();je=c.toolbar("addtoolbartextbutton","id-stop-record",Tt,"tooltip",!0,!0,-1,!1,fa(),i).hide();ke=c.toolbar("addtoolbartextbutton","id-stop",mw,Ut,!1,!0,-1,!1,function(){if(Na)Na.autoRotate=!1,ge.show(),typeof navigator.xr!=="undefined"&&he.show(),ie.hide(),je.hide(),ke.hide()},i).hide();var e=c.toolbar("addemptycell");Fx(e);de=c.toolbar("addtoolbartextbutton",
"id-show-diagramview",nw,Mt,!0,!1,-1,!1,function(a,c){c||(Qb(),de.toolbarbtn("setselected",!0),ee.toolbarbtn("setselected",!1),fe.toolbarbtn("setselected",!1),Wi(Fa))});ee=c.toolbar("addtoolbartextbutton","id-show-3dview",ow,Nt,!1,!1,-1,!1,function(a,c){c||(Qb(),de.toolbarbtn("setselected",!1),ee.toolbarbtn("setselected",!0),fe.toolbarbtn("setselected",!1),Wi(La))});fe=c.toolbar("addtoolbartextbutton","id-show-tableview",pw,Ot,!1,!0,-1,!1,function(a,c){c||(Qb(),de.toolbarbtn("setselected",!1),ee.toolbarbtn("setselected",
!1),fe.toolbarbtn("setselected",!0),Wi(Ia))});de.toolbarbtn("setselected",d.B<=Fa);ee.toolbarbtn("setselected",d.B==La);fe.toolbarbtn("setselected",d.B==Ia);a('<div class="editoverlay"></div>').prependTo(c);c.toolbar("setlast")})();(function(){var c=a('<div class="closetoolbar invisible"></div>').appendTo(C.find(".diagramcontainer")).toolbar({vertical:!1});c.toolbar("addtoolbartextbutton","id-hide-items-on-click-item",Xs,"",!0,!0,-1,!1,function(){Se.galleryitem("setselected",!1);d.Ia=!1;a(".quickaccesstoolbar").removeClass("invisible");
a(".closetoolbar").addClass("invisible");d.pc>=0&&B({action:"combineundoactionsupto",undostepid:d.pc,description:qk,database:O},function(){d.pc=-1;Wa.ff(d.Hb);yh();a.isEmptyObject(d.Hb)||Wa.jb(Ab,i,0);d.Hb={}})});a('<div class="editoverlay"></div>').prependTo(c);c.toolbar("setlast")})();b.legalnotice!=""&&a('<div class="kbb_legalnotice"></div>').appendTo(C.find(".diagramcontainer")).html(b.legalnotice).myDisableSelection(!1);(function(){C.addClass("restoredscreenpages").css({width:b.width,height:b.height});
Ya(function(){a('<div class="kmappage restoredscreenkmappage"></div>').appendTo(C.find(".diagramcontainer")).html('<div class="ikmap"><canvas class="canvas1"></canvas><canvas class="canvas5"></canvas><canvas class="canvas6"></canvas><canvas class="canvas9"></canvas><div class="textlayer" tabindex="-1"><div class="itemselector" tabindex="-1"><a href=""></a><div class="kbb-selector-button"><div class="kbb-selector-icon"></div></div></div><div class="relationselector"></div><div class="editoverlay"></div></div></div>');
a('<div class="itemtoolbar"></div><div class="relationtoolbar"></div><div class="newrelationbar"></div>').appendTo(C)});var c=C.find(".textlayer");Yb=a("<div></div>").selector({id:"id-item-selector","handle-background-color":"#FF0","background-color":"kbb-blue",iconindex:344,onmove:function(c){vb(c)||a.fn.C.close()}}).bindMouseOrTouchEvent("click",function(c){Yb.focus();if(!Wb&&(Hf(i),vb(c)))if(C.find(".itemselector").is(":visible"))C.find(".itemselector a").trigger("click");else{var b=a(this).data("pid");
d.j.q[d.j.F[b]].A.J.find("a:first").trigger(c)}}).bind("dblclick",function(){if(d.H){var c=a(this).data("pid");c==P?Rc(c):(d.load(c,-1,"",Xb,!0,!1,xe+1),U()&&Oc({action:"onitemselected",i:c,r:-1,search:"",setasroot:1,redraw:1}))}}).bind("touchstart",function(c){var b=c.handleObj,e=a.data(c.target),f=(new Date).getTime(),g=e.qa?f-e.qa:0;g<300&&g>30?(e.qa=i,c.type=b.origType,d.H&&(c=a(this).data("pid"),c==P?Rc(c):(d.load(c,-1,"",Xb,!0,!1,xe+1),U()&&Oc({action:"onitemselected",i:c,r:-1,search:"",setasroot:1,
redraw:1})))):e.qa=f}).appendTo(c);bc=a("<div></div>").selector({id:"id-item-hover","handle-background-color":"#FFF","background-color":"kbb-blue",iconindex:344,onmove:function(){a.fn.C.close()}}).bindMouseOrTouchEvent("click",function(c){bc.focus();if(!Wb){Hf(i);var b=a(this).data("pid");vb(c)?d.j.q[d.j.F[b]].A.J.find("a:first").trigger(c):d.j.Vb(b);a(this).hide()}}).appendTo(c);Te=a("<div></div>").selector({id:"id-item-drag1","handle-background-color":"#FF0","background-color":"kbb-blue",iconindex:344,
onmove:function(){a.fn.C.close()}}).appendTo(c);Te.selector("showicon",!0);If=a("<div></div>").selector({id:"id-item-drag2","handle-background-color":"#FF0",onmove:function(){a.fn.C.close()}}).appendTo(c);yc=a("<div></div>").selector({id:"id-relation-from-selector","handle-background-color":"#8CF","background-color":"kbb-yellow",iconindex:346,onmove:function(){a.fn.C.close()}}).bindMouseOrTouchEvent("click",function(c){yc.focus();if(!$b){ld(i);var b=a(this).data("pfrom");vb(c)?d.j.q[d.j.F[b]].A.J.find("a:first").trigger(c):
d.j.Vb(b)}}).appendTo(c);zc=a("<div></div>").selector({id:"id-relation-to-selector","handle-background-color":"#8CF","background-color":"kbb-yellow",iconindex:346,onmove:function(){a.fn.C.close()}}).bindMouseOrTouchEvent("click",function(c){zc.focus();if(!$b){ld(i);var b=a(this).data("pto");vb(c)?d.j.q[d.j.F[b]].A.J.find("a:first").trigger(c):d.j.Vb(b)}}).appendTo(c)})();(function(){function a(){if(!Qa.is(":visible")){var c=na.attr("contenteditable")==="true";if(d.gc&&!d.Db){var b=rd();nb(na,b,!c&&
!d.lb&&!d.nb&&!d.mb,!c&&!d.lb&&!d.nb&&!d.mb)}else nb(na,[],!1,!1);c||xb()}}Ne=hb.sidegallery("addtoolbartextbutton","id-text-note-edit-mode",Eh,"tooltip",0,function(a,c){function b(){me(c,!c&&C.find(".editoverlay").is(":visible"))}c?b():Xc(b)},i,i);Ne.addClass("kbb-toolbarbtn-like-icon");var e=hb.sidegallery("gettoolbar"),f=e.toolbar("addpopupbutton","id-actions",Ms,"tooltip",-1,-1,-1,!0,fa(),i);Pg=f[0];f=f[1];f.gallery("addgalleryitem","id-analyze-textnote",Os,"tooltip",296,297,-1,!0,!0,function(){var a=
Qc(na[0],i,0,i,0,i).t;Am(!U()&&!qb()&&!Bb()&&!jf(),a)});f.gallery("addgalleryitem","id-new-textnote-item",Ps,"tooltip",51,52,-1,!0,!0,function(){Mf(!1,!0,!1,!1,!1)});b.wikipediaimport&&f.gallery("addgalleryitem","id-import-wikipedia-article",Qs,"tooltip",198,199,-1,!0,!0,function(){Mf(!1,!1,!0,!1,!1)});b.twitterimport&&f.gallery("addgalleryitem","id-import-twitter",Rs,"tooltip",222,223,-1,!0,!0,function(){Mf(!1,!1,!1,!0,!1)});var g=f.gallery("addgalleryitem","id-auto-create-item",Ss,"tooltip",71,
72,d.lb?1:0,!0,!0,function(b,e){d.lb=e;d.nb=!1;d.mb=!1;h&&h.galleryitem("setselected",!1);j&&j.galleryitem("setselected",!1);a()}),h=i;b.wikipediaimport&&(h=f.gallery("addgalleryitem","id-auto-insert-wikipedia-articles",Ts,"tooltip",200,201,d.nb?1:0,!0,!0,function(b,e){d.nb=e;d.lb=!1;d.mb=!1;g.galleryitem("setselected",!1);j&&j.galleryitem("setselected",!1);a()}));var j=i;b.twitterimport&&(j=f.gallery("addgalleryitem","id-auto-insert-twitter",Us,"tooltip",224,225,d.mb?1:0,!0,!0,function(b,e){d.mb=
e;d.lb=!1;d.nb=!1;g.galleryitem("setselected",!1);h&&h.galleryitem("setselected",!1);a()}));b.webpageimport&&f.gallery("addgalleryitem","id-import-webpage-link",Vs,"tooltip",316,317,d.me?1:0,!0,!0,function(a,c){d.me=c});f.gallery("addgalleryitem","id-highlight-item-names",Ns,"tooltip",190,191,d.gc?1:0,!0,!0,function(b,e){d.gc=e;a()});Qg=hb.sidegallery("addtoolbarbutton","id-new-textnote-item","",Ar,210,210,-1,function(){Mf(!1,!1,!1,!1,!0)},i).hide();Rg=hb.sidegallery("addtoolbarbutton","id-auto-create-item",
"",Br,212,212,d.de?1:0,function(a,c){d.de=c},i).hide();f=qj(e,!1,function(){return[ad,Kb,na,Qa]},function(){ub=!0},function(a){return a=="l"?"margin:0.2em 0.4em 0.2em 0;float:left":a=="r"?"margin:0.2em 0 0.2em 0.4em;float:right":"margin:0.2em 0.4em 0.2em 0.4em;"},function(){var a=gc(i);Qa.is(":visible")?(Me.show(),Qa.hide(),Ya(function(){na.html(a);na.find("iframe").attr("sandbox","")}),Za(na,!0),lb(na),na.focus(),Cf.show()):(a=yp(Qa,a),Qa.show(),Me.hide(),Qa.val(Vg(a,!0)),qf(Qa),Cf.hide());le&&le();
hb.sidegallery("adjustlayout")});Cf=f[0];Si=f[1];le=f[2];Ya(function(){hb.sidegallery("setbodyhtml",'<div class="textnote"><iframe></iframe><textarea spellcheck="false"></textarea></div>')});jo()})();(function(){function c(a){if(d.B==Ia){var c=f.data("psc"),b=C.find(".textlayer").find(".kbb-tableviewcolumn"),e=c.closest(".kbb-tableviewcolumn"),g=c.data("pid");P=e.data("pid");lj(c);d.j.Ga(g,-1,!1,!1,!0);d.ca=b.index(e);return a?P:g}else{c=C.find(".itemselector").find("a").data("pid");if(a&&d.j&&c>=
0&&(a=d.j.q[d.j.F[c]])&&a.A.p>=0)a=d.L.i[a.A.p].i,a>=0&&(c=a);return c}}function e(){var a=-1;if(d.B==Ia)a=f.data("psc").data("sn");else{var c=C.find(".itemselector").find("a").data("pid");if(c>=0&&(c=d.j.q[d.j.F[c]]))a=c.we}return a}var f=C.find(".itemtoolbar").mouseenter(function(){if(d.B==Ia){var c=f.data("psc");C.find(".textlayer").find(".kbb-tableviewcell-hover").removeClass("kbb-tableviewcell-hover");c.addClass("kbb-tableviewcell-hover");a(".itemtoolbar").show()}else a.fn.C.close(i,".itemselector,.itemtoolbar"),
a(".itemselector,.itemtoolbar").show()}).toolbar({}).hide();f.toolbar("addtoolbarbutton","id-new-item",mr,"tooltip",51,51,-1,!0,function(){Hc(c(d.B==Ia),d.B==Ia?e()+1:-1,"","","","","","","",i)},i);f.toolbar("addtoolbarbutton","id-edit-item",ir,"tooltip",33,33,-1,!0,function(){Rc(c(!1))},i);f.toolbar("addtoolbarbutton","id-delete-item",or,"tooltip",55,55,-1,!0,function(){dh(c(!1),Fh)},i);f.toolbar("addtoolbarbutton","id-new-relation",nr,"tooltip",53,53,-1,!0,function(){mp(c(d.B==Ia),d.B==Ia?e()+1:
-1)},i);f.toolbar("addtoolbarbutton","id-delete-relation",Sj,"tooltip",55,55,-1,!0,function(){We(d.B==Ia&&c(!1)>=0?f.data("psc").data("rid"):-1,i,Uf)},i);f.toolbar("addtoolbarbutton","id-import-image",kr,"tooltip",194,194,-1,!0,function(){ob(c(!1),"","","",!1,i)},i);f.toolbar("addtoolbarbutton","id-open-attachments",lr,"tooltip",288,288,-1,!0,function(){Sc(c(!1),!1,-1)},i);b.wikipediaimport&&f.toolbar("addtoolbarbutton","id-import-wikipedia-article",jr,"tooltip",198,198,-1,!0,function(){Tc(c(!1),
"")},i);f.toolbar("addrow");f.toolbar("addtoolbarbutton","id-undo",tr,"tooltip",90,90,-1,!0,function(){uf(!0,1)},i);f.toolbar("addtoolbarbutton","id-redo",ur,"tooltip",92,92,-1,!0,function(){uf(!1,1)},i);f.toolbar("addtoolbarbutton","id-copy-item",qr,"tooltip",338,338,-1,!0,function(){fh(c(!1),i)},i);f.toolbar("addtoolbarbutton","id-cut-item",rr,"tooltip",342,342,-1,!0,function(){yj(c(!1),c(!0))},i);f.toolbar("addtoolbarbutton","id-paste-item",sr,"tooltip",340,340,-1,!0,function(){zj()},i);f.toolbar("addtoolbarbutton",
"id-reset-item-shift",vr,"tooltip",322,322,-1,!0,function(){jp(c(!1))},i);f.toolbar("addtoolbarbutton","id-reset-item-shifts",wr,"tooltip",348,348,-1,!0,function(){lp()},i)})();(function(){var c=C.find(".relationtoolbar").mouseenter(function(c){var b=C.find(".relationselector").data("rid");d.j.Hc(new h(0,0,-1,d.j.ja[b],-1),c,!1);a.fn.C.close(i,".relationtoolbar,.relationselector");a(".relationtoolbar").show()}).toolbar({}).hide();c.toolbar("addtoolbarbutton","id-edit-relation",pr,"tooltip",33,33,
-1,!0,function(){var a=C.find(".relationselector").data("rid");Xe(a)},i);c.toolbar("addtoolbarbutton","id-delete-relation",Sj,"tooltip",55,55,-1,!0,function(){var a=C.find(".relationselector").data("rid");We(a,i,Uf)},i)})();(function(){var a=C.find(".newrelationbar").toolbar({}).hide();De(a.toolbar("addtoolbarbutton","id-drag-to-endpoint",xr,"tooltip",57,57,-1,!1,i,i));Cx(a.toolbar("addemptycell"));a.find(".selectrelateditem").bind("focus",function(){a.is(":visible")&&Mb&&a.css({left:"10px",top:"10px"})});
a.toolbar("addtoolbarbutton","id-cancel-new-relation",yr,"tooltip",55,55,-1,!1,function(){Mg()},i)})();(function(){a("<div></div>").addClass("newfirstitembtn").appendTo(C.find(".ikmap")).text(zr).bindMouseOrTouchEvent("mousedown",function(){if(!C.find(".editoverlay").is(":visible"))return Hc(-1,-1,"","","","","","","",i),!1}).myDisableSelection(!1)})();qb()||C.unbind("contextmenu.kmEvents").bind("contextmenu.kmEvents",function(c){if(!c.target.isContentEditable&&!a(c.target).is(":input,.kbb-searchresults *"))return!1});
a(document).unbind("keydown.kmEvents").bind("keydown.kmEvents",function(c){var e=c.which?c.which:c.keyCode;if(!a(document.activeElement).is(":input,[contenteditable]")&&C.find(".editoverlay:visible").length==0&&a(".ui-widget-overlay:visible").length==0)if(e==13){if(d.H&&d.j){var c=H(),f=J();f>=0?Xe(f):c>=0&&Rc(c);return!1}}else if(e==46){if(d.H)if(f=J(),f>=0)return We(f,i,Uf),!1;else if(c=H(),c>=0)return dh(c,Fh),!1}else if(e==8){if(ec&&ec.Ge())return!1}else if(e==37||e==38||e==39||e==40)(c=Ja(e==
37,e==39,e==38,e==40))&&c.trigger("click");else if((c.ctrlKey||c.metaKey)&&e==67){if(d.H&&d.j)return fh(H(),i),!1}else if((c.ctrlKey||c.metaKey)&&e==69){if(b.editmode)return Ui(!d.H),!1}else if((c.ctrlKey||c.metaKey)&&e==70)return c.shiftKey?(C.find(".id-search-items-gallery").sidegallery("show",!0,d.T==0?0:500,function(a){a&&gb(0,P,!1,!1,!1)}),Dh.toolbarbtn("setselected",!0),tb&&tb.find(".kbb-searchresults").empty(),id&&id.val("").focus()):C.find(".search").focus(),!1;else if((c.ctrlKey||c.metaKey)&&
e==71)c=H(),c!=P&&(d.load(c,-1,"",Xb,!0,!1,xe+1),U()&&Oc({action:"onitemselected",i:c,r:-1,search:"",setasroot:1,redraw:1}));else if((c.ctrlKey||c.metaKey)&&e==75){if(d.H&&d.j)return c.shiftKey?(e=H(),c=-1):(e=Ga(),c=aa()+1),Hc(e,c,"","","","","","","",i),!1}else if((c.ctrlKey||c.metaKey)&&e==78){if(window.onNewKnowledgeBaseShortcutPressed)return window.onNewKnowledgeBaseShortcutPressed(),!1}else if((c.ctrlKey||c.metaKey)&&e==79){if(window.onOpenKnowledgeBaseShortcutPressed)return window.onOpenKnowledgeBaseShortcutPressed(),
!1}else if((c.ctrlKey||c.metaKey)&&e==80){if(window.onPrintDiagramShortcutPressed)return window.onPrintDiagramShortcutPressed(),!1}else if((c.ctrlKey||c.metaKey)&&e==83){if(window.onSaveKnowledgeBaseShortcutPressed)return window.onSaveKnowledgeBaseShortcutPressed(),!1}else if((c.ctrlKey||c.metaKey)&&e==86){if(d.H&&d.j)return zj(),!1}else if((c.ctrlKey||c.metaKey)&&e==88){if(d.H&&d.j)return yj(H(),Ga()),!1}else if((c.ctrlKey||c.metaKey)&&e==89){if(d.H&&d.j)return uf(!1,1),!1}else if((c.ctrlKey||c.metaKey)&&
e==90){if(d.H&&d.j)return uf(c.shiftKey!==!0,1),!1}else if((c.ctrlKey||c.metaKey)&&(e==187||e==189||e==48))return ip(e==187?1.05:e==189?1/1.05:0),!1;if(e==27){Pb=!0;if(Gp||Ub)return!1;if(Wb)return Hf(i),!1;if($b)return ld(i),!1;if(window.onbackbtnpressed(!1))return!1}});d.Lf();new Iw(C.find(".kmappage")[0]);a.ajaxSetup({timeout:6E4,type:"POST"});a(document).ajaxError(function(){Jw=Kw=1;cg();Lh()});Oe(b.editmode);Hb&&Hb.galleryitem("setselected",d.H);Fb&&Fb.toolbarbtn("setselected",d.H);Gb&&Gb.toolbarbtn("setselected",
!d.H);d.Df==2?(hb.sidegallery("show",!0,0,i),Yd.toolbarbtn("setselected",!0)):d.Df<=0&&Yd.hide();xd(d.D,d.M,d.rotation,d.$);a(window).resize(function(c){c.target==window&&(a(".fullscreenpage").length>0&&gb(0,P,!1,!1,!1),a("#docframe").is(":visible")&&a("#doccontent").width(a("#doccontainer").width()).height(Math.max(0,a("#doccontainer").height()-a("#docheader").height())))});a(".kmappage").unbind("scroll.tableview").bind("scroll.tableview",function(){Lc();Ma&&!L.zoom&&!L.dragged&&(Ma=i,a("html,body").removeClass("cursormove"))});
a("body,html,.kmappage").unbind("scroll.diagram").bind("scroll.diagram",function(){if(!(d==i||d.j==i||d.B==Ia||Ma&&L.zoom)){var c=a(this).data("lastscrollposleft"),b=a(this).data("lastscrollpostop");typeof c==="undefined"&&(c=0);typeof b==="undefined"&&(b=0);var e=a(this).scrollLeft(),f=a(this).scrollTop();if(e!=c||f!=b)if(a.fn.C.close(),a(this).data("lastscrollposleft",e),a(this).data("lastscrollpostop",f),this==a(".kmappage")[0]){var c=d.j.Oc!=i,b=a(this).width(),g=a(this).height(),h=C.find(".canvas1"),
j=h.position(),m=parseInt(h.attr("width")),p=parseInt(h.attr("height"));if(j.left>e||j.top>f||j.left+m<e+b||j.top+p<f+g)c?oe([h]):d.j.he();c||(h=C.find(".canvas5"),j=h.position(),m=parseInt(h.attr("width")),p=parseInt(h.attr("height")),(j.left>e||j.top>f||j.left+m<e+b||j.top+p<f+g)&&d.j.Pc(1E3,!1,!0,!0))}}});C.find(".itemselector,.relationselector,.textselector,.itemtoolbar,.relationtoolbar").mouseleave(function(c){if(!d.lc(c))if(d.B==Ia)C.find(".textlayer"),Lc();else{if(d.j&&(c=d.j.Qb(c))&&c.Ua>=
0&&this==C.find(".relationselector")[0])return;a.fn.C.close()}});b.fullscreen&&go(!0);if(!U()&&!qb()&&!Bb()&&!Cb()){var xj={action:"getdatabaseid",resetdatabaseid:0,database:O};a.ajax({url:b.baseurl+nc+b.scriptextension,dataType:"json",data:xj,success:function(a){P=d.xf(a,!1);P<0&&(P=b.rootitemid);d.load(P,-1,P<0?b.rootitemname:"",0,!0,!1,xe+1)}})}Oa=!1;b.editmode&&typeof window.localStorage!=="undefined"&&b.editmode&&b.knowledgebasegallery&&(window.localStorage.getItem("showintro")==i&&(Oa=!0),window.localStorage.setItem("showintro",
0));if(Oa&&!a(".ui-dialog").is(":visible")){var Xf=i,Oa={};Oa[bs]=function(){Xf.dialog("close");xp(b.language,C,d,B,O)};Oa[eb]=function(){Xf.dialog("close")};a.fn.C.close();Xf=a("<div></div>");Ya(function(){Xf.text(as)});Xf.dialog({modal:!0,closeOnEscape:!1,resizable:!1,buttons:Oa,title:$r,width:375,position:{my:"center",at:"center"},open:function(){a(this).parent(".ui-dialog").find("*").myDisableSelection(!1)},close:function(){a(this).dialog("destroy")}})}})}}})(jQuery);var xe=-1,Jw=0,Kw=0;jQuery.easing.smoothEasing=function(a,e,b,g,f){return g*((e=e/f-1)*e*e+1)+b};function Yf(a){for(var e=0,b=arguments.length;e<b;e++)if($(arguments[e]).scrollTop()>0)return arguments[e];else{$(arguments[e]).scrollTop(1);var g=$(arguments[e]).scrollTop()>0;$(arguments[e]).scrollTop(0);if(g)return arguments[e]}return""}
function Wk(a,e,b){var g=a.css("overflow-x")=="scroll"&&e!=0,f=a.css("overflow-y")=="scroll"&&b!=0,h=!1;g&&f&&U()&&a.css("visibility")=="visible"&&(a.css("visibility","hidden"),h=!0);g&&(a[0].scrollLeft+=e);f&&(a[0].scrollTop+=b);h&&a.css("visibility","visible")}
function Zf(a,e,b){var g=a.css("overflow-x")=="scroll"&&a.scrollLeft()!=e,f=a.css("overflow-y")=="scroll"&&a.scrollTop()!=b,h=!1;g&&f&&U()&&a.css("visibility")=="visible"&&(a.css("visibility","hidden"),h=!0);if(g)a[0].scrollLeft=e;if(f)a[0].scrollTop=b;h&&a.css("visibility","visible")}function Lw(a){return a.css("overflow-x")=="scroll"?a.scrollLeft():0}function Mw(a){return a.css("overflow-y")=="scroll"?a.scrollTop():0}
function jf(){var a=window.navigator.userAgent,e=!!a.match(/iPad/i)||!!a.match(/iPhone/i),b=!!a.match(/WebKit/i);return e&&b&&!a.match(/CriOS/i)}function ye(){return window.navigator.vendor&&window.navigator.vendor.match(/apple/i)}function Xk(){$("input[type=text].search").first().focus().blur()}
$.fn.extend({myDisableSelection:function(a){var e={"user-select":"none","-o-user-select":"none","-moz-user-select":"-moz-none","-khtml-user-select":"none","-webkit-user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)","-webkit-touch-callout":"none"},b={"-moz-user-select":"text"};return this.each(function(){var g=this.nodeName.toLowerCase();!a&&(g=="input"||g=="textarea"||g=="button"||$(this).attr("contenteditable")=="true")?this.hasAttribute("unselectable")&&($(this).removeAttr("unselectable"),
$(this).css(b)):this.hasAttribute("unselectable")||($(this).attr("unselectable","on"),$(this).css(e));this.onselectstart=function(b){return typeof b!=="undefined"&&b.target==this?(b=this.nodeName.toLowerCase(),!a&&(b=="input"||b=="textarea"||b=="button"||$(this).attr("contenteditable")=="true")):!0}})},bindFirst:function(a,e){this.on(a,e);this.each(function(){var b=$._data(this,"events")[a.split(".")[0]],e=b.pop();b.splice(0,0,e)})}});
function Ih(a,e,b){return Ya(function(){function g(a){j.execCommand(a,!1,i)}var f=a[0],h=f.contentWindow?f.contentWindow:f.contentDocument.defaultView,j=f.contentDocument?f.contentDocument:f.contentWindow.document;j.open();j.write('<!DOCTYPE html><html><head><base target="_blank"><link type="text/css" href="'+Gc+'" rel="stylesheet"/><style>'+(qb()?"html{width:calc(100% - 16px);height:calc(100% - 16px);overflow:auto;-ms-overflow-style:scrollbar;}":"html{width:100%;height:100%;}")+" "+("body{margin:0;padding:8px;"+
(qb()?"":"width:calc(100% - 16px);min-height:calc(100% - 16px);overflow:auto;-ms-overflow-style:scrollbar;")+"font-family:"+e+";font-size:"+b+";line-height:1.45;background-color:#FFF;color:#000;user-select:text;-o-user-select:text;-moz-user-select:text;-khtml-user-select:text;-webkit-user-select:text;-ms-user-select:text;}")+' body p,body div{margin:0px;} body[contenteditable="true"] .mathformula{background-color:#FF0;} body[contenteditable="true"] fmath *,body[contenteditable="true"] math *{background-color:#DDD;} span.autohilite{display:inline-block;} span.autohilite a{text-decoration:none;cursor:pointer;} font[size="1"]{font-size:0.63em;} font[size="2"]{font-size:0.82em;} font[size="3"]{font-size:1.0em;} font[size="4"]{font-size:1.13em;} font[size="5"]{font-size:1.5em;} font[size="6"]{font-size:2em;} font[size="7"]{font-size:3em;} .kbb-default-font-size{font-size:16px !important;} hr{border-width:1px 0 0 0;border-style:solid;border-color:currentColor;}</style></head><body onClick="body.focus();"></body></html>');
j.close();j.body.contentEditable="true";qb()&&$(h).bind("paste.kmEvents",function(a){if(typeof a.originalEvent!=="undefined"&&typeof a.originalEvent.clipboardData!=="undefined"){var b=a.originalEvent.clipboardData.items;if(b)for(var e=0;e<b.length;e++)if(b[e].kind=="string"&&b[e].type.indexOf("html")!==-1)return a=a.originalEvent.clipboardData.getData(b[e].type),b=a.indexOf("<"),b>0&&(a=a.substr(b)),b=a.lastIndexOf(">"),b<a.length-1&&(a=a.substr(0,b+1)),j.execCommand("insertHTML",!1,a),!1}});$(j).unbind("keydown.kmEvents").bind("keydown.kmEvents",
function(a){var b=a.which?a.which:a.keyCode;if(a.ctrlKey||a.metaKey)if(b==66)return g("bold"),!1;else if(b==73)return g("italic"),!1;else if(b==85)return g("underline"),!1;else if(b==83)return g("strikeThrough"),!1});return[h,j]})}function Mh(a){$(".overlay").length==0?($("<div></div>").addClass("overlay").fadeTo(0,a).appendTo($("body")),Jw=1):Jw++;Gp&&$.fn.C.close()}function Lh(){$(".overlay").length==0?Jw=0:(Jw--,Jw<=0&&($(".overlay").remove(),Jw=0))}
function bg(a){if($(".waitanim").length==0){$("<div></div>").addClass("waitbk").fadeTo(0,0).appendTo($("body"));var e=$("<div></div>").addClass("waitanim").appendTo($("body")),b=$("<div><span class='waittext'>"+a+"</span><span id='wp0'>.</span><span id='wp1'>.</span><span id='wp2'>.</span><span id='wp3'>.</span><span id='wp4'>.</span></div>").addClass("waitinl").appendTo($("<td align='center' valign='middle'></td>").appendTo($("<tr></tr>").appendTo($("<table width='100%' height='100%'></table>").appendTo(e)))),
g=0,a=function(){for(var a=0;a<5;a++)a<g?b.children("#wp"+a).removeClass("waitpt"):b.children("#wp"+a).addClass("waitpt");g++;g>5&&(g=0)};a();e.data("interval",setInterval(a,250));Kw=1}else Kw++}function cg(){$(".waitanim").length==0?Kw=0:(Kw--,Kw<=0&&(clearInterval($(".waitanim").data("interval")),$(".waitbk").remove(),$(".waitanim").remove(),Kw=0))}function kf(a,e){Mh(e?e:0);bg(a)}window.kbb_disableScreenAndWait=kf;function lf(){cg();Lh()}window.kbb_enableScreenAndStopWait=lf;
function Iw(a){(a=a||a.querySelector(a))&&a.addEventListener&&a.addEventListener("touchstart",function(){var e=a.scrollTop;if(e<=0)a.scrollTop=1;if(e+a.offsetHeight>=a.scrollHeight)a.scrollTop=a.scrollHeight-a.offsetHeight-1},!1)}
function hf(a,e,b){var g,f,h,a=Math.max(0,Math.min(360,a)),e=Math.max(0,Math.min(100,e)),b=Math.max(0,Math.min(100,b));e/=100;b/=100;if(e==0)return g=e=b,[Math.round(g*255),Math.round(e*255),Math.round(b*255)];a/=60;g=Math.floor(a);f=a-g;a=b*(1-e);h=b*(1-e*f);f=b*(1-e*(1-f));switch(g){case 0:g=b;e=f;b=a;break;case 1:g=h;e=b;b=a;break;case 2:g=a;e=b;b=f;break;case 3:g=a;e=h;break;case 4:g=f;e=a;break;default:g=b,e=a,b=h}return[Math.round(g*255),Math.round(e*255),Math.round(b*255)]}
function ff(a,e,b){var g,f,h,a=Math.max(0,Math.min(255,a)),e=Math.max(0,Math.min(255,e)),b=Math.max(0,Math.min(255,b));g=Math.min(a,e,b);f=Math.max(a,e,b);h=f-g;f==0?(a=-1,g=0):h==0?g=a=0:(g=h/f,a=a==f?(e-b)/h:e==f?2+(b-a)/h:4+(a-e)/h,a*=60,a<0&&(a+=360));return[a,100*g,100*(f/255)]}function mg(a,e,b){return(0.299*a[0]+0.587*a[1]+0.114*a[2])/255>0.75?b:e}function $e(a){return"rgb("+a[0]+","+a[1]+","+a[2]+")"}function gf(a,e){return"rgba("+a[0]+","+a[1]+","+a[2]+","+e+")"}
jQuery.fn.offset=function(a){if(arguments.length)return typeof a==="undefined"?this:this.each(function(b){jQuery.offset.setOffset(this,a,b)});var e=0,b=0,g=this[0];if(g){do if(b+=g.offsetTop||0,e+=g.offsetLeft||0,g.offsetParent==document.body)break;while(g=g.offsetParent);for(g=this[0];g=g.parentNode;)typeof g!=="undefined"&&g.tagName!="BODY"&&g.tagName!="HTML"&&(b-=g.scrollTop||0,e-=g.scrollLeft||0)}return{left:e,top:b}};
function Yg(a,e,b){try{var b=typeof b==="undefined"?document:b,g=(typeof e==="undefined"?window:e).getSelection();if(g.rangeCount>0){var f=g.getRangeAt(0),h=b.createRange();h.selectNodeContents(a);h.setEnd(f.startContainer,f.startOffset);var j=(h+"").length;return{start:j,end:j+(f+"").length,after:f.startOffset>0&&f.startContainer.nodeType==3,scrollX:Lw($(a)),scrollY:Mw($(a))}}}catch(m){}return{start:0,end:0,after:!1,scrollX:Lw($(a)),scrollY:Mw($(a))}}
function bh(a,e,b,g){var f=Yg(a,b,g);if(!(f.start==e.start&&f.end==e.end))try{var b=typeof b==="undefined"?window:b,g=typeof g==="undefined"?document:g,h=$(":focus");if(!(h.length>0&&h[0]!=a)){var j=g.createRange();if(e.start<0&&e.end<0)j.selectNodeContents(a),j.collapse(!1);else{var h=0,g=[a],f=i,m=!1,o=!1,x=i;j.setStart(a,0);for(j.collapse(!0);!o&&(f=g.pop());)if(x=f,f.nodeType==3){var s=h+f.length;if(!m&&e.start>=h&&(e.start<s||e.after&&e.start==s))j.setStart(f,e.start-h),m=!0;m&&e.end>=h&&e.end<=
s&&(j.setEnd(f,e.end-h),o=!0);h=s}else for(var r=f.childNodes,A=r.length;A>0;)A-=1,g.push(r[A]);x&&(m||j.setStart(x,x.length),o||j.setEnd(x,x.length))}var p=b.getSelection();p.removeAllRanges();p.addRange(j);Zf($(a),e.scrollX,e.scrollY)}}catch(E){}}function qf(a){a.focus();if(a[0].setSelectionRange)a[0].setSelectionRange(0,0);else if(a[0].createTextRange){var e=a[0].createTextRange();e.collapse(!0);e.moveStart("character",0);e.moveEnd("character",0);e.select()}a.scrollTop(0);a.scrollLeft(0)}
function Kh(a,e,b){try{var b=typeof b==="undefined"?document:b,g=(typeof e==="undefined"?window:e).getSelection();if(g.getRangeAt&&g.rangeCount){var f=g.getRangeAt(0);f.deleteContents();var h=b.createElement("div");h.innerHTML=a;for(var j=b.createDocumentFragment(),m,o;m=h.firstChild;)o=j.appendChild(m);f.insertNode(j);o&&(f=f.cloneRange(),f.setStartAfter(o),f.collapse(!0),g.removeAllRanges(),g.addRange(f))}}catch(x){}}
function Vg(a,e){function b(a){var e=!1;if(!h.test(a.nodeName))if(a.nodeType==1){j.push(a);for(var f=0;f<a.childNodes.length;f++)b(a.childNodes[f])&&(e=!0);e&&j.push(a)}else a.nodeType==3&&(j.push(a),e=!0);return e}function g(a,b){var e=Array(b+1).join("  "),j,m,p;if(a.nodeType==1){j=f.test(a.nodeName);for(var E=0;E<a.childNodes.length;E++){m=a.childNodes[E];if(m.nodeType==3)for(p=40;p+1<m.nodeValue.length;p+=40+e.length)if(p=m.nodeValue.indexOf(" ",p),p>=0)m.nodeValue=m.nodeValue.substr(0,p)+"\n"+
e+m.nodeValue.substr(p+1);else break;if(m.nodeType==1&&f.test(m.nodeName)){if(b>0||E>0)j=document.createTextNode("\n"+e),a.insertBefore(j,m),E++;h.test(m.nodeName)||g(m,b+1);j=document.createTextNode("\n"+e);m.appendChild(j);j=!0}else{if(j&&b>0&&(m.nodeType==3||m.nodeType==1))j=document.createTextNode("\n"+e),a.insertBefore(j,m),E++;j=!1;m.nodeType==1&&!h.test(m.nodeName)&&g(m,b+1)}}}return a}var f=/^(address|blockquote|body|br|center|dir|div|dl|fieldset|form|h[1-6]|hr|isindex|menu|noframes|noscript|ol|p|pre|table|ul|dd|dt|frameset|li|tbody|td|tfoot|th|thead|tr|html)$/i,
h=/^(pre|code|samp)$/i,j=[],m=document.createElement("div");m.innerHTML=a;m.normalize();b(m);(function(){for(var a,b,e,g,h=0;h<j.length;h++)if(a=j[h],a.nodeType==3){e=!1;h>0&&(b=j[h-1],b.nodeType==1?!f.test(b.nodeName)&&h>1&&(b=j[h-2],b.nodeType==1?f.test(b.nodeName)||(e=!0):e=!0):e=!0);g=!1;h<j.length-1&&(b=j[h+1],b.nodeType==1?!f.test(b.nodeName)&&h<j.length-2&&(b=j[h+2],b.nodeType==1?f.test(b.nodeName)||(g=!0):g=!0):g=!0);a.nodeValue=a.nodeValue.replace(/[\r\n\t ]+/g," ");if(!e&&a.nodeValue.length>
0&&a.nodeValue[0]==" ")a.nodeValue=a.nodeValue.substr(1);if(!g&&a.nodeValue.length>0&&a.nodeValue[a.nodeValue.length-1]==" ")a.nodeValue=a.nodeValue.substr(0,a.nodeValue.length-1)}})();m.normalize();e&&(m=g(m,0),m.normalize());return m.innerHTML}function Nh(a){a=a.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(a,b,g,f){return b+b+g+g+f+f});return(a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a))?[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]:i}
function Jh(a){try{var e=a.match(/^rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i);return e&&e.length==4?[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]:i}catch(b){try{var g=parseInt(a),f=Math.floor(g/65536);if(f<0||f>255)return i;g-=f*65536;var h=Math.floor(g/256);if(h<0||h>255)return i;g-=h*256;a=g;return a<0||a>255?i:[f,h,a]}catch(j){}}return i}
function Th(a,e,b){function g(a,b,e){e.x=b.x-a.x;e.y=b.y-a.y;e.Gc=Math.sqrt(e.x*e.x+e.y*e.y);e.qc=e.x/e.Gc;e.tc=e.y/e.Gc;e.Le=Math.atan2(e.tc,e.qc)}var f,h,j,m,o,x,s,r,A,p,E;a.beginPath();h=b;r={};A={};m=e.length;o=e[m-1];for(f=0;f<m;f++)x=e[f%m],s=e[(f+1)%m],g(x,o,r),g(x,s,A),o=r.qc*A.tc-r.tc*A.qc,j=r.qc*A.qc-r.tc*-A.tc,E=Math.asin(o<-1?-1:o>1?1:o),o=1,p=!1,j<0?E<0?E=Math.PI+E:(E=Math.PI-E,o=-1,p=!0):E>0&&(o=-1,p=!0),h=x.mg!==ea?x.mg:b,E/=2,j=Math.abs(Math.cos(E)*h/Math.sin(E)),j>Math.min(r.Gc/2,
A.Gc/2)?(j=Math.min(r.Gc/2,A.Gc/2),E=Math.abs(j*Math.sin(E)/Math.cos(E))):E=h,h=x.x+A.qc*j,j=x.y+A.tc*j,h+=-A.tc*E*o,j+=A.qc*E*o,a.arc(h,j,E,r.Le+Math.PI/2*o,A.Le-Math.PI/2*o,p),o=x,x=s;a.closePath()}function Nw(a,e){var b,g,f=1E6,h;$.each(colorbrewer,function(j,m){if(typeof m[e.toString()]!=="undefined")for(var o=0;o<e;o++){var x=Nh(m[e.toString()][o]);x&&(h=Math.pow(Math.pow(x[0]-a[0],2)+Math.pow(x[1]-a[1],2)+Math.pow(x[2]-a[2],2),0.5),h<f&&(b=j,g=o,f=h))}});return[b,g,f]}
function fg(a){var e=0;typeof a.pageX==="undefined"?typeof a.originalEvent.touches!=="undefined"&&a.originalEvent.touches.length>0&&typeof a.originalEvent.touches[0].pageX!=="undefined"?e=a.originalEvent.touches[0].pageX:typeof a.originalEvent.changedTouches!=="undefined"&&a.originalEvent.changedTouches.length>0&&typeof a.originalEvent.changedTouches[0].pageX!=="undefined"?e=a.originalEvent.changedTouches[0].pageX:typeof a.originalEvent.pageX!=="undefined"&&(e=a.originalEvent.pageX):e=a.pageX;return e}
function lg(a){var e=0;typeof a.pageY==="undefined"?typeof a.originalEvent.touches!=="undefined"&&a.originalEvent.touches.length>0&&typeof a.originalEvent.touches[0].pageY!=="undefined"?e=a.originalEvent.touches[0].pageY:typeof a.originalEvent.changedTouches!=="undefined"&&a.originalEvent.changedTouches.length>0&&typeof a.originalEvent.changedTouches[0].pageY!=="undefined"?e=a.originalEvent.changedTouches[0].pageY:typeof a.originalEvent.pageY!=="undefined"&&(e=a.originalEvent.pageY):e=a.pageY;return e}
function Qh(a){var e=0.55*Math.PI;if(a.length>2){for(var b=1;b<a.length-1;){var g=Ok(a[b],a[b-1]),f=Ok(a[b+1],a[b]),h=Math.acos(Ow(g,f));Math.abs(g.x-f.x)<1.0E-4&&Math.abs(g.y-f.y)<1.0E-4||Math.abs(h)>e?a.splice(b,1):b++}a.shift();a.pop();return a}return i}function yp(a,e){var b=[],e=e.replace(/src="data:image[^"]*"/g,function(a){b.push(a);return'src="#imageRef'+b.length+'"'});a.data("imagerefs",b);return e}
function Og(a,e){var b=a.data("imagerefs");b&&(e=e.replace(/src="#imageRef([0-9]*)"/g,function(a,e){return e>0&&e<=b.length?b[e-1]:""}));return e}function gd(){function a(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}var Ef="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
function we(a){try{var e="",b,g,f,h,j,m,o,x=0,s;s=a.replace(/\r\n/g,"\n");for(var r="",A=0;A<s.length;A++){var p=s.charCodeAt(A);p<128?r+=String.fromCharCode(p):(p>127&&p<2048?r+=String.fromCharCode(p>>6|192):(r+=String.fromCharCode(p>>12|224),r+=String.fromCharCode(p>>6&63|128)),r+=String.fromCharCode(p&63|128))}for(a=r;x<a.length;)b=a.charCodeAt(x++),g=a.charCodeAt(x++),f=a.charCodeAt(x++),h=b>>2,j=(b&3)<<4|g>>4,m=(g&15)<<2|f>>6,o=f&63,isNaN(g)?m=o=64:isNaN(f)&&(o=64),e=e+Ef.charAt(h)+Ef.charAt(j)+
Ef.charAt(m)+Ef.charAt(o);return e}catch(E){return""}}
function ve(a){try{for(var e="",b,g,f,h,j,m,o,x=0,a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");x<a.length;)h=Ef.indexOf(a.charAt(x++)),j=Ef.indexOf(a.charAt(x++)),m=Ef.indexOf(a.charAt(x++)),o=Ef.indexOf(a.charAt(x++)),b=h<<2|j>>4,g=(j&15)<<4|m>>2,f=(m&3)<<6|o,e+=String.fromCharCode(b),m!=64&&(e+=String.fromCharCode(g)),o!=64&&(e+=String.fromCharCode(f));a="";for(h=f=g=b=0;b<e.length;)g=e.charCodeAt(b),g<128?(a+=String.fromCharCode(g),b++):g>191&&g<224?(f=e.charCodeAt(b+1),a+=String.fromCharCode((g&31)<<
6|f&63),b+=2):(f=e.charCodeAt(b+1),h=e.charCodeAt(b+2),a+=String.fromCharCode((g&15)<<12|(f&63)<<6|h&63),b+=3);return a}catch(s){return""}}
function ef(a,e,b){if(e.A.tb.length>0){for(var g=0,a=$('<span class="kbb-itemtable"></span>').appendTo(a),f=(b?"<span>":"")+'<table cellspacing="0">',g=0;g<e.A.tb.length;g++)e.A.tb[g].n==""&&e.A.tb[g].v==""||(f+=e.A.tb[g].n==""||e.A.tb[g].v==""?'<tr><td colspan="2"></td></tr>':"<tr><td></td><td></td></tr>");f+="</table>"+(b?"</span>":"");a.html(f);for(var h=a.find("td"),j=0,g=0;g<e.A.tb.length;g++){var b=jd($.trim(e.A.tb[g].n)),m=hd($.trim(e.A.tb[g].n)),f=jd($.trim(e.A.tb[g].v)),o=hd($.trim(e.A.tb[g].v));
e.A.tb[g].n!=""&&(m?Ya(function(){$(h[j]).html(m)}):$(h[j]).text(b),Za($(h[j]),!1),j++);e.A.tb[g].v!=""&&(o?Ya(function(){$(h[j]).html(o)}):$(h[j]).text(f),Za($(h[j]),!1),j++)}return a}return i}function Rd(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var e=Math.random()*16|0;return(a=="x"?e:e&3|8).toString(16)}).toUpperCase()}
function mf(a){if((a.keyCode||a.which)==9){a.preventDefault();var e=this.selectionStart,b=this.selectionEnd,g=this.value,f=g.substring(e,b),h,j,m;a.shiftKey?(a=/^\t/gm,j=-1,m=""):(a=/^/gm,j=1,m="\t");if(h=f.match(a))h=j*h.length,this.value=g.substring(0,e)+f.replace(a,m)+g.substring(b),this.selectionStart=e===b?b+h:e,this.selectionEnd=b+h}};function X(a,e){return{x:a,y:e}}function $h(a){return Math.sqrt(a.x*a.x+a.y*a.y)}function Ik(a,e){var b=e.x-a.x,g=e.y-a.y;return Math.sqrt(b*b+g*g)}function Ph(a,e){return{x:a.x+e.x,y:a.y+e.y}}function Zi(a,e,b){b!=0&&(e=Ph(a,Z(Ok(e,a),Ik(e,a)+b)));return e}function Vh(a,e){return{x:a.x-e.x,y:a.y-e.y}}function Z(a,e){return{x:a.x*e,y:a.y*e}}function Oh(a,e){return e==0?{x:0,y:0}:{x:a.x/e,y:a.y/e}}function Yi(a){return Oh(a,$h(a))}function Ok(a,e){return Yi(Vh(a,e))}
function Pk(a){return{x:-a.y,y:a.x}}function Oi(a){return Math.atan2(a.y,a.x)}function Ow(a,e){return a.x*e.x+a.y*e.y}function Pw(a,e,b,g){var f=a.x,a=a.y,h=e.x,j=e.y,e=b.x,m=b.y,o=g.x,x=g.y,g=h-f,b=j-a,s=o-e,r=x-m,f=h*a-f*j,a=o*m-e*x,h=r*g-b*s;return h==0?{x:1E9,y:1E9}:{x:(s*f-g*a)/h,y:(r*f-b*a)/h}}function wj(a,e,b,g){var f=e=Ok(e,a);if(g>b)var h=b,b=g,g=h,f=Pk(f);f=Math.cos(Oi(f));return Ph(a,Z(e,g/Math.sqrt(1-(b*b-g*g)/(b*b)*f*f)))}
function Sk(a,e,b,g){function f(a,e){return Ph(a,Z(Pk(Ok(e,a)),b))}function h(a,g,h){var j=f(a,g),r=f(g,h),A=Pw(j,Ph(j,Vh(g,a)),r,Ph(r,Vh(h,g))),p=Vh(g,a),E=Vh(A,j),E=(Ow(p,E)>=0?1:-1)*$h(E);E-$h(p)>2*b?(p=Yi(Ph(Pk(Ok(g,a)),Pk(Ok(h,g)))),A=Pk(p),p=Ph(g,Z(p,2*b)),a=Pw(j,Ph(j,Vh(g,a)),p,Ph(p,A)),g=Pw(p,Ph(p,A),r,Ph(r,Vh(h,g))),Ik(a,r)>4*b||Ik(g,r)>4*b?e.push(r):(e.push(a),e.push(g))):E>0&&e.push(A)}var j=0;if(a.length>1)if(g)for(j=a.length-1;j>=0;j--)j==0?e.push(Ph(a[0],Z(Pk(Ok(a[0],a[1])),b))):j==
a.length-1?e.push(f(a[a.length-1],a[a.length-2])):h(a[j+1],a[j],a[j-1]);else for(j=0;j<a.length;j++)j==0?e.push(f(a[0],a[1])):j==a.length-1?e.push(Ph(a[a.length-1],Z(Pk(Ok(a[a.length-1],a[a.length-2])),b))):h(a[j-1],a[j],a[j+1])}function Tk(a,e,b,g,f){for(var h=0,h=1;h<a.length;h++){for(var j=Vh(a[h],a[h-1]),m=Yi(j),j=$h(j)-(h==a.length-1?f:0);g<j;)e.push(Ph(a[h-1],Z(m,g))),g+=b;g-=j}}
function Uh(a,e){for(var b=0,g=0,f,h,j=X(0,0),b=0;b<a.length;b++){f=a[b];h=a[b>=a.length-1?0:b+1];var m=Vh(h,f),m=Pw(f,Ph(f,m),e,Ph(e,Pk(m))),o;Math.abs(Vh(h,f).x*Vh(m,f).y-Vh(h,f).y*Vh(m,f).x)>0.001?o=!1:(o=Ow(Vh(m,f),Vh(h,f)),o=o<0?!1:o>Math.pow(Ik(h,f),2)?!1:!0);o||(m=Ik(e,f)<Ik(e,h)?f:h);h=m;f=$h(Vh(h,e));if(b==0||f<g)g=f,j=h}return j}
function Hk(a,e,b,g){return g=="rect"?[X(a.x-0.5*e,a.y-0.5*b),X(a.x+0.5*e,a.y-0.5*b),X(a.x+0.5*e,a.y+0.5*b),X(a.x-0.5*e,a.y+0.5*b)]:g=="rhomb"?[X(a.x-0.5*e,a.y),X(a.x,a.y-0.5*b),X(a.x+0.5*e,a.y),X(a.x,a.y+0.5*b)]:g=="hexagon"?[X(a.x-0.5*e,a.y),X(a.x-0.25*e,a.y-0.5*b),X(a.x+0.25*e,a.y-0.5*b),X(a.x+0.5*e,a.y),X(a.x+0.25*e,a.y+0.5*b),X(a.x-0.25*e,a.y+0.5*b)]:g=="triangle"?[X(a.x,a.y-0.5*b),X(a.x+0.5*e,a.y+0.5*b),X(a.x-0.5*e,a.y+0.5*b)]:g=="para"?[X(a.x-0.33*e,a.y-0.5*b),X(a.x+0.5*e,a.y-0.5*b),X(a.x+
0.33*e,a.y+0.5*b),X(a.x-0.5*e,a.y+0.5*b)]:g=="trapez"?[X(a.x-0.33*e,a.y-0.5*b),X(a.x+0.33*e,a.y-0.5*b),X(a.x+0.5*e,a.y+0.5*b),X(a.x-0.5*e,a.y+0.5*b)]:[]}function Kk(a){for(var e=0,b=0;b<a.length;b++)e=b==0?a[b].x:Math.min(e,a[b].x);return e}function Jk(a){for(var e=0,b=0;b<a.length;b++)e=b==0?a[b].x:Math.max(e,a[b].x);return e}function Mk(a){for(var e=0,b=0;b<a.length;b++)e=b==0?a[b].y:Math.min(e,a[b].y);return e}
function Lk(a){for(var e=0,b=0;b<a.length;b++)e=b==0?a[b].y:Math.max(e,a[b].y);return e}function Gk(a,e,b){for(var g=Ik(e,a),f=0;f<b.length;f++){var h=b[f],j=b[f==b.length-1?0:f+1],m=Pw(a,e,h,j);if(Ik(m,h)+Ik(m,j)-Ik(h,j)<1.0E-4&&Ik(e,m)<g)return m}return a}
function Lg(a,e,b){if(b.length<=0)return!1;(b[0].x!=b[b.length-1].x||b[0].y!=b[b.length-1].y)&&b.push(b[0]);for(var g=b[b.length-1].x,f=b[b.length-1].y,h=0,j=0,m=g,o=0,x=!1,s=0,r=0,r=0;r<b.length;r++){h=b[r].x;j=b[r].y;if(x)if(j==e){if(m<a==a<h||h==a)return!1}else f<e==e<j&&o++,x=!1,g=h,f=j;else if(j==e&&h>=a){if(h==a)return!1;x=!0}else{if(f<e==e<j)if(a<Math.min(g,h))o++;else if(!(a>Math.max(g,h)))if(a<(s=(h-g)*(e-f)/(j-f)+g))o++;else if(s==a)return!1;g=h;f=j}m=h}return(o&1)>0?!0:!1}
function Qk(a,e){a.moveTo(e.x,e.y)}function Rk(a,e){a.lineTo(e.x,e.y)}function Vk(a,e,b){a.quadraticCurveTo(e.x,e.y,b.x,b.y)}function Uk(a,e,b){a.arc(e.x,e.y,b,0,2*Math.PI)}function Nk(a,e){if(!(e.length<2)){Qk(a,e[0]);for(var b=1;b<e.length;b++)Rk(a,e[b])}};var Qw;
(function(){function a(a){var b=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,o=Number.NEGATIVE_INFINITY,x;for(x=a.length;x--;)a[x][0]<b&&(b=a[x][0]),a[x][0]>g&&(g=a[x][0]),a[x][1]<e&&(e=a[x][1]),a[x][1]>o&&(o=a[x][1]);a=g-b;g=o-e;o=Math.max(a,g);b+=a*0.5;e+=g*0.5;return[[b-20*o,e-o],[b,e+20*o],[b+20*o,e-o]]}function e(a,b,e,m){var o=a[b][0],x=a[b][1],s=a[e][0],r=a[e][1],A=a[m][0],p=a[m][1],E=Math.abs(x-r),B=Math.abs(r-p),I,F;if(E<g&&B<g)throw Error("Eek! Coincident points!");E<
g?(a=(s+o)/2,E=-((A-s)/(p-r))*(a-(s+A)/2)+(r+p)/2):B<g?(a=(A+s)/2,E=-((s-o)/(r-x))*(a-(o+s)/2)+(x+r)/2):(I=-((s-o)/(r-x)),F=-((A-s)/(p-r)),o=(o+s)/2,A=(s+A)/2,x=(x+r)/2,p=(r+p)/2,a=(I*o-F*A+p-x)/(I-F),E=E>B?I*(a-o)+x:F*(a-A)+p);s-=a;r-=E;return{Jd:b,Od:e,Pd:m,x:a,y:E,r:s*s+r*r}}function b(a){var b,e,g,o,x,s;for(e=a.length;e;){o=a[--e];g=a[--e];for(b=e;b;)if(s=a[--b],x=a[--b],g===x&&o===s||g===s&&o===x){a.splice(e,2);a.splice(b,2);break}}}var g=1/1048576;Qw={Fg:function(f,h){var j=f.length,m,o,x,s,
r,A,p,E,B;if(j<3)return[];f=f.slice(0);if(h)for(m=j;m--;)f[m]=f[m][h];x=Array(j);for(m=j;m--;)x[m]=m;x.sort(function(a,b){return f[b][0]-f[a][0]});m=a(f);f.push(m[0],m[1],m[2]);s=[e(f,j+0,j+1,j+2)];r=[];A=[];for(m=x.length;m--;A.length=0){B=x[m];for(o=s.length;o--;)p=f[B][0]-s[o].x,p>0&&p*p>s[o].r?(r.push(s[o]),s.splice(o,1)):(E=f[B][1]-s[o].y,p*p+E*E-s[o].r>g||(A.push(s[o].Jd,s[o].Od,s[o].Od,s[o].Pd,s[o].Pd,s[o].Jd),s.splice(o,1)));b(A);for(o=A.length;o;)E=A[--o],p=A[--o],s.push(e(f,p,E,B))}for(m=
s.length;m--;)r.push(s[m]);s.length=0;for(m=r.length;m--;)r[m].Jd<j&&r[m].Od<j&&r[m].Pd<j&&s.push(r[m].Jd,r[m].Od,r[m].Pd);return s},contains:function(a,b){if(b[0]<a[0][0]&&b[0]<a[1][0]&&b[0]<a[2][0]||b[0]>a[0][0]&&b[0]>a[1][0]&&b[0]>a[2][0]||b[1]<a[0][1]&&b[1]<a[1][1]&&b[1]<a[2][1]||b[1]>a[0][1]&&b[1]>a[1][1]&&b[1]>a[2][1])return i;var e=a[1][0]-a[0][0],g=a[2][0]-a[0][0],o=a[1][1]-a[0][1],x=a[2][1]-a[0][1],s=e*x-g*o;if(s===0)return i;g=(x*(b[0]-a[0][0])-g*(b[1]-a[0][1]))/s;e=(e*(b[1]-a[0][1])-o*
(b[0]-a[0][0]))/s;return g<0||e<0||g+e>1?i:[g,e]}}})();var Rh={none:function(a,e,b,g,f,h,j){h=i;a&&a.getContext&&(h=a.getContext("2d"));a=Rh.od(h,e,b,g,f,e,b);a+=Rh.rect(h,0,0,e,b,j,i,i,i);a+=Rh.nd(h);return a},perspective:function(a,e,b,g,f,h,j){var m=i;a&&a.getContext&&(m=a.getContext("2d"));var a=0,o=e/h,h=b/h,x=o/2,s=0.425*h,r=0,A=0,p=0,E=!0,B=!0,e=Rh.od(m,e,b,g,f,o,h);e+=Rh.rect(m,0,0,o,h,j,i,i,i);e+=Rh.Af(m,i,mg(j,[168,168,168],[88,88,88]),1,[2,2]);e+=Rh.oc(m,x,0,x+s,h);for(a=1;E||B;a++)r=x-a*35,A=x-a*175+s,A<0?(p=r*h/(r-A),A=0):p=h,(E=r>0||A>0)&&
(e+=Rh.oc(m,r,0,A,p)),r=x+a*35,A=x+a*175+s,A>o?(p=(o-r)*h/(A-r),A=o):p=h,(B=r<o||A<o)&&(e+=Rh.oc(m,r,0,A,p));e+=Rh.Xe(m);e+=Rh.nd(m);return e},"checkered-paper":function(a,e,b,g,f,h,j){var m=i;a&&a.getContext&&(m=a.getContext("2d"));a=e/h;h=b/h;e=Rh.od(m,e,b,g,f,a,h);e+=Rh.yg(m);e+=Rh.Bg(m,"checkered-pattern",0,0,20,20,0,0,40,40);e+=Rh.rect(Rh.uc,0,0,40,40,j,i,i,i);e+=Rh.Af(Rh.uc,i,mg(j,[192,192,192],[64,64,64]),1,[1,1]);e+=Rh.oc(Rh.uc,39,0,39,40);e+=Rh.oc(Rh.uc,0,39,40,39);e+=Rh.Xe(Rh.uc);e+=Rh.Wf(m);
e+=Rh.Vf(m);e+=Rh.rect(m,0,0,a,h,i,"checkered-pattern",i,i);e+=Rh.nd(m);return e},"edge-circles":function(a,e,b,g,f,h,j){function m(a){return p[2]<2?Nh(colorbrewer[p[0]][r.toString()][(p[1]+a)%r]):hf((E[0]+a*A)%360,E[1],E[2])}var o=i;a&&a.getContext&&(o=a.getContext("2d"));var a=e/h,h=b/h,x=Math.min(a,h),s=0,r=8,A=360/r,p=Nw(j,r),E=ff(j[0],j[1],j[2]),e=Rh.od(o,e,b,g,f,a,h);e+=Rh.rect(o,0,0,a,h,[255,255,255],i,i,i);for(b=10;b<=100;b+=10)s=0.01*b*x,e+=Rh.yc(o,0.5*a,-0.1*h,s,m(4),i,i,0.1),e+=Rh.yc(o,
0.5*a,1.1*h,s,m(0),i,i,0.1),b<=70&&(e+=Rh.yc(o,0,0,s,m(2),i,i,0.25)),b<=60&&(e+=Rh.yc(o,a,0,s,m(3),i,i,0.25)),b<=60&&(e+=Rh.yc(o,0,h,s,m(7),i,i,0.25)),b<=70&&(e+=Rh.yc(o,a,h,s,m(6),i,i,0.25));e+=Rh.nd(o);return e},triangles:function(a,e,b,g,f,h,j){function m(a){return E[2]<2?Nh(colorbrewer[E[0]][A.toString()][(E[1]+a)%A]):hf((B[0]+a*p)%360,B[1],B[2])}function o(a,b,e,f,g,h){function j(a){return Math.max(0,Math.min(255,parseInt(m*p*T[a]+(1-m)*p*ca[a]+m*(1-p)*F[a]+(1-m)*(1-p)*I[a])))}var m=(a+e+g)/
(3*s),p=(b+f+h)/(3*r),a=ff(j(0),j(1),j(2));return hf(a[0],a[1],a[2]+15*(Rh.qe()-0.5))}var x=i;a&&a.getContext&&(x=a.getContext("2d"));var s=e/h,r=b/h,A=8,p=360/A,E=Nw(j,A),B=ff(j[0],j[1],j[2]);Rh.qg=142321;for(var I=m(0),F=m(2),ca=m(6),T=m(4),h=4+parseInt(s/200),j=4+parseInt(r/200),V=s/(h-3),da=r/(j-3),a=Array(h*j),N=0;N<h;N++)for(var ka=0;ka<j;ka++)a[N*j+ka]=[(N-1+0.4*(Rh.qe()-0.5))*V,(ka-1+0.4*(Rh.qe()-0.5))*da];e=Rh.od(x,e,b,g,f,s,r);e+=Rh.rect(x,0,0,s,r,[255,255,255],i,i,i);b=Qw.Fg(a);for(g=b.length-
1;g>1;g-=3)e+=Rh.Eg(x,a[b[g]][0],a[b[g]][1],a[b[g-1]][0],a[b[g-1]][1],a[b[g-2]][0],a[b[g-2]][1],o(a[b[g]][0],a[b[g]][1],a[b[g-1]][0],a[b[g-1]][1],a[b[g-2]][0],a[b[g-2]][1]));e+=Rh.nd(x);return e},getDataURL:function(a,e,b,g,f,h,j,m){return Rh[e](a,b,g,f,h,j,m)==""?"":"data:image/svg+xml;base64,"+we(Rh[e](a,b,g,f,h,j,m))},od:function(a,e,b,g,f,h,j){return a?(a.save(),a.setTransform(1,0,0,1,g,f),a.scale(e/h,b/j),a.lineWidth=h/e,""):'<svg width="'+e+'" height="'+b+'" viewBox="0 0 '+h+" "+j+'" xmlns="http://www.w3.org/2000/svg">'},
nd:function(a){return a?(a.restore(),""):"</svg>"},Af:function(a,e,b,g,f){if(a){a.save();if(e)a.fillStyle=$e(e);if(b)a.strokeStyle=$e(b);if(g)a.lineWidth=g;f&&typeof a.setLineDash!=="undefined"&&a.setLineDash(f);return""}else return"<g"+(e?' fill="'+$e(e)+'"':"")+(b?' stroke="'+$e(b)+'"':"")+(g?' stroke-width="'+g+'"':"")+(f?' stroke-dasharray="'+f.join(",")+'"':"")+">"},Xe:function(a){return a?(a.restore(),""):"</g>"},yg:function(a){return a?"":"<defs>"},Vf:function(a){return a?"":"</defs>"},Bg:function(a,
e,b,g,f,h,j,m,o,x){if(a){a=$("<canvas></canvas>");a.attr("width",f).attr("height",h);if((a=a[0])&&a.getContext)Rh.mf=a,Rh.uc=a.getContext("2d"),Rh.uc.scale(f/o,h/x);return""}else return'<pattern id="'+e+'" x="'+b+'" y="'+g+'" width="'+f+'" height="'+h+'" viewBox="'+j+" "+m+" "+o+" "+x+'" patternUnits="userSpaceOnUse">'},Wf:function(a){return a?(Rh.pattern=a.createPattern(Rh.mf,"repeat"),""):"</pattern>"},rect:function(a,e,b,g,f,h,j,m,o){if(a){a.save();if(h)a.fillStyle=$e(h);if(j&&Rh.pattern)a.fillStyle=
Rh.pattern;a.fillRect(e,b,g,f);a.restore();return""}else return'<rect x="'+e+'" y="'+b+'" width="'+g+'" height="'+f+'" style="'+(h?"fill:rgb("+h[0]+","+h[1]+","+h[2]+"); ":"")+(j?"fill:url(#"+j+"); ":"")+(m?"filter:url(#"+m+"); ":"")+(o?"opacity:"+o+"; ":"")+'stroke:none" />'},oc:function(a,e,b,g,f){return a?(a.beginPath(),a.moveTo(e,b),a.lineTo(g,f),a.stroke(),""):'<line x1="'+e+'" y1="'+b+'" x2="'+g+'" y2="'+f+'" />'},yc:function(a,e,b,g,f,h,j,m){return a?(a.save(),f=f[0]+","+f[1]+","+f[2],a.strokeStyle=
a.fillStyle=m?"rgba("+f+","+m+")":"rgb("+f+")",a.beginPath(),a.arc(e,b,g,0,2*Math.PI),a.closePath(),a.fill(),a.stroke(),a.restore(),""):'<circle cx="'+e+'" cy="'+b+'" r="'+g+'" style="'+(f?"fill:rgb("+f[0]+","+f[1]+","+f[2]+"); ":"")+(h?"fill:url(#"+h+"); ":"")+(j?"filter:url(#"+j+"); ":"")+(m?"opacity:"+m+"; ":"")+'stroke:none" />'},Eg:function(a,e,b,g,f,h,j,m){return a?(a.save(),a.fillStyle=a.strokeStyle=$e(m),a.beginPath(),a.moveTo(e,b),a.lineTo(g,f),a.lineTo(h,j),a.closePath(),a.fill(),a.stroke(),
a.restore(),""):'<path d="M'+e+","+b+"L"+g+","+f+"L"+h+","+j+'Z" fill="'+$e(m)+'" stroke="'+$e(m)+'" />'},seed:1,mf:i,uc:i,pattern:i,qe:function(){var a=Math.sin(Rh.qg++)*1E4;return a-Math.floor(a)}};window.lastTooltipItemID=-1;window.lastTooltipRelationID=-1;
(function(a){var e=i;a.fn.kbbtooltip=a.fn.C=function(b){e=a.extend({url:"none",action:"none",diagram:i,openAttachments:i,openDocument:i,rootItemID:-1,id:-1,idfrom:-1,idto:-1,alignment:{body:"right",pointer:"left"},fadeOnBlur:!1,fadeOnBlurExceptions:[".ttip",".ui-datepicker-calendar",".ui-datepicker-header"],fadeIn:!0,onOpenCallback:fa(),hOffset:13,vOffset:3,left:0,top:0,width:0,moveTop:!0,searchEngines:i,database:"sqlite://knowledgebase.kdb"},b);a.fn.C.obj=".ttip";if(this.length==0)a.fn.C.init(),
a.fn.C.alignTo(i,e.hOffset,e.vOffset,e.left,e.top,e.width),e.url!="none"&&a.fn.C.ajax();else return this.each(function(){a.fn.C.init();a.fn.C.alignTo(a(this),e.hOffset,e.vOffset,e.left,e.top,e.width);e.url!="none"&&a.fn.C.ajax()})};a.extend(a.fn.C,{alignTo:function(b,g,f,h,j,m){var o=a.fn.C.obj,x=b?b.offset():i,j=x?x.top:j,h=x?x.left:h,s;g===ea&&(g=e.hOffset);f===ea&&(f=e.vOffset);e.alignment.body==="right"?g+=b?b.outerWidth():m:e.alignment.body=="left"&&(s=a(window).width()-h+g-13);j-=f;h+=g;a(o).css("display")!=
"none"&&a(o).stop().fadeTo(0,1);a(o).css("display")!="none"?a(o).stop().animate({left:h,top:j},0):typeof s==="undefined"?a(o).css({left:h,top:j}):a(o).css({right:s,top:j})},ajax:function(){a.fn.C.closed=!1;var b={action:e.action,id:e.id,idfrom:e.idfrom,idto:e.idto,database:e.database};U()?(b=Oc(b),a.fn.C.success(b)):qb()?Pc(b,function(b){a.fn.C.success(a.parseJSON(b))}):Bb()?dd(b,function(b){a.fn.C.success(a.parseJSON(b))}):Cb()?fd(b,function(b){a.fn.C.success(a.parseJSON(b))}):a.ajax({cache:!1,url:e.url,
dataType:"json",data:b,success:function(b){a.fn.C.success(b)}})},bindings:function(b){qb()||a(b).unbind("contextmenu.kmEvents").bind("contextmenu.kmEvents",function(b){if(!a(b.target).is('input,div[contenteditable="true"]'))return!1});a(b).find("div.ttip-pointer").unbind("click.kmEvents").bind("click.kmEvents",function(){var b=a.fn.C.directlinkurl;if(e.id>=0)if(e.idfrom>=0&&e.idto>=0){var f=e.id;e.diagram&&e.diagram.H?U()?Oc({action:"onrelationselected",i:e.idfrom,r:f,redraw:1}):e.diagram.j.Ga(-1,
f,!0,!1,!0):b!=""&&a.fn.C.openDirectLinkURL(b)}else f=e.id,b==""?f!=e.rootItemID&&(e.diagram&&e.diagram.load(f,-1,"",Xb,!0,!1,xe+1),U()&&Oc({action:"onitemselected",i:f,r:-1,search:"",setasroot:1,redraw:1})):a.fn.C.openDirectLinkURL(b)});a.fn.C.isBound||a(document).click(function(b){if(b.button===0&&e.fadeOnBlur){for(var f=e.fadeOnBlurExceptions.length,h=!1,j=0;j<f;++j)if(a(b.target).parents(e.fadeOnBlurExceptions[j]).length||a(b.target).is(e.fadeOnBlurExceptions[j])){h=!1;break}else h=!0;h&&a.fn.C.close()}});
a.fn.C.isBound=!0},close:function(b,e){typeof e==="undefined"&&(e="");a(".itemselector,.relationselector,.textselector,.itemtoolbar,.relationtoolbar").not(e).hide();var f=a(a.fn.C.obj).length;a.fn.C.closedelayed=!0;a.fn.C.closed=!0;a.fn.C.initialized=!0;b||(b=a(".ttip"));a.fn.C.initialized&&a(b).is(":visible")&&(f?a(b).stop().hide(0,function(){a(this).remove();a.fn.C.initialized=!1}):a.fn.C.initialized=!1);return!1},closedelayed:!1,closed:!0,destroy:function(){a("body").find(".ttip").hide(0).remove();
a.fn.C.initialized=!1},directlinkurl:"",initialized:!1,init:function(){a(".ttip").remove();var b=a('<div class="ttip"><div class="ttip-content"></div></div>').appendTo("body");a.fn.C.obj=b;b.append('<div class="ttip-pointer toolbaricon ttip-pointer-'+e.alignment.pointer+'"></div>');a.fn.C.bindings(b)},openDirectLinkURL:function(a){var g=!1;a.length>3&&a.substring(a.length-3)=="\u00a7if"&&(g=!0,a=a.substring(0,a.length-3));var f=a.length>=7&&a.substring(0,7).toLowerCase()=="file://";if(a.length>=9&&
a.substring(0,9).toLowerCase()=="itemid://")a=parseInt(a.substring(9)),isNaN(a)||(e.diagram&&e.diagram.load(a,-1,"",Xb,!0,!1,xe+1),U()&&Oc({action:"onitemselected",i:a,r:-1,search:"",setasroot:1,redraw:1}));else if(g&&!f)e.openDocument&&e.openDocument(a);else if(U())Oc({action:"shellexecute",file:a});else if(Cb())fd({action:"launchurl",file:a},fa());else if((qb()||Bb())&&f)a={action:"launchfile",file:a},qb()?Pc(a,fa()):Bb()&&dd(a,fa());else if(qb())try{var h=new window.Windows.Foundation.Uri(a);window.Windows.System.Launcher.launchUriAsync(h)}catch(j){}else window.open(a,
"_blank","")},open:function(){var b=a.fn.C.obj;a(b).css("display")=="none"&&a(b).stop().fadeIn(e.fadeIn?300:0)},success:function(b){if(a(".editoverlay").is(":visible")||a(".overlay").is(":visible"))a(".itemselector,.relationselector,.textselector,.itemtoolbar,.relationtoolbar").hide();else if(b.r==0&&!a.fn.C.closed){var g=!1,f=!1,h="",j="",m="",o="";if(typeof b.n!=="undefined"&&b.n!=i){h=Ad(a.trim(b.n));if(h==""&&(typeof b.t==="undefined"||b.t==i||b.t=="")&&b.a.length==0)return;h="<b>"+h+"</b>";g=
!0}else if(typeof b.nf!=="undefined"&&typeof b.nt!=="undefined"&&typeof b.nr!=="undefined"&&b.nf!=i&&b.nt!=i&&b.nr!=i){j=Ad(a.trim(b.nf));m=Ad(a.trim(b.nt));o=Ad(a.trim(b.nr));if(j==""&&m==""&&(o==""||o==">>")&&(typeof b.t==="undefined"||b.t==i||b.t=="")&&b.a.length==0)return;h="<b>"+j+" </b><i><small>"+o+"</small></i><b> "+m+"</b>";f=!0}if((g||f)&&typeof b.t!=="undefined"&&b.t!=i)if((typeof b.i!=="undefined"&&b.i==window.lastTooltipItemID||typeof b.ri!=="undefined"&&b.ri==window.lastTooltipRelationID)&&
h.length>0){var f=0,g=jd(b.t),x=hd(b.t),s=a.fn.C.obj,j=e.alignment.body=="left",r='<div class="tthead',A=typeof b.u!=="undefined"&&b.u!=i?b.u:"";a.fn.C.directlinkurl=A;j&&(r+=" ttheadright");r+='"><table border="0" cellpadding="0" cellspacing="0"><tr>';j||(r+='<td class="tttitle" align="left"></td>');m=Ya(function(){return encodeURIComponent(a("<div></div>").html(h).text().replace(" >> "," "))});if(m.length>0&&e.searchEngines){r+='<td><ul class="kbb-popupmenu kbb-popupmenu-down"><li><div class="kbb-sectionpopup"><div class="kbb-sectionpopupframe"></div><div class="kbb-sectionpopupicon"></div></div><ul>';
for(f=0;f<e.searchEngines.length;f++)r+='<li><a href="'+e.searchEngines[f][0].replace("*u*",m)+'" target="_blank">'+e.searchEngines[f][1]+"</a></li>";r+="</ul></li></ul></td>"}j&&(r+='<td class="tttitle" align="right"></td>');r+="</tr></table></div>";if(g.length>0||x&&x.length>=64||b.a.length>0)r+='<div class="ttbody">';if(b.a.length>0){r+='<div class="ttimages">';for(f=0;f<b.a.length;f++)r+='<div class="ttimg'+(b.a[f].c!=0||A!=""?" ttactive":"")+(b.a[f].f!=0?" ttborder":"")+'" data-index="'+f+'" data-recordid="'+
b.a[f].r+'"><img src="data:image/png;base64,'+b.a[f].i+'"></img></div>';r+="</div>"}if(g.length>0||x&&x.length>=64)r+='<div class="tttext"></div>';if(g.length>0||x&&x.length>=64||b.a.length>0)r+="</div>";a.fn.C.open();Ya(function(){r=a.fn.C.obj.find(".ttip-content").empty().append(r)});f=Ya(function(){return a(r).find("td.tttitle").html(h)});Za(f,!1);var p=a(r).find("div.tttext");x?(Ya(function(){p.html(x)}),p.find("a").unbind("click.kmEvents").bind("click.kmEvents",function(){var b=a(this).attr("href"),
f=a(this).attr("target");return b?(f&&f.toLowerCase()=="_blank"||qb()||Bb()||Cb()?U()?Oc({action:"shellexecute",file:b}):Cb()?fd({action:"launchurl",file:b},fa()):qb()?(b=new window.Windows.Foundation.Uri(b),window.Windows.System.Launcher.launchUriAsync(b)):window.open(b,"_blank",""):e.openDocument&&e.openDocument(b),!1):!0})):p.text(g);Za(p,!1);a(r).find("div.ttimg.ttactive").bind("click.kmEvents",function(){var f=a(this).data("index"),g=a(this).data("recordid");b.a[f].c!=0?e.openAttachments&&(typeof b.ri!==
"undefined"?e.openAttachments(b.ri,!0,g):e.openAttachments(b.i,!1,g)):A!=""&&a.fn.C.openDirectLinkURL(A);return!1});a(r).myDisableSelection(!1);a(r).find("*").myDisableSelection(!1);var g=a(window).scrollTop(),f=a(window).height(),E=a(a.fn.C.obj).offset().top,B=a(a.fn.C.obj).outerHeight(),j=a.fn.C.obj.find(".ttip-pointer"),m=j.position().top;if(E+B>g+f-20){o=e.moveTop?Math.max(g,g+f-B-20):E;E=o-E;if(o+B>g+f-20){var I=a.fn.C.obj.find(".ttbody"),F=I.height(),B=g+f-20-o-B;a.fn.C.obj.outerHeight(g+f-
20-o);I.height(F+B).css("overflow-y","auto")}a.fn.C.obj.css("top",o);j.css("top",m-E)}e.onOpenCallback(b);a(s).find(".kbb-popupmenu>li").bindMouseOrTouchEvent("mouseenter",function(b){vb(b)||ca(a(this),!0)}).bindMouseOrTouchEvent("mouseleave",function(b){if(!vb(b)){var e=fg(b),b=lg(b),f=a(this).children("div.kbb-sectionpopup"),g=f.offset();g.left+=2;g.top+=2;var h=f.outerWidth()-4,f=f.outerHeight()-4,j=a(this).children("ul"),m=j.offset();m.left+=2;m.top+=2;var p=j.outerWidth()-4,j=j.outerHeight()-
4,o=m.top>g.top,r=[];r.push(X(g.left,g.top));r.push(X(g.left,g.top+f));o?(r.push(X(m.left,m.top+j)),r.push(X(m.left+p,m.top+j)),r.push(X(m.left+p,m.top)),r.push(X(g.left+h,m.top)),r.push(X(g.left+h,g.top))):(r.push(X(g.left+h,g.top+f)),r.push(X(g.left+h,m.top+j)),r.push(X(m.left+p,m.top+j)),r.push(X(m.left+p,m.top)),r.push(X(m.left,m.top)));Lg(e,b,r)||ca(a(this),!1)}}).bindMouseOrTouchEvent("click",function(b){var e=fg(b),b=lg(b),f=a(this).children("ul"),g=f.offset();g.left+=2;g.top+=2;var h=f.outerWidth()-
4,f=f.outerHeight()-4,j=[];j.push(X(g.left,g.top));j.push(X(g.left,g.top+f));j.push(X(g.left+h,g.top+f));j.push(X(g.left+h,g.top));if(!Lg(e,b,j))return e=a(this),b=e.children("ul"),ca(e,!b.is(":visible")),!1});var ca=function(b,e){var f=a(s).find(".kbb-popupmenu"),g=b.children("ul"),h=b.find(".kbb-sectionpopupframe");if(e){g.css({height:"auto","overflow-y":"visible"});var j=f.offset().top-a(window).scrollTop(),m=h.height(),p=g.height(),o=a(window).height();j+m+p<o-30||j+m/2<o/2?(f.addClass("kbb-popupmenu-down"),
f.removeClass("kbb-popupmenu-up"),j+m+p>o-30&&g.css({"overflow-y":"auto",height:Math.max(Math.min(100,p),o-m-j-30)+"px"})):(f.addClass("kbb-popupmenu-up"),f.removeClass("kbb-popupmenu-down"),j-p<30&&g.css({"overflow-y":"auto",height:Math.max(Math.min(100,p),j-30)+"px"}));g.stop(!0,!0).fadeTo("fast",1);h.stop(!0,!0).fadeTo("fast",1)}else g.stop(!0,!0).hide(),h.stop(!0,!0).hide()}}}}})})(jQuery);(function(a){a.fn.sidegallery=function(e){if(typeof this.data(e)==="function")return this.data(e).apply(this,Array.prototype.slice.call(arguments,1));else if(typeof e==="object"||!e){var b=a.extend({id:"",width:"200px",expandindex:0,borderifhidden:"",overlaymode:!0,toolbar:!1,"toolbar-background-color":"#1871B9",header:!0,headerText:"",textBtnText:"",sideGalleryGroup:[],closeBtnTooltip:"",expandBtnTooltip:"",textBtnTooltip:"",pinBtnTooltip:"",textBtnSelected:-1,closeDiagramTooltipOnBody:!0,onClose:i,
onClosed:i,onRemainderSizeChanged:i,onTextBtnClick:i,onSideGalleryPin:i,animateTransitions:i},e);return this.each(function(){function e(){a.fn.C.close()}function f(a){return m()?(j(!1,a,i),!0):!1}function h(){a.each(b.sideGalleryGroup,function(a,b){b.sidegallery("closeifnotpinned")})}function j(e,f,g){function h(){if(e)I?m=="100%"&&p.hide():r.css("width",m),o();else{r.hide();var a=r.parents(".kbb-sidegalleryremainder").last();a.length>0&&a.find(".kbb-sidegallery:visible").length==0&&a.css("border-left",
"none");b.onSideGalleryPin&&F&&(F=!1,V.toolbaricon("seticonindex",214,215))}p.removeClass("kbb-resizing");r.removeClass("kbb-resizing");g!=i&&g(x);if(!e&&j&&b.onClosed)b.onClosed(r);if(!e&&j&&b.onRemainderSizeChanged&&x&&g==i)b.onRemainderSizeChanged(r)}var j=r.is(":visible"),m=e?E?b.width[B]:b.width:"0px",p=r.parent().children(".kbb-sidegalleryremainder"),s=b.overlaymode&&!F||!e?"0px":m,A=p.css("left"),x=s!=A,H=!1,N=0;a.each(b.sideGalleryGroup,function(a,b){b[0]!=r[0]&&b.is(":visible")&&!b.sidegallery("ispinned")&&
(a==0?N=b.width():H=!0)});if(!e&&j&&b.onClose)b.onClose(r);x&&(!b.overlaymode||F&&(!e||!j||A!="0px"))?p.addClass("kbb-resizing"):r.addClass("kbb-resizing");e?(b.overlaymode&&!j&&!x&&!H?r.css("left","-"+(parseInt(m)-N)+"px"):r.css("left","0px"),r.show(),a.each(b.sideGalleryGroup,function(a,e){e[0]!=r[0]&&!e.sidegallery("ispinned")&&e.sidegallery("show",!1,b.overlaymode||b.animateTransitions&&b.animateTransitions()==0?0:500,i)}),I?r.css("width",m):p.show()):p.show();b.borderifhidden!=""&&p.css("border-left",
e||p.find(".kbb-sidegallery:visible").length==0?"none":b.borderifhidden);e&&o();x?p.stop().animate({left:s},f,"smoothEasing",function(){a(this).css("left",s);h()}):b.overlaymode&&!j&&!H&&e?r.stop().animate({left:"0px"},f,"smoothEasing",function(){r.css("left","0px");h()}):b.overlaymode&&j&&!e?r.stop().animate({left:"-"+r.css("width")},f,"smoothEasing",function(){r.css("left","-"+r.css("width"));h()}):h()}function m(){return r.length>0&&r.is(":visible")}function o(){var a=0;ca&&(a+=ca.outerHeight());
H&&H.is(":visible")&&(H.toolbar("setlast"),a+=H.outerHeight(),H.height()>H.children().height()&&(a+=4));Ga.css("top",a+"px")}function x(a){return a?function(b,e,f){h();a(b,e,f)}:a}function s(a){F=a;V&&V.toolbaricon("seticonindex",F?216:214,F?217:215);b.overlaymode&&j(!0,b.animateTransitions&&b.animateTransitions()==0?0:500,function(a){if(b.onRemainderSizeChanged&&a)b.onRemainderSizeChanged(r)})}var r=a(this),A=i,p=i,E=typeof b.width!=="string",B=b.expandindex,I=!1,F=!1;r.addClass(b.id+" kbb-sidegallery").css("width",
E?b.width[B]:b.width);a('<div class="editoverlay"></div>').appendTo(r);var ca=i,T=i,V=i,da=i,N=i,ka=i,ka=0;if(b.header){var Y='<div class="kbb-sidegalleryheader"><table><tr><td style="width: 100%;">'+b.headerText+"</td>";b.onTextBtnClick&&(Y+='<td><div style="padding-left:8px"></div></td>');b.onSideGalleryPin&&(Y+='<td style="width:33px;"><div style="padding-left:8px"></div></td>');E&&(Y+='<td style="width:33px;"><div style="padding-left:8px"></div></td><td style="width:33px;"><div style="padding-left:8px"></div></td>');
Y+='<td style="width:33px;"><div style="padding-left:8px"></div></td></tr></table></div>';ca=a(Y).appendTo(r);Y=ca.find("tr td>div");if(b.onTextBtnClick){T=a(Y[ka]);ka++;T.toolbarbtn({text:b.textBtnText,tooltip:b.textBtnTooltip,iconindex:-1,iconhilightindex:-1,selected:b.textBtnSelected,"round-left":!0,"round-right":!0,onClick:b.onTextBtnClick});var aa=T.clone().find("div").css("display","inline-block");a("body").append(aa);T.parent().width(aa.outerWidth());aa.remove()}b.onSideGalleryPin&&(V=a(Y[ka]),
ka++,V.toolbaricon({index:214,hilightindex:215,width:19,height:19,color:"#FFF",border:!0,hover:i}),V.attr("title",b.pinBtnTooltip).css("cursor","pointer").bind("click",function(){s(!F);b.onSideGalleryPin(F)}));E&&(N=a(Y[ka]),ka++,N.toolbaricon({index:204,hilightindex:205,width:19,height:19,color:"#FFF",border:!0,hover:i}),B==0&&N.parent().hide(),N.attr("title",b.expandBtnTooltip).css("cursor","pointer").bind("click",function(){B>0&&(B--,I=!1,j(!0,b.animateTransitions&&b.animateTransitions()==0?0:
500,function(a){da.parent().show();B==0&&N.parent().hide();if(b.onRemainderSizeChanged&&a)b.onRemainderSizeChanged(r)}))}),da=a(Y[ka]),ka++,da.toolbaricon({index:202,hilightindex:203,width:19,height:19,color:"#FFF",border:!0,hover:i}),B==b.width.length-1&&da.parent().hide(),da.attr("title",b.expandBtnTooltip).css("cursor","pointer").bind("click",function(){B<b.width.length-1&&(B++,I=!0,j(!0,b.animateTransitions&&b.animateTransitions()==0?0:500,function(a){N.parent().show();B==b.width.length-1&&da.parent().hide();
if(b.onRemainderSizeChanged&&a)b.onRemainderSizeChanged(r)}))}));ka=a(Y[ka]);ka.toolbaricon({index:80,hilightindex:81,width:19,height:19,color:"#FFF",border:!0,hover:i});ka.attr("title",b.closeBtnTooltip).css("cursor","pointer").bind("click",function(){f(b.animateTransitions&&b.animateTransitions()==0?0:500)})}var H=i;b.toolbar&&(H=a('<div class="kbb-sidegallerytoolbar"></div>').appendTo(r).toolbar({"background-color":b["toolbar-background-color"]}));var Ga=a('<div class="kbb-sidegallerybody"></div>').appendTo(r);
(ca||H)&&Ga.css("padding-top","0px");ca&&ca.bindMouseOrTouchEvent("mousemove",e);H&&H.bindMouseOrTouchEvent("mousemove",e);b.closeDiagramTooltipOnBody&&Ga.bindMouseOrTouchEvent("mousemove",e);o();a(window).resize(function(){o()});r.data("setheadertext",function(a){ca&&ca.find("td:first").text(a)});r.data("show",j);r.data("showpinned",function(a){F=a;V&&V.toolbaricon("seticonindex",F?216:214,F?217:215);j(a,0,fa())});r.data("close",f);r.data("closeifnotpinned",function(){b.overlaymode&&!F&&j(!1,0,i)});
r.data("isvisible",m);r.data("gettoolbar",function(){return H});r.data("showtoolbar",function(a){a?H.show():H.hide();o()});r.data("addtoolbarbutton",function(a,b,e,f,g,h,j,m){return H.toolbar("addtoolbarbutton",a,b,e,f,g,h,!0,j,m)});r.data("addtoolbarbuttoninverse",function(a,b,e,f,g,h,j,m,p,o){return H.toolbar("addtoolbarbuttoninverse",a,b,e,f,g,h,j,m,!0,p,o)});r.data("addtoolbartextbutton",function(a,b,e,f,g,h,j){return H.toolbar("addtoolbartextbutton",a,b,e,!1,!1,f,!0,g,h,j)});r.data("addpopupbutton",
function(a,b,e,f,g,h,j,m){return H.toolbar("addpopupbutton",a,b,e,f,g,h,!0,j,m)});r.data("addemptycelltotoolbar",function(){return H.toolbar("addemptycell")});r.data("setbodyhtml",function(a){return Ga.html(a).addClass("kbb-noscroll")});r.data("addgallery",function(){return A=a("<div></div>").appendTo(Ga).gallery({})});r.data("addgallerysection",function(a,b,e,f){return A.gallery("addgallerysection",a,b,e,f)});r.data("addgalleryitem",function(a,b,e,f,g,h,j,m,p,o){return A.gallery("addgalleryitem",
a,b,e,f,g,h,j,m,h<0&&(typeof o==="undefined"||!o)?x(p):p)});r.data("addslidergalleryitem",function(a,b,e,f,g,h,j,m,p,o,r,s,B,x){return A.gallery("addslidergalleryitem",a,b,e,f,g,h,j,m,p,o,r,s,B,x)});r.data("addgalleryitemtosection",function(a,b,e,f,g,h,j,m,p,o,r){return A.gallery("addgalleryitemtosection",a,b,e,f,g,h,j,m,p,j<0&&(typeof r==="undefined"||!r)?x(o):o)});r.data("addslidergalleryitemtosection",function(a,b,e,f,g,h,j,m,p,o,r,s,B,x,E){return A.gallery("addslidergalleryitemtosection",a,b,
e,f,g,h,j,m,p,o,r,s,B,x,E)});r.data("addcolorpickergalleryitemtosection",function(a,b,e,f,g,h,j,m){return A.gallery("addcolorpickergalleryitemtosection",a,b,e,f,g,h,j,m)});r.data("addiconpickergalleryitemtosection",function(a,b,e,f,g,h){return A.gallery("addiconpickergalleryitemtosection",a,b,e,f,g,h)});r.data("addcomboboxgalleryitemtosection",function(a,b,e,f,g,h,j){return A.gallery("addcomboboxgalleryitemtosection",a,b,e,f,g,h,j)});r.data("addpropertysheettosection",function(a,b){return A.gallery("addpropertysheettosection",
a,b)});r.data("addsidebar",function(){p=a('<div class="kbb-sidegallerybar"></div>').appendTo(Ga).toolbar({vertical:!0})});r.data("addsidebarbutton",function(a,b,e,f,g,h,j){return p.toolbar("addtoolbarbutton",a,b,e,f,g,h,!0,j,i)});r.data("setsidebarbtnselected",function(a,b){p.toolbar("setbtnselected",a,b)});r.data("setpinned",s);r.data("settextbtnselected",function(a){T&&T.toolbarbtn("setselected",a)});r.data("ispinned",function(){return F});r.data("getid",function(){return b.id});r.data("adjustlayout",
o)})}}})(jQuery);(function(a){a.fn.gallery=function(e){if(typeof this.data(e)==="function")return this.data(e).apply(this,Array.prototype.slice.call(arguments,1));else if(typeof e==="object"||!e)return a.extend({},e),this.each(function(){function b(a){return j.find("."+a)}function e(a){return function(b,e,f){m&&m(b,e,f);a&&a(b,e,f)}}function f(b){return function(e){o&&o(e);b&&b(e);a(this).closest(".kbb-combobox-gallery-item").comboboxgalleryitem("setexpanded",!1,0)}}function h(b){return function(e){x&&x(e);b&&b(e);
a(this).closest(".kbb-colorpicker-gallery-item").colorpickergalleryitem("setexpanded",!1,0)}}var j=a(this),m=i,o=i,x=i;j.addClass("kbb-gallery");j.data("addgallerysection",function(b,e,f,g){return a("<div></div>").appendTo(j).gallerysection({id:b,headertext:e,expanded:f,onBeforeExpand:typeof g!=="undefined"?g:i})});j.data("addgalleryitem",function(b,f,h,m,o,B,x,F,ca){return a("<div></div>").appendTo(j).galleryitem({id:b,text:f,tooltip:h,iconindex:m,iconhilightindex:o,selected:B,enabled:x,synchron:F,
onClick:e(ca)})});j.data("addslidergalleryitem",function(b,e,f,g,h,m,o,x,ca,T,V,da,N,ka){return a("<div></div>").appendTo(j).slidergalleryitem({id:b,text:e,tooltip:f,iconindex:g,iconhilightindex:h,min:m,max:o,step:x,value:ca,suffix:T,onClick:V,onStart:da,onSlide:N,onStop:ka})});j.data("addcomboboxgalleryitem",function(b,e,g,h,m,o){return a("<div></div>").appendTo(j).comboboxgalleryitem({id:b,text:e,tooltip:g,expanded:h,synchron:m,onitemselected:f(o)})});j.data("addcolorpickergalleryitem",function(b,
e,f,g,m,o,x,F){return a("<div></div>").appendTo(j).colorpickergalleryitem({id:b,text:e,tooltip:f,rgbcolortabletext:g,palettecolortabletext:m,colorpalette:o,synchron:x,oncolorselected:h(F)})});j.data("addgalleryitemtosection",function(a,e,f,g,h,j,m,o,x,T){return b(a).gallerysection("addgalleryitem",e,f,g,h,j,!1,m,o,x,T)});j.data("addslidergalleryitemtosection",function(a,e,f,g,h,j,m,o,x,T,V,da,N,ka,Y){return b(a).gallerysection("addslidergalleryitem",e,f,g,h,j,m,o,x,T,V,da,N,ka,Y)});j.data("addcolorpickergalleryitemtosection",
function(a,e,f,g,h,j,m,o){return b(a).gallerysection("addcolorpickergalleryitem",e,f,g,h,j,m,o)});j.data("addiconpickergalleryitemtosection",function(a,e,f,g,h,j){return b(a).gallerysection("addiconpickergalleryitem",e,f,g,h,j)});j.data("addcomboboxgalleryitemtosection",function(a,e,f,g,h,j,m){return b(a).gallerysection("addcomboboxgalleryitem",e,f,g,h,j,m)});j.data("addpropertysheettosection",function(a,e){return b(a).gallerysection("addpropertysheet",e)});j.data("setonclickhandler",function(a){m=
a});j.data("setonitemselectedhandler",function(a){o=a});j.data("setoncolorselectedhandler",function(a){x=a});j.data("hitgalleryitem",function(b){var e=fg(b),f=lg(b),g=i;j.find(".kbb-gallery-item").each(function(){var b=[],h=a(this).offset(),j=a(this).outerWidth(),m=a(this).outerHeight();b.push(X(h.left,h.top-3));b.push(X(h.left+j,h.top-3));b.push(X(h.left+j,h.top+m+3));b.push(X(h.left,h.top+m+3));if(Lg(e,f,b))return g=a(this),!1});return g});j.data("closeallexpandablesectionsexceptme",function(b){j.find(".kbb-colorpicker-gallery-item").not(b).each(function(){a(this).colorpickergalleryitem("setexpanded",
!1,200)});j.find(".kbb-iconpicker-gallery-item").not(b).each(function(){a(this).iconpickergalleryitem("setexpanded",!1,200)});j.find(".kbb-combobox-gallery-item").not(b).each(function(){a(this).comboboxgalleryitem("setexpanded",!1,200)})})})}})(jQuery);(function(a){a.fn.gallerysection=function(e){if(typeof this.data(e)==="function")return this.data(e).apply(this,Array.prototype.slice.call(arguments,1));else if(typeof e==="object"||!e){var b=a.extend({id:"",headertext:"",expanded:!0,onBeforeExpand:i},e);return this.each(function(){function e(a,g){function j(){a?(s.toolbaricon("seticonindex",84,85),g==0?r.show():r.slideDown(g,"smoothEasing")):(s.toolbaricon("seticonindex",82,83),g==0?(r.hide(),b.onBeforeExpand&&f()):r.slideUp(g,"smoothEasing",function(){b.onBeforeExpand&&
f()}));m=a}if(b.onBeforeExpand&&a)b.onBeforeExpand(h,j);else j()}function f(){r.empty()}var h=a(this),j=!0,m=!1;h.addClass(b.id+" kbb-gallery-section kbb-gallery-section-enabled");var o=a("<a></a>").appendTo(h),x=a("<span></span>").appendTo(o).text(b.headertext),s=a("<div></div>").prependTo(o).toolbaricon({index:82,hilightindex:83,width:19,height:19,color:"#FFF",border:!0,hover:o}),r=a("<div></div>").appendTo(h);e(b.expanded,0);o.bind("click",function(){j&&e(!m,250)});h.data("setheadertext",function(a){x.text(a)});
h.data("clear",f);h.data("clearexcept",function(b){r.children().each(function(){var e=a(this),f=!1;a.each(b,function(){if(e.is("."+this))return f=!0,!1});f||e.remove()})});h.data("addgalleryitem",function(b,e,f,g,h,j,m,o,s,x){return a("<div></div>").appendTo(r).galleryitem({id:b,text:e,tooltip:f,iconindex:g,iconhilightindex:h,hilightallabove:j,selected:m,enabled:o,synchron:s,onClick:x})});h.data("addslidergalleryitem",function(b,e,f,g,h,j,m,o,s,x,N,ka,Y,aa){return a("<div></div>").appendTo(r).slidergalleryitem({id:b,
text:e,tooltip:f,iconindex:g,iconhilightindex:h,min:j,max:m,step:o,value:s,suffix:x,onClick:N,onStart:ka,onSlide:Y,onStop:aa})});h.data("addcolorpickergalleryitem",function(b,e,f,g,h,j,m){return a("<div></div>").appendTo(r).colorpickergalleryitem({id:b,text:e,tooltip:f,rgbcolortabletext:g,palettecolortabletext:h,synchron:j,oncolorselected:m})});h.data("addiconpickergalleryitem",function(b,e,f,g,h){return a("<div></div>").appendTo(r).iconpickergalleryitem({id:b,text:e,tooltip:f,synchron:g,oniconselected:h})});
h.data("addcomboboxgalleryitem",function(b,e,f,g,h,j){return a("<div></div>").appendTo(r).comboboxgalleryitem({id:b,text:e,tooltip:f,expanded:g,synchron:h,onitemselected:j})});h.data("addpropertysheet",function(b){return a("<div></div>").appendTo(r).propertysheet({id:b})});h.data("isexpanded",function(){return m});h.data("setexpanded",e);h.data("setenabled",function(a){a!=j&&((j=a)?h.addClass("kbb-gallery-section-enabled"):(h.removeClass("kbb-gallery-section-enabled"),e(!1,0)),s.toolbaricon("setenabled",
j))});h.data("setselected",function(b){r.children("div.kbb-gallery-item").not("div.kbb-gallery-item."+b).each(function(){a(this).galleryitem("setselected",!1)});r.children("div.kbb-gallery-item."+b).galleryitem("setselected",!0)});h.data("setallselectedexcept",function(b){for(var e=r.children("div.kbb-gallery-item"),f=0;f<b.length;f++)e=e.not("div.kbb-gallery-item."+b[f]);e.each(function(){a(this).galleryitem("setselected",!0)})});h.data("getselected",function(){return r.children("div.kbb-gallery-item-selected")})})}}})(jQuery);(function(a){a.fn.galleryitem=function(e){if(typeof this.data(e)==="function")return this.data(e).apply(this,Array.prototype.slice.call(arguments,1));else if(typeof e==="object"||!e){var b=a.extend({id:"",text:"",tooltip:"",iconindex:0,iconhilightindex:0,hilightallabove:!1,colorfield:i,selected:-1,enabled:!0,synchron:!0,onClick:i},e);return this.each(function(){function e(){h?(f.addClass("kbb-gallery-item-selected"),o.show(),x.show()):(f.removeClass("kbb-gallery-item-selected"),o.hide(),x.hide())}
var f=a(this),h=!1,j=b.enabled;b.selected>=0&&(h=b.selected!=0);f.addClass(b.id+" kbb-gallery-item"+(j?" kbb-gallery-item-enabled":"")+(b.hilightallabove?" kbb-gallery-item-hilightabove":""));b.tooltip.length>0&&b.tooltip!="tooltip"&&f.attr("title",b.tooltip);var m="",m=b.iconindex>=0?'<table><tr><td style="width:23px;padding-right:5px"><div></div></td><td style="width:100%;">'+b.text+"</td></tr></table>":b.colorfield?'<table><tr><td style="padding-right:5px"><div class="kbb-gallery-item-colorfield" style="background:rgb('+
b.colorfield[0]+","+b.colorfield[1]+","+b.colorfield[2]+')"></div></td><td style="width:100%;">'+b.text+"</td></tr></table>":'<div class="kbb-gallery-item-text">'+b.text+"</div>";Ya(function(){a(m).appendTo(f)});var o=a('<div class="kbb-gallery-item-check-background"></div>').appendTo(f),x=a('<div class="kbb-gallery-item-check-mark"></div>').appendTo(f).toolbaricon({index:87,hilightindex:86,width:23,height:23,border:!1,enabled:j,hover:f}),s=i;b.iconindex>=0&&(s=f.find("tr td:nth-child(1)>div").toolbaricon({index:b.iconindex,
hilightindex:b.iconhilightindex,width:23,height:23,border:!1,enabled:j,hover:f}));e();f.bindMouseOrTouchEvent("mouseenter",function(){f.addClass("kbb-gallery-item-hover");b.hilightallabove&&f.prevAll(".kbb-gallery-item").each(function(){a(this).galleryitem("sethilighted",!0)})});f.bindMouseOrTouchEvent("mouseleave",function(){f.removeClass("kbb-gallery-item-hover");b.hilightallabove&&f.prevAll(".kbb-gallery-item").each(function(){a(this).galleryitem("sethilighted",!1)})});f.bind("click",function(a){if(j&&
(f.trigger("mouseleave"),b.selected>=0&&(h=!h,e()),b.onClick)){var m=this;b.synchron?b.onClick.call(m,f,h,a):setTimeout(function(){b.onClick.call(m,f,h,a)},25)}return!1});f.data("isselected",function(){return h});f.data("setselected",function(a){a!=h&&(h=a,e())});f.data("isenabled",function(){return j});f.data("setenabled",function(a){a!=j&&((j=a)?f.addClass("kbb-gallery-item-enabled"):f.removeClass("kbb-gallery-item-enabled"),x.toolbaricon("setenabled",j),s&&s.toolbaricon("setenabled",j))});f.data("sethilighted",
function(a){j&&(a?(f.addClass("kbb-gallery-item-hilighted"),s&&s.toolbaricon("seticonindex",b.iconhilightindex,b.iconhilightindex)):(f.removeClass("kbb-gallery-item-hilighted"),s&&s.toolbaricon("seticonindex",b.iconindex,b.iconhilightindex)))});f.data("getid",function(){return b.id});f.data("geticonindex",function(){return b.iconindex});f.data("gethilighticonindex",function(){return b.iconhilightindex});f.data("getcolorfield",function(){return b.colorfield})})}}})(jQuery);(function(a){a.fn.slidergalleryitem=function(e){if(typeof this.data(e)==="function")return this.data(e).apply(this,Array.prototype.slice.call(arguments,1));else if(typeof e==="object"||!e){var b=a.extend({id:"",text:"",tooltip:"",iconindex:0,iconhilightindex:0,min:0,max:100,step:5,value:50,suffix:"",onClick:i,onStart:i,onSlide:i,onStop:i},e);return this.each(function(){var e=a(this),f=b.suffix;e.addClass(b.id+" kbb-slider-gallery-item");var h=b.text,j='<div class="kbb-slider-gallery-item-reset-btn"><table><tr><td style="width:23px;padding-right:5px"><div></div></td><td style="width:100%;">'+
h+": "+b.value+f+'</td></tr></table></div><div class="kbb-slider-gallery-item-slider"></div>';Ya(function(){a(j).appendTo(e)});var m=e.find(".kbb-slider-gallery-item-reset-btn"),o=e.find(".kbb-slider-gallery-item-slider"),x=e.find("tr td:nth-child(1)>div"),s=e.find("tr td:nth-child(2)");x.toolbaricon({index:b.iconindex,hilightindex:b.iconhilightindex,width:31,height:31,border:!1,hover:m});m.bindMouseOrTouchEvent("mouseenter",function(){m.addClass("kbb-slider-reset-btn-hover")});m.bindMouseOrTouchEvent("mouseleave",
function(){m.removeClass("kbb-slider-reset-btn-hover")});m.bind("click",function(a){if(b.onClick)b.onClick(e,a);return!1});o.slider({orientation:"horizontal",min:b.min,max:b.max,step:b.step,value:b.value,start:function(a,j){s.html(h+": "+j.value+f);if(b.onStart)b.onStart(e,j.value,a)},slide:function(a,j){s.html(h+": "+j.value+f);if(b.onSlide)b.onSlide(e,j.value,a)},stop:function(a,j){s.html(h+": "+j.value+f);if(b.onStop)b.onStop(e,j.value,a)}});e.data("setvalue",function(a){s.html(h+": "+parseInt(a)+
f);o.slider("value",a)});e.data("settext",function(a){h=a})})}}})(jQuery);(function(a){a.fn.colorpickergalleryitem=function(e){if(typeof this.data(e)==="function")return this.data(e).apply(this,Array.prototype.slice.call(arguments,1));else if(typeof e==="object"||!e){var b=a.extend({id:"",text:"",tooltip:"",rgbcolortabletext:"",palettecolortabletext:"",expanded:!1,currentcolor:[127,127,127],colorpalette:[],synchron:!0,oncolorselected:i},e);return this.each(function(){function e(){f();I=a('<div class="kbb-colorpicker-color-fields"></div>').appendTo(E);b.colorpalette.length==
0?(F=a('<div class="kbb-colorpicker-tabbar"></div>').appendTo(I),ca=a('<div class="kbb-colorpicker-tab kbb-colorpicker-active-tab">'+b.rgbcolortabletext+"</div>").appendTo(F).bind("click",function(){V.show();da.hide();ca.addClass("kbb-colorpicker-active-tab");T.removeClass("kbb-colorpicker-active-tab")}),T=a('<div class="kbb-colorpicker-tab">'+b.palettecolortabletext+"</div>").appendTo(F).bind("click",function(){V.hide();da.show();ca.removeClass("kbb-colorpicker-active-tab");T.addClass("kbb-colorpicker-active-tab")}),
V=a("<div></div>").appendTo(I),da=a("<div></div>").appendTo(I).hide(),o(V,h(),!0),o(da,j(),!0)):(da=a("<div></div>").appendTo(I),o(da,b.colorpalette,!1));I.find("*").myDisableSelection(!1)}function f(){I&&(I.remove(),I=i)}function h(){for(var a=[],b=[[40,25],[80,50],[65,75],[50,80],[30,85],[20,90],[10,95],[5,100],[100,55],[90,90],[85,100],[75,100],[65,100],[50,100],[35,100],[25,100]],e=0,f=0,e=f=0;e<8;e++)f=parseInt(e*255/7,10),a.push([f,f,f]);for(e=0;e<12;e++)for(f=0;f<16;f++)a.push(hf(e*30,b[f][0],
b[f][1]));return a}function j(){var b=[];a.each(colorbrewer,function(a,e){if(typeof e["8"]!=="undefined")for(var f=7;f>=0;f--){var g=Nh(e["8"][f]);g?b.push(g):b.push([255,255,255])}});return b}function m(a){a=a.css("background-color").replace("rgb","").replace("(","").replace(")","").replace(/[ ]/gi,"").split(",");return a.length==3?[parseInt(a[0]),parseInt(a[1]),parseInt(a[2])]:[255,255,255]}function o(e,f,g){for(var h="",j=!1,p=0;p<f.length;p++)j=N&&N.toString()==f[p].toString(),p>0&&p%8==0&&g&&
(h+="<br>"),h+='<div class="kbb-colorpicker-color-field'+(j?" kbb-colorpicker-color-field-selected":"")+'" style="background: rgb('+f[p][0]+","+f[p][1]+","+f[p][2]+')"></div>';a(h).appendTo(e);e.find(".kbb-colorpicker-color-field").bind("click",function(){var e=m(a(this));if(b.oncolorselected&&!a(this).hasClass("kbb-colorpicker-color-field-selected")){var f=this;b.synchron?b.oncolorselected.call(f,e):setTimeout(function(){b.oncolorselected.call(f,e)},25)}return!1})}function x(a,b){a?(s.parents(".kbb-gallery").gallery("closeallexpandablesectionsexceptme",
s),p.toolbaricon("seticonindex",84,85),s.addClass("kbb-colorpicker-gallery-item-expanded"),e(),b==0?E.show():E.slideDown(b,"smoothEasing")):(p.toolbaricon("seticonindex",82,83),s.removeClass("kbb-colorpicker-gallery-item-expanded"),b==0?(E.hide(),f()):E.slideUp(b,"smoothEasing",function(){f()}));ka=a}var s=a(this);s.addClass(b.id+" kbb-colorpicker-gallery-item");var r=a("<a></a>").appendTo(s).text(b.text),A=a('<div class="kbb-colorpicker-header-left kbb-colorpicker-color-field"></div>').css("background",
$e(b.currentcolor)).prependTo(r),p=a('<div class="kbb-colorpicker-header-right"></div>').appendTo(r).toolbaricon({index:82,hilightindex:83,width:19,height:19,color:"#FFF",border:!0,hover:r}),E=a("<div></div>").appendTo(s),B=i,I=i,F=i,ca=i,T=i,V=i,da=i,N=i,ka=!1;x(b.expanded,0);r.bind("click",function(){x(!ka,250)});s.data("setcurrentcolor",function(b,e){A.css("background",$e(b));if(I){var f=b.toString(),g=I.find(".kbb-colorpicker-color-field");g.removeClass("kbb-colorpicker-color-field-selected");
e&&g.each(function(){var b=a(this);m(b).toString()==f&&b.addClass("kbb-colorpicker-color-field-selected")})}N=e?b:i});s.data("addcustombutton",function(b,e,f,g,h,j,m,p,o){B==i&&(B=a('<div class="kbb-colorpicker-custom-buttons"></div>').prependTo(E));return a("<div></div>").appendTo(B).galleryitem({id:b,text:e,tooltip:f,iconindex:g,iconhilightindex:h,selected:j,enabled:m,synchron:p,onClick:o})});s.data("setexpanded",x)})}}})(jQuery);(function(a){a.fn.propertysheet=function(e){if(typeof this.data(e)==="function")return this.data(e).apply(this,Array.prototype.slice.call(arguments,1));else if(typeof e==="object"||!e){var b=a.extend({id:""},e);return this.each(function(){var e=a(this);e.addClass(b.id+" kbb-property-sheet");e.data("adddescription",function(b){var h='<div class="kbb-property-sheet-description">'+b+"</div>";Ya(function(){a(h).appendTo(e)})});e.data("addinput",function(b,h,j,m,o){function x(a){var b=s.val();m=="int"&&
(b=parseInt(b),isNaN(b)&&(b=0),b<h&&(b=h),b>j&&(b=j),s.val(b));o(a,b)}var s=a('<table class="kbb-property-sheet-input"><tr><td><input type="'+(m=="int"?"number":"text")+'"></td></tr></table>').appendTo(e).find("input");s.val(b);s.bind("blur",function(){x(!1)});s.bind("keydown",function(a){a=a.which?a.which:a.keyCode;if(a==13||a==13)return x(!1),!1;else if(a==27)return x(!0),!1});return s})})}}})(jQuery);(function(a){a.fn.symbolbtn=function(e){if(typeof this.data(e)==="function")return this.data(e).apply(this,Array.prototype.slice.call(arguments,1));else if(typeof e==="object"||!e){var b=a.extend({index:-1,width:64,height:64,selected:-1,enabled:!0,synchron:!0,onClick:i},e);return this.each(function(){function e(){j?(f.addClass("kbb-symbolbtn-selected"),r.show(),A.show()):(f.removeClass("kbb-symbolbtn-selected"),r.hide(),A.hide())}var f=a(this),h=b.index,j=!1,m=b.enabled,o=parseInt(b.width),x=parseInt(b.height);
b.selected>=0&&(j=b.selected!=0);f.addClass("kbb-symbolbtn"+(m?" kbb-symbolbtn-enabled":"")).css({width:o+"px",height:x+"px"});var s=a("<img>").attr("src",ja.src).height(x).width(ja.width*x/ja.height).css("margin-left",-h*x+"px").appendTo(f),r=a('<div class="kbb-symbolbtn-check-background"></div>').appendTo(f),A=a('<div class="kbb-symbolbtn-check-mark"></div>').appendTo(f).toolbaricon({index:87,hilightindex:86,width:23,height:23,border:!1,enabled:m,hover:f});e();(b.selected>=0||b.onClick)&&f.bind("click",
function(a){if(m&&(b.selected>=0&&(j=!j,e()),b.onClick))if(b.synchron)b.onClick(f,j,a);else setTimeout(function(){b.onClick(f,j,h,a)},25);return!1});f.data("isselected",function(){return j});f.data("setselected",function(a){a!=j&&(j=a,e())});f.data("isenabled",function(){return m});f.data("setenabled",function(a){a!=m&&((m=a)?f.addClass("kbb-symbolbtn-enabled"):f.removeClass("kbb-symbolbtn-enabled"),A.toolbaricon("setenabled",m))});f.data("setindex",function(a){a!=h&&(h=a,s.css("margin-left",-h*x+
"px"))})})}}})(jQuery);(function(a){a.fn.iconpickergalleryitem=function(e){if(typeof this.data(e)==="function")return this.data(e).apply(this,Array.prototype.slice.call(arguments,1));else if(typeof e==="object"||!e){var b=a.extend({id:"",text:"",tooltip:"",expanded:!1,selectedicons:[],synchron:!0,oniconselected:i},e);return this.each(function(){function e(){E<200&&!ja.complete?(E++,setTimeout(e,250)):typeof ja.src!=="undefined"&&typeof ja.src!=="unknown"&&ja.width>0&&ja.height>0&&ja.complete&&s.symbolbtn({index:o.length>
0?o[0]:-1,width:23,height:23,selected:-1,enabled:!0,synchron:!0,onClick:i})}function f(e){if(E<200&&!ja.complete)E++,setTimeout(function(){f(e)},250);else if(typeof ja.src!=="undefined"&&typeof ja.src!=="unknown"&&ja.width>0&&ja.height>0&&ja.complete){A.empty();for(var g=ja.width/ja.height,h=0;h<g;h++)a("<div></div>").appendTo(A).symbolbtn({index:h,width:37,height:37,selected:0,enabled:!0,synchron:b.synchron,onClick:function(e,f,g){e=a.inArray(g,o);e>=0&&o.splice(e,1);f&&o.push(g);s.symbolbtn("setindex",
o.length>0?o[0]:-1);if(b.oniconselected)b.oniconselected(o)}});j(o);e()}}function h(a,b){a?(m.parents(".kbb-gallery").gallery("closeallexpandablesectionsexceptme",m),r.toolbaricon("seticonindex",84,85),m.addClass("kbb-iconpicker-gallery-item-expanded"),E=0,f(function(){b==0?A.show():A.slideDown(b,"smoothEasing")})):(r.toolbaricon("seticonindex",82,83),m.removeClass("kbb-iconpicker-gallery-item-expanded"),b==0?(A.hide(),A.empty()):A.slideUp(b,"smoothEasing",function(){A.empty()}));p=a}function j(b){o=
b;b=A.find(".kbb-symbolbtn");if(b.length>0){b.each(function(){a(this).symbolbtn("setselected",!1)});for(var e=0;e<o.length;e++)o[e]>=0&&o[e]<b.length&&a(b[o[e]]).symbolbtn("setselected",!0)}s.symbolbtn("setindex",o.length>0?o[0]:-1)}var m=a(this),o=b.selectedicons;m.addClass(b.id+" kbb-iconpicker-gallery-item");var x=a("<a></a>").appendTo(m);a("<span></span>").appendTo(x).text(b.text);var s=a('<div class="kbb-iconpicker-header-left"></div>').prependTo(x),r=a('<div class="kbb-iconpicker-header-right"></div>').appendTo(x).toolbaricon({index:82,
hilightindex:83,width:19,height:19,color:"#FFF",border:!0,hover:x}),A=a("<div></div>").appendTo(m),p=!1,E=0;setTimeout(e,50);h(b.expanded,0);x.bind("click",function(){h(!p,250)});m.data("setselectedicons",j);m.data("setexpanded",h)})}}})(jQuery);(function(a){a.fn.comboboxgalleryitem=function(e){if(typeof this.data(e)==="function")return this.data(e).apply(this,Array.prototype.slice.call(arguments,1));else if(typeof e==="object"||!e){var b=a.extend({id:"",text:"",tooltip:"",expanded:!1,selecteditemid:"",synchron:!0,onitemselected:i},e);return this.each(function(){function e(a,b){a?(j.parents(".kbb-gallery").gallery("closeallexpandablesectionsexceptme",j),r.toolbaricon("seticonindex",84,85),j.addClass("kbb-combobox-gallery-item-expanded"),
b==0?A.show():A.slideDown(b,"smoothEasing")):(r.toolbaricon("seticonindex",82,83),j.removeClass("kbb-combobox-gallery-item-expanded"),b==0?A.hide():A.slideUp(b,"smoothEasing"));p=a}function f(a){h(a.galleryitem("getid"))&&b.onitemselected&&b.onitemselected.call(this,m)}function h(b){if(b!=m){m=b;A.children("div.kbb-gallery-item").not("div.kbb-gallery-item."+b).each(function(){a(this).galleryitem("setselected",!1)});var e=A.children("div.kbb-gallery-item."+b);e.galleryitem("setselected",!0);b=e.galleryitem("geticonindex");
e=e.galleryitem("getcolorfield");b>=0&&s?s.toolbaricon("seticonindex",b,b):e&&x&&x.css("background","rgb("+e[0]+","+e[1]+","+e[2]+")");return!0}return!1}var j=a(this),m=b.selecteditemid;j.addClass(b.id+" kbb-combobox-gallery-item");var o=a("<a></a>").appendTo(j);a("<span></span>").appendTo(o).text(b.text);var x=i,s=i,r=a('<div class="kbb-combobox-header-right"></div>').appendTo(o).toolbaricon({index:82,hilightindex:83,width:19,height:19,color:"#FFF",border:!0,hover:o}),A=a("<div></div>").appendTo(j),
p=!1;e(b.expanded,0);o.bind("click",function(){e(!p,250)});j.data("clear",function(){A.empty()});j.data("addcomboboxitem",function(e,g,h,j,m){s==i&&(s=a('<div class="kbb-combobox-header-left"></div>').prependTo(o).toolbaricon({index:0,hilightindex:0,width:23,height:23,border:!1,hover:o}));return a("<div></div>").appendTo(A).galleryitem({id:e,text:g,tooltip:h,iconindex:j,iconhilightindex:m,selected:-1,enabled:!0,synchron:b.synchron,onClick:f})});j.data("addcomboboxcoloritem",function(e,g,h,j){x==i&&
(x=a('<div class="kbb-combobox-colorfield"></div>').prependTo(o));return a("<div></div>").appendTo(A).galleryitem({id:e,text:g,tooltip:h,iconindex:-1,iconhilightindex:-1,colorfield:j,selected:-1,enabled:!0,synchron:b.synchron,onClick:f})});j.data("setselected",h);j.data("setexpanded",e);j.data("isexpanded",function(){return p})})}}})(jQuery);(function(a){a.fn.toolbar=function(e){if(typeof this.data(e)==="function")return this.data(e).apply(this,Array.prototype.slice.call(arguments,1));else if(typeof e==="object"||!e){var b=a.extend({vertical:!1,"text-color":"#FFF","text-color-hilighted":"#FFF","text-color-selected":"#FFF","text-color-selected-hilighted":"#FFF","text-color-disabled":"#BBB","background-color":"#1871B9","background-color-hilighted":"#439DE7","background-color-selected":"#DB552D","background-color-selected-hilighted":"#E17353",
"background-color-disabled":"#555"},e);return this.each(function(){function e(f,g,j,m,A,p,E,B,I,F){var ca=h();return a("<div></div>").appendTo(ca).toolbarbtn({id:f,text:g,tooltip:j,iconindex:m,iconhilightindex:A,selected:p,scrollable:E,"text-color":b["text-color"],"text-color-hilighted":b["text-color-hilighted"],"text-color-selected":b["text-color-selected"],"text-color-selected-hilighted":b["text-color-selected-hilighted"],"text-color-disabled":b["text-color-disabled"],"background-color":b["background-color"],
"background-color-hilighted":b["background-color-hilighted"],"background-color-selected":b["background-color-selected"],"background-color-selected-hilighted":b["background-color-selected-hilighted"],"background-color-disabled":b["background-color-disabled"],vertical:b.vertical,"round-left":!1,"round-right":!1,onClick:B,onMouseDown:I,onMouseEnter:typeof F!==ea?F:i})}function f(e,f,g,j,m,p,E,B,I,F){var ca=h();return a("<div></div>").appendTo(ca).toolbarbtn({id:e,text:f,tooltip:g,iconindex:-1,iconhilightindex:-1,
selected:p,scrollable:E,"text-color":b["text-color"],"text-color-hilighted":b["text-color-hilighted"],"text-color-selected":b["text-color-selected"],"text-color-selected-hilighted":b["text-color-selected-hilighted"],"text-color-disabled":b["text-color-disabled"],"background-color":b["background-color"],"background-color-hilighted":b["background-color-hilighted"],"background-color-selected":b["background-color-selected"],"background-color-selected-hilighted":b["background-color-selected-hilighted"],
"background-color-disabled":b["background-color-disabled"],vertical:b.vertical,"round-left":j,"round-right":m,onClick:B,onMouseDown:I,onMouseEnter:typeof F!==ea?F:i})}function h(){var e=m;b.vertical||(e=a("<td></td>").appendTo(m));return e}var j=a(this),m=j;b.vertical||(m=a("<table><tr></tr></table>").appendTo(j).find("tr"));j.data("addtoolbarbutton",e);j.data("addtoolbarbuttoninverse",function(e,f,g,j,m,p,E,B,I,F,ca){var T=h();return a("<div></div>").appendTo(T).toolbarbtn({id:e,text:f,tooltip:g,
iconindex:j,iconhilightindex:m,selected:B,scrollable:I,"text-color":b["text-color-selected"],"text-color-hilighted":b["text-color-selected-hilighted"],"text-color-selected":b["text-color"],"text-color-selected-hilighted":b["text-color-hilighted"],"text-color-disabled":b["text-color-disabled"],"background-color":b["background-color-selected"],"background-color-hilighted":b["background-color-selected-hilighted"],"background-color-selected":b["background-color"],"background-color-selected-hilighted":b["background-color-hilighted"],
"background-color-disabled":b["background-color-disabled"],vertical:b.vertical,"round-left":p,"round-right":E,onClick:F,onMouseDown:ca})});j.data("addtoolbartextbutton",f);j.data("addpopupbutton",function(b,h,m,r,A,p,E,B,I){function F(a,b){T.find(".kbb-popup-frame:visible").length>0&&ca(a,!0,b)}function ca(b,e,f){if(!V.is(":visible")){T.find(".kbb-popup-frame").hide();var g=T.offsetParent(),h=da.offset(),j=g.offset(),g=V.outerWidth(),g=Math.min(h.left,a(window).width()+a(window).scrollLeft()-g-20)-
j.left-4,j=h.top-j.top,m=da.outerHeight(),h=Math.max(100,a(window).height()-(h.top-a(window).scrollTop())-m-20);V.css({left:g+"px",top:j+m+"px","max-height":h+"px"}).show()}B&&B(b,e,f)}var T=j.parent(),V;V=a('<div class="kbb-popup-frame"></div>').appendTo(T).gallery({}).hide();V.gallery("setonclickhandler",function(){T.find(".kbb-popup-frame").hide()});V.gallery("setonitemselectedhandler",function(){T.find(".kbb-popup-frame").hide()});V.gallery("setoncolorselectedhandler",function(){T.find(".kbb-popup-frame").hide()});
var da;r>=0?da=e(b,h,m,r,A,p,E,ca,I,F):(da=f(b,h,m,!1,!1,p,E,ca,I,F),da.addClass("kbb-toolbarbtn-like-icon"));return[da,V]});j.data("addemptycell",h);j.data("addrow",function(){b.vertical||(m=a("<tr></tr>").appendTo(m.parent()))});j.data("setbtnselected",function(a,b){j.find("."+a).toolbarbtn("setselected",b)});j.data("setbtnenabled",function(a,b){j.find("."+a).toolbarbtn("setenabled",b)});j.data("showbtn",function(a,b){var e=j.find("."+a);b?e.show():e.hide();return j});j.data("setlast",function(){j.find(".kbb-last").removeClass("kbb-last");
j.find(".kbb-toolbarbtn:visible:last").addClass("kbb-last")})})}}})(jQuery);(function(a){a.fn.toolbarbtn=function(e){if(typeof this.data(e)==="function")return this.data(e).apply(this,Array.prototype.slice.call(arguments,1));else if(typeof e==="object"||!e){var b=a.extend({id:"",text:"",tooltip:"",iconindex:0,iconhilightindex:0,selected:-1,enabled:!0,scrollable:!1,"text-color":"#FFF","text-color-hilighted":"#FFF","text-color-selected":"#FFF","text-color-selected-hilighted":"#FFF","text-color-disabled":"#BBB","background-color":"#1871B9","background-color-hilighted":"#439DE7",
"background-color-selected":"#DB552D","background-color-selected-hilighted":"#E17353","background-color-disabled":"#555",vertical:!1,"round-left":!1,"round-right":!1,onClick:i,onMouseDown:i,onMouseEnter:i},e);return this.each(function(){function e(){var a,g;m?(j?(a=h&&b.selected>=0?b["text-color-selected-hilighted"]:b["text-color-selected"],g=h&&b.selected>=0?b["background-color-selected-hilighted"]:b["background-color-selected"]):(a=h?b["text-color-hilighted"]:b["text-color"],g=h?b["background-color-hilighted"]:
b["background-color"]),j&&b.selected<0?f.css("cursor","default"):f.css("cursor","")):(a=b["text-color-disabled"],g=b["background-color-disabled"],f.css("cursor","default"));f.css({color:a,"background-color":g})}var f=a(this),h=!1,j=!1,m=b.enabled;b.selected>=0&&(j=b.selected!=0);f.addClass(b.id+" kbb-toolbarbtn"+(b.vertical?" kbb-toolbarbtn-vertical":" kbb-toolbarbtn-horizontal"));b["round-left"]&&f.addClass("kbb-toolbarbtn-round-left");b["round-right"]&&f.addClass("kbb-toolbarbtn-round-right");b.tooltip.length>
0&&b.tooltip!="tooltip"&&f.attr("title",b.tooltip);var o=i;b.iconindex>=0?o=a('<div class="kbb-toolbarbtn-icon"></div>').appendTo(f).toolbaricon({index:b.iconindex,hilightindex:b.iconhilightindex,width:23,height:23,color:"#FFF",border:!1,hover:f}):f.addClass("kbb-toolbarbtn-pure-text");b.text.length>0&&a('<div class="kbb-toolbarbtn-text"></div>').appendTo(f).html(b.text);e();f.bindMouseOrTouchEvent("mouseenter",function(a){h=!0;e();if(m&&b.onMouseEnter)b.onMouseEnter(f,a)});f.bindMouseOrTouchEvent("mouseleave",
function(){h=!1;e()});if(b.selected>=0&&b.onMouseDown==i||b.onClick){var x=function(a){if(m){b.selected>=0&&b.onMouseDown==i&&(j=!j);if(b.onClick)b.onClick(f,j,a);b.selected>=0&&b.onMouseDown==i&&e()}return!1};b.scrollable?f.bind("click",x):f.bindMouseOrTouchEvent("click",x)}(m&&b.onMouseDown||!b.scrollable)&&f.bindMouseOrTouchEvent("mousedown",function(a){m&&b.onMouseDown&&(b.selected>=0&&(j=!j),b.onMouseDown(f,j,a),b.selected>=0&&e());return!1});f.data("seticonindex",function(a,b){o&&o.toolbaricon("seticonindex",
a,b)});f.data("settooltip",function(a){f.attr("title",a)});f.data("isselected",function(){return j});f.data("setselected",function(a){a!=j&&(j=a,e())});f.data("isenabled",function(){return m});f.data("setenabled",function(a){a!=m&&(m=a,e())});f.data("getid",function(){return b.id})})}}})(jQuery);(function(a){a.fn.toolbaricon=function(e){if(typeof this.data(e)==="function")return this.data(e).apply(this,Array.prototype.slice.call(arguments,1));else if(typeof e==="object"||!e){var b=a.extend({index:0,hilightindex:0,width:29,height:29,color:"#FFF",border:!0,enabled:!0,hover:i},e);return this.each(function(){function e(){m.css("background-position","-"+23*(s?x:o)+"px 0px")}var f=a(this),h=b.enabled,j=a('<div class="kbb-toolbaricon-background"></div>').css({width:b.width,height:b.height}).appendTo(f);
b.border&&j.addClass("kbb-toolbaricon-background-border").css("border-color",b.color);var m=a('<div class="kbb-toolbaricon-icon"></div>').appendTo(j);b.width!=23&&m.css("left",(b.width-23)/2+"px");b.height!=23&&m.css("top",(b.height-23)/2+"px");var o=b.index,x=b.hilightindex,s=!1;e();var r=f;b.hover&&(r=b.hover);r.bindMouseOrTouchEvent("mouseenter",function(){h&&(s=!0,e(),b.border&&j.css("background-color",b.color))});r.bindMouseOrTouchEvent("mouseleave",function(){h&&(s=!1,e(),b.border&&j.css("background-color",
"transparent"))});f.data("seticonindex",function(a,b){o=a;x=b;e()});f.data("isenabled",function(){return h});f.data("setenabled",function(a){a!=h&&((h=a)||(s=!1),e())})})}}})(jQuery);(function(a){a.fn.tabbeddialog=function(e){if(typeof this.data(e)==="function")return this.data(e).apply(this,Array.prototype.slice.call(arguments,1));else if(typeof e==="object"||!e){var b=a.extend({id:"",title:"",editoktext:"",editcanceltext:"",astabletext:"",addcontenteditabletoolbarmenus:i,onenddialog:i},e);return this.each(function(){function e(b){var f=b.find("textarea"),b=b.find("iframe");if(f.length==0||b.length==0)return i;var g=b[0],h=g.contentWindow?g.contentWindow:g.contentDocument.defaultView,
g=g.contentDocument?g.contentDocument:g.contentWindow.document,j=a(g.body);return[b,h,g,j,f]}function f(a,b,e,f,g,h,j,m){return A.toolbar("addtoolbarbutton",a,b,e,f,g,h,!0,j,m)}function h(b){var f=x.outerHeight(),h=p.children("div:visible");h.length>0&&(h=h.attr("class").split(" ")[0])&&typeof ca[h]!=="undefined"&&ca[h].hide();typeof ca[b]!=="undefined"&&ca[b].show();p.children("div").not("."+b).hide();B.find("td > div").not("."+b).removeClass("kbb-tabbed-dialog-active-tab");var j=p.children("div."+
b),m=i,o=i;j.show();B.find("td > div."+b).addClass("kbb-tabbed-dialog-active-tab");if(typeof j.data("pishtml")!=="undefined"){if(b=j.data("pishtml"),h=e(j))m=h[3],o=h[4],b?(F.show(),o.is(":visible")?I.hide():I.show(),T&&T()):(I.hide(),F.hide())}else I.hide(),F.hide();j.data("astable")?(da.show(),da.toolbarbtn("setselected",j.data("astableselected"))):da.hide();f-=p.position().top+E.outerHeight();p.height(f);a(".kbb-assistant-overlay").length==0&&setTimeout(function(){var a=j.find("input:first");o&&
o.is(":visible")?o.focus():m?m.focus():a.length>0?a.focus():j.focus()},10)}function j(e){o!=i&&clearTimeout(o);if(b.onenddialog)b.onenddialog(e,x);a(r).unbind();x.find("iframe").remove();x.remove();jf()&&Xk()}function m(b,f){var h="",j=e(b);if(j){var m=j[3],h=j[4];h.is(":visible")?m=a("<div></div>").html(Og(b,h.val())):(Za(m,!0),lb(m),m=Ya(function(){return a("<div></div>").html(m.html())}),cb(m));h=f?m.html():m.text()}return h}var o=i,x=a(this),s=i,r=[];x.addClass(b.id+" kbb-tabbed-dialog");b.title.length>
0&&(s=a('<div class="kbb-tabbed-dialog-header"><div></div></div>').appendTo(x),s.children("div").text(b.title));var A=a('<div class="kbb-tabbed-dialog-toolbar"><div></div></div>').appendTo(x).children("div").toolbar({}),p=a('<div class="kbb-tabbed-dialog-pages"></div>').appendTo(x),E=a('<div class="kbb-tabbed-dialog-tabs"></div>').appendTo(x),B=a("<div><table><tr></tr></table></div>").appendTo(E).find("tr"),I=[],F=[],ca={},T=i;f("id-edit-ok",b.editoktext,"tooltip",37,37,-1,function(){j(!1)},i);f("id-edit-cancel",
b.editcanceltext,"tooltip",55,55,-1,function(){j(!0)},i);if(b.addcontenteditabletoolbarmenus)var V=b.addcontenteditabletoolbarmenus(A,!0,function(){var a=p.children("div:visible");return a.data("pishtml")&&(a=e(a))?[a[1],a[2],a[3],a[4]]:i},fa(),function(a,b){return(p.children("div:visible").data("pscaleimage")?"width:auto;height:"+b/27+"em;":"")+(a=="l"?"margin:0.2em 0.4em 0.2em 0;float:left;":a=="r"?"margin:0.2em 0 0.2em 0.4em;float:right;":"margin:0.2em 0.4em 0.2em 0.4em;")},function(){var a=p.children("div:visible");
if(a.data("pishtml")){var b=x.outerHeight(),f=m(a,!0),h=e(a);if(h){var j=h[0],o=h[3],h=h[4];h.is(":visible")?(j.show(),h.hide(),Ya(function(){o.html(f);o.find("iframe").attr("sandbox","")}),Za(o,!0),lb(o),o.focus(),I.show()):(f=yp(a,f),h.show(),j.hide(),h.val(Vg(f,!0)),qf(h),I.hide());T&&T();b-=p.position().top+E.outerHeight();p.height(b)}}}),I=V[0],F=V[1],T=V[2];var da=f("id-as-table",b.astabletext,"tooltip",218,218,0,function(a,b){p.children("div:visible").data("astableselected",b)},i);x.data("addtexteditpage",
function(b,e,f,g,m,s,A,E){var F="",I="",V=Ya(function(){return a('<div class="'+b+'"><div class="kbb-iframe-overlay"></div><iframe></iframe><textarea spellcheck="false"></textarea></div>').appendTo(p).data("pishtml",g).data("pscaleimage",m).data("astable",s).data("astableselected",A)}),ca=V.find("iframe"),E=Ih(ca,E,"14px"),da=E[0],Tc=E[1],sb=a(Tc.body),V=V.find("textarea");sb.attr("spellcheck","false");a([sb[0],V[0]]).bind("keypress.kmEvents",function(a){var b=a.which?a.which:a.keyCode;if((b==10||
b==13)&&a.ctrlKey)return j(!1),!1}).bind("keydown.kmEvents",function(a){var b=a.which?a.which:a.keyCode;if(b==9)return b=p.children("div:visible"),a.shiftKey?(a=b.prev(),a.length==0&&(a=p.children("div:last"))):(a=b.next(),a.length==0&&(a=p.children("div:first"))),(a=a.attr("class").split(" ")[0])&&h(a),!1;else if(b==27)return j(!0),!1});sb.bind("keyup.kmEvents paste.kmEvents cut.kmEvents input.kmEvents",function(){try{sb.find("iframe").attr("sandbox",""),o!=i&&clearTimeout(o),Bb()||(o=setTimeout(function(){o=
i;I=sb.text();if(I!==F){var a=Yg(sb[0],da,Tc);Za(sb,!0);lb(sb);bh(sb[0],a,da,Tc);F=I}},500))}catch(a){}});sb.bind("click.kmEvents",function(){x.find(".kbb-popup-frame:visible").hide()});r.push(da);r.push(Tc);r.push(sb[0]);r.push(V[0]);a(Tc).bind("selectionchange.kmEvents",function(){T&&T()});var R=hd(f);R?Ya(function(){sb.html(R)}):sb.text(f);g&&(sb.find("iframe").attr("sandbox",""),Za(sb,!0),lb(sb));a('<td><div class="'+b+'" unselectable="on">'+e+"</div></td>").appendTo(B).children("div").bindMouseOrTouchEvent("click",
function(){h(b)})});x.data("addpropertypage",function(b,e){var f=a('<div class="'+b+' kbb-tabbed-dialog-property-page"></div>').appendTo(p);a('<td><div class="'+b+'" unselectable="on">'+e+"</div></td>").appendTo(B).children("div").bindMouseOrTouchEvent("click",function(){h(b)});return f});x.data("addtoolbarbutton",f);x.data("addpagetoolbarbutton",function(a,b,e,g,h,j,m,p,o){typeof ca[a]==="undefined"&&(ca[a]=[]);ca[a].push(f(b,e,g,h,j,m,p,o).hide()[0])});x.data("activatetab",h);x.data("show",function(b,
e,f,g,h,m){if(typeof window.localStorage!=="undefined"){var o=window.localStorage.getItem("kbb_tabbed_dialog_size");if(o&&(o=JSON.parse(o)))h=o.w,m=o.h}a.each(ca,function(b){ca[b]=a(ca[b])});var r=b.width(),o=b.height();if(a(".kbb-assistant-overlay").length>0){var F=a(".kbb-assistant-dialog").parent();F.length>0&&(f=b.scrollTop()+F.position().top+F.outerHeight()+10,g=!1,o*=0.5)}else Mb&&(o*=0.5);h=Math.min(h,r);m=Math.min(m,o);x.width(h);x.css({left:"-2000px",top:"-2000px"}).show();r=Math.min(B.outerWidth()+
50,r);o=Math.min((s?s.outerHeight():0)+A.outerHeight()+E.outerHeight()+100,o);h<r&&x.width(r);h=Math.max(o,m)-x.outerHeight()+p.outerHeight();p.height(h);b=Od(x.parent(),b,x,Mb||a(".kbb-assistant-overlay").length>0?0:e-0.5*x.width(),Mb&&a(".kbb-assistant-overlay").length==0?0:f-(g?x.height():0));x.hide().css({left:b[0]+"px",top:b[1]+"px"}).fadeIn(300);a(".kbb-assistant-overlay").length==0&&p.children("div:visible").focus();x.find(".kbb-tabbed-dialog-toolbar,.kbb-tabbed-dialog-toolbar *,.kbb-tabbed-dialog-tabs,.kbb-tabbed-dialog-tabs *,.kbb-tabbed-dialog-property-page,.kbb-property-page-text-label").myDisableSelection(!1);
p.find("input").bindFirst("keydown",function(b){if(!a(this).is(".ui-autocomplete-input")||!a(this).autocomplete("widget").is(":visible")){var e=b.which?b.which:b.keyCode;if(e==10||e==13)return j(!1),b.stopImmediatePropagation(),!1;else if(e==27)return j(!0),b.stopImmediatePropagation(),!1}});x.resizable({start:function(){var b=B.outerWidth()+50,e=(s?s.outerHeight():0)+A.outerHeight()+E.outerHeight()+100;a(this).resizable("option","minWidth",b);a(this).resizable("option","minHeight",e);x.find(".kbb-iframe-overlay").show()},
resize:function(){var a=x.outerHeight()-p.position().top-E.outerHeight();p.height(a)},stop:function(){if(typeof window.localStorage!=="undefined"){var b=JSON.stringify({w:Math.max(200,Math.min(a(window).width()-200,a(this).outerWidth())),h:Math.max(200,Math.min(a(window).height()-50,a(this).outerHeight()))});window.localStorage.setItem("kbb_tabbed_dialog_size",b)}x.find(".kbb-iframe-overlay").hide()}}).draggable({handle:".kbb-tabbed-dialog-header"})});x.data("enddialog",j);x.data("handlevirtualkeyboard",
function(a,b){x.find("input[type='text'],div[contenteditable='true']").bind("focus",function(){if(x.is(":visible")&&Mb){var a=Od(x.parent(),b,x,0,0);x.css({left:a[0]+"px",top:a[1]+"px"})}})});x.data("getcontent",function(a){var b="",a=p.children("div."+a);a.data("pishtml")?(b=m(a,!0),a=m(a,!1),b=Md(b),b=b.replace(/(<\/p[ ]*>[ ]*<p([ ]+[^>]*)*>)/gi,"<br>").replace(/(([^<^>]{1,1})<p([ ]+[^>]*)*>)/gi,"$2<br>").replace(/(<p([ ]+[^>]*)*>)/gi,"").replace(/(<\/p[ ]*>)/gi,""),b=b.replace(/(<\/div[ ]*>[ ]*<div([ ]+[^>]*)*>)/gi,
"<br>").replace(/(([^<^>]{1,1})<div([ ]+[^>]*)*>)/gi,"$2<br>").replace(/(<div([ ]+[^>]*)*>)/gi,"").replace(/(<\/div[ ]*>)/gi,""),$.trim(a)!=$.trim(b.replace(/(&nbsp;)/gi," ").replace(/(&lt;)/gi,"<").replace(/(&gt;)/gi,">").replace(/(&quot;)/gi,'"').replace(/(&amp;)/gi,"&"))&&(a="<html>"+b+"</html>"),b=a):(a=e(a))&&(b=a[3].text());return b});x.data("getpropertypagecontrol",function(a,b){return p.children("div."+a).find("div."+b)});x.data("getpagedata",function(a,b){return p.children("div."+a).data(b)});
x.data("getactivetexteditdocument",function(){var a=p.children("div:visible");return e(a)})})}}})(jQuery);(function(a){a.fn.selector=function(e){if(typeof this.data(e)==="function")return this.data(e).apply(this,Array.prototype.slice.call(arguments,1));else if(typeof e==="object"||!e){var b=a.extend({id:"","border-width":1,"handle-width":9,"handle-background-color":"#FF0",iconindex:-1,onmove:i},e);return this.each(function(){var e=a(this),f=i;e.addClass(b.id+" kbb-selector").attr("tabindex","-1");var h=a("<div></div>").appendTo(e),j=a("<div></div>").appendTo(e),m=a("<div></div>").appendTo(e),o=a("<div></div>").appendTo(e),
x=a("<div></div>").appendTo(e),s=a("<div></div>").appendTo(e),r=a("<div></div>").appendTo(e),A=a("<div></div>").appendTo(e);e.children("div").css("background-color",b["handle-background-color"]);b["background-color"]&&e.addClass(b["background-color"]);var p=b.iconindex;p>=0&&(f=a('<div class="kbb-selector-icon"></div>').appendTo(e),f.css("background-position","-"+23*p+"px 0px"));b.onmove&&e.bindMouseOrTouchEvent("mousemove",function(a){b.onmove(a)});e.data("show",function(a,p,I,F,ca){var T=b["handle-width"]*
ca,V=Math.max(1,b["border-width"]*ca),da=V+0.5*T,N=2*T+16*V;a-=V;p-=V;I<N&&(a-=0.5*(N-I),I=N);F<N&&(p-=0.5*(N-F),F=N);h.css({left:-da+"px",top:-da+"px",width:T+"px",height:T+"px","border-width":V+"px"});j.css({left:0.5*I-da+"px",top:-da+"px",width:T+"px",height:T+"px","border-width":V+"px"});m.css({right:-da+"px",top:-da+"px",width:T+"px",height:T+"px","border-width":V+"px"});o.css({left:-da+"px",bottom:-da+"px",width:T+"px",height:T+"px","border-width":V+"px"});x.css({left:0.5*I-da+"px",bottom:-da+
"px",width:T+"px",height:T+"px","border-width":V+"px"});s.css({right:-da+"px",bottom:-da+"px",width:T+"px",height:T+"px","border-width":V+"px"});r.css({left:-da+"px",top:0.5*F-da+"px",width:T+"px",height:T+"px","border-width":V+"px"});A.css({right:-da+"px",top:0.5*F-da+"px",width:T+"px",height:T+"px","border-width":V+"px"});e.css({left:a+"px",top:p+"px",width:I+"px",height:F+"px","border-width":V+"px"}).show();f&&f.css("transform","scale("+ca+")")});e.data("showicon",function(a){a?e.addClass("kbb-show-icon"):
e.removeClass("kbb-show-icon")})})}}})(jQuery);(function(a){a.fn.iconbtn=function(e){if(typeof this.data(e)==="function")return this.data(e).apply(this,Array.prototype.slice.call(arguments,1));else if(typeof e==="object"||!e){var b=a.extend({iconindex:0,iconhilightindex:0,iconhilightbackgroundcolor:[255,255,255],link:"",width:64,synchron:!0,onclick:i,onMouseDown:i},e);return this.each(function(){function e(){x.css("margin-left",-(o?b.iconhilightindex:b.iconindex)*m+"px");f.css({"background-color":o?$e(b.iconhilightbackgroundcolor):"#FFF","border-color":o?
"#FFF":$e(b.iconhilightbackgroundcolor)})}var f=a(this),h=a("<div></div>").appendTo(f),j=h,m=parseInt(b.width),o=!1;b.link.length>0&&(j=a('<a href="'+b.link+'" target="_blank"></a>').appendTo(h));f.addClass("kbb-iconbtn").css({width:m+"px",height:m+"px"});var x=a("<img>").attr("src",la.src).appendTo(j);la.complete&&la.width>0&&la.height>0?x.width(la.width*m/la.height).height(m):x.width(0).height(0);e();f.bindMouseOrTouchEvent("mouseenter",function(){o=!0;e()});f.bindMouseOrTouchEvent("mouseleave",
function(){o=!1;e()});b.onclick&&f.bindMouseOrTouchEvent("click",function(a){if(b.synchron)b.onclick(f,a);else setTimeout(function(){b.onclick(f,a)},25);return!1});b.onMouseDown&&f.bindMouseOrTouchEvent("mousedown",function(a){b.onMouseDown(f,a);return!1});f.data("setwidth",function(a){m=parseInt(a);f.width(m).height(m);la.complete&&la.width>0&&la.height>0&&x.width(la.width*m/la.height).height(m).css("margin-left",-(o?b.iconhilightindex:b.iconindex)*m+"px")})})}}})(jQuery);(function(a){a.fn.panzoom=function(e){if(typeof this.data(e)==="function")return this.data(e).apply(this,Array.prototype.slice.call(arguments,1));else if(typeof e==="object"||!e)return a.extend({},e),this.each(function(){var b=a(this),e=b.children();if(e.length==1&&e[0]instanceof HTMLImageElement){var f=i,h=i,j=1,m=e[0];b.css({"overflow-x":"auto","overflow-y":"auto","touch-action":"none","-ms-touch-action":"none"});b.find("*").css({"touch-action":"none","-ms-touch-action":"none"});b.unbindMouseOrTouchEvent("mousedown.mypanzoom").bindMouseOrTouchEvent("mousedown.mypanzoom",
function(e){if(f==i){a(document).unbindMouseOrTouchEvent("mousemove.mypanzoom").bindMouseOrTouchEvent("mousemove.mypanzoom",function(e){if(f){if(Ob.ids.length==2){var g=Ob[Ob.ids[0]],p=Ob[Ob.ids[1]];if(h.zoom){if(p=Math.pow(Math.pow(p.pageX-g.pageX,2)+Math.pow(p.pageY-g.pageY,2),0.5),Math.abs(p-h.newdistance)>3)h.newdistance=p,p=Math.max(0.2,Math.min(5,j*h.newdistance/h.startdistance)),a(m).width(m.naturalWidth*p).height(m.naturalHeight*p)}else h.zoom=!0,h.startdistance=Math.pow(Math.pow(p.pageX-
g.pageX,2)+Math.pow(p.pageY-g.pageY,2),0.5),h.newdistance=h.startdistance}p=fg(e);g=lg(e);if(Ob.ids.length>1&&(g=Ob[Ob.ids[0]],p=g.pageX,g=g.pageY,Ob.ids.length>h.tps))h.x=p,h.y=g,h.xl=p,h.yl=g,h.tps=Ob.ids.length;var o=vb(e)?15:15;if(h.dragged||Math.pow(Math.pow(p-h.x,2)+Math.pow(g-h.y,2),0.5)>o)h.dragged||b.addClass("cursormove"),b[0].scrollLeft+=h.xl-p,b[0].scrollTop+=h.yl-g,f=e,h.xl=p,h.yl=g,h.dragged=!0}return!1});a(document).unbindMouseOrTouchEvent("mouseup.mypanzoom").bindMouseOrTouchEvent("mouseup.mypanzoom",
function(){if(f)h.zoom?(j=Math.max(0.2,Math.min(5,j*h.newdistance/h.startdistance)),a(m).width(m.naturalWidth*j).height(m.naturalHeight*j),f=i,h.zoom=!1,b.removeClass("cursormove")):Ob.ids.length==0&&(f=i,b.removeClass("cursormove")),a(document).unbindMouseOrTouchEvent("mousemove.mypanzoom"),a(document).unbindMouseOrTouchEvent("mouseup.mypanzoom");return!1});var g=fg(e),s=lg(e);if(Ob.ids.length>1)s=Ob[Ob.ids[0]],g=s.pageX,s=s.pageY;f=e;h={x:g,y:s,xl:g,yl:s,dragged:!1,zoom:!1,startdistance:100,newdistance:100,
tps:Ob.ids.length};b.addClass("cursormove")}return!1})}})}})(jQuery);function Rw(a,e){this.text=jd($.trim(a.n));this.html=hd($.trim(a.n));this.ba=jd($.trim(a.dt));this.Z=hd($.trim(a.dt));this.I=a.i;this.Q=a.ti;this.Yb=a.a;a.k.length>0?(this.image=new Image,this.image.src="data:image/png;base64,"+a.k,this.Tb=a.f&&a.f!=0,this.$a=a.s&&a.s!=0,e[this.I]={i:this.image,f:this.Tb,s:this.$a}):typeof e[this.I]!=="undefined"?(this.image=e[this.I].i,this.Tb=e[this.I].f,this.$a=e[this.I].s):(this.image=i,this.$a=this.Tb=!1);this.Ha=a.u;this.properties=a.o&&a.o.length>0?$.parseJSON(a.o):
i;this.Zd=this.text.replace(/\s+/g," ").replace(/[^\s]/g,"").length+1;this.wd=this.ba.replace(/\s+/g," ").replace(/[^\s]/g,"").length+1;this.Ef=this.text.toLowerCase().replace(/[^a\u00e4eio\u00f6u\u00fcy]/g,"").length;this.Ve=this.ba.toLowerCase().replace(/[^a\u00e4eio\u00f6u\u00fcy]/g,"").length;this.Cf=this.text.replace(/[^\d]/g,"").length;this.Ue=this.ba.replace(/[^\d]/g,"").length;this.td=0;this.oa=this.Nd=-1;if(this.properties&&typeof this.properties.nttl!=="undefined"&&this.properties.nttl!==
i)this.oa=this.properties.nttl;this.Eb=-1;if(this.properties&&typeof this.properties.cli!=="undefined"&&this.properties.cli!==i)this.Eb=this.properties.cli;this.pb=this.oa<0?0:1}function Sw(a,e,b){this.mc=a;this.Ya=e;this.Qd=b;this.Jc=this.Kc=this.te=this.ue=i;this.ce=[];this.be=[];this.Of=parseInt((this.Ya.length+1)*Math.random())}function Tw(){this.ac=this.tf=this.uf=this.lf=this.$d=this.wf=0}
function eg(a,e,b,g,f,h,j,m,o,x,s,r,A,p,E,B,I){this.Td=a;this.pf=e;this.Yf=b;this.q=[];this.S=[];this.Mc=i;this.hg=h;this.ig=j;this.lg=m;this.Kf=o;this.Mf=x;this.yf=s;this.vg=r;this.Gg=A;this.$e=p;this.af=E;this.Xf=B;this.Ze=I;this.ee=this.If=0;this.xc=g;this.Ye=f;this.Mb=-1;this.qf=!1}
eg.prototype.init=function(a){var e=this,b,g,f={},h=Date.now(),j=this.Yf?this.Td:1.5*this.pf;for(b=0;b<a.i.length;b++)g=new Rw(a.i[b],this.hg),g.text!=""&&(this.xc&&g.Yb>=0||g.ba!="")&&(this.Ye!="n"||g.Yb>=0)&&(this.Ye!="w"||g.Yb<0)&&this.q.push(g);if(this.xc)for(b=0;b<this.q.length;b++)this.S.push(b);else{for(b=0;b<this.q.length&&this.S.length<=this.Td;b++)g=this.q[b],g.oa>=0&&g.oa<h&&(this.S.push(b),f[b]=1);if(this.S.length<this.Td)for(b=0;b<this.q.length&&this.S.length<this.Td;b++)typeof f[b]===
"undefined"&&(g=this.q[b],g.oa<0&&(this.S.push(b),f[b]=1));if(this.S.length<j){a=[];for(b=0;b<this.q.length;b++)a.push(b);a.sort(function(a,b){return(e.q[a].oa<0?h-1:e.q[a].oa)-(e.q[b].oa<0?h-1:e.q[b].oa)});for(b=0;b<a.length&&this.S.length<j;b++)typeof f[a[b]]==="undefined"&&this.S.push(a[b])}for(b=this.S.length-1;b>0;b--)f=Math.floor(Math.random()*(b+1)),j=this.S[b],this.S[b]=this.S[f],this.S[f]=j}};
function ag(a,e,b){var g=0,f=-1,h=[],j={},m=i,o=i,x=!0,s=[];if(a.xc){if(!b||a.Mb<0)if(e){if(a.Mb++,a.Mb>=a.S.length)a.Mb=0}else if(a.Mb--,a.Mb<0)a.Mb=a.S.length-1;f=a.Mb}else{for(g=0;g<a.S.length;g++)if(o=a.q[a.S[g]],o.pb<3){m=o;f=g;j[g]=1;break}if(m==i)return i;x=m.pb<2;if(m.pb>0){for(g=0;g<a.S.length;g++)o=a.q[a.S[g]],g==f||x&&o.ba.toLowerCase()==m.ba.toLowerCase()||!x&&o.text.toLowerCase()==m.text.toLowerCase()?o.td=0:(e=Math.pow(Math.pow(o.Zd-m.Zd,2)+0.5*Math.pow(o.Ef-m.Ef,2)+Math.pow(o.Cf-m.Cf,
2),0.5),b=Math.pow(Math.pow(o.wd-m.wd,2)+0.5*Math.pow(o.Ve-m.Ve,2)+Math.pow(o.Ue-m.Ue,2),0.5),o.td=x?1+0.75*b+0.25*e:1+0.75*e+0.25*b,o.Nd=g,s.push(o));s.sort(function(a,b){return a.td-b.td});for(g=0;h.length<Math.min(a.pf-1,s.length);)o=s[g],typeof j[o.Nd]==="undefined"&&Math.random()>0.25+0.75*g/(1+s.length)&&(h.push(o.Nd),j[o.Nd]=1),g++,g>s.length-1&&(g=0)}}return Uw(a,new Sw(f,h,x),!0)}
function Uw(a,e,b){function g(a){var b=a.replace(/^[\s\[({"']+/g,"").replace(/[\s\])}"']+$/g,"");b.length>3&&b!=a&&x.unshift(b);a.length>3&&x.unshift(a);a=b.split(/\s/);a.length>1&&$.each(a,function(a,b){var e=b.replace(/^[\s\[({"']+/g,"").replace(/[\s\])}"']+$/g,"");(e.length>3||e.length>0&&e.replace(/[^\d]/g,"").length==e.length)&&x.push(e)})}function f(a){a&&$.each(x,function(b,e){a=a.replace(RegExp("\\b"+e.replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:])/g,"\\$1")+"\\w*\\b","gi"),"[...]")});
return a}function h(a){a&&$.each(x,function(b,e){a=a.replace(RegExp("(\\b"+e.replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:])/g,"\\$1")+"\\w*\\b)(?![^<]*>|[^<>]*<\\/)","gi"),"[...]")});return a}var j=a.q[a.S[e.mc]],m,o=j.wd>j.Zd||e.Qd&&j.wd==j.Zd,x=[];o?(g(j.text),$.each(e.Ya,function(b,e){g(a.q[a.S[e]].text)})):(g(j.ba),$.each(e.Ya,function(b,e){g(a.q[a.S[e]].ba)}));var s=j.text,r=j.html,A=j.ba,j=j.Z;b&&e.Ya.length>0&&(o?(A=f(A),j=h(j)):(s=f(s),r=h(r)));e.Qd?(e.ue=s,e.te=r,e.Kc=A,e.Jc=j):(e.ue=
A,e.te=j,e.Kc=s,e.Jc=r);e.ce=[];e.be=[];$.each(e.Ya,function(b,g){m=a.q[a.S[g]];e.ce.push(e.Qd?o?f(m.ba):m.ba:o?m.text:f(m.text));e.be.push(e.Qd?o?h(m.Z):m.Z:o?m.html:h(m.html))});return e}
function dg(a,e,b){function g(){$("#doccontent td.kbb-toggle-note").text(E?f.yf:f.vg);var a=$("#doccontent td.kbb-answer");E?(a.removeClass("kbb-answer-textnote"),e.Jc?Ya(function(){a.html(e.Jc)}):a.text(e.Kc),f.$e(a,[],!1,!1),Za(a,!1)):(a.addClass("kbb-answer-textnote"),f.Xf(h.I,function(b){Ya(function(){a.html(b);a.find("iframe").attr("sandbox","");Za(a,!1)})}));E=!E}var f=a,h=a.q[a.S[e.mc]],j=$f(a),m=i,o=0,x=e.Ya.length==0?"100%":"50%",s=100/parseInt((2+e.Ya.length)/2)+"%",r=$("#docheader table.kbb-learn-header td"),
A='<table class="kbb-question"><tr><td class="kbb-question" style="height:25%;padding:25px;text-align:center;"></td></tr><tr><td style="height:75%"><table class="kbb-answer"><tr><td class="kbb-answer" style="width:'+x+";height:"+s+';"></td>',p;for(p=0;p<e.Ya.length;p++)p%2==1&&(A+="</tr><tr>"),A+='<td class="kbb-answer" style="width:'+x+";height:"+s+';"></td>';e.Ya.length>0?e.Ya.length%2==0&&(A+='<td class="kbb-answer" style="width:'+x+";height:"+s+';"></td>'):h.Yb>=0&&(A+='</tr><tr><td class="kbb-toggle-note" style="width:100%;">'+
f.yf+"</td>");A+="</tr></table></td></tr></table>";r.empty();$("#doccontent").empty();Ya(function(){r.first().text(e.Ya.length==0?f.ig:f.lg);r.last().text(f.xc?f.Mf.replace("%1",e.mc+1).replace("%2",f.S.length):f.Kf.replace("%1",j.wf));$(A).appendTo($("#doccontent"))});$("#doccontent td.kbb-question,#doccontent td.kbb-answer").each(function(a){var b=$(this),g;if(a==0)a=e.ue,g=e.te;else if(a-1==e.Of)a=e.Kc,g=e.Jc,m=this;else{if(o>=e.Ya.length)return!1;a=e.ce[o];g=e.be[o];o++}g?Ya(function(){b.html(g)}):
b.text(a);f.$e(b,[],!1,!1);Za(b,!1)});b&&m&&$(m).addClass("kbb-answer-correct");$("#doccontent td.kbb-answer").bind("click",function(a){var b=$(this).offset(),g=$(this).outerWidth(),h=$(this).outerHeight(),j=Math.min(40,0.15*g),o=Math.min(40,0.15*h),p=a.pageX>b.left+g/2;if(!(a.pageX<b.left+j||a.pageX>b.left+g-j||a.pageY<b.top+o||a.pageY>b.top+h-o)){if(f.Mc!=i)clearTimeout(f.Mc),f.Mc=i;var r=$("#doccontent td.kbb-answer.kbb-answer-correct").length>0,a=e.Ya.length==0,s=this==m;r||a?s=!0:$(this).addClass(s?
"kbb-answer-correct":"kbb-answer-wrong");setTimeout(function(){if(s){Vw(f,e,s&&!r);var a=ag(f,p,!1);a==i?f.Ze(!0,!0,!1):dg(f,a,!1)}else Uw(f,e,!1),dg(f,e,!0),f.Mc=setTimeout(function(){f.Mc=i;Vw(f,e,!1);var a=ag(f,p,!1);a==i?f.Ze(!0,!0,!1):dg(f,a,!1)},5E3)},r||a?0:750)}});var E=!1;$("#doccontent td.kbb-toggle-note").bind("click",function(){g();f.qf=E});$("#docframe").find("*").myDisableSelection(!1);a.xc&&(e.Kc==""||a.qf&&h.Yb>=0)&&g();$("#doccontent").scrollTop(0)}
function Vw(a,e,b){if(!a.xc){var g=a.q[a.S[e.mc]],f=a.S.length-1-e.mc,h=f;b?(g.pb>0&&a.ee++,g.pb++,g.pb>=3?h=f:g.pb>=2?h=Math.min(10,f):g.pb>=1&&(h=Math.min(2,f))):(a.If++,g.Eb=-1,g.pb=0,h=Math.min(3,f));a.S.splice(e.mc+h,0,a.S.splice(e.mc,1));if(g.pb>=3){g.Eb<0.49?g.Eb=0.5:g.Eb<5.49?g.Eb=5.5:g.Eb*=1.75;g.oa=Date.now()+g.Eb*864E5;if(g.properties===i)g.properties={};g.properties.nttl=g.oa;g.properties.cli=g.Eb;e=JSON.stringify(g.properties);b=a.Gg.replace("%1",g.text);a.af&&a.af(g.I,i,i,i,i,-1,e,i,
-1,"","","","",b,i)}}}function $f(a){var e=0,b=i,g=0,f=0,h=Date.now(),j=new Tw;j.ac=99999999999;for(e=0;e<a.q.length;e++)b=a.q[e],j.ac=b.oa<0?1:Math.min(j.ac,1+Math.max(0,parseInt((b.oa-h)/864E5))),b.oa<0&&j.lf++,b.oa>=0&&b.oa<=h&&j.uf++,b.oa>h&&(b.oa-h)/864E5<=7&&j.tf++,j.$d+=Math.max(0,Math.min(30,(b.oa-h)/864E5)/30);j.$d=parseInt(100*j.$d/30);for(e=0;e<a.S.length;e++)b=a.q[a.S[e]],g+=3-b.pb,f+=3-(b.oa<0?0:1);if(f>0)j.wf=parseInt(100*(f-g)/f);return j};var Gp=!1,Sh=!0,Ww=0,Xw=[],Yw=[],Wf=!1,Zw={execItemCommand:JSON.stringify([{a:"ci",i:".id-show-sidebar:visible",mbh:".id-sidebar",wa:500},{a:"ci",i:".id-editmode",mbh:".id-editmode-gallery",wa:500},{a:"ci",i:".id-editmode-item>a",mbh:".id-editmode-item>div",wa:500},{a:"ci",i:"$1$"}]),execInsertCommand:JSON.stringify([{a:"ci",i:".id-show-sidebar:visible",mbh:".id-sidebar",wa:500},{a:"ci",i:".id-editmode",mbh:".id-editmode-gallery",wa:500},{a:"ci",i:".id-insert>a",mbh:".id-insert>div",wa:500},{a:"ci",
i:"$1$"}]),setLayoutMode:JSON.stringify([{a:"ci",i:".id-show-sidebar:visible",mbh:".id-sidebar",wa:500},{a:"ci",i:".id-viewmode",mbh:".id-viewmode-gallery",wa:500},{a:"ci",i:".id-viewmode-diagram>a",mbh:".id-viewmode-diagram>div",wa:500},{a:"ci",i:".id-diagram-layout>a",mbh:".id-diagram-layout>div",wa:500},{a:"ci",i:"$1$",waudr:!0,wto:1500,wa:500},{a:"csg",sg:".id-viewmode-gallery"}]),selectDiagramMode:JSON.stringify([{a:"ci",i:".id-show-sidebar:visible",mnbs:"$1$",mbh:".id-sidebar",wa:500},{a:"ci",
i:".id-viewmode",mnbs:"$1$",mbh:".id-viewmode-gallery",wa:500},{a:"ci",i:".id-viewmode-diagram>a",mnbs:"$1$",mbh:".id-viewmode-diagram>div",wa:500},{a:"ci",i:"$1$",mnbs:"$1$",waudr:!0,wto:1500,wa:500},{a:"csg",sg:".id-viewmode-gallery"}]),clickItemToolbar:JSON.stringify([{a:"oit",ii:"$1$",bi:"$2$",mbh:".itemtoolbar",wa:500},{a:"ci",i:".itemtoolbar $3$",wa:500}]),clickRelationToolbar:JSON.stringify([{a:"ort","if":"$1$",it:"$2$",bi:"$3$",wa:500},{a:"ci",i:".relationtoolbar $4$",wa:500}]),clickQuickAccessToolbar:JSON.stringify([{a:"ci",
i:".quickaccesstoolbar $1$",mnbs:"$1$",waudr:!0,wa:500}]),clickQuickAccessToolbarDirect:JSON.stringify([{a:"ci",i:".quickaccesstoolbar $1$",wa:500,mnbs:"$1$"}]),newItem:JSON.stringify([{a:"sit",it:"$1$"},{m:"clickItemToolbar",p:["$2$","$3$",".id-new-item"]},{a:"ci",i:".kbb-tabbed-dialog-tabs .id-edit-item-name",mbh:".kbb-tabbed-dialog-pages .id-edit-item-name"},{a:"tt",iifs:".kbb-tabbed-dialog-pages .id-edit-item-name > iframe",i:"body",t:"$4$",mbv:".kbb-tabbed-dialog-pages .id-edit-item-name",wb:5E3},
{m:"insertTable",p:[".kbb-tabbed-dialog-toolbar","$5$","$6$",".kbb-tabbed-dialog-pages .id-edit-item-name","$7$","$8$","$9$","$10$","$11$","$12$","$13$","$14$","$15$","$16$"],eine:"$5$$6$$7$$8$$9$$10$$11$$12$$13$$14$$15$$16$"},{a:"ci",i:".kbb-tabbed-dialog-tabs .id-edit-item-description",eine:"$17$"},{a:"tt",iifs:".kbb-tabbed-dialog-pages .id-edit-item-description > iframe",i:"body",t:"$17$",mbv:".kbb-tabbed-dialog-pages .id-edit-item-description",wb:5E3,eine:"$17$"},{m:"insertTable",p:[".kbb-tabbed-dialog-toolbar",
"$18$","$19$",".kbb-tabbed-dialog-pages .id-edit-item-description","$20$","$21$","$22$","$23$","$24$","$25$","$26$","$27$","$28$","$29$"],eine:"$18$$19$$20$$21$$22$$23$$24$$25$$26$$27$$28$$29$"},{a:"ci",i:".kbb-tabbed-dialog-tabs .id-edit-item-hyperlink",eine:"$30$"},{a:"tt",i:".kbb-tabbed-dialog-pages .id-edit-item-hyperlink .id-edit-item-hyperlink input",t:"$30$",mbv:".kbb-tabbed-dialog-pages .id-edit-item-hyperlink",wb:5E3,eine:"$30$"},{a:"ci",i:".kbb-tabbed-dialog-tabs .id-edit-item-category",
eine:"$31$"},{a:"tt",i:".kbb-tabbed-dialog-pages .id-edit-item-category .id-edit-item-select-category .kbb-selectcategory",t:"$31$",mbv:".kbb-tabbed-dialog-pages .id-edit-item-category",wb:5E3,eine:"$31$"},{a:"ci",i:".id-edit-ok",waudr:!0,wa:500},{a:"uis"},{a:"sit",it:!1}]),newItemName:JSON.stringify([{m:"newItem",p:["$1$","$2$","$3$","$4$","","","","","","","","","","","","","","","","","","","","","","","","","","",""]}]),newRelation:JSON.stringify([{a:"sit",it:"$1$"},{a:"dift",iif:"$2$",bif:"$3$",
iit:"$4$",bit:"$5$",waudr:!0,wto:2500,wa:500},{a:"ci",i:".id-edit-cancel",mbv:".id-edit-item-dialog"},{a:"urs"},{a:"sit",it:!1}]),editRelation:JSON.stringify([{m:"clickRelationToolbar",p:["$1$","$2$","$3$",".id-edit-relation"]},{a:"ci",i:".kbb-tabbed-dialog-tabs .id-edit-relation-name",mbh:".kbb-tabbed-dialog-pages .id-edit-relation-name"},{a:"tt",iifs:".kbb-tabbed-dialog-pages .id-edit-relation-name > iframe",i:"body",t:"$4$",mbv:".kbb-tabbed-dialog-pages .id-edit-relation-name",wb:5E3},{a:"ci",
i:".kbb-tabbed-dialog-tabs .id-edit-relation-backrelname",eine:"$5$"},{a:"tt",iifs:".kbb-tabbed-dialog-pages .id-edit-relation-backrelname > iframe",i:"body",t:"$5$",mbv:".kbb-tabbed-dialog-pages .id-edit-relation-backrelname",wb:5E3,eine:"$5$"},{a:"ci",i:".kbb-tabbed-dialog-tabs .id-edit-relation-description",eine:"$6$"},{a:"tt",iifs:".kbb-tabbed-dialog-pages .id-edit-relation-description > iframe",i:"body",t:"$6$",mbv:".kbb-tabbed-dialog-pages .id-edit-relation-description",wb:5E3,eine:"$6$"},{a:"ci",
i:".kbb-tabbed-dialog-tabs .id-edit-relation-category",eine:"$7$"},{a:"tt",i:".kbb-tabbed-dialog-pages .id-edit-relation-category .id-edit-relation-select-category .kbb-selectcategory",t:"$7$",mbv:".kbb-tabbed-dialog-pages .id-edit-relation-category",wb:5E3,eine:"$7$"},{a:"ci",i:".id-edit-ok",waudr:!0,wa:500}]),clickButton:JSON.stringify([{a:"ci",i:"$1$",wa:500}]),setDistance:JSON.stringify([{a:"ci",i:".id-show-sidebar:visible",mbh:".id-sidebar",wa:500},{a:"ci",i:".id-viewmode",mbh:".id-viewmode-gallery",
wa:500},{a:"dib",i:".id-viewmode-stretch .ui-slider-handle",dx:"$1$",waudr:!0,wa:500}]),setItemColor:JSON.stringify([{a:"si",ii:"$1$",bi:"$2$",wa:100},{a:"ci",i:".id-show-sidebar:visible",mbh:".id-sidebar",wa:500},{a:"ci",i:".id-format-diagram",mbh:".id-format-diagram-gallery",wa:500},{a:"ci",i:".id-format-diagram-item>a",mbh:".id-format-diagram-item>div",wa:500},{a:"ci",i:".id-item-color>a",mbh:".id-item-color>div",wa:500},{a:"ci",i:".id-item-color .kbb-colorpicker-color-field:eq($3$)",waudr:!0,
wa:500},{a:"csg",sg:".id-format-diagram-gallery"}]),setItemFontSize:JSON.stringify([{a:"si",ii:"$1$",bi:"$2$",wa:100},{a:"ci",i:".id-show-sidebar:visible",mbh:".id-sidebar",wa:500},{a:"ci",i:".id-format-diagram",mbh:".id-format-diagram-gallery",wa:500},{a:"ci",i:".id-format-diagram-item>a",mbh:".id-format-diagram-item>div",wa:500},{a:"ci",i:".id-item-font-size>a",mbh:".id-item-font-size>div",wa:500},{a:"ci",i:".id-item-font-size $3$",waudr:!0,wa:500},{a:"csg",sg:".id-format-diagram-gallery"}]),setRelationColor:JSON.stringify([{a:"ort",
"if":"$1$",it:"$2$",bi:"$3$",wa:500},{a:"ci",i:".id-show-sidebar:visible",mbh:".id-sidebar",wa:500},{a:"ci",i:".id-format-diagram",mbh:".id-format-diagram-gallery",wa:500},{a:"ci",i:".id-format-diagram-relation>a",mbh:".id-format-diagram-relation>div",wa:500},{a:"ci",i:".id-relation-color>a",mbh:".id-relation-color>div",wa:500},{a:"ci",i:".id-relation-color .kbb-colorpicker-color-field:eq($4$)",waudr:!0,wa:500},{a:"csg",sg:".id-format-diagram-gallery"}]),setRelationLineStyle:JSON.stringify([{a:"ort",
"if":"$1$",it:"$2$",bi:"$3$",wa:500},{a:"ci",i:".id-show-sidebar:visible",mbh:".id-sidebar",wa:500},{a:"ci",i:".id-format-diagram",mbh:".id-format-diagram-gallery",wa:500},{a:"ci",i:".id-format-diagram-relation>a",mbh:".id-format-diagram-relation>div",wa:500},{a:"ci",i:".id-relation-line-style>a",mbh:".id-relation-line-style>div",wa:500},{a:"ci",i:".id-relation-line-style $4$",waudr:!0,wa:500},{a:"csg",sg:".id-format-diagram-gallery"}]),setTextNote:JSON.stringify([{a:"si",ii:"$1$",bi:"$2$",wa:100},
{a:"ci",i:".id-show-sidebar:visible",mbh:".id-sidebar",wa:500},{a:"ci",i:".id-textnote",mbh:".id-textnote-gallery",wa:500},{a:"ci",i:".id-text-note-edit-mode",mnbs:".id-text-note-edit-mode"},{a:"tt",iifs:".id-textnote-gallery .textnote > iframe",i:"body",t:"$3$",mbv:".id-textnote-gallery",wb:5E3},{m:"insertTable",p:[".id-textnote-gallery","$4$","$5$",".id-textnote-gallery .textnote","$6$","$7$","$8$","$9$","$10$","$11$","$12$","$13$","$14$","$15$"],eine:"$4$$5$$6$$7$$8$$9$$10$$11$$12$$13$$14$$15$"},
{a:"ci",i:".id-textnote-gallery .id-edit",wa:500},{a:"ci",i:".id-textnote-gallery .id-update-textnote",wa:500},{a:"ci",i:".id-textnote",mbv:".id-textnote-gallery",wa:500}]),insertTable:JSON.stringify([{a:"mcte",iifs:"$4$ > iframe"},{a:"ci",i:"$1$ .id-table",wa:500},{a:"ci",i:"$1$ .id-insert-table",wa:500},{a:"tt",i:".kbb-insert-table-dialog .kbb-rowcount",t:"$2$",eine:"$2$",wa:500},{a:"tt",i:".kbb-insert-table-dialog .kbb-columncount",t:"$3$",eine:"$3$",wa:500},{a:"ci",i:".ui-dialog:has(.kbb-insert-table-dialog) .ui-dialog-buttonset button:first-child",
wa:500},{a:"tt",iifs:"$4$ > iframe",i:"td:eq(0)",t:"$5$",eine:"$5$",wa:500},{a:"tt",iifs:"$4$ > iframe",i:"td:eq(1)",t:"$6$",eine:"$6$",wa:500},{a:"tt",iifs:"$4$ > iframe",i:"td:eq(2)",t:"$7$",eine:"$7$",wa:500},{a:"tt",iifs:"$4$ > iframe",i:"td:eq(3)",t:"$8$",eine:"$8$",wa:500},{a:"tt",iifs:"$4$ > iframe",i:"td:eq(4)",t:"$9$",eine:"$9$",wa:500},{a:"tt",iifs:"$4$ > iframe",i:"td:eq(5)",t:"$10$",eine:"$10$",wa:500},{a:"tt",iifs:"$4$ > iframe",i:"td:eq(6)",t:"$11$",eine:"$11$",wa:500},{a:"tt",iifs:"$4$ > iframe",
i:"td:eq(7)",t:"$12$",eine:"$12$",wa:500},{a:"tt",iifs:"$4$ > iframe",i:"td:eq(8)",t:"$13$",eine:"$13$",wa:500},{a:"tt",iifs:"$4$ > iframe",i:"td:eq(9)",t:"$14$",eine:"$14$",wa:500}]),closeLastTableViewColumn:JSON.stringify([{a:"ci",i:".kbb-tableviewcolumnclosebtn:last",wa:250}]),searchItemName:JSON.stringify([{a:"ci",i:"input.ui-autocomplete-input.search",wa:500},{a:"focus",i:"input.ui-autocomplete-input.search"},{a:"kd",i:"input.ui-autocomplete-input.search",kc:37},{a:"slow"},{a:"ttkb",i:"input.ui-autocomplete-input.search",
t:"$1$",wa:1E3},{a:"normal"},{a:"kd",i:"input.ui-autocomplete-input.search",kc:13},{a:"blur",i:"input.ui-autocomplete-input.search"}]),waitUntilVisible:JSON.stringify([{a:"dn",mbv:"$1$",wb:5E3}])};function $w(a,e,b){var g=a.scrollParent().first();g.length>0?ax(g,a.offset(),a.outerWidth(),a.outerHeight(),e,b):b()}
function ax(a,e,b,g,f,h){var j=0,m=0,o=a.offset(),x=a.width(),s=a.height();e.left<o.left?j=e.left-(o.left+150):e.left+b>o.left+x&&(j=e.left+b-(o.left+x-150));e.top<o.top?m=e.top-(o.top+150):e.top+g>o.top+s&&(m=e.top+g-(o.top+s-150));j!=0&&typeof a[0].scrollLeft!=="undefined"||m!=0&&typeof a[0].scrollTop!=="undefined"?(e={},j!=0&&typeof a[0].scrollLeft!=="undefined"&&(e.scrollLeft=a[0].scrollLeft+j),m!=0&&typeof a[0].scrollTop!=="undefined"&&(e.scrollTop=a[0].scrollTop+m),a.stop().animate(e,500/f,
"smoothEasing",h)):h()}function bx(){var a=$(".kbb-sp-cursor");a.length==0&&(a=$('<div class="kbb-sp-cursor"></div>').appendTo("body"));a.show();return a}function cx(a,e){var b=document.createEvent("Event");b.initEvent(a,!0,!0);b.altKey=!1;b.ctrlKey=!1;b.shiftKey=!1;b.charCode=b.which=b.keyCode=e;return $.Event(b)}function dx(a,e){a.trigger(cx("keydown",e));a.trigger(cx("keypress",e));a.trigger(cx("input",e));a.trigger(cx("change",e));a.trigger(cx("keyup",e))}
function ex(a,e,b){var g=$(".kbb-sp-cursor"),f=g.offset(),h=g.outerWidth(),g=g.outerHeight();if(b)switch(a){case "mousedown":mb()?a="pointerdown":rb()&&(a="MSPointerDown");break;case "mousemove":mb()?a="pointermove":rb()&&(a="MSPointerMove");break;case "mouseup":mb()?a="pointerup":rb()&&(a="MSPointerUp")}b=document.createEvent("Event");b.initEvent(a,!0,!0);b.pageX=f.left+0.5*h;b.pageY=f.top+0.5*g;b.button=0;b.buttons=1;b.which=1;a=$.Event(b);a.kmap_istouchevent=a.originalEvent.kmap_istouchevent=e;
return a}function fx(a,e,b,g,f,h,j){var m=bx();g&&m.addClass("kbb-sp-cursor-mousedown");setTimeout(function(){a.trigger(ex(e,b,h));setTimeout(function(){f&&m.removeClass("kbb-sp-cursor-mousedown");j()},100)},100)}function gx(a,e,b,g,f){var h=Math.pow(a*a+e*e,0.5);h>0?(g=Math.max(500,Math.min(5E3,h/0.75))/g,bx().animate({left:"+="+a+"px",top:"+="+e+"px"},{duration:g,easing:"smoothEasing",progress:function(){$(document).trigger(ex("mousemove",!1,b))},always:function(){f()}})):f()}
function hx(a,e,b,g){var f=bx(),h=f.offset(),j=f.outerWidth(),f=f.outerHeight();gx(a.left-(h.left+0.5*j),a.top-(h.top+0.5*f),e,b,g)}function ix(a,e,b,g,f){$w(e,g,function(){var h=e.offset();h.left+=0.5*e.outerWidth();h.top+=0.5*e.outerHeight();if(a&&a.length>0){var j=a.offset();h.left+=j.left;h.top+=j.top}hx(h,b,g,f)})}function jx(a,e,b,g,f,h,j,m){ix(a,e,!1,j,function(){Pb?m():fx(e,b,g,f,h,!1,function(){Pb?m():setTimeout(function(){m()},100)})})}
function kx(a,e,b,g){hx(a,!1,b,function(){Pb?g():fx(e.find(".canvas9"),"click",!0,!0,!0,!1,function(){Pb?g():setTimeout(function(){g()},100)})})}function lx(a,e,b,g){(a=mx(a,e))?jx(i,a.find("a:first"),"click",!0,!0,!0,b,g):g()}function nx(a,e,b,g,f){var h=ox(a,e,b);h?ax(e.find(".kmappage"),h,50,50,g,function(){(h=ox(a,e,b))?kx(h,e,g,f):f()}):f()}function px(a,e,b,g){(a=qx(a,e))?jx(i,a.find("a:first"),"click",!0,!0,!0,b,g):g()}
function rx(a,e,b,g,f){var h=sx(a,e,b);h?ax(e.find(".kmappage"),h,50,50,g,function(){(h=sx(a,e,b))?kx(h,e,g,f):f()}):f()}function Rx(a,e,b,g,f,h){var j=Sx(a,e,b,g);j?ax(b.find(".kmappage"),j,50,50,f,function(){(j=Sx(a,e,b,g))?kx(j,b,f,h):h()}):h()}function Tx(a,e,b,g,f){var h=Ux(a,e,b);h?ax(e.find(".kmappage"),h,50,50,g,function(){(h=Ux(a,e,b))?kx(h,e,g,f):f()}):f()}
function Vx(a,e,b,g,f){a.find(".kmappage").focus();jx(i,e.find("a:first"),"click",!0,!0,!0,g,function(){setTimeout(function(){function a(){fx(j,"mousedown",!1,!0,!1,!0,function(){ix(i,b,!0,0.25*g,function(){setTimeout(function(){ix(i,b,!0,1E4,function(){fx($(document),"mouseup",!1,!1,!0,!0,f)})},250)})})}var j=$(".itemselector:visible").first();j.length>0?a():jx(i,e.find("a:first"),"click",!0,!0,!0,g,function(){j=$(".itemselector:visible").first();j.length>0?a():f()})},250)})}
function Wx(a,e,b,g,f){jx(i,a,"mouseover",!1,!1,!1,g,function(){fx(a,"mousemove",!1,!1,!1,!1,function(){fx(a,"mousedown",!1,!0,!1,!1,function(){gx(e,b,!1,g,function(){fx($(document),"mouseup",!1,!1,!0,!1,f)})})})})}function Xx(a,e){for(var b=0,g=0;g<e.j.q.length;g++){var f=e.j.q[g];if(f&&f.A&&f.A.J)if(a==b)return g;else b++}return-1}function mx(a,e){var b=Xx(a,e);return b>=0?e.j.q[b].A.J:i}
function qx(a,e){if(a<Xw.length){var b=Xw[Xw.length-1-a];if(typeof e.j.F[b]!=="undefined"&&(b=e.j.q[e.j.F[b]])&&b.A&&b.A.J)return b.A.J}return i}function ox(a,e,b){a=Xx(a,b);return a>=0?(b=b.j.q[a],e=e.find(".ikmap").offset(),e.left+=b.O,e.top+=b.N,e):i}function sx(a,e,b){return a<Xw.length&&(a=Xw[Xw.length-1-a],typeof b.j.F[a]!=="undefined"&&(b=b.j.q[b.j.F[a]]))?(e=e.find(".ikmap").offset(),e.left+=b.O,e.top+=b.N,e):i}
function Sx(a,e,b,g){a=Xx(a,g);e=Xx(e,g);if(a>=0&&e>=0)for(var f=0;f<g.j.R.length;f++){var h=g.j.R[f];if(h.Uc&&h.ra==a&&h.Va==e)return g=h.je(),b=b.find(".ikmap").offset(),b.left+=g.x,b.top+=g.y,b}return i}function Ux(a,e,b){return a<Yw.length&&(a=Yw[Yw.length-1-a],typeof b.j.ja[a]!=="undefined"&&(b=b.j.R[b.j.ja[a]]))?(b=b.je(),e=e.find(".ikmap").offset(),e.left+=b.x,e.top+=b.y,e):i}
function Yx(a,e,b,g){var f=1,h=setInterval(function(){var b=e.substr(0,f);a.is("input,textarea")?a.val(b):(a.text(b),a[0].isContentEditable&&bh(a[0],{start:-1,end:-1,after:!1,scrollX:0,scrollY:0}));a[0].scrollTop!=a[0].scrollHeight-a.innerHeight()&&a.stop().animate({scrollTop:1+a[0].scrollHeight-a.innerHeight()},"100","smoothEasing",i);f++;if(Pb||f>e.length)clearInterval(h),g()},100/b)}function Zx(a,e,b,g,f){jx(a,e,"click",!1,!0,!0,g,function(){Pb?f():Yx(e,b,g,f)})}
function $x(a,e,b,g){var f=0,h=setInterval(function(){var b=e.substr(0,f+1);a.is("input,textarea")?a.val(b):(a.text(b),a[0].isContentEditable&&bh(a[0],{start:-1,end:-1,after:!1,scrollX:0,scrollY:0}));a[0].scrollTop!=a[0].scrollHeight-a.innerHeight()&&a.stop().animate({scrollTop:1+a[0].scrollHeight-a.innerHeight()},"100","smoothEasing",i);dx(a,e.charCodeAt(f));f++;if(Pb||f>=e.length)clearInterval(h),g()},100/b)}
function ay(a,e,b,g,f,h){function j(){function x(a){var b;if(Pb)A();else if(typeof p.eine!=="undefined"&&p.eine=="")j();else{if(typeof p.mbh!=="undefined"){var e=$(p.mbh).first();if(typeof p.wb!=="undefined"){if(e.is(":visible")||a<2){b=(new Date).getTime();b-E<p.wb?setTimeout(function(){x(e.is(":visible")?0:a+1)},100):A();return}}else if(e.is(":visible")){j();return}}if(typeof p.mbv!=="undefined"){var f=$(p.mbv).first();if(typeof p.wb!=="undefined"){if(!f.is(":visible")||a<2){b=(new Date).getTime();
b-E<p.wb?setTimeout(function(){x(f.is(":visible")?a+1:0)},100):A();return}}else if(!f.is(":visible")){j();return}}if(typeof p.mbs!=="undefined"||typeof p.mnbs!=="undefined"){var g,h;typeof p.mbs!=="undefined"?(b=!1,g=!0,h=$(p.mbs).first()):(b=!0,g=!1,h=$(p.mnbs).first());h.hasClass("kbb-symbolbtn")?b=h.symbolbtn("isselected"):h.hasClass("kbb-gallery-item")?b=h.galleryitem("isselected"):h.hasClass("kbb-toolbarbtn")&&(b=h.toolbarbtn("isselected"));if(b!=g){j();return}}Sh=!1;Ww=0;r()}}function s(){Pb?
A():typeof p.waudr!=="undefined"&&p.waudr&&!Sh&&Ww<(typeof p.wto!=="undefined"?p.wto:1E4)?setTimeout(function(){Ww+=25;s()},25):typeof p.wa!=="undefined"?setTimeout(function(){j()},p.wa):j()}function r(){if(Pb)A();else{var a=$(),f=i;typeof p.iifs!=="undefined"&&(f=$(p.iifs).first(),f.length==0&&(f=i));if(typeof p.i!=="undefined"&&(a=f?f.contents().find(p.i).first():$(p.i).first(),a.length==0)){A();return}if(typeof p.m!=="undefined"){var h=p.m,a=typeof p.p!=="undefined"?p.p:i,f=e,j=b,o=g,r=s,x=!1;
if(h&&typeof Zw[h]!=="undefined"){h=Zw[h];if(a)for(var E=0;E<a.length;E++){var ka=typeof a[E]==="number"||typeof a[E]==="boolean",Y=JSON.stringify(a[E]);Y.length>1&&Y[0]=='"'&&Y[Y.length-1]=='"'&&(Y=Y.substring(1,Y.length-1));Y.substring(0,2)=="T:"&&(Y=o[Y.substring(2)]);h=h.replace(RegExp((ka?'"':"")+"\\$"+(E+1)+"\\$"+(ka?'"':""),"g"),Y)}try{var aa=$.parseJSON(h);aa&&(ay(aa,f,j,o,!0,r),x=!0)}catch(H){}}x||r()}else if(p.a=="ci")jx(f,a,"click",!1,!0,!0,m,s);else if(p.a=="cii")lx(typeof p.ii!=="undefined"?
p.ii:0,b,m,s);else if(p.a=="ciis")nx(typeof p.ii!=="undefined"?p.ii:0,e,b,m,s);else if(p.a=="csi")px(typeof p.bi!=="undefined"?p.bi:0,b,m,s);else if(p.a=="csis")rx(typeof p.bi!=="undefined"?p.bi:0,e,b,m,s);else if(p.a=="cri")Rx(typeof p["if"]!=="undefined"?p["if"]:0,typeof p.it!=="undefined"?p.it:0,e,b,m,s);else if(p.a=="csr")Tx(typeof p.bi!=="undefined"?p.bi:0,e,b,m,s);else if(p.a=="uis")aa=$(".id-item-selector").first(),aa.length>0&&(aa=aa.data("pid"),aa>=0&&Xw.push(aa)),s();else if(p.a=="urs"){aa=
b.j.R;a=-1;for(f=0;f<aa.length;f++)a=Math.max(a,aa[f].Ea);a>=0&&Yw.push(a);s()}else p.a=="oit"?typeof p.bi!=="undefined"&&p.bi>=0?px(p.bi,b,m,s):lx(typeof p.ii!=="undefined"?p.ii:0,b,m,s):p.a=="ort"?typeof p.bi!=="undefined"&&p.bi>=0?Tx(p.bi,e,b,m,s):Rx(typeof p["if"]!=="undefined"?p["if"]:0,typeof p.it!=="undefined"?p.it:0,e,b,m,s):p.a=="dift"?(a=aa=i,typeof p.bif!=="undefined"&&p.bif>=0?aa=qx(p.bif,b):typeof p.iif!=="undefined"&&p.iif>=0&&(aa=mx(p.iif,b)),typeof p.bit!=="undefined"&&p.bit>=0?a=
qx(p.bit,b):typeof p.iit!=="undefined"&&p.iit>=0&&(a=mx(p.iit,b)),aa&&a?Vx(e,aa,a,m,s):s()):p.a=="si"?typeof p.bi!=="undefined"&&p.bi>=0?rx(p.bi,e,b,m,s):nx(typeof p.ii!=="undefined"?p.ii:0,e,b,m,s):p.a=="ctvc"?(f=typeof p.ii!=="undefined"?p.ii:0,aa=m,a=s,j=e.find(".kbb-tableviewcell"),f<j.length?(f=$(j[f]),jx(i,f,"click",!1,!0,!0,aa,a)):a()):p.a=="dib"?Wx(a,typeof p.dx!=="undefined"?p.dx:0,typeof p.dy!=="undefined"?p.dy:0,m,s):p.a=="tt"?(aa=p.t,Zx(f,a,aa,m,s)):p.a=="ttd"?(aa=p.t,Yx(a,aa,m,s)):p.a==
"ttkb"?(aa=p.t,$x(a,aa,m,s)):p.a=="kd"?(dx(a,p.kc),s()):p.a=="mcte"?(a=f[0],aa=a.contentWindow?a.contentWindow:a.contentDocument.defaultView,a=a.contentDocument?a.contentDocument:a.contentWindow.document,f=a.body,f.focus(),j=Yg(f,aa,a),j.start=-1,j.end=-1,bh(f,j,aa,a),f.blur(),s()):p.a=="focus"?(a.focus(),s()):p.a=="blur"?(a.blur(),s()):p.a=="slow"?(m=0.2,s()):p.a=="normal"?(m=1,s()):p.a=="fast"?(m=5,s()):p.a=="csg"?e.find(p.sg).sidegallery("show",!1,0,s):p.a=="sit"?(Wf=typeof p.it==="boolean"?p.it:
!1,s()):p.a=="dn"&&s()}}function A(){f||(bx().hide(),$(".kbb-screenplay-overlay").remove(),Gp=!1);h()}if(Pb||o>=a.length)A();else{var p=a[o];o++;var E=(new Date).getTime();x(0)}}var m=1,o=0;f||$("<div></div>").addClass("kbb-screenplay-overlay").fadeTo(0,0).appendTo($("body")).bind("mousedown mousemove mouseup click",ha(!1));j()}function by(a,e,b,g,f){Gp=!0;Pb=!1;ay(a,e,b,g,!1,f)};var cy={0:"Weiter",1:"Beenden",2:"Hilfe-Assistent",3:"Im n\u00e4chsten Schritt f\u00fcge ich ein neues Element in das Diagramm ein. Wichtigster Teil eines Diagrammelements ist sein Name, der im Diagramm angezeigt wird. Zus\u00e4tzlich k\u00f6nnen Sie noch eine Beschreibung, einen Hyperlink und eine Kategorie angeben. Der Beschreibungstext wird als Tooltip bei einem Klick auf das Diagrammelement angezeigt. Der Hyperlink wird als Icon in der linken oberen Ecke des Elements angezeigt und erm\u00f6glicht z.B. das Aufrufen von Webseiten. Viele Befehle wirken auf alle Mitglieder einer Kategorie gleichzeitig, so werden alle Elemente einer Kategorie z.B. immer gleichartig formatiert dargestellt.",
4:"Als N\u00e4chstes erstelle ich vier weitere Elemente und verbinde sie durch Linien.",5:"Elementname - wird im Diagramm angezeigt",6:"Elementbeschreibung - wird bei einem Klick auf das Element als Tooltip angezeigt",7:"http://www.buildyourmap.de",8:"Kategoriename - das Element ist Mitglied dieser Kategorie",9:"Um eine neue Verbindungslinie zu erstellen, klicke ich zun\u00e4chst auf das Element, bei dem die Linie starten soll, und ziehe anschlie\u00dfend den Finger bzw. die Maus zu dem Element, bei dem die Linie enden soll.",
10:'Ich hoffe, diese kurze Einf\u00fchrung hat Ihr Interesse an unserem Programm geweckt. Sie k\u00f6nnen \u00fcbrigens alle \u00c4nderungen, die der Hilfe-Assistent durchgef\u00fchrt hat, im "Diagramm bearbeiten"-Men\u00fc unter "R\u00fcckg\u00e4ngig" - "Hilfe-Assistent" wieder r\u00fcckg\u00e4ngig machen. Falls Sie noch Fragen oder Verbesserungsvorschl\u00e4ge haben, so senden Sie diese bitte per E-Mail an info@inforapid.de. Und ich freue mich nat\u00fcrlich ganz besonders \u00fcber jeden Nutzer, der meine Arbeit durch den Kauf der kostenpflichtigen Version unterst\u00fctzt.',
11:"Diese Rundtour f\u00fchrt Sie durch die wichtigsten Funktionen des KnowledgeBase Builders. Beginnen wir mit einer MindMap, die ich durch Einf\u00fcgen von gegliedertem Text erstelle.",12:"Elementname",13:"Jetzt soll noch ein kurzer Text entlang der Verbindungslinie ausgegeben werden. Dazu w\u00e4hle ich zun\u00e4chst die Verbindungslinie aus und \u00f6ffne dann den Bearbeiten-Dialog. Hier kann ich sowohl den Text f\u00fcr die Vorw\u00e4rts- als auch f\u00fcr die R\u00fcckw\u00e4rtsverbindung eingeben. Normalerweise gen\u00fcgt der Text f\u00fcr die Vorw\u00e4rtsverbindung. Gebe ich beide Texte ein, so wird der Text f\u00fcr die R\u00fcckw\u00e4rtsverbindung dann angezeigt, wenn das Endelement der Verbindung hierarchisch \u00fcber dem Startelement liegt. Zus\u00e4tzlich kann ich wie bei Elementen noch einen Beschreibungstext, der als Tooltip ausgeben wird, und eine Kategorie eingeben.",
14:"Verbindungsname",15:"R\u00fcckw\u00e4rtsverbindungsname",16:"Verbindungsbeschreibung - wird bei einem Klick auf die Verbindung als Tooltip angezeigt",17:"Kategoriename - die Verbindung ist Mitglied in dieser Kategorie",18:"Aktuell wird das Diagramm mit einem kompakten MindMap-Layout dargestellt. Besser geeignet ist in diesem Fall jedoch ein radiales MindMap-Layout. Sie k\u00f6nnen aber noch zwischen vielen anderen Layoutm\u00f6glichkeiten wie einem Flussdiagramm- oder einem Netzwerk-Layout w\u00e4hlen.",
19:"Eine Notiz im HTML-Format mit Bildern, Tabellen und allen Formatierungsm\u00f6glichkeiten, die HTML bietet, l\u00e4sst sich zusammen mit jedem Element speichern. Der Elementname und die Elementbeschreibung werden \u00fcbrigens ebenfalls im HTML-Format gespeichert und bieten dieselben Formatierungsm\u00f6glichkeiten wie Notizen.",20:"Textnotiz im HTML-Format",21:"Elemente und Verbindungen lassen sich auf vielf\u00e4ltige Weise formatieren. Dazu w\u00e4hle ich zun\u00e4chst das Element oder die Verbindung aus und \u00e4ndere dann die Farbe, Schriftart und den Linienstil.",
22:"Zus\u00e4tzlich zur normalen Diagrammansicht bietet die Anwendung noch eine 3D-Ansicht und eine Tabellenansicht. Zun\u00e4chst schalte ich in die 3D-Ansicht um und lasse das Diagramm rotieren. Davon kann die Anwendung \u00fcbrigens auch ein Video aufzeichnen und speichern. Anschlie\u00dfend schalte ich in die Tabellenansicht um und bl\u00e4ttere die Kindelemente durch.",23:"Als n\u00e4chstes erstelle ich ein Flussdiagramm durch Einf\u00fcgen von Pseudocode und zeige, wie man vom horizontalen in das vertikale Layout wechselt.",
24:"Name",25:"Wert",26:"Zum Schluss gehe ich zum ersten Diagramm zur\u00fcck, indem ich nach dem Namen seines Wurzelelements suche. Au\u00dferdem stelle ich das Layout wieder auf das kompakte MindMap-Layout um.",27:"Durch Aufklappen der Elemente kann der Beschreibungstext auch direkt im Diagramm angezeigt werden."},dy={0:"Continue",1:"Close",2:"Help Assistant",3:"In the next step I will insert a new item into the diagram. The most important part of a diagram item is its name, which is displayed in the diagram. Additionally, you can specify a description, a hyperlink and a category. The description text is displayed as a tooltip when you click on the diagram item. The hyperlink is displayed as an icon in the top left corner of the item and allows to link web pages. Many commands affect all members of a category at the same time, so that, for example, all items in a category are displayed identically formatted.",
4:"Next, I create four more items and connect them by relation lines.",5:"Item Name - is displayed in the diagram",6:"Item Description - will be displayed as a tooltip when you click on the item",7:"http://www.buildyourmap.com",8:"Category Name - the item is a member of this category",9:"To create a new relation line first click on the item where the line should start and drag the finger or the mouse to the item where the line should end.",10:'I hope this short introduction has aroused your interest in our program. By the way, you can undo any changes made by the Help Assistant in the "Edit Diagram" menu at "Undo" "Help Assistant". If you have any questions or suggestions for improvements, please contact me by e-mail at info@inforapid.de. And of course, I\'m happy about every user who supports my work by purchasing the paid version.',
11:"This round trip will take you through the main features of the KnowledgeBase Builder. Let's start with a MindMap I create by inserting outlined text.",12:"Item Name",13:"Now let's display a short text along the relation line. First I select the line and then I open the edit dialog. Here I can enter both the text for the forward and the backward relation. Normally the text for the forward relation is sufficient. If I enter both texts, the text for the backward relation is displayed for the case that the end item of the relation is hierarchically above the start item. Additionally, as with items, I can enter a description text which is displayed in a tooltip and a category.",
14:"Relation Name",15:"Backward Relation Name",16:"Relation Description - will be displayed as a tooltip when you click on the relation",17:"Category Name - the relation is a member of this category",18:"Currently, the diagram is displayed with a compact Mind Map layout. In this case, however, a radial Mind Map layout is more suitable. You can also choose between many other layout options like a Flowchart or a Network layout.",19:"A note in HTML format with images, tables and all formatting options that HTML provides can be saved together with each item. Item names and descriptions are also saved in HTML format and offer the same formatting options as notes.",
20:"Text Note in HTML format",21:"Items and relations can be formatted in many ways. First, I select the item or relation and then I change the color, font and line style.",22:"In addition to the regular diagram view, the application also offers a 3D view and a table view. First I switch to the 3D view and make the diagram rotate. By the way, the application can also record and save a video of the rotating diagram. In the next step I switch to the table view and browse through the child elements.",
23:"Next, I create a flowchart by inserting pseudocode and show you how to switch from horizontal to vertical layout.",24:"Name",25:"Value",26:"Finally, I browse back to the first diagram by searching for the name of its root item. I also switch the layout back to the compact Mind Map layout.",27:"Expanding items will show the description text directly in the diagram."},ey={intro:[{as:"11",sp:[{m:"execInsertCommand",p:[".id-outlinedtext"]},{m:"waitUntilVisible",p:[".kbb-text-input"]},{m:"clickButton",
p:[".kbb-insert-example"]},{m:"clickButton",p:[".kbb-insert-outlinedtext-dialog + div>div>button:first-child"],waudr:!0,wa:500}]},{as:"18",sp:[{m:"setLayoutMode",p:[".id-mindmap-circular-straight"]}]},{as:"3",sp:[{m:"newItem",p:[!0,1,-1,"T:5","2","","T:24","T:25","T:24","T:25","","","","","","","T:6","","","","","","","","","","","","","T:7","T:8"]}]},{as:"27",sp:[{m:"selectDiagramMode",p:[".id-expand-items"]}]},{as:"19",sp:[{m:"setTextNote",p:[5,-1,"T:20","2","","T:24","T:25","T:24","T:25","","",
"","","",""]}]},{as:"4",sp:[{m:"newItemName",p:[!0,2,-1,"T:12"]},{m:"newItemName",p:[!0,3,-1,"T:12"]},{m:"newItemName",p:[!0,4,-1,"T:12"]},{m:"newItemName",p:[!0,5,-1,"T:12"]}]},{as:"9",sp:[{m:"newRelation",p:[!0,-1,0,-1,1]},{m:"newRelation",p:[!0,-1,1,-1,2]},{m:"newRelation",p:[!0,-1,2,-1,3]},{m:"newRelation",p:[!0,-1,3,-1,4]},{m:"newRelation",p:[!0,-1,4,-1,0]}]},{as:"13",sp:[{m:"editRelation",p:[-1,-1,0,"T:14","T:15","T:16","T:17"]}]},{as:"21",sp:[{m:"setItemColor",p:[-1,0,"81"]},{m:"setItemFontSize",
p:[-1,0,".id-very-large-font-size"]},{m:"setRelationColor",p:[-1,-1,0,"51"]},{m:"setRelationLineStyle",p:[-1,-1,1,".id-dotted-line"]}]},{as:"22",sp:[{m:"clickQuickAccessToolbar",p:[".id-show-3dview"]},{m:"clickQuickAccessToolbarDirect",p:[".id-rotate"],wa:3E3},{m:"clickQuickAccessToolbarDirect",p:[".id-stop"]},{m:"clickQuickAccessToolbar",p:[".id-show-tableview"]},{m:"clickQuickAccessToolbarDirect",p:[".id-browse-mode"]},{a:"ctvc",ii:2,wa:500},{a:"ctvc",ii:3,wa:500},{a:"ctvc",ii:9,wa:500},{a:"ctvc",
ii:14,wa:500},{m:"closeLastTableViewColumn"},{m:"closeLastTableViewColumn"},{m:"closeLastTableViewColumn"},{m:"clickQuickAccessToolbarDirect",p:[".id-edit-mode"]},{m:"clickQuickAccessToolbar",p:[".id-show-diagramview"]}]},{as:"23",sp:[{m:"execInsertCommand",p:[".id-pseudocode"]},{m:"waitUntilVisible",p:[".kbb-text-input"]},{m:"clickButton",p:[".kbb-insert-example"]},{m:"clickButton",p:[".kbb-insert-pseudocode-dialog + div>div>button:first-child"],waudr:!0,wa:500},{a:"si",ii:30,wa:2E3},{a:"si",ii:0,
wa:2E3},{m:"setLayoutMode",p:[".id-flowchart-topbottom"]},{a:"si",ii:30,wa:2E3},{a:"si",ii:0,wa:2E3}]},{as:"26",sp:[{m:"searchItemName",p:["Name 1"]},{m:"setLayoutMode",p:[".id-mindmap-circular-straight"]}]},{as:"10",sp:[]}],intro2:[{as:"10",sp:[{m:"setDistance",p:["50"]}]},{as:"10",sp:[]}]};
function xp(a,e,b,g,f){e.find(".kbb-assistant-dialog").length>0||(Xw=[],Yw=[],$("<div></div>").addClass("kbb-assistant-overlay").fadeTo(0,0).appendTo(e.find(".kmap")).bind("mousedown mousemove mouseup click",ha(!1)),g({action:"getnextundopos",database:f},function(h){function j(){$(".kbb-assistant-overlay").remove();h>=0&&(Pb=!0,g({action:"combineundoactionsupto",undostepid:h,description:m["2"],database:f},function(){b.load(-1,-1,"",0,!1,!1,xe+1)}),h=-1)}var m=a=="de"?cy:dy,o=ey.intro,x=0,s=0,r=i,
A=i,p="<form>";p+='<div class="kbb-assistant-output"></div>';p+="</form>";var E={};E[m["0"]]=function(a){s==0?(s=1,r.parent(".ui-dialog").hide(),by(o[x].sp,e,b,m,function(){x<o.length-1&&(s=0,x++,A.text(m[o[x].as]),setTimeout(function(){A.scrollTop(0)},10),a&&x==o.length-1&&$(a.target).closest(".ui-button").hide());r.parent(".ui-dialog").show();h>=0&&g({action:"combineundoactionsupto",undostepid:h,description:m["2"],database:f},fa())})):x<o.length-1?(s=0,x++,A.text(m[o[x].as]),setTimeout(function(){A.scrollTop(0)},
10),x==o.length-1&&$(a.target).closest(".ui-button").hide()):(r.dialog("close"),j())};E[m["1"]]=function(){r.dialog("close");j()};r=$('<div class="kbb-assistant-dialog" />').html(p).dialog({modal:!1,closeOnEscape:!1,buttons:E,title:m["2"],width:285,height:300,position:{my:"left top",at:"left+45px top+45px",of:e.find(".kmap")},appendTo:e.find(".kmap"),open:function(){$(this).parent(".ui-dialog").find("*").myDisableSelection(!1);$(this).parent(".ui-dialog").css("z-index","100001")},close:function(){$(this).dialog("destroy");
j()}});r.find("form").bind("submit",function(){setTimeout(function(){E[m["0"]]()},50);return!1});A=r.find(".kbb-assistant-output");A.text(m[o[x].as]);setTimeout(function(){A.scrollTop(0)},10)}))};
